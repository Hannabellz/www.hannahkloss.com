<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Imagination that Expands faster than the Universe</title>
<style title="Twine CSS">@keyframes appear{0%{opacity:0}to{opacity:1}}@keyframes fade-in-out{0%,to{opacity:0}50%{opacity:1}}@keyframes rumble{25%{top:-0.1em}75%{top:0.1em}0%,to{top:0px}}@keyframes shudder{25%{left:0.1em}75%{left:-0.1em}0%,to{left:0px}}@keyframes buoy{25%{top:0.25em}75%{top:-0.25em}0%,to{top:0px}}@keyframes sway{25%{left:0.25em}75%{left:-0.25em}0%,to{left:0px}}@keyframes pulse{0%{transform:scale(0, 0)}20%{transform:scale(1.2, 1.2)}40%{transform:scale(0.9, 0.9)}60%{transform:scale(1.05, 1.05)}80%{transform:scale(0.925, 0.925)}to{transform:scale(1, 1)}}@keyframes zoom-in{0%{transform:scale(0, 0)}to{transform:scale(1, 1)}}@keyframes shudder-in{0%, to{transform:translateX(0em)}5%, 25%, 45%{transform:translateX(-1em)}15%, 35%, 55%{transform:translateX(1em)}65%{transform:translateX(-0.6em)}75%{transform:translateX(0.6em)}85%{transform:translateX(-0.2em)}95%{transform:translateX(0.2em)}}@keyframes rumble-in{0%, to{transform:translateY(0em)}5%, 25%, 45%{transform:translateY(-1em)}15%, 35%, 55%{transform:translateY(1em)}65%{transform:translateY(-0.6em)}75%{transform:translateY(0.6em)}85%{transform:translateY(-0.2em)}95%{transform:translateY(0.2em)}}@keyframes fidget{0%, 8.1%, 82.1%, 31.1%, 38.1%, 44.1%, 40.1%, 47.1%, 74.1%, 16.1%, 27.1%, 72.1%, 24.1%, 95.1%, 6.1%, 36.1%, 20.1%, 4.1%, 91.1%, 14.1%, 87.1%, to{left:0px;top:0px}8%, 82%, 31%, 38%, 44%{left:-1px}40%, 47%, 74%, 16%, 27%{left:1px}72%, 24%, 95%, 6%, 36%{top:-1px}20%, 4%, 91%, 14%, 87%{top:1px}}@keyframes slide-right{0%{transform:translateX(-100vw)}}@keyframes slide-left{0%{transform:translateX(100vw)}}@keyframes slide-up{0%{transform:translateY(100vh)}}@keyframes slide-down{0%{transform:translateY(-100vh)}}@keyframes fade-right{0%{opacity:0;transform:translateX(-1em)}to{opacity:1}}@keyframes fade-left{0%{opacity:0;transform:translateX(1em)}to{opacity:1}}@keyframes fade-up{0%{opacity:0;transform:translateY(1em)}to{opacity:1}}@keyframes fade-down{0%{opacity:0;transform:translateY(-1em)}to{opacity:1}}@keyframes flicker{0%,29%,31%,63%,65%,77%,79%,86%,88%,91%,93%{opacity:0}30%{opacity:0.2}64%{opacity:0.4}78%{opacity:0.6}87%{opacity:0.8}92%, to{opacity:1}}@keyframes blur{0%{filter:blur(2rem);opacity:0}25%{opacity:1}to{filter:blur(0rem);opacity:1}}.dom-debug-mode tw-story,.dom-debug-mode tw-passage,.dom-debug-mode tw-sidebar,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{outline:1px solid #f5a3da;min-height:32px;display:block !important}.dom-debug-mode tw-story::before,.dom-debug-mode tw-passage::before,.dom-debug-mode tw-sidebar::before,.dom-debug-mode tw-include::before,.dom-debug-mode tw-hook::before,.dom-debug-mode tw-expression::before,.dom-debug-mode tw-link::before,.dom-debug-mode tw-dialog::before,.dom-debug-mode tw-columns::before,.dom-debug-mode tw-column::before,.dom-debug-mode tw-align::before{position:absolute;top:0;left:0;height:16px;background-color:#f5a3da;color:black;font-size:16px;font-weight:normal;font-style:normal;font-family:monospace;display:inline-block;line-height:100%;white-space:pre;z-index:999997}.dom-debug-mode tw-story:hover,.dom-debug-mode tw-passage:hover,.dom-debug-mode tw-sidebar:hover,.dom-debug-mode tw-include:hover,.dom-debug-mode tw-hook:hover,.dom-debug-mode tw-expression:hover,.dom-debug-mode tw-link:hover,.dom-debug-mode tw-dialog:hover,.dom-debug-mode tw-columns:hover,.dom-debug-mode tw-column:hover,.dom-debug-mode tw-align:hover{outline:1px solid #fc9}.dom-debug-mode tw-story:hover::before,.dom-debug-mode tw-passage:hover::before,.dom-debug-mode tw-sidebar:hover::before,.dom-debug-mode tw-include:hover::before,.dom-debug-mode tw-hook:hover::before,.dom-debug-mode tw-expression:hover::before,.dom-debug-mode tw-link:hover::before,.dom-debug-mode tw-dialog:hover::before,.dom-debug-mode tw-columns:hover::before,.dom-debug-mode tw-column:hover::before,.dom-debug-mode tw-align:hover::before{background-color:#fc9;transition:background-color 1s}.dom-debug-mode tw-passage,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{padding:1em;margin:0}.dom-debug-mode tw-story::before{content:'<tw-story tags="' attr(tags) '">'}.dom-debug-mode tw-passage::before{top:-16px;content:'<tw-passage tags="' attr(tags) '">'}.dom-debug-mode tw-sidebar::before{top:-16px;content:"<tw-sidebar>"}.dom-debug-mode tw-hook::before{content:'<tw-hook name="' attr(name) '">'}.dom-debug-mode tw-expression::before{content:'<tw-expression name="' attr(name) '">'}.dom-debug-mode tw-link::before{content:'<tw-link name="' attr(name) '">'}.dom-debug-mode tw-dialog::before{content:"<tw-dialog>"}.dom-debug-mode tw-columns::before{content:"<tw-columns>"}.dom-debug-mode tw-column::before{content:"<tw-column>"}.dom-debug-mode tw-align::before{content:"<tw-align>"}.dom-debug-mode tw-include::before{content:'<tw-include type="' attr(type) '" title="' attr(title) '">'}.debug-mode tw-expression{display:inline-block !important}.debug-mode tw-expression[type=variable]::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"$" attr(name)}.debug-mode tw-expression[type=tempVariable]::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"_" attr(name)}.debug-mode tw-expression[return=boolean]{background-color:rgba(179,179,179,0.2)}.debug-mode tw-expression[return=array]{background-color:rgba(255,102,102,0.2)}.debug-mode tw-expression[return=dataset]{background-color:rgba(255,128,0,0.2)}.debug-mode tw-expression[return=number]{background-color:rgba(255,179,102,0.2)}.debug-mode tw-expression[return=datamap]{background-color:rgba(255,255,102,0.2)}.debug-mode tw-expression[return=changer]{background-color:rgba(179,255,102,0.2)}.debug-mode tw-expression[return=lambda]{background-color:rgba(102,255,102,0.2)}.debug-mode tw-expression[return=hookname]{background-color:rgba(102,255,204,0.2)}.debug-mode tw-expression[return=string]{background-color:rgba(102,255,255,0.2)}.debug-mode tw-expression[return=datatype]{background-color:rgba(102,153,255,0.2)}.debug-mode tw-expression[return=gradient],.debug-mode tw-expression[return=colour]{background-color:rgba(204,102,255,0.2)}.debug-mode tw-expression[return=instant],.debug-mode tw-expression[return=macro]{background-color:rgba(240,117,199,0.2)}.debug-mode tw-expression[return=command]{background-color:rgba(153,153,255,0.2)}.debug-mode tw-expression.false{background-color:rgba(255,0,0,0.2) !important}.debug-mode tw-expression[type=macro]::before{content:"(" attr(name) ":)";padding:0 0.5rem;font-size:1rem;vertical-align:middle;line-height:normal;background-color:inherit;border:1px solid rgba(255,255,255,0.5)}.debug-mode tw-hook{background-color:rgba(0,85,255,0.1) !important}.debug-mode tw-hook::before{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"["}.debug-mode tw-hook::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"]"}.debug-mode tw-hook[name]::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"]<" attr(name) "|"}.debug-mode tw-pseudo-hook{background-color:rgba(255,170,0,0.1) !important}.debug-mode tw-collapsed::before{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"{"}.debug-mode tw-collapsed::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"}"}.debug-mode tw-verbatim::before,.debug-mode tw-verbatim::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"`"}.debug-mode tw-align[style*="text-align: center"]{background:linear-gradient(to right, rgba(255,204,189,0) 0%, rgba(255,204,189,0.25) 50%, rgba(255,204,189,0) 100%)}.debug-mode tw-align[style*="text-align: left"]{background:linear-gradient(to right, rgba(255,204,189,0.25) 0%, rgba(255,204,189,0) 100%)}.debug-mode tw-align[style*="text-align: right"]{background:linear-gradient(to right, rgba(255,204,189,0) 0%, rgba(255,204,189,0.25) 100%)}.debug-mode tw-column{background-color:rgba(189,228,255,0.2)}.debug-mode tw-enchantment{animation:enchantment 0.5s infinite;border:1px solid}.debug-mode tw-link::after,.debug-mode tw-broken-link::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:attr(passage-name)}.debug-mode tw-include{background-color:rgba(204,128,51,0.1)}.debug-mode tw-include::before{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:attr(type) ' "' attr(title) '"'}@keyframes enchantment{0%,to{border-color:#ffb366}50%{border-color:#6fc}}tw-debugger{position:fixed;box-sizing:border-box;bottom:0;right:0;z-index:999999;min-width:10em;min-height:1em;padding:0em 0.5em 0.5em 1em;font-size:1.25em;font-family:sans-serif;color:#000;border-left:solid #000 2px;border-top:solid #000 2px;border-top-left-radius:.5em;background:#fff;opacity:1}tw-debugger select{margin-right:1em;width:12em}tw-debugger button{border-radius:3px;border:solid #999 1px;margin:auto 4px;background-color:#fff;font-size:inherit;color:#000}tw-debugger button.enabled{background-color:#eee;box-shadow:inset #ddd 3px 5px 0.5em}tw-debugger .panel{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;position:absolute;bottom:100%;left:-2px;right:0;padding:1em;max-height:40vh;overflow-y:scroll;overflow-x:hidden;z-index:999998;background:#fff;border:inherit;border-bottom:solid #999 2px;border-top-left-radius:.5em;border-bottom-left-radius:.5em;font-size:0.8em}tw-debugger .panel:empty,tw-debugger .panel[hidden]{display:none}tw-debugger .panel-source,tw-debugger .panel-row-source{font-family:monospace;overflow-x:scroll;white-space:pre;-ms-flex-preferred-size:100%;flex-basis:100%}tw-debugger .panel-row-source{margin:5px 0}tw-debugger .panel-rows{width:100%;overflow-x:scroll}tw-debugger .panel-rows>*{display:table-row}tw-debugger .panel-rows>div:nth-of-type(2n){background:#EEE}tw-debugger .panel-row-buttons{text-align:right}tw-debugger .panel-variables .panel-rows:empty::before{content:"~ No variables ~";font-style:italic;color:#888;text-align:center}tw-debugger .panel-enchantments .panel-rows:empty::before{content:"~ No enchantments ~";font-style:italic;color:#888;text-align:center}tw-debugger .panel-errors .panel-rows:empty::before{content:"~ No errors... for now. ~";font-style:italic;color:#888;text-align:center}tw-debugger .panel-rows:empty+.panel-variables-bottom{display:none}tw-debugger .panel-storylets:not(.panel-exclusive) .storylet-exclusive,tw-debugger .panel-storylets:not(.panel-urgent) .storylet-urgent{display:none}tw-debugger .panel-variables-bottom{padding-top:5px}tw-debugger .enchantment-row{min-height:1.5em}tw-debugger .variable-path{opacity:0.4}tw-debugger .temporary-variable-scope,tw-debugger .enchantment-local{font-family:sans-serif;font-weight:normal;opacity:0.8;font-size:0.75em}tw-debugger .temporary-variable-scope:not(:empty)::before,tw-debugger .enchantment-local:not(:empty)::before{content:" in "}tw-debugger .variable-name,tw-debugger .enchantment-name{font-family:monospace;font-weight:bold}tw-debugger .variable-type{color:#444;font-weight:normal;text-overflow:ellipsis;overflow:hidden;max-width:10em}tw-debugger .error-row{display:table-row;background-color:rgba(230,101,204,0.3)}tw-debugger .error-row:nth-of-type(2n){background-color:rgba(237,145,219,0.3)}tw-debugger .error-row>*{display:table-cell;padding:0.25em 0.5em}tw-debugger .error-row .error-message{cursor:help}tw-debugger .error-row .error-passage{color:#444}tw-debugger .storylet-row{background-color:rgba(201,233,222,0.3)}tw-debugger .storylet-row:nth-child(2n){background-color:rgba(128,203,178,0.3)}tw-debugger .storylet-row.storylet-closed{font-style:italic;opacity:0.4;background-color:rgba(217,217,217,0.3)}tw-debugger .storylet-row.storylet-closed:nth-child(2n){background-color:rgba(166,166,166,0.3)}.storylet-error tw-debugger .storylet-row{background-color:rgba(230,101,204,0.3)}.storylet-error tw-debugger .storylet-row:nth-child(2n){background-color:rgba(237,145,219,0.3)}tw-debugger .storylet-row .storylet-name,tw-debugger .storylet-row .storylet-value{display:inline-block;width:50%}tw-debugger .tabs{padding-bottom:0.5em}tw-debugger .tab{border-radius:0px 0px 0.5em 0.5em;border-top:none}tw-debugger .resizer{position:absolute;height:3em;border-left:2px solid #ccc;border-right:2px solid #ccc;top:10px;left:4px;width:8px;cursor:ew-resize}tw-dialog{z-index:999997;border:#fff solid 2px;padding:2em;color:#fff;background-color:#000;display:block}@media (min-width: 576px){tw-dialog{max-width:50vw}}tw-dialog input[type=text]{font-size:inherit;width:100%}tw-dialog-links{text-align:right;display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end}tw-backdrop{z-index:999996;position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,0.8);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}tw-backdrop ~ tw-backdrop{display:none}tw-link,.link,tw-icon,.enchantment-clickblock{cursor:pointer}tw-link,.enchantment-link{color:#4169E1;font-weight:bold;text-decoration:none;transition:color 0.2s ease-in-out}tw-passage [style^="color"] tw-link:not(:hover),tw-passage [style*=" color"] tw-link:not(:hover),tw-passage [style^="color"][hover="true"] tw-link:hover,tw-passage [style*=" color"][hover="true"] tw-link:hover,tw-passage [style^="color"] .enchantment-link:not(:hover),tw-passage [style*=" color"] .enchantment-link:not(:hover),tw-passage [style^="color"][hover="true"] .enchantment-link:hover,tw-passage [style*=" color"][hover="true"] .enchantment-link:hover{color:inherit}tw-link:hover,.enchantment-link:hover{color:#00bfff}tw-link:active,.enchantment-link:active{color:#DD4B39}.visited{color:#6941e1}tw-passage [style^="color"] .visited:not(:hover),tw-passage [style*=" color"] .visited:not(:hover),tw-passage [style^="color"][hover="true"] .visited:hover,tw-passage [style*=" color"][hover="true"] .visited:hover{color:inherit}.visited:hover{color:#E3E}tw-broken-link{color:#993333;border-bottom:2px solid #993333;cursor:not-allowed}tw-passage [style^="color"] tw-broken-link:not(:hover),tw-passage [style*=" color"] tw-broken-link:not(:hover),tw-passage [style^="color"][hover="true"] tw-broken-link:hover,tw-passage [style*=" color"][hover="true"] tw-broken-link:hover{color:inherit}.enchantment-mouseover{border-bottom:2px dashed #999}.enchantment-mouseout{border:rgba(64,149,191,0.6) 1px solid}.enchantment-mouseout:hover{background-color:rgba(175,197,207,0.75);border:transparent 1px solid;border-radius:0.2em}.enchantment-clickblock{width:100%;height:100%;display:block}.enchantment-clickblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;color:rgba(65,105,225,0.5);transition:color 0.2s ease-in-out}.enchantment-clickblock>:not(tw-enchantment):hover::after{color:rgba(0,191,255,0.5)}.enchantment-clickblock>:not(tw-enchantment):active::after{color:rgba(222,78,59,0.5)}.enchantment-clickblock>:not(tw-enchantment)::after{box-shadow:inset 0 0 0 0.5vmax}.enchantment-clickblock>tw-passage::after,.enchantment-clickblock>tw-sidebar::after{box-shadow:0 0 0 0.5vmax}.enchantment-mouseoverblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:2px dashed #999}.enchantment-mouseoutblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:rgba(64,149,191,0.6) 2px solid}.enchantment-mouseoutblock:hover>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;background-color:rgba(175,197,207,0.75);border:transparent 2px solid;border-radius:0.2em}tw-link.enchantment-button,.enchantment-link.enchantment-button,.enchantment-button:not(.enchantment-link) tw-link,.enchantment-button:not(.enchantment-link) .enchantment-link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block}tw-dialog-links{padding-top:1.5em}tw-dialog-links tw-link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block;display:inline-block}html{margin:0;height:100%;overflow-x:hidden}*,:before,:after{position:relative;box-sizing:inherit}body{margin:0;height:100%}tw-storydata{display:none}tw-story{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;font:100% Georgia, serif;box-sizing:border-box;width:100%;min-height:100%;font-size:1.5em;line-height:1.5em;padding:5% 5%;overflow:hidden;background-color:#000;color:#fff}tw-story [style*=content-box] *{box-sizing:border-box}@media (min-width: 576px){tw-story{padding:5% 20%}}tw-story tw-consecutive-br{display:block;height:1.6ex;visibility:hidden}tw-story select{background-color:transparent;font:inherit;border-style:solid;padding:2px}tw-story select:not([disabled]){color:inherit}tw-story textarea{resize:none;background-color:transparent;font:inherit;color:inherit;border-style:none;padding:2px}tw-story input[type=checkbox]{transform:scale(1.5);margin:0 0.5em}tw-story tw-noscript{animation:appear 0.8s}tw-passage{display:block}tw-sidebar{text-align:center;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}@media (min-width: 576px){tw-sidebar{left:-5em;width:3em;position:absolute;-ms-flex-direction:column;flex-direction:column}tw-enchantment[style*="width"]>tw-sidebar{width:inherit}}tw-icon{display:inline-block;margin:0.5em 0;font-size:66px;font-family:"Verdana",sans-serif}tw-icon[alt]{opacity:0.2}tw-icon[alt]:hover{opacity:0.4}tw-icon[data-label]::after{font-weight:bold;content:attr(data-label);font-size:20px;bottom:-20px;left:-50%;white-space:nowrap}tw-meter{display:block}tw-hook:empty,tw-expression:empty{display:none}tw-error{display:inline-block;border-radius:0.2em;padding:0.2em;font-size:1rem;cursor:help;white-space:pre-wrap}tw-error.error{background-color:rgba(223,58,190,0.6);color:#fff}tw-error.warning{background-color:rgba(223,140,58,0.6);color:#fff;display:none}.debug-mode tw-error.warning{display:inline}tw-error-explanation{display:block;font-size:0.8rem;line-height:1rem}tw-open-button,tw-folddown{cursor:pointer;line-height:0em;border-radius:1px;border:1px solid black;font-size:0.8rem;margin:0 0.4rem;padding:2px;white-space:pre}tw-folddown::after{content:"\25b6"}tw-folddown.open::after{content:"\25bc"}tw-open-button::after{content:"Open"}tw-notifier{border-radius:0.2em;padding:0.2em;font-size:1rem;background-color:rgba(223,182,58,0.4);display:none}.debug-mode tw-notifier{display:inline}tw-notifier::before{content:attr(message)}tw-colour{border:1px solid black;display:inline-block;width:1em;height:1em}tw-enchantment:empty{display:none}h1{font-size:3em}h2{font-size:2.25em}h3{font-size:1.75em}h1,h2,h3,h4,h5,h6{line-height:1em;margin:0.3em 0 0.6em 0}pre{font-size:1rem;line-height:initial}small{font-size:70%}big{font-size:120%}mark{color:rgba(0,0,0,0.6);background-color:#ff9}ins{color:rgba(0,0,0,0.6);background-color:rgba(255,242,204,0.5);border-radius:0.5em;box-shadow:0em 0em 0.2em #ffe699;text-decoration:none}center{text-align:center;margin:0 auto;width:60%}blink{text-decoration:none;animation:fade-in-out 1s steps(1, end) infinite alternate}tw-align{display:block}tw-columns{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}.transition-in{animation:appear 0ms step-start}.transition-out{animation:appear 0ms step-end}[data-t8n^=dissolve].transition-in,[data-t8n=fade].transition-in{animation:appear .8s}[data-t8n^=dissolve].transition-out,[data-t8n=fade].transition-out{animation:appear .8s reverse}[data-t8n^=shudder].transition-in{display:inline-block !important;animation:shudder-in .8s}[data-t8n^=shudder].transition-out{display:inline-block !important;animation:shudder-in .8s reverse}[data-t8n^=rumble].transition-in{display:inline-block !important;animation:rumble-in .8s}[data-t8n^=rumble].transition-out{display:inline-block !important;animation:rumble-in .8s reverse}[data-t8n^=pulse].transition-in{animation:pulse .8s;display:inline-block !important}[data-t8n^=pulse].transition-out{animation:pulse .8s reverse;display:inline-block !important}[data-t8n^=zoom].transition-in{animation:zoom-in .8s;display:inline-block !important}[data-t8n^=zoom].transition-out{animation:zoom-in .8s reverse;display:inline-block !important}[data-t8n^=blur].transition-in{animation:blur .8s;display:inline-block !important}[data-t8n^=blur].transition-out{animation:blur .8s reverse;display:inline-block !important}[data-t8n^=slideleft].transition-in{animation:slide-left .8s;display:inline-block !important}[data-t8n^=slideleft].transition-out{animation:slide-right .8s reverse;display:inline-block !important}[data-t8n^=slideright].transition-in{animation:slide-right .8s;display:inline-block !important}[data-t8n^=slideright].transition-out{animation:slide-left .8s reverse;display:inline-block !important}[data-t8n^=slideup].transition-in{animation:slide-up .8s;display:inline-block !important}[data-t8n^=slideup].transition-out{animation:slide-down .8s reverse;display:inline-block !important}[data-t8n^=slidedown].transition-in{animation:slide-down .8s;display:inline-block !important}[data-t8n^=slidedown].transition-out{animation:slide-up .8s reverse;display:inline-block !important}[data-t8n^=fadeleft].transition-in{animation:fade-left .8s;display:inline-block !important}[data-t8n^=fadeleft].transition-out{animation:fade-right .8s reverse;display:inline-block !important}[data-t8n^=faderight].transition-in{animation:fade-right .8s;display:inline-block !important}[data-t8n^=faderight].transition-out{animation:fade-left .8s reverse;display:inline-block !important}[data-t8n^=fadeup].transition-in{animation:fade-up .8s;display:inline-block !important}[data-t8n^=fadeup].transition-out{animation:fade-down .8s reverse;display:inline-block !important}[data-t8n^=fadedown].transition-in{animation:fade-down .8s;display:inline-block !important}[data-t8n^=fadedown].transition-out{animation:fade-up .8s reverse;display:inline-block !important}[data-t8n^=flicker].transition-in{animation:flicker .8s}[data-t8n^=flicker].transition-out{animation:flicker .8s reverse}
</style>
</head>
<body>
<tw-story><noscript><tw-noscript>JavaScript needs to be enabled to play Imagination that Expands faster than the Universe.</tw-noscript></noscript></tw-story>
<tw-storydata name="Imagination that Expands faster than the Universe" startnode="1" creator="Twine" creator-version="2.3.14" ifid="6ACFA756-92A6-4091-AD94-3EDE1305E5CA" zoom="1" format="Harlowe" format-version="3.2.2" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">tw-hook[name="zhotkey"] tw-link {
    display: none; 
}
tw-hook[name="ahotkey"] tw-link {
    display: none; 
}
tw-hook[name="bhotkey"] tw-link {
    display: none; 
}
tw-hook[name="mhotkey"] tw-link {
    display: none; 
}
/**
 * Harlowe Audio Library (HAL), by Chapel, v2.2.1
 * for Harlowe 2.1.0 and higher
 * Released under the Unlicense, and dedicated to the public domain.
**/
#audio-overlay{position:fixed;top:0;right:0;left:0;bottom:0;z-index:100000;background:#111}.lds-ring{display:block;position:relative;top:20%;margin:auto;width:20em;height:20em}.lds-ring div{box-sizing:border-box;display:block;position:absolute;width:18em;height:18em;margin:6px;border:6px solid #fff;border-radius:50%;-webkit-animation:lds-ring 1.2s cubic-bezier(.5,0,.5,1) infinite;animation:lds-ring 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:#fff transparent transparent transparent}.lds-ring div:nth-child(1){-webkit-animation-delay:-.45s;animation-delay:-.45s}.lds-ring div:nth-child(2){-webkit-animation-delay:-.3s;animation-delay:-.3s}.lds-ring div:nth-child(3){-webkit-animation-delay:-.15s;animation-delay:-.15s}@-webkit-keyframes lds-ring{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes lds-ring{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}input#audio-volume{width:100%;margin:2em 0}span#vol-title{position:relative;bottom:-1em;font-size:1rem;float:left}tw-link#audio-mute{display:inline-block;padding:.3em;width:90%;text-decoration:none;color:#111;background:#eee;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:1px solid #000}tw-link#audio-mute:hover{opacity:.8}tw-link#audio-mute:active{opacity:.6}tw-link#audio-mute span{display:inline-block;width:1em;position:relative;height:1em;top:.2em;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAQAAABLCVATAAABF0lEQVR4Ae2VJVREYRSEB3ftuFUaLhF6I22iF7TgLr1XvAc849CwiBac9Xtm3e97cefp/Pec7+mdH0mZrGtMoBomyAEHfjGHXKg07gNxeUS3BuMAqGZswE7YcOIYgqgG7BFlSQgTAgKysC2jNjQmghFQCOpMxq+QmQgmFATU4kcq/YlgfKB1lALUqFSukRIbEwpy4BTZPM/Bu9TaQ362KAsl56sAtSR+Sgv6RCFdr/gjBYiuj65c3J0eNEmXz95TgybocvmoJj3avf5l59L1iD/WglZCP7/uh8zgeQ6epdahaZENFIPCCFvEYNPW4JdNazBGzhkj6caCbSc02DRRu0+8RR/+rb7wx6D505HxCVKvG0zpp+yknHe8MBDkT/s8AAAAAElFTkSuQmCC);background-size:contain}tw-link#audio-mute.muted span{right:4px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAASElEQVR4Ae3WsQ0AMAjAsJ7ez9MTGEmlRGL3BJzPq6prw2DDYMNgw2DDYMOwh1kAMUygQIEC2RejANVxnVE9aDOqJ39GVZWqB5Z3r1ndBX5oAAAAAElFTkSuQmCC)}div#audio-volume{float:left}div#audio-controls{font:100% Georgia,serif;font-size:1.5em;position:fixed;width:8em;height:100%;padding:1em 2em;z-index:10000;top:0;left:0;bottom:0;background:#333;color:#eee;transition:left .3s;text-align:center}div#audio-controls.closed{left:-10.5em}div#audio-controls tw-link#audio-panel-toggle{display:inline-block;width:1.5em;position:absolute;height:1.5em;top:0;right:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-decoration:none;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAQAAABLCVATAAAAYklEQVR4Ae3MsQFAMAAEQMDEagCgN4EuVTrbPcACeUBugDNeSdMQomI0PmYdTEYD9DA5jcVoBKuxGY1kNQ6jGRSaGaIj8gw1aI/KYVUSNqsSzMpiVT2zMjlVN0fqVW5o2luMGHqkQmD9cPYAAAAASUVORK5CYII=);background-size:contain}div#audio-controls.closed tw-link#audio-panel-toggle{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAQAAABLCVATAAAAZElEQVR4Ae3TpwGAMBQAUfrEeHB0cDhcXBSO7ehlgBw9N8BL/YZO95r6uA/UEbOv+ylfHRJ9z1BWLynKJqmWohyS6ijKOygKCpmjZYqXTTA2xUiCsShGAMw8/Q3ArFgFMHek0w3WCaR74eO2YQAAAABJRU5ErkJggg==)}@media screen and (max-width:800px){div#audio-controls.closed{left:-12em}div#audio-controls.closed tw-link#audio-panel-toggle{right:-1.5em}}div#story-menu{margin:1em 0}tw-link.story-menu{width:100%;display:block;font-weight:400;background:#ccc;font-size:.9em;padding:.1em 0;color:#111;border:1px solid #333}tw-link.story-menu.hide{display:none}tw-link.story-menu:hover{opacity:.8}tw-link.story-menu:active{opacity:.6}input[type=range].hal{-webkit-appearance:none;width:100%;margin:2.25px 0}input[type=range].hal:focus{outline:0}input[type=range].hal::-webkit-slider-runnable-track{width:100%;height:15.5px;cursor:pointer;box-shadow:.4px .4px 1px #000,0 0 .4px #0d0d0d;background:#111;border-radius:0;border:0 solid #010101}input[type=range].hal::-webkit-slider-thumb{box-shadow:0 0 2.2px rgba(17,17,17,.1),0 0 0 rgba(30,30,30,.1);border:0 solid #fff;height:20px;width:11px;border-radius:0;background:rgba(255,255,255,.93);cursor:pointer;-webkit-appearance:none;margin-top:-2.25px}input[type=range].hal:focus::-webkit-slider-runnable-track{background:#444}input[type=range].hal::-moz-range-track{width:100%;height:15.5px;cursor:pointer;box-shadow:.4px .4px 1px #000,0 0 .4px #0d0d0d;background:#111;border-radius:0;border:0 solid #010101}input[type=range].hal::-moz-range-thumb{box-shadow:0 0 2.2px rgba(17,17,17,.1),0 0 0 rgba(30,30,30,.1);border:0 solid #fff;height:20px;width:11px;border-radius:0;background:rgba(255,255,255,.93);cursor:pointer}input[type=range].hal::-ms-track{width:100%;height:15.5px;cursor:pointer;background:0 0;border-color:transparent;color:transparent}input[type=range].hal::-ms-fill-lower{background:#000;border:0 solid #010101;border-radius:0;box-shadow:.4px .4px 1px #000,0 0 .4px #0d0d0d}input[type=range].hal::-ms-fill-upper{background:#111;border:0 solid #010101;border-radius:0;box-shadow:.4px .4px 1px #000,0 0 .4px #0d0d0d}input[type=range].hal::-ms-thumb{box-shadow:0 0 2.2px rgba(17,17,17,.1),0 0 0 rgba(30,30,30,.1);border:0 solid #fff;height:20px;width:11px;border-radius:0;background:rgba(255,255,255,.93);cursor:pointer;height:15.5px}input[type=range].hal:focus::-ms-fill-lower{background:#111}input[type=range].hal:focus::-ms-fill-upper{background:#444}
/** End of HAL code */</style><script role="script" id="twine-user-script" type="text/twine-javascript">$(document).on('keyup', function (ev) {
    if (ev.which !== 90) {
        return; 
    }
    var $hook = $('tw-hook[name="zhotkey"]');
    if ($hook[0]) {
        $hook.find('tw-link').trigger('click');
    }
});
/**77 is m, 89 is y, a is 65**/
$(document).on('keyup', function (ev) {
    if (ev.which !== 65) {
        return; 
    }
    var $hook = $('tw-hook[name="ahotkey"]');
    if ($hook[0]) {
        $hook.find('tw-link').trigger('click');
    }
});
$(document).on('keyup', function (ev) {
    if (ev.which !== 66) {
        return; 
    }
    var $hook = $('tw-hook[name="bhotkey"]');
    if ($hook[0]) {
        $hook.find('tw-link').trigger('click');
    }
});
$(document).on('keyup', function (ev) {
    if (ev.which !== 77) {
        return; 
    }
    var $hook = $('tw-hook[name="mhotkey"]');
    if ($hook[0]) {
        $hook.find('tw-link').trigger('click');
    }
});
/**
 * Harlowe Audio Library (HAL), by Chapel, v2.2.1
 * for Harlowe 2.1.0 and higher
 * Released under the Unlicense, and dedicated to the public domain.
**/
;!function(e){(jQuery.browser=jQuery.browser||{}).mobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}(navigator.userAgent||navigator.vendor||window.opera),function(){"use strict";window.Fast={filter:function(e,t){for(var o=e.length,n=[],a=0;a<o;a++)t(e[a],a,e)&&n.push(e[a]);return n},forEach:function(e,t){for(var o=e.length,n=0;n<o;n++)t(e[n],n,e)},map:function(e,t){for(var o=e.length,n=new Array(o),a=0;a<o;a++)n[a]=t(e[a],a,e);return n},find:function(e,t){for(var o=e.length,n=0;n<o;n++)if(t(e[n],n,e))return e[n]},findIndex:function(e,t){for(var o=e.length,n=0;n<o;n++)if(t(e[n],n,e))return n;return-1},some:function(e,t){for(var o=e.length,n=0;n<o;n++)if(t(e[n],n,e))return!0;return!1}}}(),window.Chapel=window.Chapel||{},window.Chapel.options={preload:!0,loadDelay:0,muteOnBlur:!0,startingVol:.5,persistPrefs:!0,globalA:!0,showControls:!0,sidebarStartClosed:!0,volumeDisplay:!1,trackLoadLimit:500,totalLoadLimit:8e3,debug:!1},window.Chapel.debug=function(){Chapel.options.debug&&console.log.apply(null,arguments)},function(){"use strict";var n=$("tw-storydata"),o=/(.+?):(.+)/,t=/[\r\n]+/,a=/^["']/,r=/["']$/;function e(e){return Fast.map(Fast.filter(e.split(t),function(e){return e&&e.trim()&&e.includes(":")}),function(e){return e.trim()})}function i(e){return e.trim().replace(a,"").replace(r,"").trim()}function s(e){var t=e.match(o);return t instanceof Array?{key:i(t[1]),value:i(t[2])}:e}var u,l,c,p=n.find('tw-passagedata[name="hal.tracks"]'),d=null;p.length&&(u=e(p.text()),l=[],c=[],Fast.forEach(u,function(e){var t,o=s(e);"string"==typeof o&&c.push(o),l.push([o.key,(t=o.value,Fast.map(t.split(","),i))])}),c.length&&console.error("Some track definitions could not be parsed:\n"+c.join("\n")+"\nPlease check these definitions and try again."),d=new Map(l));var m,h,f=n.find('tw-passagedata[name="hal.config"]'),g=null;function y(e){var t=n.attr("format-version");if(e)return t;var o=t.split(".")[0],o=Number(o);return Number.isNaN(o)&&(o=3),o<1&&(o=3),o}f.length&&(m=e(f.text()),h={},Fast.forEach(Fast.map(m,function(e){return s(e)}),function(e){h[e.key]=e.value}),g=h),g&&Fast.forEach(Object.keys(g),function(e){var t=e,o=h[e],n=typeof Chapel.options[e];"boolean"==n?"true"===o?Chapel.options[t]=!0:"false"===o&&(Chapel.options[t]=!1):"number"==n?(o=Number(o),Number.isNaN(o)||(Chapel.options[t]=o)):"string"==n&&o&&(Chapel.options[t]=o)});var w=require("macros");if(window.Chapel=window.Chapel||{},window.Chapel.Macros={add:function(n){n&&"object"==typeof n&&Fast.forEach(Object.keys(n),function(e){var t,o;o=n[t=e],w.add(t,function(){var e=[].slice.call(arguments).slice(1),t=o.apply(null,e);return"string"==typeof t||"boolean"==typeof t||"number"==typeof t?t:""},w.TypeSignature.zeroOrMore(w.TypeSignature.Any))})}},window.Chapel.Get={version:y(),isHarlowe3OrLater:3<=y(),storyTitle:n.attr("name"),IFID:n.attr("ifid"),fromPassage:d},Chapel.debug("Harlowe Version -> ",y(!0)),Chapel.debug("Harlowe Major Version -> ",Chapel.Get.version),Chapel.debug("Story Title -> ",Chapel.Get.storyTitle),Chapel.debug("Story IFID -> ",Chapel.Get.IFID),Chapel.Get.version<2)throw new Error("The Harlowe Audio Library is only designed to work with Harlowe 2 and 3; you appear to be using Harlowe 1 or an otherwise invalid story format.","get.js -> initialization",176);Chapel.options.storagekey="%%hal-"+Chapel.Get.IFID+"-{"+Chapel.Get.storyTitle+"}",Chapel.debug("Storage Key -> ",Chapel.options.storagekey)}(),function(){"use strict";var t=Chapel.options,e=function(e,t){if(window.localStorage)try{e=""+e,"string"!=typeof t&&(t=JSON.stringify(t)),window.localStorage.setItem(e,t)}catch(e){console.error(e)}},o=function(e){if(window.localStorage)try{return e=""+e,window.localStorage.getItem(e)}catch(e){console.error(e)}},n=function(e){if(window.localStorage)try{e=""+e,window.localStorage.removeItem(e)}catch(e){console.error(e)}},a={loaded:[],classes:{},master:{volume:t.startingVol,mute:!1},groups:{playing:[],looping:[],custom:{}},mute:function(e){a.master.mute=!!e,$(document).trigger({type:":master-mute",mute:!!e})},isMuted:function(){return!!a.master.mute},volume:function(e){e=Number(e),Number.isNaN(e)||(1<e?e=1:e<0&&(e=0),a.master.volume=e),$(document).trigger({type:":master-volume",volume:e})},getVolume:function(){return a.master.volume},stopAll:function(){a.classes.Track&&Fast.forEach(a.classes.Track.list,function(e){e.stop()})},audioPlaying:function(){return!!a.groups.playing.length},savePrefs:function(){e(t.storagekey,a.master)},loadPrefs:function(){var e=o(t.storagekey);e&&"object"==typeof e&&e.hasOwnProperty("volume")&&"number"==typeof e.volume&&e.hasOwnProperty("mute")&&"boolean"==typeof e.volume&&(delete a.master,a.master=e)},clearPrefs:function(){n(t.storagekey)}},r={track:[":available",":loaded",":play",":stop",":mute",":volume"],master:[":master-mute",":master-volume"]};var i=r.track.concat(r.master);function s(e,t){if(!e||"string"!=typeof e||!e.trim())return null;var o=Fast.filter(Fast.map(e.split(" "),function(e){return":"!==(e=e.split(".")[0])[0]&&(e=":"+e),e+".userland"}),function(e){return t?i.includes(e):r.track.includes(e)}).join(" ");return o&&o.trim()?o:null}a.data={parseEvent:s,bail:function(e){throw new Error(e,"audio.js -> bail()",140)}},a.on=function(e,t){t&&"function"==typeof t?(e=s(e,!0))&&$(document).on(e,t):console.error("Chapel.Audio.on() -> invalid callback")},a.one=function(e,t){t&&"function"==typeof t?(e=s(e,!0))&&$(document).one(e,t):console.error("Chapel.Audio.one() -> invalid callback")},a.off=function(e){(e=s(e,!0))&&$(document).off(e)},t.persistPrefs&&($(document).on(":master-mute",a.savePrefs),$(document).on(":master-volume",a.savePrefs)),$(document).on(":play",function(e){e.track.addToGroup("playing")}),$(document).on(":stop",function(e){e.track.removeFromGroup("playing")}),t.muteOnBlur&&$(window).on("blur",function(){a.isMuted()||(a.mute(!0),$(window).one("focus",function(){a.mute(!1)}))}),a.parseEvent=s,window.Chapel=window.Chapel||{},window.Chapel.Audio=a}(),function(){"use strict";var r=Chapel.Audio,o=r.data.pareEvent,a=r.data.bail,i=Chapel.options,t=$(document.createElement("div")).attr("id","audio-container").css("display","none").appendTo(document.body),s={aac:"audio/aac",caf:"audio/x-caf","x-caf":"audio/x-caf",mp3:'audio/mpeg; codecs="mp3"',mpeg:'audio/mpeg; codecs="mp3"',m4a:"audio/mp4",mp4:"audio/mp4","x-m4a":"audio/mp4","x-mp4":"audio/mp4",oga:"audio/ogg",ogg:"audio/ogg",opus:'audio/ogg; codecs="opus"',wav:"audio/wav",wave:"audio/wav",weba:"audio/webm",webm:"audio/webm"};function u(e,t,o){this instanceof u||a("Track: called without `new` operator"),e||a("Track: no id specified"),"string"!=typeof e&&a("Track: track id is not a string"),t&&(!Array.isArray(t)||t.length)||a("Track: no sources specified"),o?t=[].slice.call(arguments).slice(1):"string"==typeof t&&(t=[t]);var n=$(document.createElement("audio"));Fast.forEach(t,function(e){var t,o;$(document.createElement("source")).attr({src:e,type:(t=e.split("."),(o=t[t.length-1]).includes("?")&&(o=o.split("?")[0]),o=o.toLowerCase().trim(),Object.keys(s).includes(o)||a('Track: unsupported file type "'+o+'"'),s[o])}).appendTo(n)}),n.attr({"data-track":"id","data-volume":1,"data-mute":!1}).one("canplaythrough.hal",function(){r.loaded.push(e)}),i.preload&&n.attr("preload","auto"),n[0].volume=+r.master.volume,this.id=e,this.$el=n,this.unwrap=n[0],this.sources=t}Object.assign(u,{list:[],is:function(e){return e instanceof u},has:function(t){return Fast.some(u.list,function(e){return e.id===t})},emit:function(e,t){$(document).trigger({type:e,track:t}),t.emit(e)},add:function(e,t,o){o&&(t=[].slice.call(arguments).slice(1));var n=new u(e,t);return u.list.push(n),n.$el.on("canplay",function(){u.emit(":available",n)}),n.$el.on("canplaythrough",function(){u.emit(":loaded",n)}),n.attach(),n},renew:function(){Fast.forEach(u.list,function(e){e.mute(e.isMuted()),e.volume(e.getVolume())})},getIdx:function(t){return Fast.findIndex(u.list,function(e){return e.id===t})},get:function(t){var e=Fast.find(u.list,function(e){return e.id===t});if(!e)throw new ReferenceError('There is no track with the id "'+t+'". Please check your spelling and capitalization.',"track.js -> Track.get()",155);return e},removeFromDOM:function(e){"string"==typeof e&&(e=u.get(e)),e&&u.is(e)?e.unattach():t.remove()},_runOnMultiple:function(e,t,o){e instanceof Array&&u.prototype.hasOwnProperty(t)&&Fast.forEach(u.list,function(e){u.is(e)||(e=u.get(e)||null),e&&e[t].apply(e,o&&o instanceof Array?o:[])})}}),Object.assign(u.prototype,{constructor:u,emit:function(e){this.$el.trigger({type:e,track:this})},clone:function(){return new u(this.id,this.sources)},isAttached:function(){return $.contains(t[0],this.unwrap)},attach:function(){return this.isAttached()||this.$el.appendTo(t),this},unattach:function(){return this.isAttached()&&this.$el.remove(),this},isPlaying:function(){return!this.unwrap.paused},play:function(){var e=this;return this.unwrap.play(),u.emit(":play",this),this.$el.on("ended",function(){e.unwrap.loop||(e.unwrap.currentTime=0,u.emit(":stop",e))}),this},playWhenPossible:function(){var t=this;return this.unwrap.play().then(function(){u.emit(":play",t),t.$el.on("ended",function(){t.unwrap.loop||(t.unwrap.currentTime=0,u.emit(":stop",t))})},function(e){$(document).one("click mousedown keydown touchstart",function(){t.play()})}).catch(function(e){console.error(e)}),this},forcePlay:function(){var e=this,t=$(document.createElement("a")).css("display","none").appendTo(document.body).on("click",function(){e.play()});setTimeout(function(){t.trigger("click")},safeAudioStart)},pause:function(){return this.unwrap.pause(),u.emit(":pause",this),this},stop:function(){return this.unwrap.pause(),this.unwrap.currentTime=0,u.emit(":stop",this),this},mute:function(e){return e=!!e,this.$el.attr("data-mute",e),r.master.mute?this.unwrap.muted=!0:this.unwrap.muted=e,u.emit(":mute",this),this},isMuted:function(){var e=this.$el.attr("data-mute");return"boolean"==typeof e?e:"false"!==e},toggleMute:function(){return this.mute(!this.isMuted()),this},volume:function(e){return e=Number(e),Number.isNaN(e)||(1<e?e=1:e<0&&(e=0),this.$el.attr("data-volume",e),this.unwrap.volume=e*r.master.volume),u.emit(":volume",this),this},getVolume:function(){return Number(this.$el.attr("data-volume"))},addToGroup:function(e,t){var o=this,n=t?r.groups.custom[e]:r.groups[e];return Fast.some(n,function(e){return o.id===e.id})||n.push(this),this},removeFromGroup:function(e,t){var o=this,n=t?r.groups.custom[e]:r.groups[e],a=Fast.findIndex(n,function(e){return e.id&&e.id===o.id});return n.splice(a,1),this},loop:function(e){return this.unwrap.loop=!!e,this.unwrap.loop?this.addToGroup("looping"):this.removeFromGroup("looping"),this},isLooping:function(){return!!this.unwrap.loop},toggleLoop:function(){return this.loop(!this.isLooping()),this},seek:function(e){return e<0?e=this.unwrap.duration-e:e>this.unwrap.duration&&(e=this.unwrap.duration),this.unwrap.currentTime=e,this},fadeIn:function(e){var t=this;e=e||1;var o=this.getVolume();return this.volume(0),this.play(),this.$el.animate({volume:o*r.master.volume},1e3*e,function(){t.volume(o),u.emit(":volume",t),u.emit(":fade",t)}),this},fadeOut:function(e){e=e||1;var t=this,o=this.getVolume();return this.$el.animate({volume:0},1e3*e,function(){t.stop(),t.volume(o),u.emit(":volume",t),u.emit(":fade",t)}),this},fadeTo:function(e,t){var o=this;if(e=e||1,t=Number(t),!Number.isNaN(t))return 1<t?t=1:t<0&&(t=0),this.$el.animate({volume:t*r.master.volume},1e3*e,function(){o.volume(t),u.emit(":volume",o),u.emit(":fade",o)}),this;alert("ivalid volume level")},delay:function(e,t){var o=this;"function"==typeof t&&(e=Number(e),(Number.isNaN(e)||e<0)&&(e=0),setTimeout(function(){t.call(o,o,e)},e))},on:function(e,t){if(!t||"function"!=typeof t)return console.error("<track>.on() -> invalid callback"),this;(e=o(e))&&this.$el.on(e,t)},one:function(e,t){if(!t||"function"!=typeof t)return console.error("<track>.one() -> invalid callback"),this;(e=o(e))&&this.$el.one(e,t)},off:function(e){(e=o(e))&&this.$el.off(e)}}),r.classes.Track=u,r.newTrack=function(){try{return u.add.apply(null,arguments)}catch(e){console.error(e.message),alert("Error in A.newTrack() -> see the console for more information.")}},r.track=function(e){try{return u.get(e)}catch(e){console.error(e.message),alert("Error in A.track() -> see the console for more information.")}},$(document).on(":master-mute",u.renew),$(document).on(":master-volume",u.renew)}(),function(){"use strict";var i=Chapel.Audio,s=i.classes.Track,o=(i.data._extend,/(play)?list:(.+)/i);i.createGroup=function(e,t,o){var n,a,r=o?[].slice.call(arguments).slice(1):t;n=e,(a=r)&&Array.isArray(a)||(a=[]),i.groups.custom[n]=Fast.map(a,function(e){return s.get(e)})},i.group=function(e){if(!(this instanceof i.group))return new i.group(e);if(Object.keys(i.groups.custom).includes(e))this.members=i.groups.custom[e];else{if(!(i.groups[e]&&i.groups[e]instanceof Array))throw new ReferenceError('There is no group with the id "'+id+'". Please check your spelling and capitalization.',"group.js -> A.group()",29);this.members=i.groups[e]}var t;!o.test(e)||(t=e.match(o)[2])&&t.trim()&&(this.members=i.playlist(t).tracks),Array.isArray(this.members)||(this.members=[],console.error('Could not find members for track group "'+e+'"!'))},Object.assign(i.group,{is:function(e){return this instanceof i.group},_runOnAll:function(e,t,o,n){null!=n?o=[].slice.call(arguments).slice(2):o instanceof Array||(o=[o]);var a=[e.members,t,o];s._runOnMultiple.apply(null,a)}}),Object.assign(i.group.prototype,{constructor:i.group,_run:function(){i.group._runOnAll.apply(null,[this].concat([].slice.call(arguments)))},play:function(){return this._run("play"),this},pause:function(){return this._run("pause"),this},stop:function(){return this._run("stop"),this},mute:function(e){return this._run("mute",e),this},volume:function(e){return this._run("volume",e),this},loop:function(e){return this._run("loop",e),this}})}(),function(){"use strict";var e=Chapel.Audio,r=e.classes.Track;e.data._extend;function n(e,t){if(!(this instanceof n))return new n(e,t);this.id=e,this.tracks=t.map(function(e){return r.get(e)}),this.looping=!1,this.current="",this.playing=!1}Object.assign(n,{list:{},is:function(e){return e instanceof n},add:function(e,t,o){return o&&(t=[].slice.call(arguments).slice(1)),n.list[e]=new n(e,t),n.list[e]},_runOnAll:function(e,t,o,n){null!=n?o=[].slice.call(arguments).slice(2):o instanceof Array||(o=[o]);var a=[e.tracks,t,o];r._runOnMultiple.apply(null,a)}}),Object.assign(n.prototype,{constructor:n,clone:function(){return new n(this.id,this.tracks.map(function(e){return e.id}))},_run:function(){n._runOnAll.apply(null,[this].concat([].slice.call(arguments)))},volume:function(e){return this._run("volume",e),this},mute:function(e){return this._run("mute",e),this},shuffle:function(){for(var e,t,o=this.tracks,n=o.length-1;0<n;n--)e=Math.floor(Math.random()*(n+1)),t=o[n],o[n]=o[e],o[e]=t;return this.tracks=o,this},random:function(){return this.tracks[Math.floor(Math.random()*this.tracks.length)]},isPlaying:function(){return this.playing},nowPlaying:function(){return r.get(this.current)},play:function(e){var t=this;if((e=e||(t.current?Fast.findIndex(t.tracks,function(e){return e.id===t.current}):0))>=t.tracks.length&&t.looping)e=0;else if(e>=t.tracks.length)return t.current="",void(t.playing=!1);var o=t.tracks[e],n=o.isLooping();return o.loop(!1),o.play(),t.playing=!0,setTimeout(function(){o.isPlaying()||(t.playing=!1)},20),t.current=o.id,o.$el.one("ended.playlist",function(){e++,o.loop(n),t.play(e)}),t},loop:function(e){return this.looping=!!e,this},isLooping:function(){return this.looping},stop:function(){var e;return this.current&&this.isPlaying()?(e=this.nowPlaying())&&(e.stop(),e.$el.off(".playlist")):this._run("stop"),this.current="",this.playing=!1,this},pause:function(){var e;return this.current&&this.isPlaying()&&((e=this.nowPlaying())&&e.pause()),this.playing=!1,this}}),e.classes.Playlist=n,e.createPlaylist=function(){try{n.add.apply(null,arguments)}catch(e){console.error(e.message),alert("Error in A.createPlaylist() -> see the console for more information.")}},e.playlist=function(e){try{var t=n.list[e]||null;if(!t)throw new ReferenceError('There is no playlist with the id "'+e+'". Please check your spelling and capitalization.',"list.js -> A.playlist()",171);return t}catch(e){console.error(e.message),alert("Error in A.createPlaylist() -> see the console for more information.")}}}(),function(){"use strict";var t=Chapel.Audio,o=t.classes.Track,n=t.classes.Playlist;function a(t,o){if("object"!=typeof o)throw new TypeError("Invalid extension.","extensions.js -> _extend()",8);Fast.forEach(Object.keys(o),function(e){if(void 0!==t[e])throw new Error('Invalid extension: cannot clobber existing property "'+e+'".',"extensions.js -> _extend()",8);t[e]=o[e]})}t.extend=function(e){a(Audio,e)},o.extend=function(e){a(o,e)},o.extendPrototype=function(e){a(o.prototype,e)},t.extendTrack=o.extend,t.extendTrackProto=o.extendPrototype,t.group.extend=function(e){a(t.group,e)},t.group.extendPrototype=function(e){a(t.group.prototype,e)},t.extendGroup=t.group.extend,t.extendGroupProto=t.group.extendPrototype,n.extend=function(e){a(n,e)},n.extendPrototype=function(e){a(n.prototype,e)},t.extendPlaylist=n.extend,t.extendPlaylistProto=n.extendPrototype}(),function(){"use strict";var e,t,o,n,a,r,i,s,u=Chapel.options;u.showControls&&(e=$(document.createElement("div")).attr("id","story-menu").css("display","none"),t=$(document.createElement("span")).attr("id","vol-title").append("Volume"),u.volumeDisplay||t.css("display","none"),o=$(document.createElement("input")).attr({id:"audio-volume",type:"range",min:1,max:99,step:1,title:"Volume"}).addClass("hal"),(n=Math.trunc(100*window.Chapel.Audio.master.volume))<0?n=0:100<n&&(n=100),o.attr("value",n),a=function(e){void 0===e&&(e=o.val()),t.empty().append("Volume "+e)},o.on("input",function(){window.Chapel.Audio.volume($(this).val()/100),a($(this).val())}),r=$(document.createElement("tw-link")).attr({id:"audio-mute",title:"Mute"}).append("Mute <span></span>").on("click",function(e){e.preventDefault(),$(this).toggleClass("muted"),Chapel.Audio.mute(!Chapel.Audio.isMuted())}),Chapel.Audio.isMuted()&&r.addClass("muted"),i=$(document.createElement("tw-link")).attr("id","audio-panel-toggle").on("click",function(e){e.preventDefault(),s.toggleClass("closed")}),s=$(document.createElement("div")).attr("id","audio-controls").append(e,t,o,r,i).appendTo(document.body),u.sidebarStartClosed&&s.addClass("closed"),window.Chapel=window.Chapel||{},window.Chapel.Audio=window.Chapel.Audio||{},window.Chapel.Audio.controls={$panel:s,$volume:o,$mute:r,$user:e,close:function(){s.addClass("closed")},open:function(){s.removeClass("closed")},toggle:function(){s.toggleClass("closed")},hide:function(){s.css("display","none")},show:function(){s.css("display","block")},updateVolume:a})}(),function(){"use strict";var s=Chapel.options,t=State,e=$(document.createElement("div")).attr("id","audio-overlay").css("display","none").appendTo(document.body);function o(){e.css("display","block").append('<div class="lds-ring"><div></div><div></div><div></div><div></div></div>')}function u(){e.fadeOut(function(){e.empty()})}window.Chapel=window.Chapel||{},window.Chapel.Audio=window.Chapel.Audio||{},window.Chapel.Audio.loadScreen={show:o,dismiss:u,kill:function(){$("#audio-overlay").remove()}},window.Chapel.Audio.$overlay=e,window.Chapel.Audio.preload=function(){var a,e,r,i;Chapel.debug("This is a mobile browser -> ",$.browser.mobile),t.pastLength||t.futureLength||$.browser.mobile||($(document).ready(function(){o()}),a=100+s.loadDelay,e=Chapel.Audio.classes.Track.list,r=Chapel.Audio.loaded,e.length?(i=Fast.map(e,function(e){return e.id}),0<s.totalLoadLimit&&setTimeout(function(){u()},s.totalLoadLimit),function e(){var t,o,n;i.length?(t=i.shift(),r.includes(t)?e():(o=Chapel.Audio.classes.Track.get(t)).unwrap.readyState<2?(n=!1,o.$el.one("canplaythrough.hal",function(){e(),n=!0}),setTimeout(function(){n||(o.$el.off("canplaythrough.hal"),e())},s.trackLoadLimit)):(r.includes(t)||r.push(t),e())):setTimeout(u,a)}()):setTimeout(u,a))}}(),function(){"use strict";var o=Chapel.options.storagekey+"_hal_restart_";Chapel.debug("HAL Session Key -> ",o);var e,t,n=(window.sessionStorage?(Chapel.debug("Session Storage Available"),e=function(e,t){window.sessionStorage.setItem(o+e,t)},t=function(e){return window.sessionStorage.getItem(o+e)}):(Chapel.debug("Session Storage Unavailable"),e=function(){},t=function(){},console.warn("Session storage is unavailable...")),{save:e,load:t});window.Chapel.Audio.state={_store:n,saveTracks:function(){var e;try{e=Fast.map(Chapel.Audio.classes.Track.list,function(e){return{id:e.id,sources:e.sources}}),Chapel.debug("Session Saved (Tracks) -> ",e),e=JSON.stringify(e),n.save("tracks",e)}catch(e){console.error(e.message)}},loadTracks:function(){var e;try{e=(e=n.load("tracks"))&&JSON.parse(e),Array.isArray(e)&&e.length&&(Chapel.debug("Session Loaded (Tracks) -> ",e),Fast.forEach(e,function(e){e.id&&e.sources&&!Chapel.Audio.classes.Track.has(e.id)?Chapel.Audio.newTrack.apply(null,[e.id].concat(e.sources)):Chapel.debug("Track reloading skipped.")}))}catch(e){console.error(e.message)}},savePlaylists:function(){try{var o=Chapel.Audio.classes.Playlist.list,e=Fast.map(Object.keys(o),function(e){var t={};return t.tracks=Fast.map(o[e].tracks,function(e){return e.id}),t.id=o[e].id,t});Chapel.debug("Session Saved (Playlists) -> ",e),e=JSON.stringify(e),n.save("playlists",e)}catch(e){console.error(e.message)}},loadPlaylists:function(){var e;try{(e=(e=n.load("playlists"))&&JSON.parse(e))&&Array.isArray(e)&&e.length&&(Chapel.debug("Session Loaded (Playlists) -> ",e),Fast.forEach(e,function(e){e.id&&e.tracks&&Chapel.Audio.createPlaylist(e.id,e.tracks)}))}catch(e){console.error(e.message)}},saveGroups:function(){var t;try{t={},Fast.forEach(Object.keys(Chapel.Audio.groups.custom),function(e){t[e]=Fast.map(Chapel.Audio.groups.custom[e],function(e){return"string"==typeof e?e:e.id})}),Chapel.debug("Session Saved (Groups) -> ",t),t=JSON.stringify(t),n.save("groups",t)}catch(e){console.error(e.message)}},loadGroups:function(){var t;try{(t=(t=n.load("groups"))&&JSON.parse(t))&&"object"==typeof t&&(Chapel.debug("Session Loaded (Groups) -> ",t),Fast.forEach(Object.keys(t),function(e){Fast.map(t[e],function(e){return Chapel.Audio.classes.Track.get(e)})}),Chapel.Audio.groups.custom=t)}catch(e){console.error(e.message)}}}}(),function(){"use strict";var e=Chapel.options;e.globalA&&void 0===window.A&&(Chapel.debug("Created global A interface."),window.A=window.Chapel.Audio),Chapel.Get.fromPassage&&(Chapel.debug("Loading tracks from track def special passage -> ",Chapel.Get.fromPassage),Chapel.Get.fromPassage.forEach(function(e,t){Chapel.Audio.newTrack.apply(null,[t].concat(e))})),$(document).on("unload",function(){Chapel.debug("User Prefs Saved"),window.Chapel.Audio.savePrefs()}),Chapel.Audio.classes.Track.renew(),Chapel.Audio.controls&&Chapel.Audio.controls.updateVolume(),Chapel.Get.isHarlowe3OrLater&&($(window).on("unload",function(){Chapel.debug("HAL State Saved"),Chapel.Audio.state.saveTracks(),Chapel.Audio.state.savePlaylists(),Chapel.Audio.state.saveGroups()}),Chapel.debug("HAL State Loaded"),Chapel.Audio.state.loadTracks(),Chapel.Audio.state.loadPlaylists(),Chapel.Audio.state.loadGroups()),e.persistPrefs&&(Chapel.debug("User Prefs Loaded"),Chapel.Audio.loadPrefs())}(),function(){"use strict";var s,u,e,l,t;Chapel.options.showControls&&(s=Engine,u=Chapel.Audio.controls.$user,e=function(){return"none"!==u.css("display")},l=function(){return e()||u.css("display","block"),u},t=function(){return e()&&u.css("display","none"),u},Chapel.Audio.menu={hide:t,show:l,isShown:e,links:{add:function(e,t,o){var n,a;if(!e||"string"!=typeof e){var r="undefined";return alert(r),void console.error(r)}o||"function"!=typeof t?(t&&"string"==typeof t&&(n=t),o&&"function"==typeof o&&(a=o)):(a=t,n=null);var i=$(document.createElement("tw-link")).append(e).attr({tabindex:"0",name:e.toLowerCase().trim()}).on("click",function(){n&&s.goToPassage(n),a&&a()}).addClass("story-menu").appendTo(u);return l(),i},clear:function(){return u.empty(),t()},hide:function(e){e=e.toLowerCase().trim(),$('tw-link.story-menu[name="'+e+'"]').addClass("hide")},show:function(e){e=e.toLowerCase().trim(),$('tw-link.story-menu[name="'+e+'"]').removeClass("hide")},toggle:function(e){e=e.toLowerCase().trim(),$('tw-link.story-menu[name="'+e+'"]').toggleClass("hide")},remove:function(e){e=e.toLowerCase().trim(),$('tw-link.story-menu[name="'+e+'"]').remove()}}})}(),function(){"use strict";var n=Chapel.Audio;function o(e){return e&&"function"==typeof e}function a(e,t){if(!e||"string"!=typeof e)return null;switch(e=e.toLowerCase().trim()){case"isplaying":e="isPlaying";break;case"playwhenpossible":e="playWhenPossible";break;case"ismuted":e="isAMuted";break;case"togglemute":e="toggleMute";break;case"getvolume":e="getVolume";break;case"islooping":e="isLooping";break;case"toggleloop":e="toggleLoop";break;case"fadein":e="fadeIn";break;case"fadeout":e="fadeOut";break;case"fadeto":e="fadeTo";break;case"stopall":e="stopAll"}if("isPlaying"===e&&"master"===t&&(e="audioPlaying"),"group"===t){if(o(n.group.prototype[e]))return e}else if("master"===t){if(o(n[e]))return e}else if(o(n.classes[t].prototype[e]))return e;throw new ReferenceError('Cannot run the command: "'+e+'" on the API "'+t+'". The command may be invalid, or this may be a bug in HAL.',"macros.js -> getCommand()",10)}var e={newtrack:function(){var e=[].slice.call(arguments);try{return n.newTrack.apply(null,e)}catch(e){alert("Error in the (newtrack:) macro: "+e.message)}},newplaylist:function(e,t){t=[].slice.call(arguments).slice(1);try{return n.createPlaylist(e,t)}catch(e){alert("Error in the (newplaylist:) macro: "+e.message)}},newgroup:function(e,t){t=[].slice.call(arguments).slice(1);try{return n.createGroup(e,t)}catch(e){alert("Error in the (newgroup:) macro: "+e.message)}},masteraudio:function(e){try{return e=a(e,"master"),n[e].apply(null,[].slice.call(arguments).slice(1))}catch(e){alert("Error in the (masteraudio:) macro: "+e.message)}},track:function(e,t){try{var o=n.track(e);return o[t=a(t,"Track")].apply(o,[].slice.call(arguments).slice(2))}catch(e){alert("Error in the (track:) macro: "+e.message)}},playlist:function(e,t){try{var o=n.playlist(e);return o[t=a(t,"Playlist")].apply(o,[].slice.call(arguments).slice(2))}catch(e){alert("Error in the (playlist:) macro: "+e.message)}},group:function(e,t){try{var o=n.group(e);return o[t=a(t,"group")].apply(o,[].slice.call(arguments).slice(2))}catch(e){alert("Error in the (group:) macro: "+e.message)}}};window.Chapel.Macros.add(e)}();
/** End of HAL code */</script><tw-passagedata pid="1" name="Introductions" tags="" position="405,171" size="100,100">(set: $text to &quot;&quot;)
(set: $zPressed to false)
(set: $beforeOptionsA to true)
(set: $beforeOptionsB to true)
(set: $index to 0)
(set: $Mindscape to false)(set: $Expert to false)(set: $OC to false)(set: $uh to false)(set: $aih to false)(set: $begin to false)(set: $corrupt to false)(set: $allFalse to true)(set: $Greetings to (dm:1,&quot;Hello!&quot;,2, &quot; I&#39;m so glad that you&#39;ve made it.&quot;, 3, &quot; I was worried that you had gotten lost in the mindscape.&quot;, 4, &quot;
&#96;[&#96;a&#96;]&#96; The mindscape?                                    &#96;[&#96;b&#96;]&#96; I&#39;m an expert navigator!&quot;))(set: $firstA to (dm:1, &quot;Yes, the mindscape!&quot;, 2, &quot; Why, you&#39;re in the creator&#39;s mind. Don&#39;t worry-&quot;, 3, &quot; there&#39;s more activity past this checkpoint. I&#39;m just in charge of making sure those admitted get in.&quot;, 4, &quot; Do you have your ticket?&quot;, 5, &quot;
&#96;[&#96;a&#96;]&#96; Of course! It&#39;s right here!                       &#96;[&#96;b&#96;]&#96; Uhhh&quot;))(set: $firstB to (dm:1, &quot;You have experience in navigating other people&#39;s minds?&quot;, 2, &quot; That&#39;s insane.&quot;, 3, &quot; How do you get practice in that?&quot;, 4, &quot; Wait...&quot;, 5, &quot;are you one of those Corruptors?&quot;,6,&quot;
&#96;[&#96;a&#96;]&#96; What&#39;s a Corruptor?&quot;))(set: $OfCourse to (dm:1, &quot;Excellent!&quot;, 2, &quot; I&#39;ll be taking that, then. And I&#39;ll just stamp your mind so that you can be on your way.&quot;, 3, &quot; What&#39;s the look- oh!&quot;, 4, &quot; I can&#39;t actually stamp your mind.&quot;, 5, &quot; It&#39;s not something you would feel.&quot;,6,&quot; It&#39;s an...imagined happening!&quot;,7,&quot; If you allow, it just sorta happens.&quot;,8,&quot;
&#96;[&#96;a&#96;]&#96; An imagined happening?                      &#96;[&#96;b&#96;]&#96; Alright! Let&#39;s get rolling.&quot;))(set: $Uhhh to (dm:1, &quot;Now, don&#39;t think too hard, friend!&quot;,2,&quot; Remember, you&#39;re in the mindscape now.&quot;,3, &quot; Anything that you can imagine can take place.&quot;,4,&quot; Of course you have your ticket! And of course, I&#39;ll stamp your mind for entrance.&quot;, 5, &quot; What...&quot;,6,&quot;what are you looking at me like that for?&quot;, 7, &quot; Oh-&quot;,8,&quot; OH! I can&#39;t actually stamp your mind, like...physically.&quot;,9,&quot; It&#39;s an imagined happening!&quot;,10, &quot;
&#96;[&#96;a&#96;]&#96; An imagined happening?                      &#96;[&#96;b&#96;]&#96; Alright! Let&#39;s get rolling.&quot;))(set: $Corruptor to (dm:1,&quot;...Nevermind!&quot;,2,&quot; You&#39;re safe and true.&quot;,3,&quot; You just probably meant that you&#39;re good with directions and whatnot! That&#39;s so cool.&quot;,4,&quot; The creator isn&#39;t quite that directionally fluent.&quot;,5,&quot; It&#39;s easy to get lost when there&#39;s so much going on,&quot;,6,&quot; so many possibilities to follow!&quot;,7,&quot; Do you have your ticket?&quot;,8,&quot;
&#96;[&#96;a&#96;]&#96; Of course! It&#39;s right here!                 &#96;[&#96;b&#96;]&#96; Uhhh...&quot;))(set: $ImaHap to (dm:1,&quot;That&#39;s kinda why you&#39;re here, after all.&quot;,2,&quot; The mindscape is great for many things.&quot;,3,&quot; That, I will recognize, but I am incredibly partial for what it can produce when it is LIMITLESS.&quot;,4,&quot; And what better limitless place than the imagination?&quot;,5,&quot; So, if you believe that I have stamped you,&quot;,6,&quot; granted you admission, then I have,&quot;,7,&quot; and you won&#39;t run into any problems down the line.&quot;,8,&quot;
&#96;[&#96;a&#96;]&#96; Alright! Let&#39;s get rolling.&quot;))(set: $ClosingPara1 to (dm:1,&quot;Now, you&#39;ll be seeing a lot in these next few hours.&quot;,2,&quot; Minutes.&quot;,3, &quot; Seconds! Time is weirder here.&quot;,4,&quot; Easy to lose the sense of reality if you so much as wish it away.&quot;,5,&quot; And I implore you to do that for the short time you&#39;re here!&quot;,6,&quot; There&#39;s a lot to invest yourself in, if you so permit. Otherwise, by time you return to reality, you may feel like you&#39;re missing something.&quot;,7,&quot; Otherwise, by time you return to reality, you may feel like you&#39;re missing something.&quot;))(set: $ClosingPara2 to (dm:1, &quot;The first episode that we&#39;ll be exploring is titled &#96;Friends Who Understand.&#96;&quot;, 2, &quot; My creator wound up doing speech therapy for a few years in elementary school,&quot;,3,&quot; if that tells you anything.&quot;,4,&quot; She still may not pronounce the r-sound right from time to time.&quot;,5,&quot; Before she was in school, there were moments where she sounded like she wasn&#39;t speaking English at all!&quot;,6,&quot; But that&#39;s okay. Everything in the mind can automatically understand. No frustration necessary.&quot;, 7, &quot; Everything in the mind can automatically understand. No frustration necessary.&quot;))(set: $ClosingPara3 to (dm:1,&quot;In order to be more immersive, I won&#39;t be narrating your ear off once you enter!&quot;,2, &quot; It&#39;s better for you to experience this based on what you see and feel.&quot;,3,&quot; But don&#39;t worry. If you need reassurance or anything,&quot;,4,&quot; hit the &#39;m&#39; key.&quot;,5,&quot; I&#39;ll always be right behind you.&quot;))(set: $CP3 to false)(set: $CP2 to false)

(set: $co to 1)
(b4r:&quot;inset&quot;,&quot;inset&quot;,&quot;outset&quot;,&quot;outset&quot;)+(b4r-colour:purple,purple,yellow,yellow)[(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]](else:)[(text-colour:#111)[Press z to continue]]]]
(live:1s)[(if: $firstB is true)+(if: $co&lt;=7)[(set: $co to it + 1)(if: $timer%2 is 0)[&lt;img src = &quot;https://github.com/Hannabellz/Group-Project/blob/master/OneDrive/Pictures/Imagination%20Project/Mindscape%20Guide%20Anger.png?raw=true&quot;&gt;](else:)[&lt;img src = &quot;https://github.com/Hannabellz/Group-Project/blob/master/OneDrive/Pictures/Imagination%20Project/Mindscape%20Guide%20Anger%202.png?raw=true&quot;&gt;]](else:)[(if: $timer%2 is 0)[&lt;img src = &quot;https://github.com/Hannabellz/Group-Project/blob/master/OneDrive/Pictures/Imagination%20Project/Mindscape%20Guide%20Happy%202.png?raw=true&quot;&gt;](else:)[&lt;img src = &quot;https://github.com/Hannabellz/Group-Project/blob/master/OneDrive/Pictures/Imagination%20Project/Mindscape%20Guide%20Happy.png?raw=true&quot;&gt;]]]
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $allFalse is true)+(if: $index&lt;=4)[(set: $text to it + $Greetings&#39;s ($index))(if:$index is 4)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $CP3 is true)[(if: $index &lt;= 5)[(set: $text to it + $ClosingPara3&#39;s ($index))](if: $index is 5)[[[Enter the first episode.-&gt;Friends Who Understand]]]]
	(else-if: $CP2 is true)+(if:$index&lt;=7)[(set: $text to it + $ClosingPara2&#39;s ($index)) (if: $index is 7)[(set: $CP3 to true) (set: $index to 0) (set: $text to &quot;&quot;)]]
	(else-if: $begin is true)+(if: $index&lt;=7)[(set: $text to it + $ClosingPara1&#39;s ($index))(if: $index is 7)[(set: $CP2 to true) (set: $index to 0) (set: $text to &quot;&quot;)]]
	(else-if: $aih is true)+(if: $index &lt;= 8)[(set: $text to it + $ImaHap&#39;s ($index))(if: $index is 8)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $OC is true)+(if:$index&lt;=8)[(set: $text to it + $OfCourse&#39;s ($index))(if: $index is 8)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $uh is true)+(if:$index&lt;=10)[(set: $text to it + $Uhhh&#39;s ($index))(if: $index is 10)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $corrupt is true)+(if:$index &lt;= 8)[(set: $text to it + $Corruptor&#39;s ($index))(if: $index is 8)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $Mindscape is true)+(if:$index &lt;=5)[(set: $text to it + $firstA&#39;s ($index))(if: $index is 5)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $Expert is true)+(if: $index &lt;=6)[(set: $text to it + $firstB&#39;s ($index))(if: $index is 6)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
] ] ]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $Mindscape to true) (set:$allFalse to false)]
	(else-if: $aih is true)[(set: $begin to true)]
	(else-if: $OC is true)[(set: $aih to true)]
	(else-if: $uh is true)[(set: $aih to true)]
	(else-if: $corrupt is true)[(set: $OC to true)]
	(else-if: $Expert is true)[(set: $corrupt to true)]
	(else-if: $Mindscape is true)[(set: $OC to true)]
]]
]
}
{
|bhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsB is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $Expert to true) (set:$allFalse to false)]
	(else-if: $uh is true)[(set: $begin to true)]
	(else-if: $OC is true)[(set: $begin to true)]
	(else-if: $corrupt is true)[(set: $uh to true)]
	(else-if: $Mindscape is true)[(set: $uh to true)]
]]]
}</tw-passagedata><tw-passagedata pid="2" name="Friends Who Understand" tags="" position="405,321" size="100,100">(set: $timer to 0)(set: $text to &quot;&quot;)(set: $zPressed to false)(set: $beforeOptionsA to true)(set: $beforeOptionsB to true)(set: $index to 0)(set: $mindscapeGuide to 1)(set: $allFalse to true)(set: $mistAppear to false)(set: $teleportAppear to false)(set: $earlyBird to false)(set: $antics to false)(set: $bF to false)(set: $cF to false)(set: $actualChoiceF to false)(set: $goInCloud to false)(set: $notCloud to false)(set: $becomingCloud to false)(set: $PinkiePromise to false)(set: $CottonCandy to false)(set: $cloudedEnd to false)(set: $lightning to false)(set: $destination to false)(set: $onlyHuman to false)(set: $admitHuman to false)(set: $avoidCloud to false)(set: $windTrampoline to false)(set: $screaming to false)(set: $screamingEnd to false)(set: $underDaSea to false)(set: $tigers to false)(set: $appearl to false)(set: $interjection to false)(set: $neverMet to false)(set: $yumCookie to false)(set: $seaEnd to false)(set: $Emcouragement to (dm:1,&quot;
(text-colour:#8225cd)[As promised. I believe in you! :)
]&quot;,2, &quot;
(text-colour:#8225cd)[You&#39;ve got this, friend. Keep pushing through.]
&quot;, 3, &quot;
(text-colour:#8225cd)[No need to fear. There is no danger here.]
&quot;, 4, &quot;
(text-colour:#8225cd)[Take a deep breath and delve back into it!]
&quot;))(set: $Waking to(dm:1,&quot;You rise before the sun.&quot;,2, &quot; Everything in the house is quiet and still.&quot;,3,&quot; You know you&#39;re not alone, for every family member is there,&quot;,4,&quot; but you don&#39;t want to wake them up. Even if you&#39;re hungry,&quot;,5,&quot; you don&#39;t have to make a sound.&quot;,6,&quot;
&#96;[&#96;a&#96;]&#96; Mist swirls around you, forming two figures.
&#96;[&#96;b&#96;]&#96; Two figures teleport to your side.&quot;))(set: $Mist to(dm:1,&quot;Complementary blue and orange mist wraps around you as you sit up,&quot;,2,&quot; feeling like a warm embrace. By time they are through,&quot;,3,&quot; there are two figures before you.&quot;,4,&quot; They&#39;re both taller, but not intimidatingly so.&quot;,5, &quot; You can easily outgrow them in no time, and they agree.&quot;,6,&quot;
(text-colour:blue)[&#39;Hello.&#39; Blue says delightedly, holding out a hand to help you off the bed.]&quot;,7,&quot;
(text-colour:orange)[&#39;The early bird catches the worm!&#39; Orange beckoned for you to follow.]&quot;,8,&quot;
&#96;[&#96;a&#96;]&#96; What worm? Why are we catching it?
&#96;[&#96;b&#96;]&#96; Laugh at their crazy antics.&quot;))(set: $Teleport to (dm:1,&quot;With a POP! more excitable than a balloon, your best imaginary friends Blue and Orange appear before you.&quot;,2,&quot; Confetti zips out and sprinkles down, landing on top of your head and nose.&quot;,3,&quot; It&#39;s like a magic trick!&quot;,4,&quot; Every time you see them do it,&quot;,5,&quot; you think about how much you&#39;d want to have that as your grand entrance.&quot;,6,&quot;
(text-colour:blue)[&#39;Good morning.&#39; Blue gives you a smile, lifting you up from the bed and twirling you around before returning you to the ground.]&quot;,7,&quot;
(text-colour:orange)[&#39;The early bird catches the worm!&#39; Orange knelt down to let you onto their back.]&quot;,8,&quot;
&#96;[&#96;a&#96;]&#96; What worm? Why are we catching it?
&#96;[&#96;b&#96;]&#96; Laugh at their crazy antics.&quot;))(set: $Worm to (dm:1,&quot;&#39;At owm? Hy aw tatchi ee?&#39;&quot;,2,&quot;
(text-colour:blue)[&#39;Ah, it is a saying.]&quot;,3,&quot;(text-colour:blue)[ We are not catching a worm, but we could be birds if you would so like.&#39;]&quot;,4,&quot;
(text-colour:orange)[&#39;Indeed! Do you want to be a bird this morning?&#39;]&quot;,5,&quot;(text-colour:orange)[ Orange crouched down beside you, eyes like a sunset.]&quot;,6,&quot;
&#96;[&#96;a&#96;]&#96; YES! Be a bird and fly to get your food.&quot;))(set: $Giggle to (dm:1, &quot;A wholehearted giggle erupts from you, causing a laughing fit from each of your companions as well.&quot;,2,&quot; And their laughter is so contagious, it only makes you laugh more!&quot;,3,&quot;
(text-colour: blue)[Wiping a tear from both eyes, Blue started to whistle.]&quot;,4,&quot;(text-colour:blue)[ Exactly like you had always wanted to! It sounded like a sweet song.]&quot;,5,&quot;
(text-colour: orange)[&#39;Would you like to take to the skies to hear more tunes?&#39;]&quot;,6,&quot;(text-colour:orange)[ Orange asked you wistfully, immediately catching onto your thoughts.]&quot;,7,&quot;
&#96;[&#96;a&#96;]&#96; YES! Be a bird and fly to get your food.&quot;))(set: $beginFly to (dm:1,&quot;Your jaw practically drops to the floor. Even though you&#39;re growing taller, that isn&#39;t a long way down.&quot;,2,&quot; But flying?&quot;,3,&quot; You&#39;ve never done that before!&quot;,4,&quot; So you nod emphatically while saying an &#39;Ay!&#39;&quot;,5,&quot;
And the longer you looked into orange&#39;s eyes, the more they expanded.&quot;,6,&quot; In no time at all,&quot;,7,&quot; the hallway that led to the kitchen turned into a vast sky.&quot;,8,&quot; There were clouds above and beneath you as you levitated in the air.&quot;,9,&quot; When you looked down, Blue was coming up to your right, and Orange to your left.&quot;,10,&quot; Each of them extended their arms. You got the feeling that you should as well!&quot;,11,&quot; You got the feeling that you should as well!&quot;))(set: $contFly to (dm:1,&quot;And so you mimicked them.&quot;,2,&quot; It must have been what did the trick, for your feet lifted to be horizontal with your head.&quot;,3,&quot; Your heart fluttered with your arms as you started to soar ahead.&quot;,4,&quot;
It reminded you of what you thought those big rollercoasters would be like.&quot;,5,&quot; The winds whispered in your ear, encouraging words to keep going.&quot;,6,&quot; Even as the tips of your ears began to grow numb and your hair was a mess atop your head,&quot;,7,&quot; you kept going.&quot;,8,&quot; You could hear the sounds of birds chirping as they came to your flanks, following your dives and rises.&quot;,9,&quot; You didn&#39;t have the slightest clue where you were, but you knew you were safe! Blue and Orange wouldn&#39;t let you do anything unsafe.&quot;,10,&quot; Blue and Orange wouldn&#39;t let you do anything unsafe.&quot;))(set: $choicesFly to (dm:1,&quot;But your hair started to stand straight on its end.&quot;,2,&quot; Your flying came to a dramatic halt,&quot;,3,&quot; and all of a sudden, Blue and Orange were slightly in front of you.&quot;,4,&quot; How had you not seen it before?&quot;,5,&quot; In front of you was a GIGANTIC storm cloud.&quot;,6,&quot;
Lightning crackled in the air, static electrifying everything around you.&quot;,7,&quot; Your head felt fuzzy, and your fingers felt as if they were constantly being softly shocked.&quot;,8,&quot; You could see lightning streaking closer to the cloud. When thunder rumbled, your whole body shook.&quot;,9,&quot; It echoed like drums in your ears and heightened your heartbeat.&quot;,10,&quot; You could hear rain start to pick up with the winds in challenge.&quot;,11,&quot;
&#96;[&#96;a&#96;]&#96; Go closer to the cloud.
&#96;[&#96;b&#96;]&#96; Take an abrupt turn so you can avoid flying straight into the storm.&quot;))(set: $cloud to (dm:1,&quot;You put your hands on the shoulders of your protectors, giving them a look of reassurance.&quot;,2,&quot; You&#39;ve got this handled!&quot;,3,&quot; Despite how ominous it was, you weren&#39;t going to let it put a damper on things.&quot;,4,&quot; After all, your father loved to watch storms like the one this cloud was rolling in.&quot;,5,&quot; He wasn&#39;t afraid of them!&quot;,6,&quot;
Starting your flight to venture into the darkness, the sky only grew grayer and grayer.&quot;,7,&quot; You didn&#39;t have to look back over your shoulder to know that Blue and Orange were still with you.&quot;,8,&quot; It was their job to make sure you made it back home okay! You could see them start to glow,&quot;,9,&quot; to help you stay brave through the darkening darkness.&quot;,10,&quot;
Engulfed by the cloud, you felt droplets condense on your head and hands.&quot;,11,&quot; Misty figures lit up in front of your eyes at a fresh flash of lightning.&quot;,12,&quot; They had muscled arms and long tails that would&#39;ve made you think of a snake. What looked like mustaches and hair went on for so long, you were sure they made up the bulk of this cloud.&quot;,13,&quot; Their eyes were frightening shades of yellow.&quot;,14,&quot; There had to be at least 5 of them, you were sure.&quot;,15,&quot;
(text-colour: yellow)[&#39;You guysss are not cloudssss,&#39; The one at the head hissed, slithering through the air slightly closer to you.]
&#96;[&#96;a&#96;]&#96; Agree. You are most definitely not a cloud.
&#96;[&#96;b&#96;]&#96; Become a cloud.&quot;))(set:$notACloud to (dm:1,&quot;&#39;owm no loud. Uman! Owm uman.&#39;&quot;,2,&quot;
(text-colour: yellow)[&#39;Human? How did you get up here? Humanssss have no wingsss. Sssussspiciousss human.&#39;]&quot;,3,&quot;(text-colour:yellow)[ It narrowed its eyes at you, now encircling you, Blue, and Orange.]&quot;,4,&quot;
(text-colour:blue)[&#39;They can fly as they pleassse- uh, as they please. Who says they must have wings to fly?]&quot;,5,&quot;(text-colour:blue)[ We expect pigs to fly, but they have no wings just the same!&#39;]&quot;,6,&quot;
(text-colour:yellow)[&#39;What are pigssss?&#39;]&quot;,7,&quot;
(text-colour:orange)[&#39;Pink, small animals that tend to roll around in the mud! Something that your rain cloud helps to create.&#39;]&quot;,8,&quot;
(text-colour:yellow)[&#39;What is pink?&#39;]&quot;,9,&quot;
Your eyes widen at the prospect.&quot;,10,&quot; They haven&#39;t seen pink!&quot;,11,&quot; It&#39;s hard to take such a notion seriously,&quot;,12,&quot; but all of the slithery cloud beasts look at you expectantly. To be fair,&quot;,13,&quot; it was very gray in this space.
&#96;[&#96;a&#96;]&#96; Pink is soft, like a pinkie promise. Serious, reassuring, a tiny embrace.
&#96;[&#96;b&#96;]&#96; Pink is sweet like cotton candy, misty and melting like water and snow!&quot;))(set: $becomeCloud to (dm:1,&quot;If there was a problem, you knew the solution!&quot;,2,&quot; In mere seconds, you phased into a cloud form, feeling lighter than you have ever remembered feeling.&quot;,3,&quot; Heck, why didn&#39;t you do this to fly sooner?!&quot;,4,&quot; Susceptible to the wind...you could get used to this!&quot;,5,&quot; There was no weight on your shoulders and no emptiness in your belly.&quot;,6,&quot;
Or so you thought, but you could feel the tiniest rumble, and it sounded like THUNDER!&quot;,7,&quot;
(text-colour:yellow)[The creatures surrounding you gasped. There was immediate recognition.]&quot;,8,&quot;(text-colour:yellow)[ Had they been hungry, too?]&quot;,9,&quot;(text-colour:yellow)[ Any preious problem or suspicion was washed away as they hustled about to comprise all of the sweets and treats of your dreams.]&quot;,10,&quot;(text-colour:yellow)[ You&#39;d never have to eat again at this rate!]&quot;,11,&quot;(text-colour:yellow)[ They invited you, Blue, and Orange to a wispy table that built from the cloud-ground and up.]&quot;,12,&quot;
You floated at the table and dove straight in, not minding the erupting giggles from your two friends from the level of your enthusiasm.&quot;,13,&quot; This was a once in a life time experience!&quot;,14,&quot; How could you imagine passing it up? What if today of all days was the only time you could be a cloud...ever?&quot;,15,&quot; The idea frightened you, and lightning flashed in the surrounding area.
...Did lightning happen when they were afraid, too?&quot;,16,&quot;
&#96;[&#96;a&#96;]&#96; Ask about their meaning of lightning.
&#96;[&#96;b&#96;]&#96; Ask about where they are heading.&quot;))(set: $SoftPink to (dm:1,&quot;You close the remaining distance between the head of the charge, unperturbed by the others that stare at you with piercing, electrifying eyes.&quot;,2,&quot; You extend your hand, pinkie first, inviting the creature opposite you to do the same.&quot;,3,&quot; Reluctant as ever, it obliges, to which you interlock the pinkies and give a squeeze.&quot;,4,&quot;
&#39;Is pink. Take sewres, like me! Quiet, but sewres.&#39;&quot;,5,&quot;
(text-colour:yellow)[All of the clouds looked moved by your display, raindrops falling from their eyes.]&quot;,6,&quot;(text-colour:yellow)[ Beautiful shades of pink started to stem from their hearts, and started branching out.]&quot;,7,&quot;(text-colour:yellow)[ Swiftly followed blues and oranges, as if they were learning and mimicking from  your friends.]
(text-colour:yellow)[&#39;I promisssse to take thisss to heart. I will carry and spread it along the windsssss. Take care, human.&#39;]&quot;,8,&quot;(text-colour:yellow)[&#39;I promisssse to take thisss to heart. I will carry and spread it along the windsssss. Take care, human.&#39;]&quot;))(set: $CCPink to (dm:1,&quot;A small window appeared so the outdoor sky was visible from one wall of the cloud.&quot;,2,&quot; You willed more clouds to appear to create a misty fog, the type you imagined responsible for the dew left behind on the grass that made it sparkle in the brisk mornings.&quot;,3,&quot; And then, there was a flurry of snow that picked up, swirling through the sky in otherwise inisible paths. It looked...fluffy!&quot;,4,&quot; The flakes sparkled frequently with different colors that veered off in different directions.&quot;,5,&quot;
&#39;Is pink. Like, yummy co&#39;on candy. Sweet! Like...me!&#39; Cotton candy appeared in both of your hands, where you offered one to the nearest creature.&quot;,6,&quot;
(text-colour:yellow)[As if the colorful display hadn&#39;t been enough, the hesitance in the first bite was the only hesitance to exist.]&quot;,7,&quot;(text-colour:yellow)[ You thought you had no contest in devouring the flossy candy, but it was gone from the storm snake&#39;s hands sooner than you had made it appear.]&quot;,8,&quot;(text-colour:yellow)[ The remaining creatures weren&#39;t left out for very long, for you made enough appear for each of them. They were finished and wishing for more just moments later.]
(text-colour:yellow)[ &#39;We will make the mosssst of cloudsss of cotton candy. We will not take advantage of the knowledge you gave ussss today. Take care, human.&#39;]&quot;,9,&quot;(text-colour:yellow)[ &#39;We will make the mosssst of cloudsss of cotton candy. We will not take advantage of the knowledge you gave ussss today. Take care, human.&#39;]&quot;))(set: $CloudEnd to (dm:1,&quot;A smile was the last thing you saw before all around you was clear skies like before.&quot;,2,&quot; The thing that grounded you was your mother calling for you, having not seen you in your room.&quot;,3,&quot; Your feet were once again on the carpet, bringing warmth and fuzziness you had been missing in the sky.&quot;,4,&quot; You still felt windswept as you were pulled into your mother&#39;s loving embrace.&quot;,5,&quot;
(text-colour:#f181f1)[&#39;What do you want for breakfast?&#39;]&quot;,6,&quot;
&#39;Inamn oas...wi sugawr!&#39;&quot;,7,&quot;
(text-colour:#f181f1)[&#39;Cinnamon and sugar toast? I think we can do that.&#39;]&quot;,8,&quot;
She, too, was a friend that always understood.&quot;))(set: $LightDef to (dm:1,&quot;&#39;Doess wighing appn when oo scawred?&#39;&quot;,2,&quot;
(text-colour:yellow)[The leader appears taken aback by your question.]&quot;,3,&quot;(text-colour:yellow)[ All eyes turned to it, but there was no crackling, even underneath the pressure. There was some rising static, though.]&quot;,4,&quot;(text-colour:yellow)[ &#39;Lightning sssservess as a releassse for uss. We go around,]&quot;,5,&quot;(text-colour:yellow)[ bottling up all the bessst and all the worsst of what water the underworld givess back to usss.]&quot;,6,&quot;(text-colour:yellow)[ It would be unhealthy if we jussst kept it that way. Ssssome of us lash out more intenssely than othersss,]&quot;,7,&quot;(text-colour:yellow)[ but none of usss are the ssame.&#39;]&quot;,8,&quot;
&#39;Oh.&#39; You reply with a nod. That made sense.&quot;,9,&quot; You had to cry sometimes when everything was overwhelming-and sometimes crying wasn&#39;t enough.&quot;,10,&quot; It didn&#39;t feel as noticed as you would like it to. Or it didn&#39;t help all the way.&quot;,11,&quot; &#39;Ank oo for sharing.&#39;
(text-colour:yellow)[Nodding, it looked at you in wonder. &#39;You&#39;re welcome, fellow cloud...&#39;]&quot;,12,&quot;
&#39;...&#39;
&#96;[&#96;a&#96;]&#96; Turn back into a human
&#96;[&#96;b&#96;]&#96; Admit to not being human, but remain as a cloud.&quot;))(set: $HeadedTo to (dm:1,&quot;&#39;Ere awre oo eading to?&#39;&quot;,2,&quot;
(text-colour:yellow)[One of the smaller snake creatures perks up at the question. Before any of the others can open their mouths, they jump right onto the table, and straight into the answer!]&quot;,3,&quot;(text-colour:#eed05b)[ &#39;We go wherever the wind guidesss uss, for it knowsss the besst place for uss to go!]&quot;,4,&quot;(text-colour:#eed05b)[ We could be over any land in jusssst a few hourss. We can ssstop to enjoy the view!]&quot;,5,&quot;(text-colour:#eed05b)[ Maybe you could come along, too?&#39;]&quot;,6,&quot;
Almost immediately, you wanted to respond without a second thought. But&quot;,7,&quot; what about your family back home? They would certainly miss you in a few hours if they weren&#39;t beginning to already.&quot;,8,&quot; You knew your mom was iffy about airplanes, you doubted she&#39;d be comfortable with you up here without any safety precautions.&quot;,9,&quot; Even if you explained it was fine- she would undoubtedly be worried.&quot;,10,&quot; And...you&#39;d miss her, and everyone else. You didn&#39;t think you could last a few hours without their company, either.&quot;,11,&quot;
(text-colour:blue)[&#39;Our young friend appreciates your offer. They don&#39;t want to disregard it, but it&#39;s nearly time for breakfast with the family.&#39;]&quot;,12,&quot;
(text-colour:yellow)[&#39;Why, don&#39;t be ridiculousss! We jusst had the breakfast together asss a family. Any cloud&#39;sss home can be found among any other cloud.&#39;]&quot;,13,&quot;
&#39;...&#39;
&#96;[&#96;a&#96;]&#96; Turn back into a human.
&#96;[&#96;b&#96;]&#96; Admit to not being human, but remain as a cloud.&quot;))(set: $TurnBack to (dm:1,&quot;Although you enjoyed being a cloud, a weird feeling that definitely wasn&#39;t hunger settled deep in your abdomen.&quot;,2,&quot; You felt poorly for making them think you were a cloud when that wasn&#39;t what you were.&quot;,3,&quot; What if these were trade secrets that you were stealing from unsuspecting creatures? That wouldn&#39;t be fair. You phased back into your human form, hearing gasps from those surrounding you at the table.&quot;,4,&quot; You phased back into your human form, hearing gasps from those surrounding you at the table.&quot;))(set: $Admit to (dm:1,&quot;&#39;Owm no loud. Uman! Owm uman.&#39;&quot;,2,&quot;
The tension was thicker than the cloud that you resided in.&quot;,3,&quot; The silence was deafening, and you could feel yourself shrink lower and lower in respect to the table.&quot;,4,&quot; Blue and Orange put a hand to you shoulders, serving as reassurance to you and daring the clouds to oppose you in any way.&quot;,5,&quot;
(text-colour:yellow)[However, there was no need for the defense, it would seem.]&quot;,6,&quot;(text-colour:yellow)[ For the next thing you heard was applause that sounded like crashing cymbals, differen&#39;t colors of lightning arching from the snakes and out towards the sky.]&quot;,7,&quot;(text-colour:yellow)[ The leader stood up at the head of the table. &#39;We appreciate your honesssty, human. It fillss ussss with great joy and hope.&#39;]&quot;,8,&quot;(text-colour:yellow)[ The grayness of the cloud, of the serpents, began to brighten to colors you hadn&#39;t even seen before. Shades of blues, purples, greens, reds, oranges, some dancing like rainbows and others finding contentment in singularity. Be careful when you return to your landsss and sstay on your current path. May we crossss again, someday.&#39;]&quot;,9,&quot;(text-colour:yellow)[ Be careful when you return to your landsss and sstay on your current path. May we crossss again, someday.&#39;]&quot;))(set: $AbruptTurn to (dm:1,&quot;As much as you enjoyed the rain, that hadn&#39;t been the reason you came up here!&quot;,2,&quot; You had no idea when the next time you could fly so freely would be, and so you wanted to make complete use of it.&quot;, 3,&quot; You did a 90 degree turn to the left, twirling midair.
&#96;[&#96;a&#96;]&#96; A burst of wind shoots you up higher into the sky.&quot;))(set: $Burst to (dm:1,&quot;A gust of wind loops like a spring underneath your stomach, hurdling you farther up into the sky.&quot;,2,&quot; You had always wanted a trampoline! Repositioning yourself upright, you continue to bounce along the gusts of wind.&quot;,3,&quot; Every so often, you&#39;d see Blue and Orange doing majestic leaps, which you made a glorious show of reproducing.&quot;,4,&quot; Your giggles challenged the air with their volume.&quot;,5,&quot;
Just as you were preparing a grand 360 hop, the gust of wind you were predicting to be there fell flat, and sent you hurdling down at a new speed.&quot;,6,&quot;
&#96;[&#96;a&#96;]&#96; Scream
&#96;[&#96;b&#96;]&#96; Take a diving form, like you are about to enter a pool.&quot;))(set: $Scream to (dm:1,&quot;&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH!&#39;&quot;,2,&quot; Air rushed into your ears, you couldn&#39;t even hear yourself scream! Before you could take a breath to try to scream louder,&quot;,3,&quot; Blue and Orange were taking hold of your elbows and merging into a makeshift parachute above you. You were skydiving!&quot;,4,&quot;
The next scream you released was more of the &#39;WOOOOOOOOOOOOOOOOOOOOHOOOOOOOOOOOOO&#39; variety, a big grin plastered onto your face.&quot;,5,&quot; You kicked your feet, stretching them out towards the ground that was approaching.&quot;,6,&quot; A tree sprouted beneath you, and you were walking on the highest branches that you could only dream of climbing to (when you&#39;re older).&quot;,7,&quot;
The next moment, you were walking across growing branch to growing branch, acting as if you were an expert tightrope walker.&quot;,8,&quot; It didn&#39;t matter if there was a net or not below you. This was a cakewalk! It may have well been the runway to your modeling career, because you were most certainly working it!&quot;,9,&quot; This was a cakewalk! It may have well been the runway to your modeling career, because you were most certainly working it!&quot;))(set: $ScreamEnd to(dm:1,&quot;The thing that grounded you, and left you questioning if you had actually screamed...a little too loud, was the sound of your mom&#39;s voice and footsteps approaching from behind you.&quot;,2,&quot; Underneath your feet no longer rested bark, but the carpet of your living room, which was inarguably more welcoming.&quot;,3,&quot; There was much less of a risk for splinters!&quot;,4,&quot; You were appropriately breathless as you felt a warm embrace from behind.&quot;,5,&quot;
(text-colour:#f181f1)[&#39;What do you want for breakfast?&#39;]&quot;,6,&quot;
&#39;Inamn oas...wi sugawr!&#39;&quot;,7,&quot;
(text-colour:#f181f1)[&#39;Cinnamon and sugar toast? I think we can do that.&#39;]&quot;,8,&quot;
She, too, was a friend that always understood.&quot;))(set: $UnderSea to (dm:1,&quot;You embrace what you&#39;ve witnessed from television shows and merge your hands to a point above your head, making impact with the surface of water.&quot;,2,&quot; You take a deep breath, and find it isn&#39;t any different than taking a breath of air.&quot;,3,&quot; That may have something to do with your two legs coming together to form a tail with the finest of scales.&quot;,4,&quot;
(text-colour: blue)[&#39;Conquering the sky and sea both in one go, are we?&#39;]&quot;,5,&quot;(text-colour:blue)[ Blue sent a grin your way, animated bubbles coming from their mouth as they talked.]&quot;,6,&quot;
(text-colour: orange)[&#39;What better time than the present?&#39; Orange&#39;s voice sounded like a sweet, calming song underwater.]&quot;,7,&quot;
The more you look around, the more fish you see.&quot;,8,&quot; Heck, you even start seeing dolphins and sharks, swimming side by side like they&#39;re the best of friends.&quot;,9,&quot;
&#96;[&#96;a&#96;]&#96; Go to the tiger shark paired with the tiger that has an air bubble around its head.&quot;))(set: $Tiger to (dm:1,&quot;(text-colour:purple)[&#39;Well, hello there.&#39; The tiger purred, its stripes wavering with each passing current.]&quot;,2,&quot;
(text-colour:navy)[&#39;How peculiar! I was just talking to Marie the other day-&#39;]&quot;,3,&quot;
(text-colour:purple)[&#39;Oh, Marie makes the best peanut butter cookies.&#39;]&quot;,4,&quot;
(text-colour:navy)[&#39;Right? But were were discussing the myths of the merpeople!]&quot;,5,&quot;(text-colour:navy)[ And at that, the myths of Atlantis. It popped up because she was soooo stuck on convincing me that her ancestor was a part of helping to make it lost to more destructive visitors,]&quot;,6,&quot;(text-colour:navy)[ but I couldn&#39;t get past the fact I&#39;ve never seen more than underwater cave art of merpeople!]&quot;,7,&quot; (text-colour:navy)[ I couldn&#39;t believe they existed. And well...&#39; The shark pointed its nose to you.]&quot;,8,&quot;(text-colour:navy)[ &#39;...Here we are! I guess I owe her a few sand dollars. A shame.&#39;]&quot;,9,&quot;
(text-colour:purple)[&#39;Quite. I recall you were just about to purrchase that nice looking purrl from the oyster around the bay.]&quot;,10,&quot;(text-colour:purple)[ Will this make it so you cannot?&#39;]
(text-colour: navy)[&#39;It&#39;s up for debate. I&#39;ll need to count...&#39;]&quot;,11,&quot;
&#96;[&#96;a&#96;]&#96; Interject.
&#96;[&#96;b&#96;]&#96; Pull a shiny pearl from thin water.&quot;))(set: $Pearl to (dm:1,&quot; At talk of a pearl, you wave your hand around.&quot;,2,&quot; You can feel the push and pull of the water trailing behind, an unexplainable power pulsing from your fingertips.&quot;,3,&quot; With a snap, there&#39;s a bright pearl in hand, which you promptly offer to the tiger shark, who immediately silences.&quot;,4,&quot;
(text-colour:navy)[&#39;Ah...what...how...&#39;]&quot;,5,&quot;
(text-colour:purple)[&#39;Magic! They&#39;re magic, just as well.]&quot;,6,&quot;(text-colour:purple)[ Holy manatee, they must have come straight from Atlantis. Or, better yet, a New Atlantis!&#39;]&quot;,7,&quot;
(text-colour:navy)[The tiger shark accepted your offering. &#39;I don&#39;t believe it gets better than //Old// Atlantis-]&quot;,8,&quot;(text-colour:navy)[just Atlantis. But young one, how are you capable of such levels of sorcery?]&quot;,9,&quot;(text-colour:navy)[ I don&#39;t believe even all fully-grown citizens of Atlantis could pull off something like that.&#39;]&quot;,10,&quot;
You offer a small smile. &#39;Magic!&#39;&quot;,11,&quot; You can feel Blue and Orange doing jazz hands behind you for support, making you giggle.&quot;,12,&quot; &#39;Sometimes thewre&#39;s no be&#39;er esplanation!&#39;&quot;,13,&quot;
(text-colour:purple)[The tiger nodded. &#39;They have a point. Sometimes it&#39;s best not to try to find an exact reason. But I wish I had gotten that on an underwater cave painting, yeesh...&#39;]&quot;,14,&quot; Sometimes it&#39;s best not to try to find an exact reason. But I wish I had gotten that on an underwater cave painting, yeesh...&#39;&quot;))
(set: $PearlEnding to (dm:1,&quot;The words of the company in front of you begin to get drowned out, your mother&#39;s voice starting to come through loud and clear.&quot;,2,&quot; She had found that you weren&#39;t in your bed anymore, and had a bit of a scare.&quot;,3,&quot;
(text-colour:#f181f1)[&#39;Honey? Honey!&#39; You don&#39;t have time to react before you are lifted into a hug with kisses being scattered over your face.]&quot;,4,&quot;
You giggle, unable to contain the joy of being dry and in her embrace. Your stomach rumbled again, making both of you laugh. &#39;An we ave inamn oas...wi sugawr!&#39;&quot;,5,&quot;
(text-colour:#f181f1)[&#39;Cinnamon and sugar toast? I think we can do that.&#39;]&quot;,6,&quot;
She, too, was a friend that always understood.&quot;))(set: $Interject to (dm:1,&quot;&#39;Sowwy to intewrupt.&#39;&quot;,2,&quot;
(text-colour:purple)[Cat eyes landed on you, and the shark&#39;s followed after.]&quot;,3,&quot;
You give a shy smile. &#39;Oo taked about mewrpeople and Atlantis? Is at neawr hewre?&quot;,4,&quot; Oh, and I can bet my momma makes be&#39;er cookies.&#39;&quot;,5,&quot;
(text-colour:navy)[&#39;Oh, you don&#39;t know about Atlantis? I was about to ask you more about it! Of the three of us, I&#39;d think you know the most based on the legends.]&quot;,6,&quot;(text-colour:navy)[ There&#39;s no telling where it is, now is there?]&quot;,7,&quot;(text-colour:navy)[ It would hardly be lost if someone was able to locate it. Some even talk about it taking its rightful place in the sky.&#39;]&quot;,8,&quot;
(text-colour:purple)[&#39;That is quite ridiculous.&#39;]&quot;,9,&quot;
(text-colour:navy)[&#39;Before tonight, so was seeing a merperson. Yet, here we are!]&quot;,10,&quot;(text-colour:navy)[ But essentially, there used to be gorgeous halls where all sea life could gather.]&quot;,11,&quot;(text-colour:navy)[ The water was clean back then, but somehow Atlantis managed to take it to a whole new level. It was open for all, which was probably the best part about it.]&quot;,12,&quot;(text-colour:navy)[ Everyone was able to come to monthly events to conerse and catch up on the current news.&#39;]&quot;,13,
&quot;
(text-colour:purple)[&#39;I meant that the ridiculous part was saying their mom makes better cookies than Marie. Have they ever met Marie?&#39;]&quot;,14,&quot;
&#96;[&#96;a&#96;]&#96; I&#39;ve never met a Marie!
&#96;[&#96;b&#96;]&#96; No, but try a cookie!&quot;))(set: $Marie to (dm:1,&quot;&#39;Ah aven&#39;t come across a Mawrie at awl! Ey sound nice.&#39;&quot;,2,&quot;
(text-colour:purple)[&#39;We absolutely must introduce you to Marie and her cookies. No ifs, ands, or buts about it! You&#39;re missing out on something grand.&#39;]&quot;))(set: $Cookie to (dm:1,&quot;&#39;Ewre! Twry it.&#39; You revealed two peanut butter cookies from behind your back, holding one out for each of them to take.&quot;,2,&quot; They were MEGA size to account they had bigger mouths than you, but you knew the taste of your momma&#39;s cookies.&quot;,3,&quot;
You could see that they wanted to argue,&quot;,4,&quot; but neither could truthfully bring themselves to do it.&quot;,5,&quot; You&#39;ve introduced them to something great, and they would likely report back to Marie with the news later.&quot;,6,&quot; Maybe your mom and Marie could have a bakeoff at some point!&quot;,7,&quot;
In the distance, you hear your mother&#39;s voice. That...definitely was no stranger Marie.&quot;,8,&quot; It sounded like she was calling your name.&quot;))
(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]]]
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $allFalse is true)+(if: $index&lt;=6)[(set: $text to it + $Waking&#39;s ($index))(if:$index is 6)[(set:$beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]] 
	(else-if: $seaEnd is true)+(if: $index&lt;=6)[(set: $text to it + $PearlEnding&#39;s ($index))(if: $index is 6)[[[Intermission.-&gt;Checking In]]]]
	(else-if: $yumCookie is true)+(if: $index&lt;=8)[(set: $text to it + $Cookie&#39;s ($index))(if: $index is 8)[(set:$seaEnd to true) (set: $index to 0) (set: $text to &quot;&quot;)]]
	(else-if: $neverMet is true)+(if: $index&lt;=2)[(set: $text to it + $Marie&#39;s ($index))(if: $index is 2)[(set:$yumCookie to true) (set: $index to 0) (set: $text to it + &quot;
&quot;)]]
	(else-if: $interjection is true)+(if: $index&lt;=14)[(set: $text to it + $Interject&#39;s ($index))(if: $index is 14)[(set:$beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $appearl is true)+(if: $index&lt;=14)[(set: $text to it + $Pearl&#39;s ($index))(if: $index is 14)[(set:$seaEnd to true) (set: $index to 0) (set: $text to &quot;&quot;)]]
	(else-if: $tigers is true)+(if: $index&lt;=11)[(set: $text to it + $Tiger&#39;s ($index))(if: $index is 11)[(set:$beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $underDaSea is true)+(if: $index&lt;=9)[(set: $text to it + $UnderSea&#39;s ($index))(if: $index is 9)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $screamingEnd is true)+(if: $index&lt;=8)[(set: $text to it + $ScreamEnd&#39;s ($index))(if: $index is 8)[[[Intermission.-&gt;Checking In]]]]
	(else-if: $screaming is true)+(if: $index&lt;=9)[(set: $text to it + $Scream&#39;s ($index))(if: $index is 9)[(set:$screamingEnd to true) (set: $index to 0) (set: $text to &quot;&quot;)]]
	(else-if: $windTrampoline is true)+(if: $index&lt;=6)[(set: $text to it+ $Burst&#39;s ($index)) (if: $index is 6)[(set: $beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $avoidCloud is true)+(if: $index&lt;=3)[(set: $text to it + $AbruptTurn&#39;s ($index)) (if: $index is 3)[(set: $beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $cloudedEnd is true)+(if: $index&lt;=8)[(set: $text to it + $CloudEnd&#39;s ($index)) (if: $index is 8)[[[Intermission.-&gt;Checking In]]]]
	(else-if: $admitHuman is true)+(if: $index&lt;=9)[(set: $text to it + $Admit&#39;s ($index))(if: $index is 9)[(set: $cloudedEnd to true) (set: $index to 0) (set: $text to &quot;&quot;)]]
	(else-if: $onlyHuman is true)+(if: $index&lt;=4)[(set: $text to it + $TurnBack&#39;s ($index))(if: $index is 4)[(set:$admitHuman to true) (set: $index to 0) (set: $text to &quot;&quot;)]]
	(else-if: $destination is true)+(if: $index&lt;=13)[(set: $text to it + $HeadedTo&#39;s ($index))(if: $index is 13)[(set:$beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $lightning is true)+(if: $index&lt;=12)[(set: $text to it + $LightDef&#39;s ($index)) (if: $index is 12)[(set: $beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $CottonCandy is true)+(if: $index&lt;=9)[(set: $text to it + $CCPink&#39;s ($index)) (if: $index is 9)[(set: $cloudedEnd to true) (set: $index to 0) (set: $text to &quot;&quot;)]]
	(else-if: $PinkiePromise is true)+(if: $index&lt;=8)[(set: $text to it + $SoftPink&#39;s ($index)) (if: $index is 8)[(set: $cloudedEnd to true) (set: $index to 0) (set: $text to &quot;&quot;)]]
	(else-if: $becomingCloud is true)+(if: $index&lt;=16)[(set: $text to it + $becomeCloud&#39;s ($index))(if: $index is 16)[(set: $beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $notCloud is true)+(if: $index &lt;= 13)[(set: $text to it + $notACloud&#39;s ($index)) (if: $index is 13)[(set: $beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $goInCloud is true)+(if:$index&lt;=15)[(set: $text to it + $cloud&#39;s ($index)) (if: $index is 15)[(set: $beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $actualChoiceF is true)+(if: $index&lt;=11)[(set: $text to it + $choicesFly&#39;s ($index))(if: $index is 11)[(set: $beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $cF is true)+(if: $index &lt;= 10)[(set: $text to it + $contFly&#39;s ($index))(if: $index is 10)[(set:$actualChoiceF to true) (set: $index to 0) (set: $text to &quot;&quot;)]]
	(else-if: $bF is true)+(if:$index&lt;=11)[(set: $text to it + $beginFly&#39;s ($index))(if: $index is 11)[(set:$cF to true) (set: $index to 0) (set: $text to &quot;&quot;)]]
	(else-if: $antics is true)+(if:$index&lt;=7)[(set: $text to it + $Giggle&#39;s ($index))(if: $index is 7)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $earlyBird is true)+(if:$index &lt;= 6)[(set: $text to it + $Worm&#39;s ($index))(if: $index is 6)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $mistAppear is true)+(if:$index &lt;=8)[(set: $text to it + $Mist&#39;s ($index))(if: $index is 8)[(set:$beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $teleportAppear is true)+(if: $index &lt;=8)[(set: $text to it + $Teleport&#39;s ($index))(if: $index is 8)[(set:$beforeOptionsA to false) (set: $beforeOptionsB to false)(set: $zPressed to true)]]
] ] ]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $mistAppear to true) (set:$allFalse to false)]
	(else-if: $onlyHuman is true)[(set: $admitHuman to true)]
	(else-if: $destination is true)[(set: $onlyHuman to true)]
	(else-if: $notCloud is true)[(set: $PinkiePromise to true)]
	(else-if: $lightning is true)[(set: $onlyHuman to true)]
	(else-if: $becomingCloud is true)[(set:$lightning to true)]
	(else-if: $goInCloud is true)[(set: $notCloud to true)]
	(else-if: $interjection is true)[(set:$neverMet to true)]
	(else-if: $tigers is true)[(set: $interjection to true)]
	(else-if: $underDaSea is true)[(set: $tigers to true)]
	(else-if: $windTrampoline is true)[(set: $screaming to true)]
	(else-if: $avoidCloud is true)[(set: $windTrampoline to true)]
	(else-if: $actualChoiceF is true)[(set: $goInCloud to true)]
	(else-if: $antics is true)[(set: $bF to true)]
	(else-if: $earlyBird is true)[(set: $bF to true)]
	(else-if: $teleportAppear is true)[(set: $earlyBird to true)]
	(else-if: $mistAppear is true)[(set: $earlyBird to true)]
]]
]
}
{
|bhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsB is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsB to true)
	(set: $beforeOptionsA to true)
	(if: $allFalse is true)[(set: $teleportAppear to true) (set:$allFalse to false)]
	(else-if: $notCloud is true)[(set:$CottonCandy to true)]
	(else-if: $lightning is true)[(set: $admitHuman to true)]
	(else-if: $destination is true)[(set:$admitHuman to true)]
	(else-if: $becomingCloud is true)[(set: $destination to true)]
	(else-if: $goInCloud is true)[(set:$becomingCloud to true)]
	(else-if: $interjection is true)[(set:$yumCookie to true)]
	(else-if: $underDaSea is true)[(set: $appearl to true)]
	(else-if: $avoidCloud is true)[(set: $underDaSea to true)]
	(else-if: $actualChoiceF is true)[(set: $avoidCloud to true)]
	(else-if: $teleportAppear is true)[(set: $antics to true)]
	(else-if: $mistAppear is true)[(set: $antics to true)]
]]]
}
{
|mhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $mindscapeGuide is 5)[(set: $mindscapeGuide to 1)]
(set: $text to it + $Emcouragement&#39;s ($mindscapeGuide))
(set: $mindscapeGuide to it + 1)
]]
}
</tw-passagedata><tw-passagedata pid="3" name="Checking In" tags="" position="405,471" size="100,100">(set: $mindscapeTalk to true)(set: $timer to 0)(set: $text to &quot;&quot;)(set: $zPressed to false)(set: $beforeOptionsA to true)(set: $beforeOptionsB to true)(set: $index to 0)(set: $allFalse to true)(set: $great to false)(set: $overwhelmed to false)(set: $leadOn to false)(set: $moreTime to false)(set: $FloridaRoom to false)(set: $Basement to false)(set: $corrupting to false)(set: $transitions to false)

(b4r:&quot;inset&quot;,&quot;inset&quot;,&quot;outset&quot;,&quot;outset&quot;)+(b4r-colour:purple,purple,yellow,yellow)[(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]](else:)[(text-colour:#111)[Press z to continue]]]](if: $timer%2 is 0)[
&lt;img src = &quot;https://github.com/Hannabellz/Group-Project/blob/master/OneDrive/Pictures/Imagination%20Project/Mindscape%20Guide%20Happy%202.png?raw=true&quot;&gt;](else:)[
&lt;img src = &quot;https://github.com/Hannabellz/Group-Project/blob/master/OneDrive/Pictures/Imagination%20Project/Mindscape%20Guide%20Happy.png?raw=true&quot;&gt;]
(set: $betweenEpisodes to (dm:1,&quot;WOW! That was—&quot;,2,&quot; that was something else.&quot;,3,&quot; No matter how many times I go through it, it still gets those butterflies going.&quot;,4,&quot; They&#39;re still fluttering around a bit. How are you holding up?&quot;,5,&quot;
&#96;[&#96;a&#96;]&#96; Things are going great!                       
&#96;[&#96;b&#96;]&#96; Kind of overwhelmed, still trying to catch my breath
&quot;))
(set: $ThingsGoingGreatCorruptF to (dm:1,&quot;Hurray! I had a feeling you&#39;d enjoy it.&quot;,2,&quot; Or at least, that&#39;s always the hope!&quot;,3,&quot; I won&#39;t keep you for too long, then. It&#39;s easier to keep on a roll.&quot;,4,&quot; What is in motion, stays in motion after all!&quot;,5,&quot; Is there anything else I can get for you right now?
&#96;[&#96;a&#96;]&#96; Nope, lead on!&quot; ))
(set: $ThingsGoingGreatCorruptT to (dm:1,&quot;Hurray! I had a feeling you&#39;d enjoy it.&quot;,2,&quot; Or at least, that&#39;s always the hope!&quot;,3,&quot; I won&#39;t keep you for too long, then. It&#39;s easier to keep on a roll.&quot;,4,&quot; What is in motion, stays in motion after all!&quot;,5,&quot; Is there anything else I can get for you right now?
&#96;[&#96;a&#96;]&#96; Nope, lead on!
&#96;[&#96;b&#96;]&#96; You mentioned Corruptors before—can you go more into that?&quot;))
(set: $corruptorExplanation to (dm: 1,&quot;O-Oh. Uh. Well- you see…&quot;,2,&quot;They&#39;re just as they sound.&quot;,3,&quot; They come in disguised as anything but their true nature,&quot;,4,&quot; and when they gain access to a memory they corrupt it.&quot;,5,&quot; Ruin it.&quot;,6,&quot; Make it different than it was. Which in turn can make it more dangerous.&quot;,7,&quot; Not necessarily for you, but the creator…whole other story!&quot;,8,&quot; Anyway, enough about that. Ready?
&#96;[&#96;a&#96;]&#96; As I&#39;ll ever be…&quot;))
(set: $shaky to (dm:1,&quot;Oh…Oh dear! I apologize that you&#39;re feeling shaky.&quot;,2,&quot; I can totally empathize, though.&quot;,3,&quot; It can be jarring to experience something based on someone else,&quot;,4,&quot; but experiencing it for yourself.&quot;,5,&quot; It&#39;s wild what the mind can do, isn&#39;t it?&quot;,6,&quot; But…I don&#39;t think it&#39;s a bad thing.&quot;,7,&quot; I recommend you utilize it to the fullest.&quot;,8,&quot; Here is a safe space. I promise. &quot;,9,&quot;There won&#39;t be anything that can&#39;t be handled.&quot;,10,&quot; Is there anything else I can get for you right now?
&#96;[&#96;a&#96;]&#96; Nope, lead on!
&#96;[&#96;b&#96;]&#96; A few more seconds to help settle down more would be nice.&quot;))
(set:$secOnd to (dm:1,&quot;Of course! Here, do it with me now.&quot;,2,&quot; Breathe in: 1,&quot;,3,&quot; 2,&quot;,4,&quot; 3. Breathe out: &quot;,5,&quot;1,&quot;,6,&quot; 2,&quot;,7,&quot; 3. Breathe in: &quot;,8,&quot;1,&quot;,9,&quot; 2,&quot;,10,&quot; 3. Breathe out: &quot;,11,&quot;1,&quot;,12,&quot; 2,&quot;,13,&quot; 3. There&#39;s no rush at all.&quot;,14,&quot; After all, you&#39;re the conductor of this endeavor. &quot;,15,&quot;Just so long as we continue at some point.
&#96;[&#96;a&#96;]&#96; Alright, I&#39;m ready now.&quot;))
(set: $intro to (dm:1,&quot;So, the next path we&#39;ll be taking is to The Paranormal…&quot;,2,&quot;Oooo, spooky!&quot;,3,&quot; Ominous!&quot;,4,&quot; Ambience!&quot;,5,&quot; That&#39;s a big thing with ghosts, right?&quot;,6,&quot; Anyway, you may need a jacket for the number of chills you&#39;ll experience.&quot;,7,&quot; 
The creator&#39;s communication with spirits is very child-friendly, although there is an opportunity for something a bit more intense.&quot;,8,&quot; It&#39;s good to remember that you&#39;re never in any real danger!&quot;,9,&quot; I would never let such a thing occur,&quot;,10,&quot; and neither would you, since you&#39;re assisting in making them happen. 
Take a deep breath. And try not to hold it.&quot;,11,&quot;
Take a deep breath. And try not to hold it.&quot;
))
(set: $transition to (dm:1,&quot;You&#39;ve had some paranormal activity on your radar.&quot;,2,&quot; From phone apps that detect ghosts nearby to unexplainable sightings,&quot;,3,&quot; and everything in between, you absolutely need to get to the bottom of it.&quot;,4,&quot;
Perhaps your house is a centralized place where all energies align to form a portal for those passed past this world?&quot;,5,&quot; Or maybe you have people watching over you,&quot;,6,&quot; trying to guide you along your day? Mayhaps a melding of both!&quot;,7,&quot;
Your basement is by far the most frightening.&quot;,8,&quot;
Do you venture out to the windowed Florida Room, or dare to dive into the darkened basement?&quot;,9,&quot;
&#96;[&#96;a&#96;]&#96; Florida Room
&#96;[&#96;b&#96;]&#96; Basement&quot;))
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $allFalse is true)+(if: $index&lt;=5)[(set: $text to it + $betweenEpisodes&#39;s ($index))(if:$index is 5)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $Basement is true)[[[Dark Basement.-&gt;To The Basement]]]
	(else-if: $FloridaRoom is true)[[[Warm Florida Room.-&gt;To The Florida Room]]]
	(else-if: $transitions is true)+(if: $index&lt;=9)[(set: $text to it + $transition&#39;s ($index))(if: $index is 9)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $leadOn is true)+(if:$index &lt;= 11)[(set: $text to it + $intro&#39;s ($index))(if: $index is 11)[(set:$transitions to true)(set:$mindscapeTalk to false)(set:$text to &quot;&quot;)(set: $index to 0)]]
	(else-if: $moreTime is true)+(if:$index&lt;=15)[(set: $text to it + $secOnd&#39;s ($index))(if: $index is 15)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $overwhelmed is true)+(if:$index &lt;=10)[(set: $text to it + $shaky&#39;s ($index))(if: $index is 10)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $corrupting is true)+(if: $index &lt;=8)[(set: $text to it + $corruptorExplanation&#39;s ($index))(if: $index is 8)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $great is true)+(if: $index &lt;=5)[(if:$corrupt is false)[(set: $text to it + $ThingsGoingGreatCorruptF&#39;s ($index))(if: $index is 5)[(set:$beforeOptionsA to false)(set: $zPressed to true)]](else:)[(set: $text to it + $ThingsGoingGreatCorruptT&#39;s ($index))(if: $index is 5)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]]
] ] ]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $great to true) (set:$allFalse to false)]
	(else-if: $transitions is true)[(set:$FloridaRoom to true)]
	(else-if: $moreTime is true)[(set: $leadOn to true)]
	(else-if: $corrupting is true)[(set: $leadOn to true)]
	(else-if: $overwhelmed is true)[(set: $leadOn to true)]
	(else-if: $great is true)[(set: $leadOn to true)]
]]
]
}
{
|bhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsB is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $overwhelmed to true) (set:$allFalse to false)]
	(else-if: $transitions is true)[(set:$Basement to true)]
	(else-if: $overwhelmed is true)[(set: $moreTime to true)]
	(else-if: $great is true)[(set: $corrupting to true)]
]]]
}
</tw-passagedata><tw-passagedata pid="4" name="To The Florida Room" tags="" position="330,621" size="100,100">(set: $timer to 0)(set: $text to &quot;&quot;)(set: $zPressed to false)(set: $beforeOptionsA to true)(set: $beforeOptionsB to true)(set: $index to 0)(set: $allFalse to true)(set: $sayHello to false)(set: $stunned to false)(set: $findFood to false)(set: $theVoice to false)(set: $beyondBewild to false)(set: $acknowledgment to false)(set: $brokenNews to false)(set: $offerBerries to false)(set: $soundsMust to false)(set: $doubleCheck to false)(set: $aA to false)(set: $getDef to false)(set: $seenHer to false)(set: $familiar to false)(set: $dE to false)(set: $deerE to false)(set:$m to 1)
(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]]]
(set: $Emcouragement to (dm:1,&quot;
(text-colour:#8225cd)[The atmosphere...I can&#39;t tell if it&#39;s a misleading type of relaxing. But I&#39;d never mislead you! Just keep going.
]&quot;,2, &quot;
(text-colour:#8225cd)[It will all be alright. You&#39;re as safe as you want to be, and even safer.]
&quot;, 3, &quot;
(text-colour:#8225cd)[You&#39;ve got the power! To make it through! I believe in you!]
&quot;, 4, &quot;
(text-colour:#8225cd)[I&#39;m sure we&#39;re making it. Just a little more.]
&quot;))
(set: $Gateway to (dm:1,&quot;As soon as your feet hit the carpet,&quot;,2,&quot; which serves as a grand contrast from your kitchen&#39;s smooth floor,&quot;,3,&quot; you are greeted by a deer&#39;s breath fanning your left ear.,&quot;,4,&quot; You abruptly turn to be nose-to-nose with the animal, immediately entranced by the antlers that lean towards you.&quot;,5,&quot;
(text-colour:#b61205)[&#39;Hello, young one…&#39;] The voice is soft as he speaks to you, nothing like the deer calls you&#39;ve heard from mechanisms in possession of your dad.&quot;,6,&quot;
&#96;[&#96;a&#96;]&#96; Say hello back
&#96;[&#96;b&#96;]&#96; Stay as you are, rendered a bit speechless&quot;))
(set: $returnGreeting to (dm:1,&quot;&#39;Hello! It&#39;s warm out, isn&#39;t it?&#39;&quot;,2,&quot; The real fire in the Florida Room&#39;s stove keeps the imaginary environment warm, despite the fans that spun overhead.&quot;,3,&quot; Like disco balls, different colored lights that ranged from your emotions to the deer&#39;s flashed in and out of sight,&quot;,4,&quot; like varying sunbeams peeking through the leaves of trees.&quot;,5,&quot; They weren&#39;t overwhelming, strangely enough.&quot;,6,&quot;
The narrow room was perfect for shifting into winding, continuously changing paths of an unpredictable woods.&quot;,7,&quot; The companion deer&#39;s head bowed to you.&quot;,8,&quot;
(text-colour: #b61205)[&#39;Indeed. Like a fine summer&#39;s day.]&quot;,9,&quot;(text-colour: #b61205)[ Would you happen to have any berries nearby? I know I have seen them somewhere,]&quot;,10, &quot;(text-colour: #b61205)[ but it would make no difference if it was miles or seconds ago. They are lost now.&#39;]&quot;,11, &quot;
Silence consumed you for a few minutes.&quot;,12,&quot; It was true—wherever they&#39;d been could be few and far between from where they were now.&quot;,13,&quot; The forest had a mind of its own.&quot;,14,&quot; But did that mean there was no way to navigate it? Particularly for a fine deer in need.&quot;,15,&quot; Not to mention, berries were always your favorite.&quot;,16,&quot; 
&#96;[&#96;a&#96;]&#96; Volunteer to aid in finding a food supply&quot;))
(set: $shockedGreeting to (dm:1,&quot;You continue to gape, unable to help yourself.&quot;,2,&quot; You had always thought of having the ability to talk to animals,&quot;,3,&quot; but you hadn&#39;t tried it so up close and personal to a creature that stood taller than you.&quot;,4,&quot; It&#39;s a bit silly, you note, but that doesn&#39;t make words come any easier.&quot;,5,&quot; How do you respond to a talking deer that was right where you happened to be?&quot;,6,&quot;
(text-colour: #b61205)[Amused, the deer pressed its nose under your chin. &#39;Chin up.]&quot;,7,&quot;(text-colour: #b61205)[ No need to flounder. It&#39;s a beautiful day and there are a lot of moments to seize as our own.&#39;]&quot;,8,&quot;
He was right, of course.&quot;,9,&quot; It was absolutely stunning. The environment you were in was warm thanks to the real fire in the room it was housed in,&quot;,10,&quot; but not hot enough to make you uncomfortable or squirmy. Perhaps the real fans that spun overhead helped to add to the effect,&quot;,11,&quot; but you imagined it was a natural and gentle breeze.&quot;,12,&quot; Like disco balls, different colored lights that ranged from your emotions to the deer&#39;s flashed in and out, like varying sunbeams peeking through the leaves of trees.&quot;,13,&quot; They weren&#39;t overwhelming, strangely enough.&quot;,14,&quot; The narrow room itself was perfect for shifting into winding, continuously changing paths of an unpredictable woods.&quot;,15,&quot;
(text-colour: #b61205)[The deer alternated the conversation topic, ever so slightly. &#39;Would you happen to have any berries nearby?]&quot;,16,&quot;(text-colour: #b61205)[ I know I have seen them somewhere, but it would make no difference if it was miles or seconds ago. They are lost now.&#39;]&quot;,17,&quot; Having adapted to the whole scene change and talking deer phenomena, you felt as if you could come up with an answer.&quot;,18,&quot;
Silence consumed you for a few minutes.&quot;,19,&quot; It was true—wherever they&#39;d been could be few and far between from where they were now.&quot;,20,&quot; The forest had a mind of its own.&quot;,21,&quot; But did that mean there was no way to navigate it? Particularly for a fine deer in need.&quot;,22,&quot; Not to mention, berries were always your favorite.&quot;,23,&quot;
&#96;[&#96;a&#96;]&#96; Volunteer to aid in finding a food supply&quot;))
(set: $aid to (dm:1,&quot;&#39;I&#39;m not sure of its location.&quot;,2,&quot; I just got here, to be honest. But finding food sounds of utmost importance now that we&#39;re here.&quot;,3,&quot; I&#39;ll help you find some. Do you remember what direction you were facing before?&#39;&quot;,4,&quot;
(text-colour: #b61205)[&#39;I appreciate your time.]&quot;,5,&quot;(text-colour: #b61205)[ I can be short-tempered without food. But I feel rather]&quot;,6,&quot;(text-colour: #b61205)[…guilty to admit, I am as turned around as you.]&quot;,7,&quot;(text-colour:#b61205)[ If it weren&#39;t for the lights and the ground beneath my feet, I doubt I could tell up from down.&#39;]&quot;,8,&quot;
Just as you were about to reassure the deer and randomly choose a direction,&quot;,9,&quot; you hear something from behind you.
(text-colour:#b9ecfb)[&#39;This way.&#39;]&quot;,10,&quot;(text-colour:#b9ecfb)[ It was a whisper against the rustling leaves. It could have just been the leaves.]&quot;,11,&quot;
&#96;[&#96;a&#96;]&#96; Follow the direction of &#39;the voice&#39;&quot;))
(set: $followDirection to (dm:1,&quot;You splutter a bit at first, trying to ignore the chill that sprang an onslaught of goosebumps down your arms.&quot;,2,&quot; &#39;Ah- Um- Right. I think we may want to go this way.&#39;&quot;,3,&quot; You gesture behind you before starting to lead the proposed way,&quot;,4,&quot; ensuring the deer was by your side before picking up the pace.&quot;,5,&quot;
(text-colour: #b61205)[&#39;Sounds as good as any direction to me. Someone&#39;s got to make the decision,]&quot;,6,&quot;(text-colour: #b61205)[ and most often it will not be me. Maybe that was the problem in my coming here,]&quot;,7,&quot;(text-colour: #b61205)[ to begin with. In a place like this, you&#39;ve got to make some decision, or you&#39;re left to the will of the woods.&#39;]&quot;,8,&quot;
&#39;You didn&#39;t grow up here, then?&quot;,9,&quot; I doubt this is something that can be ever gotten used to.&#39;&quot;,10,&quot;
(text-colour: #b61205)[&#39;Ah.&#39; There was a lowly chuckle.]&quot;,11,&quot;(text-colour: #b61205)[ &#39;It was an accident, my happening to be here.]&quot;,12,&quot;(text-colour: #b61205)[ I was in a vast, open woods. The type that would stay the same, even if I were to rest.]&quot;,13,&quot;(text-colour: #b61205)[ But then, one day while I was doing my rounds and tending to my antlers, I blinked and was here.]&quot;,14,&quot;(text-colour: #b61205)[ I&#39;ve lost track of the days because I don&#39;t think it&#39;s ever night.]&quot;,15,&quot;(text-colour: #b61205)[ I&#39;ve never seen it be night.&#39;]
&#96;[&#96;a&#96;]&#96; You&#39;re beyond bewildered
&#96;[&#96;b&#96;]&#96; …You may know more than the deer does&quot;))
(set: $bewilderment to (dm:1,&quot;&#39;That&#39;s absolutely crazy. I…Has there ever been an exit seen?&quot;,2,&quot; Have you heard anything from anyone else?&quot;,3,&quot; Please tell me you&#39;ve at least seen others, here.&#39;&quot;,4,&quot;
(text-colour:#b61205)[&#39;I&#39;m uncertain about an exit. There are rumors, of course.]&quot;,5,&quot;(text-colour: #b61205)[ You entered from somewhere, didn&#39;t you?]&quot;,6,&quot;(text-colour: #b61205)[ That means that there must be a door. But that may mean only some are able to traverse it.]&quot;,7,&quot;(text-colour: #b61205)[ For I know for a fact that I&#39;ve never seen one.]&quot;,8,&quot;(text-colour: #b61205)[ As for seeing others present, well, uh…&#39;]&quot;,9,&quot;
&#39;What? What is it?&quot;,10,&quot;
(text-colour: #b61205)[&#39;Please don&#39;t coin me as crazy. I do see others here.]&quot;,11,&quot;(text-colour: #b61205)[ Others like me, on occasion. But I never]&quot;,12,&quot;(text-colour: #b61205)[—nearly never—see anyone like you.&#39;]&quot;,13,&quot;
&#39;Nearly never?&#39;&quot;,14,&quot;
(text-colour: #b61205)[&#39;Well, that&#39;s the trick, isn&#39;t it? Sometimes I see something]&quot;,15,&quot;(text-colour: #b61205)[…someone…but I can see through them.]&quot;,16,&quot;(text-colour: #b61205)[ I can see through them! And I haven&#39;t been able to do that with anyone else I&#39;ve seen.]&quot;,17,&quot;(text-colour: #b61205)[ Not even you.&#39; The deer dips his head and pokes his antlers into your side.]&quot;,18,&quot;(text-colour: #b61205)[ It feels fuzzy.]&quot;,19,&quot;(text-colour: #b61205)[ It even tickles a bit.]&quot;,20,&quot;
&#96;[&#96;a&#96;]&#96; It sounds like a spirit, it MUST be a spirit!
&#96;[&#96;b&#96;]&#96; Ask more about these encounters. You HAVE to be sure.&quot;))
(set: $knowingTheTruth to (dm:1,&quot;The more you consider the deer&#39;s words, the more it dawns on you.&quot;,2,&quot; The part that really sold it was the fact the deer had blinked,&quot;,3,&quot; and that was all it took. One moment being in its home, and the next moment being here.&quot;,4,&quot;
&#39;…Was it during hunting season, the day you arrived here?&#39;&quot;,5,&quot;
The steps beside you turned into slowed steps behind you, which inevitably turned to the deer going still.&quot;,6,&quot;
(text-colour: #b61205)[&#39;I…I can&#39;t believe I forgot all about that.]&quot;,7,&quot;(text-colour: #b61205)[ I wasn&#39;t alert at all.]&quot;,8,&quot;(text-colour: #b61205)[ I could&#39;ve avoided it, could&#39;ve done…something.&#39;]&quot;,9,&quot;
You turn to look at your newfound friend.&quot;,10,&quot; He didn&#39;t quite sound sad. The lights above you didn&#39;t turn blue, either.&quot;,11,&quot; There was more disbelief accompanied by a strange opposition&quot;,12,&quot;—relief.
(text-colour: #b61205)[&#39;Here I was,]&quot;,13,&quot;(text-colour: #b61205)[ thinking I was just scooped up and placed here to continue to get lost for the rest of my days.]&quot;,14,&quot;(text-colour:#b61205)[ But I already hit that point, didn&#39;t I?&#39;]&quot;,15,&quot;
You nodded.&quot;,16,&quot;
(text-colour: #b61205)[But to your relief just as well, the deer let out a small laugh. &#39;I didn&#39;t even realize it.]&quot;,17,&quot;(text-colour: #b61205)[ That that&#39;s what it was. I didn&#39;t feel any pain,]&quot;,18,&quot;(text-colour: #b61205)[ and I suppose that&#39;s why I haven&#39;t felt any pain since arriving here.]&quot;,19,&quot;(text-colour: #b61205)[ And while I feel hungry, it&#39;s…it&#39;s only because I wish to be.]&quot;,20,&quot;(text-colour: #b61205)[ All that I&#39;ve eaten here may as well have been made just for me.&#39;]&quot;,21,&quot;
&#96;[&#96;a&#96;]&#96; Apologize for breaking the news when they believed differently
&#96;[&#96;b&#96;]&#96; Offer to continue helping its search for the best of berries in—or out of existence.&quot;))
(set: $breakingTheNews to (dm:1,&quot;You go back to stand by him, not wanting to leave him alone, and not wanting to impose either.&quot;,2,&quot; &#39;I&#39;m sorry that I&#39;m the one—&#39;
(text-colour: #b61205)[&#39;Stop.&#39;]&quot;,3,&quot;(text-colour: #b61205)[ The deer lifted his head, amusement still present in the air. &#39;Really.]&quot;,4,&quot;(text-colour: #b61205)[ I&#39;m glad you said something. Without you saying it, I would&#39;ve been for worse.]&quot;,5,&quot;(text-colour: #b61205)[ I would&#39;ve been thinking there was a way back home and would&#39;ve been none the wiser.]&quot;,6,&quot;(text-colour: #b61205)[ I&#39;m fine. I&#39;m glad you said something.&#39;]&quot;,7,&quot;
The lights above were a brilliant shade of green,&quot;,8,&quot; like the first time you&#39;d see live grass from under a blanket a snow.&quot;,9,&quot; You know the deer wasn&#39;t pulling your leg.&quot;,10,&quot; If anything, things were more…relaxed. Freer, now.&quot;,11,&quot;
The twisting paths of the forest hadn&#39;t changed, recently.&quot;,12,&quot; Even upon that realization, the only change was the color of the leaves as they fell.&quot;,13,&quot; Twirling and dancing until they reached the ground.&quot;,14,&quot; The branches were now bare, but still the light shone unevenly around you.&quot;,15,&quot;
(text-colour: #b9ecfb)[&#39;How remarkable.&#39; The voice spoke from a small clearing to your right,]&quot;,16,&quot;(text-colour: #b9ecfb)[ both you and the deer looked towards it to see the source.]&quot;,17,&quot;(text-colour: #b9ecfb)[ &#39;I am glad that this exceeded all of my expectations.&#39;]&quot;,18,&quot;
(text-colour: #b61205)[&#39;You&#39;re—you&#39;re her. You&#39;re the girl I&#39;ve seen before.&#39;]&quot;,19,&quot;
&#96;[&#96;a&#96;]&#96; You&#39;ve seen her?
&#96;[&#96;b&#96;]&#96; There&#39;s something familiar about this spirit…&quot;))
(set: $berriesBerries to (dm:1,&quot;You try for a reassuring smile, knowing that in itself may potentially help.&quot;,2,&quot; &#39;If they&#39;ve been made just for you, we can still go looking for some.&quot;,3,&quot; I still have time and would gladly help,&quot;,4,&quot; no matter wherever we are or aren&#39;t.&#39;&quot;,5,&quot;
(text-colour: #b61205)[&#39;I appreciate that.]&quot;,6,&quot;(text-colour: #b61205)[ I think I may have eaten more recently than I originally thought.]&quot;,7,&quot;(text-colour: #b61205)[ The acknowledgement of what is has filled me.&#39;]&quot;,8,&quot;
(text-colour: #b9ecfb)[&#39;How remarkable.&#39;]&quot;,9,&quot;(text-colour: #b9ecfb)[ The voice spoke from a small clearing to your right, both you and the deer looked towards it to see the source.]&quot;,10,&quot;(text-colour: #b9ecfb)[ &#39;I am glad that this exceeded all of my expectations.&#39;]&quot;,11,&quot;
(text-colour: #b61205)[&#39;You&#39;re—you&#39;re her. You&#39;re the girl I&#39;ve seen before.&#39;]&quot;,12,&quot;
&#96;[&#96;a&#96;]&#96; You&#39;ve seen her?
&#96;[&#96;b&#96;]&#96; There&#39;s something familiar about this spirit…&quot;))
(set: $soundingLikeMust to (dm:1,&quot;&#39;You&#39;re not kidding, right? Because that&#39;s the very reason why I came here,&quot;,2,&quot; actually. In pursuit of discovery. You see, I have reason to believe that spirits stick close by me.&quot;,3,&quot; And the fact I&#39;m not the only one—&#39;&quot;,4,&quot;
(text-colour: #b9ecfb)[&#39;Over here. They are changing, again.&#39;]&quot;,5,&quot;
You pause in your sentence, looking at the deer. &#39;Did you hear that?&#39;&quot;,6,&quot;
(text-colour: #b61205)[&#39;I&#39;m going to go with no, considering I would have asked what you&#39;re asking about.&#39;]&quot;,7,&quot;
&#39;…Oh. Well.&quot;,8,&quot; I think we&#39;re about to take a turn here. The paths will begin to shift any second.&#39;&quot;,9,&quot; You felt a bit dejected about being the only one to hear that, but you didn&#39;t want to let it completely deter you.&quot;,10,&quot; You would see this through!
(text-colour: #b61205)[&#39;You were saying?&#39;]&quot;,11,&quot;
&#39;Huh? Right! So uh—if you&#39;ve seen what I believe to be a spirit,&quot;,12,&quot; and I&#39;ve seen other proof, surely that must mean there is a spirit somewhere nearby!&quot;,13,&quot; The question is, what does it want?&#39;&quot;,14,&quot;
(text-colour: #b61205)[&#39;Have you seen it?&#39;]&quot;,15,&quot;(text-colour:#b61205)[ The short fuse of the deer&#39;s temper may have been starting to shine through.]&quot;,16, &quot;(text-colour: #b61205)[ He must have really been getting hungry.]&quot;,17,&quot;
&#39;N-No.&#39;
(text-colour: #b61205)[&#39;Then why spend time dwelling over it when we could be trying harder to think of where to get berries.]&quot;,18,&quot;(text-colour: #b61205)[ I could have done all this wandering on my own. Can&#39;t you make your presence any more of a gift to me and get me some food?&#39;]&quot;,19,&quot;
&#96;[&#96;a&#96;]&#96; Agree and apologize
&#96;[&#96;b&#96;]&#96; Get defensive&quot;))
(set: $askToBeSure to (dm:1,&quot;&#39;Wait, so, what exactly did you see them do?&quot;,2,&quot; Or where did you see them?&quot;,3,&quot; Or…what were you doing when you saw them? Is it a there-then-not type of thing or—&#39;&quot;,4,&quot;
(text-colour: #b61205)[&#39;Are you actually going to let me answer a question, or…?&#39; The deer sounded rather huffy, so you remained silent to give him room to speak.]&quot;,5,&quot;
(text-colour: #b61205)[&#39;I&#39;ve seen them often enough to know they have to be more than just a mirage.]&quot;,6,&quot;(text-colour: #b61205)[ And I see them after I eat or lay down, so I know I&#39;m probably not hallucinating. But sometimes I feel like that has to be the only explanation anyways,]&quot;,7,&quot;(text-colour: #b61205)[ y&#39;know? I go to say something to them, but they never respond. And half the time they&#39;re not there anymore to respond.&#39;]&quot;,8,&quot;
Your eyes go big, but you still stay quiet.&quot;,9,&quot; This was prime information time. You nod along to assure him that you&#39;re still listening, silently asking for more.&quot;,10,&quot;
(text-colour: #b61205)[And more he delivered. &#39;I tend to see them near the spots where the most light can be seen.]&quot;,11,&quot;(text-colour: #b61205)[ Fewer branches, fewer leaves. They appear to enjoy the warmth. Soak in it, even.]&quot;,12,&quot;(text-colour: #b61205)[ I&#39;m not doing anything special when I do see them. I look for them, sometimes they&#39;re there. I don&#39;t look for them, sometimes they&#39;re there.]&quot;,13,&quot;(text-colour: #b61205)[ Other times there&#39;s no one else in sight. And typically they hang around for a while.]&quot;,14,&quot;(text-colour: #b61205)[ It&#39;s never consisted of me blinking and them not being there.&#39;]&quot;, 15, &quot;
It must have been ten steps that you turned to exuberant leaps,&quot;,16,&quot; feeling giddy and weightless as you had when you were younger.
&#96;[&#96;a&#96;]&#96; It sounds like a spirit, it MUST be a spirit!&quot;
)) 
(set: $deerSeenHer to (dm:1,&quot;&#39;Wait wait wait, you&#39;ve seen her?&#39;&quot;,2,&quot;
(text-colour: #b9ecfb)[With a small and light chuckle, the girl gracefully treaded closer to you.]&quot;,3,&quot;(text-colour: #b9ecfb)[ You couldn&#39;t tell if she was levitating or not, but she was definitely see-through.]&quot;,4,&quot;(text-colour: #b9ecfb)[ &#39;Indeed. We&#39;ve crossed paths on occasion.]&quot;,5,&quot;(text-colour: #b9ecfb)[ I was hoping to inspire some deeper thinking in a slightly less direct way.]&quot;,6,&quot;(text-colour: #b9ecfb)[ But everyone is receptive to different methods.&#39;]&quot;,7,&quot;(text-colour: #b9ecfb)[ The spirit stuck a hand out to pet the deer, who phased into being see-through.]&quot;,8,&quot;
You&#39;re left gaping at the occurrence in front of you,&quot;,9,&quot; uncertain what to make of it.&quot;,10,&quot; Sure, you had come here searching for such a sight, but that didn&#39;t mean you expected to see anything like that.&quot;,11,&quot;
(text-colour: #b9ecfb)[A wistful look lit the girl&#39;s eyes as she stood opposite of you.]&quot;,12,&quot;(text-colour: #b9ecfb)[ There was something very familiar about her. Something akin to adoration shining in her eyes.]&quot;,13,&quot;(text-colour: #b9ecfb)[ You knew there had to be, and you had the feeling that she knew everything that you didn&#39;t.]&quot;,14,&quot;(text-colour: #b9ecfb)[ &#39;You&#39;ve already grown so much. It feels like just yesterday that I was holding you.&#39;]&quot;,15,&quot;
&#39;Wh-What?&#39;&quot;,16,&quot;
(text-colour: #b9ecfb)[Just as she went to speak again, a frown quickly passed over her face.]&quot;,17,&quot;(text-colour:#b9ecfb)[ Her eyes darted upward, the deer&#39;s following shortly after.]&quot;,18,&quot;
(text-colour: #b61205)[&#39;It&#39;s time to say goodbye?&#39;]
(text-colour: #b9ecfb)[&#39;Y-Yes.&#39; Was it possible for a ghost&#39;s lips to tremble? She ushered you onto the back of the deer.]&quot;,19,&quot;
(text-colour: #b9ecfb)[&#39;Y-Yes.&#39; Was it possible for a ghost&#39;s lips to tremble? She ushered you onto the back of the deer.]&quot;
))
(set: $deerSeenEnd to (dm:1,&quot;You had little time to process that apparently they still had some sort of solid forms when she got on behind you and the three of you were taking off.&quot;,2,&quot; You could hear branches cracking from above and falling onto the ground with a heavy thud behind you.&quot;,3,&quot; You&#39;re surprised you aren&#39;t thrown off the deer&#39;s back with every leap and stride it takes,&quot;,4,&quot; somehow getting quicker as the time went on.&quot;,5,&quot;
The once beautiful scenery was whipping past you in a blur, crumbling down as if the very foundations it rested on were dissipating.&quot;,6,&quot; So when it came to a very sudden halt,&quot;,7,&quot; you were thankful for the spirit that clung to you to keep you from flying forward into the ravine that now stood between you and the other side.&quot;,8,&quot;
(text-colour: #b9ecfb)[&#39;You&#39;re going to have to trust me.&#39;]&quot;,9,&quot;(text-colour: #b9ecfb)[ The kind spirit whispered into your ear. It didn&#39;t make much of a difference whether you did or not,]&quot;,10,&quot;(text-colour: #b9ecfb)[ though you felt more inclined to, as you felt a sturdy shove against your spine.]&quot;,11,&quot;
You hurdled in the air across the ravine, breathless as you barely hovered over it.&quot;,12,&quot; There were alarms and whistles going off in your head,&quot;,13,&quot; but it was so deathly silent otherwise.&quot;,14,&quot; The next thing you knew, your feet were hitting the cold kitchen floor.&quot;,15,&quot; You hear a heavy thud in the Florida Room behind, and turn to see glass shattering everywhere.&quot;,16,&quot; One of the ceiling fans had fallen to the floor. Right where you likely just had stood…&quot;,17,&quot;
Your shoulders were still chilled when your dad came immediately to your side.&quot;,18,&quot;
(text-colour:#129212)[&#39;Are you okay?&#39;]&quot;,19,&quot;
And somehow…you were.&quot;))
(set: $familiarSpirit to (dm:1,&quot;You&#39;re rendered a bit speechless.&quot;,2,&quot; You are certain you&#39;ve never seen this girl before. At least,&quot;,3,&quot; not like this.&quot;,4,&quot; Not as she presently was.&quot;,5,&quot; You were close to her, somehow.&quot;,6,&quot; There was a familial quality to her—one that highlighted the sensation of &#39;picking up where you left off,&#39;&quot;,7,&quot; as if you had never spent time apart in the first place.&quot;))
(set: $agreeApolo to (dm:1,&quot;&#39;Y-You&#39;re right. Wreally—really.&quot;,2,&quot; I&#39;m sorry.&quot;,3,&quot; I&#39;m sure that we must be close to something, now.&#39; You hoped with all your being you were right.&quot;,4,&quot; In short, there was nothing to really support that.&quot;,5,&quot; After all, you could be as close or as far as you were to begin with.&quot;,6,&quot; Such a natural maze was a beautiful feat, but it was making you antsy now.&quot;,7,&quot; Hopefully that voice was more than just your imagination.&quot;,8,&quot;
(text-colour:#b61205)[ You hear huffs besides you. Mumblings from the deer as he stomped every few steps.]&quot;,9,&quot;(text-colour: #b61205)[ &#39;I want the food now. Why is it so impossible to get the food now?]&quot;,10,&quot;(text-colour: #b61205)[ Just a few bites of something, anything besides bark…&#39;]&quot;,11,&quot;
(text-colour: #b9ecfb)[&#39;It&#39;s berries you want, yes?&#39;]&quot;,12,&quot;
The voice—it was clearer that time.&quot;,13,&quot; More prominent. Ecstatically you cry &#39;YES!&#39;&quot;,14,&quot; You start jogging in the direction and hear hooves prancing behind you.&quot;,15,&quot; Sounding like he regained a boost of childlike hope, the deer was verbal in wondering what you were saying yes about.&quot;,16,&quot;
You only stopped when you made it to a clearing. There were bountiful berry bushes along the perimeter on the opposite side.&quot;,17,&quot;
(text-colour: #b61205)[&#39;GOLLY GEE!&#39; Without another word,]&quot;,18,&quot;(text-colour: #b61205)[ the deer rushed past you and straight towards the berries. Once it was within reach and snacking away, though, he faded until there was nothing there.]&quot;,19,&quot;
Or so the area would have you believe, anyway.&quot;,20,&quot; The closer you looked and the more you tried to ignore the pounding in your eardrums, you could still hear crunching.&quot;,21,&quot; You could see berries become fewer and fewer, until more instantaneously grew in place.&quot;))
(set: $defendThineself to (dm:1,&quot;&#39;H-Hey. I&#39;m doing all I can! Talking to you hasn&#39;t pwrev-prevented me at all from our walk.&quot;,2,&quot; We haven&#39;t stopped or slowed down.&quot;,3,&quot; I&#39;m trying. And if it weren&#39;t for me, you would be all alone in trying to navigate this place.&quot;,4,&quot; At least neither of us are alone.&quot;,5,&quot; And I get that you may get like this when you&#39;re hungry, but that gives you no right to take it out on someone that wants to help.&#39;&quot;,6,&quot;
(text-colour: #b61205)[&#39;I warned you that this was how I got! And you AGREED, anyways.]&quot;,7,&quot;(text-colour: #b61205)[ That isn&#39;t on me! Don&#39;t go and try to play the victim card when all I want is some food.&#39;]&quot;,8,&quot;
&#39;I&#39;m not playing any card!&quot;,9,&quot; I even said I get it. I wasn&#39;t about to leave you high and dry just because you get angry.&quot;,10,&quot; And maybe that is on me! But I don&#39;t think that means I&#39;m in the wrong for it.&#39;&quot;,11,&quot;
There&#39;s silence that fills the air.&quot;,12,&quot; A strange silence.&quot;,13,&quot; Until there is a strange rustling above your head, and then some clunks against the forest floor.&quot;,14,&quot;
(text-colour: #b61205)[There&#39;s a loud, delighted gasp. &#39;APPLES!&#39;]&quot;,15,&quot;(text-colour: #b61205)[ As clear as day, you hear the munching of your now not-so-hangry deer friend. When one apple was gone, however,]&quot;,16,&quot;(text-colour: #b61205)[ he faded until there was nothing there.]&quot;,17,&quot;
Or so you were made to believe, anyway. But even as you staggered away from the empty space,&quot;,18,&quot; there were still bites being taken out of apples, down to the cores that were left behind.&quot;,19,&quot; You could even hear &#39;THANK YOUs&#39; whenever you couldn&#39;t hear the bites.&quot;))
(set: $defendEnd to (dm:1,&quot;(text-colour:#b9ecfb)[&#39;You did well.&#39;]&quot;,2,&quot;
You looked around for the voice that sounded like it was coming from…everywhere, now.&quot;,3,&quot;
(text-colour: #b9ecfb)[&#39;And I wish that you could stay and enjoy these. But you cannot.]&quot;,4,&quot;(text-colour: #b9ecfb)[ It is not your day.&#39;]&quot;,5,&quot;
&#39;What—what do you mean?&#39;&quot;,6,&quot;
It was then that you realized that a branch above your head was on its way to falling.&quot;,7,&quot; Falling towards you—it was too close to avoid now.&quot;,8,&quot;
And yet, you felt two hands on your shoulders push you.&quot;,9,&quot; Your feet were met by cold floor, and you blinked to see one of the fans of the Florida Room shatter.&quot;,10,&quot; Glass pieces went everywhere, primarily where you must have been…just now. Your shoulders were still chilled when your dad came immediately to your side.&quot;,11,&quot;
(text-colour: #129212)[&#39;Are you okay?&#39;]&quot;,12,&quot;
And somehow…you were.&quot;
))
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $allFalse is true)+(if: $index&lt;=6)[(set: $text to it + $Gateway&#39;s ($index))(if:$index is 6)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $dE is true)+(if:$index&lt;=12)[(set: $text to it + $defendEnd&#39;s ($index))(if: $index is 12)[[[End of Episode 2 -&gt; Intermission 2]]]]
	(else-if: $deerE is true)+(if:$index&lt;=19)[(set: $text to it + $deerSeenEnd&#39;s ($index))(if: $index is 19)[[[End of Episode 2 -&gt; Intermission 2]]]]
	(else-if: $seenHer is true)+(if: $index&lt;=19)[(set: $text to it + $deerSeenHer&#39;s ($index))(if: $index is 19)[(set:$text to &quot;&quot;)(set:$index to 0)(set: $deerE to true)]]
	(else-if: $familiar is true)+(if: $index&lt;=7)[(set: $text to it + $familiarSpirit&#39;s ($index))(if: $index is 7)[(set:$text to &quot;&quot;)(set:$index to 0)(set: $seenHer to true)]]
	(else-if: $getDef is true)+(if: $index&lt;=19)[(set: $text to it + $defendThineself&#39;s ($index))(if: $index is 19)[(set:$text to &quot;&quot;)(set:$index to 0)(set: $dE to true)]]
	(else-if: $aA is true)+(if: $index&lt;=21)[(set: $text to it + $agreeApolo&#39;s ($index))(if: $index is 21)[(set:$text to &quot;&quot;)(set:$index to 0)(set: $dE to true)]]
	(else-if: $offerBerries is true)+(if: $index&lt;=12)[(set: $text to it + $berriesBerries&#39;s ($index))(if: $index is 12)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $brokenNews is true)+(if: $index&lt;=19)[(set: $text to it + $breakingTheNews&#39;s ($index))(if: $index is 19)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $soundsMust is true)+(if: $index&lt;=19)[(set: $text to it + $soundingLikeMust&#39;s ($index))(if: $index is 19)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $doubleCheck is true)+(if: $index&lt;=16)[(set: $text to it + $askToBeSure&#39;s ($index))(if: $index is 16)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $acknowledgment is true)+(if: $index&lt;=21)[(set: $text to it + $knowingTheTruth&#39;s ($index))(if: $index is 21)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $beyondBewild is true)+(if:$index &lt;= 20)[(set: $text to it + $bewilderment&#39;s ($index))(if: $index is 20)[(set: $beforeOptionsA to false)(set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $theVoice is true)+(if:$index&lt;=15)[(set: $text to it + $followDirection&#39;s ($index))(if: $index is 15)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $findFood is true)+(if:$index &lt;=11)[(set: $text to it + $aid&#39;s ($index))(if: $index is 11)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $stunned is true)+(if: $index &lt;=23)[(set: $text to it + $shockedGreeting&#39;s ($index))(if: $index is 23)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $sayHello is true)+(if: $index &lt;=16)[(set: $text to it + $returnGreeting&#39;s ($index))(if: $index is 16)[(set: $beforeOptionsA to false)(set: $zPressed to true)]]
] ] ]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $sayHello to true) (set:$allFalse to false)]
	(else-if: $brokenNews is true)[(set:$seenHer to true)]
	(else-if: $offerBerries is true)[(set: $seenHer to true)]
	(else-if: $soundsMust is true)[(set: $aA to true)]
	(else-if: $doubleCheck is true)[(set: $soundsMust to true)]
	(else-if: $acknowledgment is true)[(set: $brokenNews to true)]
	(else-if: $beyondBewild is true)[(set: $soundsMust to true)]
	(else-if: $theVoice is true)[(set: $beyondBewild to true)]
	(else-if: $findFood is true)[(set: $theVoice to true)]
	(else-if: $stunned is true)[(set: $findFood to true)]
	(else-if: $sayHello is true)[(set: $findFood to true)]
]]
]
}
{
|bhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsB is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $stunned to true) (set:$allFalse to false)]
	(else-if: $offerBerries is true)[(set: $familiar to true)]
	(else-if: $brokenNews is true)[(set: $familiar to true)]
	(else-if: $soundsMust is true)[(set: $getDef to true)]
	(else-if: $acknowledgment is true)[(set: $offerBerries to true)]
	(else-if: $beyondBewild is true)[(set: $doubleCheck to true)]
	(else-if: $theVoice is true)[(set: $acknowledgment to true)]
]]]
}
{
|mhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $m is 5)[(set: $m to 1)]
(set: $text to it + $Emcouragement&#39;s ($m))
(set: $m to it + 1)
]]
}</tw-passagedata><tw-passagedata pid="5" name="To The Basement" tags="" position="480,621" size="100,100">(set: $timer to 0)(set: $text to &quot;&quot;)(set: $zPressed to false)(set: $beforeOptionsA to true)(set: $beforeOptionsB to true)(set: $index to 0)(set: $allFalse to true)(set:$glow to false)(set:$flash to false)(set:$startLanterns to false)(set:$offandLeap to false)(set:$evenSteven to false)(set:$goTurn to false)(set:$followIntuition to false)(set:$seekResponse to false)(set:$grateGo to false)(set:$southernGo to false)(set:$southernGoCont to false)(set:$blunt to false)(set:$runForIt to false)(set:$askForWay to false)(set:$bushes to false)(set:$glowSelf to false)(set:$moonGlow to false)(set:$Trueend to false)(set:$m to 1)
(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]]]
(set: $Emcouragement to (dm:1,&quot;
(text-colour:#8225cd)[The atmosphere...I can&#39;t tell if it&#39;s a misleading type of relaxing. But I&#39;d never mislead you! Just keep going.
]&quot;,2, &quot;
(text-colour:#8225cd)[It will all be alright. You&#39;re as safe as you want to be, and even safer.]
&quot;, 3, &quot;
(text-colour:#8225cd)[You&#39;ve got the power! To make it through! I believe in you!]
&quot;, 4, &quot;
(text-colour:#8225cd)[I&#39;m sure we&#39;re making it. Just a little more.]
&quot;))
(set: $Gateway to (dm:1,&quot;Feeling ever so daring this afternoon, you approached the wooden door that led to the basement.&quot;,2,&quot; You had to craft some statement of bravery before heading down.&quot;,3,&quot; And a light source, for all you could reach for the time being was the light next to the stairs.&quot;,4,&quot; The other switches required more of a trip, and the one could only go so far.&quot;,5,&quot;
&#96;[&#96;a&#96;]&#96; You&#39;ll glow and be your own source of light
&#96;[&#96;b&#96;]&#96; Grab a flashlight from a nearby cabinet.&quot;))
(set: $GlowSource to (dm:1,&quot;Turning the metallic knob, you try to face the creaky opening with a brave face.&quot;,2,&quot; You definitely pulled it off.&quot;,3,&quot; Surely.&quot;,4,&quot; All the spirits that resided down here would have to take you seriously with that start.&quot;,5,&quot;
You flipped the switch on to illuminate the carpeted stairs. You could just barely see the icy cool basement floor below, and the darkened laundry room beside it was no help.&quot;,6,&quot; Reminding yourself that you could do this with every step down, you closed the door behind you.&quot;,7,&quot; Perhaps it would help keep the spirits from infiltrating the rest of your house.&quot;,8,&quot; Not to mention there was no lock on the door, so they couldn&#39;t even keep you down here with them!&quot;,9,&quot;
Before you knew it, you had completed the descent. Instinctively, you closed the door to the laundry room and started to emit a golden glow.&quot;,10,&quot; It wasn&#39;t sun or moon-level of luminescence, but it was better than being completely blind.&quot;,11,&quot;
As soon as the laundry room door was closed, the knob faded away.&quot;,12,&quot; You turn back to the dark opening to see a fog start to set in. You let out a harsh breath when the temperature decreased.&quot;,13,&quot; It was a small surprise that it didn&#39;t just start snowing, instead.&quot;,14,&quot; The floor beneath you turned into a crisp ground that would give you away if anyone was close by.&quot;,15,&quot;
Hopefully no one was close by.&quot;,16,&quot;
Hopefully nothing was close by.&quot;,17,&quot;
&#96;[&#96;a&#96;]&#96; Start on your ways to turn on all four of the lanterns&quot;
))
(set: $FlashSource to (dm:1,&quot;Before going to open the door, you opened a kitchen cabinet that held a simple, orange flashlight.&quot;,2,&quot; You clicked it on and off a few times to make sure it was working before returning to the only thing standing in your way from discovering the truth.&quot;,3,&quot;
Turning the metallic knob, you try to face the creaky opening with a brave face.&quot;,4,&quot; You definitely pulled it off.&quot;,5,&quot; Surely.&quot;,6,&quot; All the spirits that resided down here would have to take you seriously with that start.&quot;,7,&quot;
You flipped the switch on to illuminate the carpeted stairs.&quot;,8,&quot; You could just barely see the icy cool basement floor below, and the darkened laundry room beside it was no help.&quot;,9,&quot; Reminding yourself that you could do this with every step down, you closed the door behind you.&quot;,10,&quot; Perhaps it would help keep the spirits from infiltrating the rest of your house.&quot;,11,&quot; Not to mention there was no lock on the door, so they couldn&#39;t even keep you down here with them!&quot;,12,&quot;
Before you knew it, you had completed the descent.&quot;,13,&quot; Instinctively, you closed the door to the laundry room and turned on your handy dandy flashlight.&quot;,14,&quot; It wasn&#39;t a major game changer, but it was better than nothing.&quot;,15,&quot;
As soon as the laundry room door was closed, the knob faded away.&quot;,16,&quot; You turn back to the dark opening to see a fog start to set in.&quot;,17,&quot; You let out a harsh breath when the temperature decreased.&quot;,18,&quot; It was a small surprise that it didn&#39;t just start snowing, instead. The floor beneath you turned into a crisp ground that would give you away if anyone was close by.&quot;,19,&quot;
Hopefully no one was close by.&quot;,20,&quot;
Hopefully nothing was close by.&quot;,21,&quot;
But those hopes quickly dwindled as the flashlight in your hand flickered.&quot;,22,&quot; It started slow.&quot;,23,&quot; You tried to bump it into working again, but it only flickered more.&quot;,24,&quot; Until it completely went out.&quot;,25,&quot; Well—so much for that plan.&quot;,26,&quot; You noted the glass icing over and quickly tucked the flashlight away.&quot;,27,&quot; You didn&#39;t really want to impose more problems on yourself than what was already gotten into. &quot;,28,&quot;Besides…you could glow! A golden glow on your own that wouldn&#39;t flicker based on paranormal activity.&quot;,29,&quot;
&#96;[&#96;a&#96;]&#96; Start on your ways to turn on all four of the lanterns&quot;))
(set: $Commence to (dm:1,&quot;Deciding there was no time like the present, &quot;,2,&quot;you brace yourself and start going down the path.&quot;,3,&quot; Every step is a satisfying but troubling crunch that has you listening for other steps close by.&quot;,4,&quot; At least if something was walking towards you, it wouldn&#39;t have a chance at being any sneakier than you were. &quot;,5,&quot;
The only problem with this reassurance is the fact you were about 90% sure that spirits didn&#39;t have to walk&quot;,6,&quot; or make any type of sound that gave them away.&quot;,7,&quot; And while you were searching for them, you were also hoping they weren&#39;t searching for you in return.&quot;,8,&quot;
You hug your arms around yourself, asserting that it was to keep warm and for nothing else.&quot;,9,&quot; You can only see a few feet ahead of you, and you&#39;re starting to note that the fog has started to get denser.&quot;,10,&quot; Amazing! As if you weren&#39;t having trouble already.&quot;,11,&quot; How would you know if you&#39;ve gotten turned around or not?&quot;,12,&quot; What if you were going in a circle?&quot;,13,&quot;
You encourage yourself to glow a little brighter despite the odds, humming to yourself so it wasn&#39;t so unnervingly quiet.&quot;,14,&quot; It was true you didn&#39;t want to give yourself away, but you would just as quickly get into your own head.&quot;,15,&quot; And to turn away before reaching any destination? Well—that simply wouldn&#39;t do.&quot;,16,&quot;
The next step you take makes your right sock and foot damp.&quot;,17,&quot;
&#96;[&#96;a&#96;]&#96; Yuck. Take the sock off and try to jump for it.
&#96;[&#96;b&#96;]&#96; …May as well make it even and put your left foot in too. At least this way it would be your decision.&quot;
))
(set: $sockJump to (dm:1,&quot;This was one of the worst feelings ever.&quot;,2,&quot; You begrudgingly remove your foot from the water and take the sock off, curling it into a ball and stuffing it in your pocket.&quot;,3,&quot; After that, you took a few steps back to get a running start.&quot;,4,&quot; One,&quot;,5,&quot; two,&quot;,6,&quot; three,&quot;,7,&quot; LEAP!&quot;,8,&quot;
…No splash, no wet feet, everything is intact.&quot;,9,&quot; This was the ideal.&quot;,10,&quot; You let a breath of relief out and notice a post to your right. &quot;,11,&quot;
(text-colour:#d9d9d9)[&#39;No…Don&#39;t do it. Don&#39;t turn on the light.&#39;]&quot;,12,&quot; 
You still, eyes widening, spinning around in a circle to look around you.&quot;,13,&quot; There…isn&#39;t anything that you could see.&quot;,14,&quot; Could ghosts see easily through the fog?&quot;,15,&quot; That would make this even more unfair.
&#96;[&#96;a&#96;]&#96; Go to turn on the light&quot;))
(set: $leftWithRight to (dm:1,&quot;Time to throw all caution to the wind.&quot;,2,&quot; Wet socks never bothered you anyways so long as they were evenly so.&quot;,3,&quot; You braced yourself and without a moment&#39;s hesitation, decidedly put your other foot in.&quot;,4,&quot; You started to wade across the water, looking to the other side when it was in sight.&quot;,5,&quot;
Could you have made a jump?&quot;,6,&quot; …You didn&#39;t want to admit it.&quot;,7,&quot; But it may have been possible.&quot;,8,&quot; Would it have been worth the risk, though?&quot;,9,&quot; What if you had jumped to have both socks wet in the end, anyhow?&quot;,10,&quot;
Luckily you noticed a post to your right that pulled you from your debating thoughts.&quot;,11,&quot;
(text-colour:#d9d9d9)[&#39;No…Don&#39;t do it. Don&#39;t turn on the light.&#39;]&quot;,12,&quot; 
You still, eyes widening, spinning around in a circle to look around you.&quot;,13,&quot; There…isn&#39;t anything that you could see.&quot;,14,&quot; Could ghosts see easily through the fog?&quot;,15,&quot; That would make this even more unfair.
&#96;[&#96;a&#96;]&#96; Go to turn on the light&quot;))
(set: $lightOn to (dm:1,&quot;The whole reason you agreed to come down here in the first place was the fact you could be rid of the darkness by turning on the lights.&quot;,2,&quot; Whatever that voice came from, whoever it was, wanted you to be in the dark.&quot;,3,&quot; Somehow standing your ground, you walked over to the post and turned on the light.&quot;,4,&quot;
Like magic,&quot;,5,&quot; the surrounding perimeter of fog was instantaneously cleared up.&quot;,6,&quot; The light dispelled all darkness and uncertainty, and the ground beneath your feet warmed.&quot;,7,&quot; The only thing that kept you from dropping your guard completely was the dwindling whispers that silenced after a few beats had passed.&quot;,8,&quot; The sources…they wouldn&#39;t have just vanished completely.&quot;,9,&quot; Especially since they knew someone had turned on the light.&quot;,10,&quot;
You gulped, looking back to the post and noticing there rested directions to the next nearest post.&quot;,11,&quot; Following the path north would lead to what looked to be bushes.&quot;,12,&quot; Somewhere hidden among the brush would be the next light.&quot;,13,&quot;
Giving a nod, you were about to walk off when it dawned on you.&quot;,14,&quot; Where…where was north?&quot;,15,&quot;
&#96;[&#96;a&#96;]&#96; Follow your intuition. It&#39;s probably the same direction as the way you were coming in to get this one.
&#96;[&#96;b&#96;]&#96; Ask aloud to see if anyone responds.&quot;))
(set: $Intuition to (dm:1,&quot;Preferring this over the alternative, you kept walking past this post and further.&quot;,2,&quot; When you got out of the welcoming perimeter of light,&quot;,3,&quot; you were once again met with crunchy,&quot;,4,&quot; tough ground and an impenetrable fog.&quot;,5,&quot; Chills traveled like static down your spine, keeping your posture straight and your attention scattered everywhere around you.&quot;,6,&quot; You only paused to listen for other footsteps that never came.&quot;,7,&quot; Not even one out of place.&quot;,8,&quot;
The longer you walked, the more you questioned if this was the right direction.&quot;,9,&quot; 
With that possibility, you weren&#39;t sure if you would rather be completely lost than the possibility of having selected the wrong direction.&quot;,10,&quot;
You kept pressing onwards, though.&quot;,11,&quot; Surely your intuition wouldn&#39;t completely fail you.&quot;,12,&quot; There had to be a light over somewhere this way,&quot;,13,&quot; even if it hadn&#39;t been the one you originally sought for.&quot;,14,&quot;
(text-colour:#6895d9)[&#39;From East to West, you go like the Sun.&#39;]&quot;,15,&quot;
You turn with a start to see a transparent figure traipsing delicately behind you.&quot;,16,&quot; You would&#39;ve nearly missed that fact when all attention was commanded to their eyes, though.&quot;,17,&quot; It was a glorious brown, the kind you would probably melt if you were captured for too long.&quot;,18,&quot; They were so warm and lively.&quot;,19,&quot;
(text-colour: #6895d9)[&#39;Sorry to interrupt.&#39;]&quot;,20,&quot;(text-colour:#6895d9)[ They held both hands up in a surrender form, as if to assure that you were the one in control of the situation.]&quot;,21,&quot;(text-colour:#6895d9)[ &#39;You&#39;re going from far end to far end for the lights, though.]&quot;,22,&quot;(text-colour:#6895d9)[ You were at the East, and now you&#39;re heading to the West.&#39;]&quot;,23,&quot;
&#39;O-Oh.&#39; You gulped. That would explain why it felt so long.&quot;,24,&quot; &#39;Uh…Am I at least close now?&#39;&quot;,25,&quot;
(text-colour:#6895d9)[&#39;Indeed.&#39;]
&#96;[&#96;a&#96;]&#96; Thank them and be on your way&quot;))
(set: $wantResponse to (dm:1,&quot;You clear your throat.&quot;,2,&quot; You&#39;ve made yourself known at this point.&quot;,3,&quot; Perhaps there were spirits willing to guide you? &#39;Ahem. Uh…Is there anyone here that knows what direction North is?&#39;&quot;,4,&quot;
(text-colour:#c7ebe8)[&#39;You do not wish to go North, yet.&#39;]&quot;,5,&quot;
&#39;It&#39;s the closest—&#39;&quot;,6,&quot;
(text-colour: #c7ebe8)[&#39;You wanted advice, and I am here to give it to you.]&quot;,7,&quot;(text-colour: #c7ebe8)[ Regardless if the North is the closest.]&quot;,8,&quot;(text-colour:#c7ebe8)[ He is at his strongest, there.&#39;]&quot;,9,&quot;
&#39;He? He—He who?&#39; You frown, listening for a response that would not come.&quot;,10,&quot;
(text-colour: #c7ebe8)[&#39;Follow your intuition if you wish to be successful in your pursuit.&#39;]&quot;,11,&quot;
Unable to get rid of the feeling you didn&#39;t need an answer to your question to distinguish who it was,&quot;,12,&quot; anyhow,&quot;,13,&quot; you turned to where you would&#39;ve walked on your own.&quot;))
(set: $thankGo to (dm:1,&quot;&#39;Thank you.&#39;&quot;,2,&quot; You shuddered, but it was like releasing a pent up bout of sadness. You felt…&quot;,3,&quot;strangely relieved.&quot;,4,&quot; Relaxed. As if you had already made it to the next light.&quot;,5,&quot; &#39;I&#39;ll go do that, then. Would you recommend either the North or South more for where to go after?&#39;&quot;,6,&quot;
(text-colour:#6895d9)[Appearing pleasantly surprised about your inquiry, the spirit smiled before speaking.]&quot;,7,&quot;(text-colour:#6895d9)[ &#39;No problem at all. And there isn&#39;t a major difference between the two, but if it were me?]&quot;,8,&quot;(text-colour:#6895d9)[ I&#39;d go to the South first. Leave the North for the last.]&quot;,9,&quot;(text-colour:#6895d9)[ The one you fear lurks more in the East and particularly in the North, but having three lights…and yourself will help.&#39;]&quot;,10,&quot;
The one you feared.&quot;,11,&quot; The one that was in here.&quot;,12,&quot; During your birthday party.&quot;,13,&quot; The one your friends saw. Had that been the voice trying to tell you not to turn on the first light?&quot;,14,&quot;
You nodded, bidding them farewell with another &#39;Thanks&#39;&quot;,15,&quot; and returning to your path. Sure enough,&quot;,16,&quot; not even two minutes later, you came up to another light.&quot;,17,&quot; Turning it on reproduced the same impact as the first.&quot;,18,&quot; It was easier for you to glow, as if each one of these places could serve as a recharge.&quot;,19,&quot;
&#96;[&#96;a&#96;]&#96; Take the spirit&#39;s advice and head to the Southern light first&quot;))
(set: $SouthernLight to (dm:1,&quot;Heeding the words of the great Sun Spirit, as you would coin them, you turned to head south.&quot;,2,&quot; At least this pathing wouldn&#39;t be as long, and you knew the answer as to why.&quot;,3,&quot; Compelling your light to grow and dim in strength,&quot;,4,&quot; you couldn&#39;t help but grin.&quot;,5,&quot; It seemed like such a simple thing—to hold light at your fingertips.&quot;,6,&quot; But against darkness? You wouldn&#39;t have it any other way.&quot;,7,&quot;
Still, you didn&#39;t know how it would go when you did go to face the figure only your friends had seen.&quot;,8,&quot; You had been upstairs with another group to prepare a &#39;Haunted House&#39; while the ones downstairs did the same.&quot;,9,&quot; In the basement.&quot;,10,&quot; And they had seen a figure down there that followed them to the bottom of the stairs.&quot;,11,&quot; It had been facing up at them when they closed the door.&quot;,12,&quot;
…Gaaaaaaaaaah it still gave you the heebie jeebies just thinking about it.&quot;,13,&quot; You shook out your arms and your legs in the next few steps to get rid of the feeling.&quot;,14,&quot; Your arms wrapped around you again soon after.&quot;,15,&quot; You had convinced yourself of the ability to face it prior to coming down here,&quot;,16,&quot; but…were you really ready?&quot;,17,&quot; Could you really do this?&quot;,18,&quot; Or would you be running away before you got the chance?&quot;,19,&quot;
You hadn&#39;t even prepared what you would do upon seeing it. Would you freeze entirely?&quot;,20,&quot; Become a statue as if it was gifted with Medusa&#39;s icy stare?&quot;,21,&quot; Mythology was intriguing, but you could do without that part.
In heat of your internal debate, you walked right into…through…and past another spirit.&quot;,22,&quot;
In heat of your internal debate, you walked right into…through…and past another spirit.&quot;))
(set: $SouthernLightCont to (dm:1,&quot;(text-colour:#f3d8a9)[&#39;Hey, hey YOU THERE. The—The audacity. Watch where you&#39;re walking!&#39;]&quot;,2,&quot;
Your eyes shot up from the ground and to the sassy entity,&quot;,3,&quot; a hand going to the back of your head. &#39;Sorry.&#39;&quot;,4,&quot;
(text-colour: #f3d8a9)[In front of you in the blink of an eye, this particular spirit didn&#39;t seem afraid to get all up in your face.]&quot;,5,&quot;(text-colour:#f3d8a9)[ &#39;Sorry? Of course you&#39;re sorry!]&quot;,6,&quot;(text-colour:#f3d8a9)[ I was minding my own business when you just decided to go right through me.]&quot;,7,&quot;(text-colour:#f3d8a9)[ As if it isn&#39;t bad enough when people do it when they don&#39;t see me, they do it when they CAN too?]&quot;,8,&quot;(text-colour:#f3d8a9)[ Why—Why can you see me, anyways?&#39;]&quot;,9,&quot;(text-colour:#f3d8a9)[ She lost her steam a bit at the end there, her look becoming skeptical.]&quot;,10,&quot;
&#39;Is it not normal for you to be seen?&#39;&quot;,11,&quot; When the spirit shook her head, your eyebrows furrowed. &#39;Hm…I&#39;m not sure.&quot;,12,&quot; Would you happen to know if the Southern light is anywhere near here?&#39;&quot;,13,&quot;
(text-colour:#f3d8a9)[&#39;And now you&#39;re asking me for directions like I&#39;m a tour guide!&#39;]&quot;,14,&quot;
&#39;I&#39;m sorry—&#39;&quot;,15,&quot;
(text-colour:#f3d8a9)[&#39;No no NO,]&quot;,16,&quot;(text-colour:#f3d8a9)[ I have nothing better to do anyways.]&quot;,17,&quot;(text-colour:#f3d8a9)[ What you seek is nearby, and I&#39;ll lead you the rest of the way…&#39;]&quot;,18,&quot;
&#39;That really isn&#39;t necessary, I&#39;ve disturbed you enough—&#39;&quot;,19,&quot;
(text-colour:#f3d8a9)[&#39;…so long as you tell me why you want to know.&#39;]&quot;,20,&quot;
You pause at that.&quot;,21,&quot; Maybe she was some guardian of the light.&quot;,22,&quot; She could just be nosy, but&quot;,23,&quot;…what was the harm in saying, even so?&quot;,24,&quot; &#39;Being able to see is always nice, to start.&quot;,25,&quot; But y&#39;see, my parents also think it&#39;s silly for me to be afraid to be down here.&quot;,26,&quot; And there&#39;s like a pool table and foosball…somewhere.&quot;,27,&quot; And in order to spend time down here I should probably not be afraid.&#39;&quot;,28,&quot;
(text-colour:#f3d8a9)[&#39;Why are you afraid?&#39;]&quot;,29,&quot;
&#96;[&#96;a&#96;]&#96; Be blunt&quot;))
(set: $BeBlunt to (dm:1,&quot;&#39;Some spirit my friends saw during a party.&quot;,2,&quot; They all even fell on the steps at the same time—but I guess he just had this…aura.&quot;,3,&quot; This scary aura that I feel even now.&#39;&quot;,4,&quot;
(text-colour:#f3d8a9)[&#39;…Hm. I think I know the spirit you&#39;re talking about.]&quot;,5,&quot;(text-colour:#f3d8a9)[ Alright. Come on, then.&#39;]&quot;,6,&quot;
Without another word, she started to drift to you&quot;,7,&quot;…through you&quot;,8,&quot;…and right past you.&quot;,9,&quot; 
The heebie jeebies were back,&quot;,10,&quot; but this time you supposed it was really warranted.&quot;,11,&quot; You shook them from you again as you followed, shortly thereafter coming to the light.&quot;,12,&quot; When you flicked it on and turned to say something to the spirit,&quot;,13,&quot; she was already being pushed outwards by the light.&quot;,14,&quot;
Now with three lights,&quot;,15,&quot; you could sort of see the other two sources East and West of here.&quot;,16,&quot; Straight ahead remained dark and foggy. No—it was worse than that now. Far worse.&quot;,17,&quot; As if all that you had been pushing away with the other three lights was now focused into one condensed package.&quot;,18,&quot;
This was almost certainly going to be a fun ride.&quot;,19,&quot;
You wouldn&#39;t say you were afraid of the dark,&quot;,20,&quot; but the unknown was something you tentatively danced around.&quot;,21,&quot; And who knew how much unknown was being hosted in what you couldn&#39;t see?&quot;,22,&quot;
But you dared to argue with yourself.&quot;,23,&quot; Sure, the unknown was frightening, but it could be just as rewarding.&quot;,24,&quot; It could even mean…more light.&quot;,25,&quot; Everything you&#39;ve done so far had previously been in a state of darkness,&quot;,26,&quot; in the state of unknown.&quot;,27,&quot; And you had come out of it. This was much the same.&quot;,28,&quot;
Not wanting to spend another moment frozen,&quot;,29,&quot; you started taking a few steps. Spirits may be a part of this mass,&quot;,30,&quot; but the ones you&#39;ve come face-to-face with so far were benevolent.&quot;,31,&quot; They wanted to help you.&quot;,32,&quot; Their personalities were fun and lively. Your heart got to be more in it. Your sights were aligned with the prize.&quot;,33,&quot;
Your steps hastened while you continued North.&quot;,34,&quot; Engulfed, swallowed, you may very well have momentarily become one with the dark mass.&quot;,35,&quot; There was little to distinguish you and it besides the light that continued to emit from you.&quot;,36,&quot;
(text-colour: #d9d9d9)[&#39;This is where your adventure ends.&#39;]&quot;,37,&quot;(text-colour: #d9d9d9)[ Everywhere surrounding you came the same voice as before. The misty fog swirled around you, a permeating darkness making a cloak-like form.]&quot;,38,&quot;(text-colour: #d9d9d9)[ Starkly contrasting it was the white head, like the moon against the night sky.]&quot;,39,&quot;(text-colour:#d9d9d9)[ In fact, the face was much like the &#39;man on the moon,&#39; with those being the distinguishing features. But even so, it emitted no light.]&quot;,40,&quot;
&#96;[&#96;a&#96;]&#96; Try to make a run for it past
&#96;[&#96;b&#96;]&#96; Ask for a way through&quot;))
(set: $runPast to (dm:1,&quot;They may have thought that it would be as easy as that.&quot;,2,&quot; That you could be chased away with some threatening words,&quot;,3,&quot; that you would be turned around.&quot;,4,&quot; No! You would be running the rest of the way.&quot;,5,&quot; Just for extra measure, as you went to run past them though…&quot;,6,&quot;
&#39;LIGHT&quot;,7,&quot; LIGHT LIGHT &quot;,8,&quot;LIGHT LIGHT LIGHT LIGHT LIGHT LIGHT!&#39;&quot;,9,&quot; You ran in leaps and bounds as you repeated the word,&quot;,10,&quot; keeping your glow against the pull the darkness seemed to hold on it.&quot;,11,&quot; &#39;LIGHT LIGHT LIGHT LIGHT LIGHT LIGHT LIGHT!&#39;&quot;,12,&quot;
To you, it sounded like a battle cry.&quot;,13,&quot; To anyone else, well…you would never know!&quot;,14,&quot; But you kept running,&quot;,15,&quot; even when the shifting mist seemed to move with you.&quot;,16,&quot;
&#39;LIGHT LIGHT LIGHT.&quot;,17,&quot; LIGHT—This isn&#39;t ANY fair,&quot;,18,&quot; you can&#39;t GET OUT OF BREATH. LIGHT LIGHT LIGHT LIGHT LIGHT.&#39;&quot;,19,&quot;
You hear a booming bass of laughter closing in behind you.&quot;,20,&quot; Whether it came from the thrill of the chase or because they thought you were funny,&quot;,21,&quot; you didn&#39;t think too much on it.&quot;,22,&quot; Your whole body was practically numb with the chills spiraling down your spine and spreading to the tips of your fingers and toes.&quot;,23,&quot; 
You stumble into a row of bushes.
&#96;[&#96;a&#96;]&#96; BUSHES???&quot;))
(set: $requestPassage to (dm:1,&quot;While thinking about the best route, you thought back to the other spirits you encountered.&quot;,2,&quot; Namely the most recent one.&quot;,3,&quot; You were surprised to find your voice and even more surprised that you could manage to keep it steady.&quot;,4,&quot; But you would at least try to request for information on getting to that final light.&quot;,5,&quot;
&#39;Could you point me in the direction of the Northern Light, please?&#39;&quot;,6,&quot;
(text-colour:#d9d9d9)[There was a loud cackle, and the darkness around you shook, leaving you feeling rather shaken.]&quot;,7,&quot;(text-colour:#d9d9d9)[ &#39;You&#39;re looking at him.&#39;]&quot;,8,&quot;
&#39;Huh?&#39;&quot;,9,&quot; But…there was no light nearby him at all.&quot;,10,&quot; What was he proposing? That he had been a light?&quot;,11,&quot; And that he wasn&#39;t, anymore? &#39;Why are you not the light, anymore?&#39;&quot;,12,&quot;
(text-colour:#d9d9d9)[&#39;Don&#39;t be ridiculous. Look at me!]&quot;,13,&quot;(text-colour:#d9d9d9)[ Could you honestly imagine me in any other form holding any power that is even the fraction of what I possess now?&#39;]&quot;,14,&quot;
You try not to flinch away from the harsh, mocking tone.&quot;,15,&quot; You continue to look onwards at him, continuing to seek and locate a resolve.&quot;,16,&quot; &#39;I am looking at you. And sure, you&#39;re powerful,&quot;,17,&quot; but are you…are you happy this way?&#39;&quot;,18,&quot;
(text-colour:#d9d9d9)[&#39;Happy? Why would that—&#39;]&quot;,19,&quot;
&#39;Because it&#39;s colder here.&quot;,20,&quot; Way, way colder.&quot;,21,&quot; And I wonder if it&#39;s because you&#39;ve forgotten what warmth is.&#39;&quot;,22,&quot;
(text-colour:#d9d9d9)[He scoffed at you. &#39;What warmth is—&#39;]&quot;,23,&quot;
&#39;Yes. The other spirits had it.&quot;,24,&quot; They embraced it. Accepted it.&quot;,25,&quot; But you…you let the power go to your head!&quot;,26,&quot; Instead of spreading and sharing the light,&quot;,27,&quot; you…you kept it to yourself until there was none left to spread!&#39;&quot;,28,&quot;
(text-colour:#d9d9d9)[&#39;…Are you daring to challenge my authority, here?]&quot;,29,&quot;(text-colour:#d9d9d9)[ Look around you. Where is that warmth, now?&#39;]
&#39;I have some.&#39; You paused, watching your glow strengthen&quot;,30,&quot;
&#39;I have some.&#39; You paused, watching your glow strengthen&quot;))
(set: $Bush to (dm:1,&quot;BUSHES???&quot;,2,&quot; BUSHES! That&#39;s right!&quot;,3,&quot; The map at the East light had mentioned bushes.&quot;,4,&quot; You clamor to your feet and heed no mind to the insane amount of noise you&#39;re making.&quot;,5,&quot; You push back all the greenery you can see to try to find a partially hidden light.&quot;,6,&quot;
But you couldn&#39;t see it.&quot;,7,&quot; Even when you tried going where the map had a nice X marking the spot, you couldn&#39;t find it.&quot;,8,&quot;
(text-colour:#d9d9d9)[&#39;Done running, yet?&#39;]&quot;,9,&quot;(text-colour:#d9d9d9)[ The being formed again right in front of you, causing an involuntary yelp.]&quot;,10,&quot;(text-colour:#d9d9d9)[ &#39;Good. You gave more trouble than those other friends of yours—&#39;]&quot;,11,&quot;
&#39;LIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIGHT.&#39; 
(text-colour:#d9d9d9)[They blinked at you screaming just.]&quot;,12,&quot;(text-colour:#d9d9d9)[ Right in their face.]&quot;,13,&quot;
You blinked back. Then, the most glorious thing happened.
&#96;[&#96;a&#96;]&#96; Your glow started to dispel the rest of the darkness
&#96;[&#96;b&#96;]&#96; The moon man…started to glow&quot;))
(set: $selfGlow to (dm:1,&quot;Like a beacon,&quot;,2,&quot; ten times the amount of light that you&#39;d seen yourself emit thus far burst out from you in a perimeter similar to the other three spots.&quot;,3,&quot; The spirit, or whatever he may have been, was dispelled almost as quickly as the others.&quot;,4,&quot; He seemed to be fighting back against your light, trying to overwhelm you still.&quot;,5,&quot;
But you kept glowing like all things good depended on it.&quot;,6,&quot; You glowed because you depended on it, and you weren&#39;t going to back down now.&quot;,7,&quot; &#39;ACCEPT IT!&#39;&quot;,8,&quot;
(text-colour: #d9d9d9)[&#39;What did you just say—&#39;]&quot;,9,&quot;
&#39;ACCEPT IT. PLEASE!&quot;,10,&quot; I…I have no problem with you staying.&quot;,11,&quot; But you can&#39;t make others feel like they&#39;re in danger.&quot;,12,&quot; You have the ability to glow like this!&quot;,13,&quot; Like the other spirits.&quot;,14,&quot; You can stay.&quot;,15,&quot; It&#39;s—It&#39;s okay to let the darkness in sometimes.&quot;,16,&quot; But you can&#39;t let it consume you! You don&#39;t want it to consume others, either.&#39;&quot;,17,&quot; You don&#39;t want it to consume others, either.&#39;&quot;
))
(set: $glowMoon to (dm:1,&quot;To your great surprise,&quot;,2,&quot; despite the ever-present darkness...the spirit, or whatever he may have been, started to glow.&quot;,3,&quot; Similarly to how you did, but dimmer.&quot;,4,&quot; Even dimmer than you had begun.&quot;,5,&quot; There was a duality to him, now.&quot;,6,&quot; You were seeing him fight against himself. On one hand, brilliant colors started to spring from him, but on the other, he just as quickly swallowed them up as if they weren&#39;t there to begin with.&quot;,7,&quot;
Taking a deep breath and taking the plunge, you walked closer to him.&quot;,8,&quot; &#39;It&#39;s okay. You don&#39;t have to be afraid.&#39;&quot;,9,&quot;
(text-colour: #d9d9d9)[&#39;Don&#39;t be so ridiculous—&#39;]&quot;,10,&quot;
&#39;I was afraid of coming down here because of what you did.&quot;,11,&quot; What I didn&#39;t see, what my friends saw…&quot;,12,&quot;You don&#39;t have to be afraid just like you don&#39;t have to be scary.&quot;,13,&quot; I have no problem with you being here!&quot;,14,&quot; But you can&#39;t make others feel like they&#39;re in danger.&quot;,15,&quot; Especially when you have the ability to make others feel warm, reassured, safe.&quot;,16,&quot; It&#39;s okay to let the darkness in, sometimes.&quot;,17,&quot; But you can&#39;t let it consume you, or the others around you either. Let yourself glow. Don&#39;t be afraid of the change.&#39;&quot;,18,&quot; Let yourself glow. Don&#39;t be afraid of the change.&#39;&quot;))
(set: $commonEnd to (dm:1,&quot;(text-colour:#d9d9d9)[&#39;…&#39; It was a deafening time after of silence.]&quot;,2,&quot;(text-colour:#d9d9d9)[ You would&#39;ve believed it if someone told you it were both seconds and hours all in one nicely kept package.]&quot;,3,&quot;
You stopped feeling a push back from the spirit.&quot;,4,&quot; He started to have a brilliant aura, stemming from his Moon-like head that started expanding downwards.&quot;,5,&quot; Where there had been no color, there was now all of them.&quot;,6,&quot; And then he was gone, up into the sky in a recreation of the Northern Lights.&quot;,7,&quot;
You were…breathless.&quot;,8,&quot; No longer did you glow, but no longer did you have to.&quot;,9,&quot;
The scene fell away.&quot;,10,&quot; You were by all four of the light switches that rested next to each other on the wall of your basement.&quot;,11,&quot; All the lights were on,&quot;,12,&quot; and all could be seen. There was nothing ominous.&quot;,13,&quot;
But there was still the slightest chill that fanned down your neck.&quot;))
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $allFalse is true)+(if: $index&lt;=5)[(set: $text to it + $Gateway&#39;s ($index))(if:$index is 5)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if:$Trueend is true)+(if:$index&lt;=13)[(set:$text to it + $commonEnd&#39;s ($index))(if:$index is 13)[[[Cont to Third Episode-&gt; Intermission 2]]]]
	(else-if: $moonGlow is true)+(if:$index&lt;=18)[(set: $text to it + $glowMoon&#39;s ($index))(if: $index is 18)[(set:$index to 0)(set:$text to &quot;&quot;)(set:$Trueend to true)]]
	(else-if: $glowSelf is true)+(if:$index&lt;=17)[(set: $text to it + $selfGlow&#39;s ($index))(if: $index is 17)[(set:$index to 0)(set:$text to &quot;&quot;)(set:$Trueend to true)]]
	(else-if: $bushes is true)+(if: $index&lt;=13)[(set: $text to it + $Bush&#39;s ($index))(if: $index is 13)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set:$zPressed to true)]]
	(else-if: $askForWay is true)+(if: $index&lt;=30)[(set: $text to it + $requestPassage&#39;s ($index))(if: $index is 30)[(set:$text to &quot;&quot;)(set:$index to 0)(set: $glowSelf to true)]]
	(else-if: $runForIt is true)+(if: $index&lt;=23)[(set: $text to it + $runPast&#39;s ($index))(if: $index is 23)[(set:$beforeOptionsA to false)(set:$zPressed to true)]]
	(else-if: $blunt is true)+(if: $index&lt;=40)[(set: $text to it + $BeBlunt&#39;s ($index))(if: $index is 40)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set:$zPressed to true)]]
	(else-if: $southernGoCont is true)+(if:$index&lt;=29)[(set: $text to it + $SouthernLightCont&#39;s ($index))(if: $index is 29)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $southernGo is true)+(if: $index&lt;=22)[(set: $text to it + $SouthernLight&#39;s ($index))(if: $index is 22)[(set:$index to 0)(set:$text to &quot;&quot;)(set:$southernGoCont to true)]]
	(else-if: $grateGo is true)+(if: $index&lt;=19)[(set: $text to it + $thankGo&#39;s ($index))(if: $index is 19)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $followIntuition is true)+(if: $index&lt;=25)[(set: $text to it + $Intuition&#39;s ($index))(if: $index is 25)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $seekResponse is true)+(if: $index&lt;=13)[(set: $text to it + $wantResponse&#39;s ($index))(if: $index is 13)[(set:$text to &quot;&quot;)(set:$index to 0)(set:$followIntuition to true)]]
	(else-if: $goTurn is true)+(if: $index&lt;=15)[(set: $text to it + $lightOn&#39;s ($index))(if: $index is 15)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $evenSteven is true)+(if:$index &lt;= 15)[(set: $text to it + $leftWithRight&#39;s ($index))(if: $index is 15)[(set: $beforeOptionsA to false)(set: $beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $offandLeap is true)+(if:$index&lt;=15)[(set: $text to it + $sockJump&#39;s ($index))(if: $index is 15)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $startLanterns is true)+(if:$index &lt;=17)[(set: $text to it + $Commence&#39;s ($index))(if: $index is 17)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $flash is true)+(if: $index &lt;=29)[(set: $text to it + $FlashSource&#39;s ($index))(if: $index is 29)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $glow is true)+(if: $index &lt;=17)[(set: $text to it + $GlowSource&#39;s ($index))(if: $index is 17)[(set: $beforeOptionsA to false)(set: $zPressed to true)]]
] ] ]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $glow to true) (set:$allFalse to false)]
	(else-if: $bushes is true)[(set:$glowSelf to true)]
	(else-if: $runForIt is true)[(set:$bushes to true)]
	(else-if: $blunt is true)[(set:$runForIt to true)]
	(else-if: $southernGoCont is true)[(set: $blunt to true)]
	(else-if: $grateGo is true)[(set: $southernGo to true)]
	(else-if: $followIntuition is true)[(set: $grateGo to true)]
	(else-if: $goTurn is true)[(set: $followIntuition to true)]
	(else-if: $offandLeap is true)[(set: $goTurn to true)]
	(else-if: $evenSteven is true)[(set: $goTurn to true)]
	(else-if: $startLanterns is true)[(set: $offandLeap to true)]
	(else-if: $flash is true)[(set: $startLanterns to true)]
	(else-if: $glow is true)[(set: $startLanterns to true)]
]]
]
}
{
|bhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsB is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $flash to true) (set:$allFalse to false)]
	(else-if: $bushes is true)[(set: $moonGlow to true)]
	(else-if: $blunt is true)[(set: $askForWay to true)]
	(else-if: $goTurn is true)[(set: $seekResponse to true)]
	(else-if: $startLanterns is true)[(set: $evenSteven to true)]
]]]
}
{
|mhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $m is 5)[(set: $m to 1)]
(set: $text to it + $Emcouragement&#39;s ($m))
(set: $m to it + 1)
]]
}</tw-passagedata><tw-passagedata pid="6" name=" Intermission 2" tags="" position="406,757" size="100,100">(set: $mindscapeTalk to true)(set: $timer to 0)(set: $text to &quot;&quot;)(set: $zPressed to false)(set: $beforeOptionsA to true)(set: $beforeOptionsB to true)(set: $index to 0)(set: $allFalse to true)(set:$agreement to false)(set:$tame to false)(set:$notReal to false)(set:$nextEpisode to false)(set:$onelastTime to false)(set:$similar to false)(set: $episodeThree to false)(set:$Archer to false)(set:$bunnies to false)
(b4r:&quot;inset&quot;,&quot;inset&quot;,&quot;outset&quot;,&quot;outset&quot;)+(b4r-colour:purple,purple,yellow,yellow)[(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]](else:)[(text-colour:#111)[Press z to continue]]]](if: $timer%2 is 0)[
&lt;img src = &quot;https://github.com/Hannabellz/Group-Project/blob/master/OneDrive/Pictures/Imagination%20Project/Mindscape%20Guide%20Happy%202.png?raw=true&quot;&gt;](else:)[
&lt;img src = &quot;https://github.com/Hannabellz/Group-Project/blob/master/OneDrive/Pictures/Imagination%20Project/Mindscape%20Guide%20Happy.png?raw=true&quot;&gt;]
(set:$checkIn to (dm:1,&quot;&#39;WOAH! That was…pretty intense, yeah?&quot;,2,&quot; Man, to be honest I only went through both of those myself ONCE.&quot;,3,&quot; Didn&#39;t dare go back for another round.&quot;,4,&quot; Not without company at least!&quot;,5,&quot; I&#39;m not one with too high of an interest in like,&quot;,6,&quot; ghost stories around a campfire.&quot;,7,&quot; I&#39;m much too jumpy! What did you think?&#39;&quot;,8,&quot;
&#96;[&#96;a&#96;]&#96; Yeah, it was pretty intense
&#96;[&#96;b&#96;]&#96; It was tame compared to what I&#39;m used to&quot;))
(set:$agrInten to (dm:1,&quot;&#39;Ah,&quot;,2,&quot; no worries though, right?&quot;,3,&quot; You&#39;ve made it through and it was just an experience.&quot;,4,&quot; It wasn&#39;t real!&#39;&quot;,5,&quot;
&#96;[&#96;a&#96;]&#96; So it wasn&#39;t real at all?
&#96;[&#96;b&#96;]&#96; Yeah, uh, what&#39;s the next episode looking like?&quot;))
(set:$agrTame to (dm:1,&quot;&#39;Daaaaaaaang. You have more guts than I do!&quot;,2,&quot; Are you a big horror fanatic?&quot;,3,&quot; The creator definitely is not.&quot;,4,&quot; But all the respect to you for powering through.&quot;,5,&quot; I guess after a while some things could get predictable.&quot;,6,&quot; But jumpscares?&quot;,7,&quot; I&#39;m a sucker for them.&#39;&quot;,8,&quot;
&#39;Are you ready for the final round?&#39;
&#96;[&#96;a&#96;]&#96; Is this the last time I&#39;ll see you?
&#96;[&#96;b&#96;]&#96; Yeah, sure thing.&quot;))
(set: $unReal to (dm:1,&quot;&#39;…Well, I guess that isn&#39;t completely fair.&quot;,2,&quot; I just meant it wasn&#39;t real for you just so that it wasn&#39;t on your mind as a fear for the rest of the day!&quot;,3,&quot; But there are some real aspects to it.&quot;,4,&quot; When the creator was young and they were building the Florida Room, for example.&quot;,5,&quot; They were applying the fans, she was going in and out, and one of the times she came in&quot;,6,&quot;…one of the fans came down.&quot;,7,&quot;
&#39;And then there was a birthday party where something was seen by friends when they were playing Haunted House.&quot;,8,&quot; Caused a whole frenzy and encouraged an investigation!&quot;,9,&quot; But nothing quite like what was described here. The power of the mind,&quot;,10,&quot; after all.&#39;&quot;,11,&quot;
&#39;Are you ready for round 3?&#39;
&#96;[&#96;a&#96;]&#96; …Is it anything like the past two?
&#96;[&#96;b&#96;]&#96; YES! Absolutely! Let&#39;s do this thing.&quot;))
(set: $nE to (dm:1,&quot;&#39;RIGHT! So, next up is Star Travels!&quot;,2,&quot; You&#39;ll be somewhat of a star explorer,&quot;,3,&quot; where you can go on adventures with constellations and see what they have to show ya.&quot;,4,&quot; As always, I encourage you to get really into it!&quot;,5,&quot; The creator&#39;s a huge fan of things relating to stars and the mythical stories they can tell.&quot;,6,&quot; She&#39;s inviting you into some of her own!&#39;&quot;,7,&quot;
&#39;Are you ready?&#39;
&#96;[&#96;a&#96;]&#96; Is this the last time I&#39;ll see you?
&#96;[&#96;b&#96;]&#96; YES! Absolutely! Let&#39;s do this thing.&quot;))
(set:$theSame to (dm:1,&quot;&#39;Ahahahaha, besides being an imagined happening, nope!&quot;,2,&quot; But if you mean in a take-your-breath-away from how sudden or frightening it is, then&quot;,3,&quot;…I would also say no.&quot;,4,&quot; This is the current final episode, entitled Star Travels!&quot;,5,&quot; The name says it all.&quot;,6,&quot; Since we&#39;ve reached the final stretch, I&#39;ll wish you the best of luck.&#39;&quot;,7,&quot;
&#96;[&#96;a&#96;]&#96; Is this the last time I&#39;ll see you?
&#96;[&#96;b&#96;]&#96; Thanks! Let&#39;s get rolling.&quot;))
(set:$fareWell to (dm:1,&quot;&#39;Oh…&quot;,2,&quot;well…&quot;,3,&quot;For now.&quot;,4,&quot; I&#39;m glad you said something. Reminded me&quot;,5,&quot;…Thanks for being such a great pilot and going through these experiences!&quot;,6,&quot; Watching from where I&#39;ve been standing has been amazing thus far, and I&#39;m sure you&#39;re going to finish really strong too.&quot;,7,&quot; It&#39;s interesting to see how people engage with it differently.&#39;&quot;,8,&quot;
&#96;[&#96;a&#96;]&#96; Thanks! Let&#39;s get rolling.&quot;))
(set:$EpisodeThreeIntro to (dm:1,&quot;You have a side hobby of travelling through space,&quot;,2,&quot; and a knack for getting in deeper than you originally planned every time.&quot;,3,&quot; But that was the fun of it! It was what kept you thrilled to do it.&quot;,4,&quot; There was no scenario that was even remotely like the last, and the next would surely be a whole new beast of its own.&quot;,5,&quot; You were writing your tales and fate in the stars, interweaving them to be relived through epic depictions.&quot;,6,&quot;
And if nothing else, they served as stunning memories and dreams that you&#39;d gladly relive.&quot;,7,&quot; Even in just small glimpses, it was nice to take bits of the past into your future.&quot;,8,&quot; It was always nice to reminisce.&quot;,9,&quot;
You paged through different sightings of comets passing,&quot;,10,&quot; new stars being born,&quot;,11,&quot; the universe expanding even though you couldn&#39;t possibly imagine it as big as it currently is.&quot;,12,&quot; Was.&quot;,13,&quot; Is now, was then.&quot;,14,&quot; 
It was always so difficult to choose where you&#39;d want to spend your free time because you always ended up with the feeling of wanting more.&quot;,15,&quot; You decided a while ago that it was a good thing, however.&quot;,16,&quot; Better to be left wanting more than to be left with an unsatisfactory taste in your mouth.&quot;,17,&quot;
But you should decide before either of the top two on your list just run right by!&quot;,18,&quot; They weren&#39;t going to wait for you or chase you back.&quot;,19,&quot; That was on you.&quot;,20,&quot;
&#96;[&#96;a&#96;]&#96; Check out the giant archer constellation in his pursuits against the terrible Star Slinger
&#96;[&#96;b&#96;]&#96; Look into the interesting phenomena of bunny constellations that are reported to grow smaller the closer you get to them&quot;))
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $allFalse is true)+(if: $index&lt;=8)[(set: $text to it + $checkIn&#39;s ($index))(if:$index is 8)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $Archer is true)[[[toArcher -&gt; Archer]]]
	(else-if: $bunnies is true)[[[toBunnies-&gt;Bunnies]]]
	(else-if: $episodeThree is true)+(if: $index&lt;=20)[(set: $text to it + $EpisodeThreeIntro&#39;s ($index))(if: $index is 20)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $onelastTime is true)+(if:$index &lt;= 8)[(set: $text to it + $fareWell&#39;s ($index))(if: $index is 8)[(set:$beforeOptionsA to false)(set:$zPressed to true)]]
	(else-if: $nextEpisode is true)+(if:$index&lt;=7)[(set: $text to it + $nE&#39;s ($index))(if: $index is 7)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $similar is true)+(if:$index &lt;=7)[(set:$text to it+ $theSame&#39;s ($index))(if:$index is 7)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set:$zPressed to true)]]
	(else-if: $notReal is true)+(if:$index &lt;=11)[(set: $text to it + $unReal&#39;s ($index))(if: $index is 11)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $tame is true)+(if: $index &lt;=8)[(set: $text to it + $agrTame&#39;s ($index))(if: $index is 8)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $agreement is true)+(if: $index &lt;=5)[(set: $text to it + $agrInten&#39;s ($index))(if: $index is 5)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
] ] ]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $agreement to true) (set:$allFalse to false)]
	(else-if:$episodeThree is true)[(set:$Archer to true)]
	(else-if: $onelastTime is true)[(set: $mindscapeTalk to false)(set:$episodeThree to true)]
	(else-if: $similar is true)[(set:$onelastTime to true)]
	(else-if: $nextEpisode is true)[(set: $onelastTime to true)]
	(else-if: $notReal is true)[(set: $similar to true)]
	(else-if: $tame is true)[(set: $onelastTime to true)]
	(else-if: $agreement is true)[(set: $notReal to true)]
]]
]
}
{
|bhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsB is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $tame to true) (set:$allFalse to false)]
	(else-if:$episodeThree is true)[(set:$bunnies to true)]
	(else-if:$similar is true)[(set: $mindscapeTalk to false)(set:$episodeThree to true)]
	(else-if:$nextEpisode is true)[(set: $mindscapeTalk to false)(set:$episodeThree to true)]
	(else-if: $notReal is true)[(set: $mindscapeTalk to false)(set:$episodeThree to true)]
	(else-if: $agreement is true)[(set: $nextEpisode to true)]
	(else-if: $tame is true)[(set: $mindscapeTalk to false)(set: $episodeThree to true)]
]]]
}</tw-passagedata><tw-passagedata pid="7" name=" Archer" tags="" position="266,902" size="100,100">(set: $timer to 0)(set: $text to &quot;&quot;)(set: $zPressed to false)(set: $beforeOptionsA to true)(set: $beforeOptionsB to true)(set: $index to 0)(set: $allFalse to true)(set: $shootingStar to false)(set:$assertNo to false)(set:$examine to false)(set:$fascination to false)(set:$fascinationCont to false)(set:$call to false)(set:$continueWay to false)(set:$Apologize to false)(set:$ApoloDraw to false)(set:$Advice to false)(set:$Dreadna to false)
(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]]]
(set: $Gateway to (dm:1,&quot;There had been reports of a notorious catapulter that took stars from their rightful place and sent them far, far away.&quot;,2,&quot; In technical terms, there was nothing wrong considering they didn&#39;t send the stars toward anything else.&quot;,3,&quot; They weren&#39;t endangering anyone.&quot;,4,&quot; But it still didn&#39;t sit right in your chest.&quot;,5,&quot; They could be causing disruptions to constellations.&quot;,6,&quot; And if they did it too much, well…you didn&#39;t see how there could be good that came out of it.&quot;,7,&quot; But you could definitely see the risks.&quot;,8,&quot;
What if they had just gotten lucky with not hurtling a star towards a planet thus far?&quot;,9,&quot; What if breaking apart a constellation unnaturally disrupted the continuum?&quot;,10,&quot; No one had ever done it before,&quot;,11,&quot; but it wasn&#39;t something you were looking forward to ever seeing, either.&quot;,12,&quot; The tales the constellations told, the interactions they had—&quot;,13,&quot;what would come of those?&quot;,14,&quot;
It wasn&#39;t a surprise to hear that someone else was bothered.&quot;,15,&quot; And the fact it was a giant archer constellation told you all you needed to know.&quot;,16,&quot; If he was worried, you were justified in your worries too.&quot;,17,&quot; Stars and constellations minded their own business, much the time.&quot;,18,&quot; They were like actors and actresses taking to a stage every night,&quot;,19,&quot; illustrating what they&#39;ve gone through and seen with others nearby. Would they like what was going on?&quot;,20,&quot; Were they worried?&quot;,21,&quot;
You had heard a peculiar sighting of an arrow soaring in the sky faster than a comet,&quot;,22,&quot; a few lightyears away. Packing lightly,&quot;,23,&quot; you were swift to take flight from your base.
&#96;[&#96;a&#96;]&#96; You looked like a shooting star with a vibrant and bright tail trailing behind you.&quot;))
(set: $withTail to (dm:1,&quot;Igniting yourself in your favorite color of flames, you propelled yourself deeper into space.&quot;,2,&quot; Any planets close enough may enjoy a tiny spectacle,&quot;,3,&quot; and you had to stop yourself from smiling at the thought of people making wishes upon you.&quot;,4,&quot; They may not know it, but you&#39;d happily grant them if you could.&quot;,5,&quot; If you wished upon yourself for the best for their wishes, would it work?&quot;,6,&quot;
This wasn&#39;t the first time you had wondered this.&quot;,7,&quot; How many wishes did you carry with you?&quot;,8,&quot; What kind of wishes were they? And were any of them hoping for your return for another glimpse at something magical?&quot;,9,&quot;
You sighed whimsically, extending your arms out and twirling like a top through the never-ending horizon that surrounded you.&quot;,10,&quot; Directions were much more lax, out here.&quot;,11,&quot; Up was down and down was sideways—it was all relative, anyhow.&quot;,12,&quot; It allowed for better days to simply get lost in star and planet gazing.&quot;,13,&quot; You tended to associate names of colors with planets with how many you&#39;ve come across.&quot;,14,&quot; Somehow they managed to expand your knowledge even when you thought you must&#39;ve seen it all by now.&quot;,15,&quot;
Lost in your train of thought, you nearly missed the sparkling arch that passed over your head.&quot;,16,&quot; If not for the trail being tiny, shimmering pieces itself,&quot;,17,&quot; you would&#39;ve chalked it up to another traveler. But you ducked towards the direction from which it came, hoping that it had instead been an arrow.&quot;,18,&quot;
Sure enough, after traveling a bit longer, you were met with a bow that had to be at least ten times your size.&quot;,19,&quot; You&#39;d be willing to bet on larger, but the constellation behind the bow was much more formidable.&quot;,20,&quot; You knew how massive constellations could be, but seeing one like this, face-to-face…&quot;,21,&quot;
(text-colour:#ef5716)[Tilting his head, the giant looked you over. He may as well have been opening a book of your autobiography and reading all there was to see about you.]&quot;,22,&quot;(text-colour:#ef5716)[ His twinkling eyes were analytical and deeper than the abyssal trenches on the other side of the galaxy. &#39;My arrow didn&#39;t strike you, did it?&#39;]&quot;,23,&quot;
&#96;[&#96;a&#96;]&#96; Assert that no, that wasn&#39;t the case
&#96;[&#96;b&#96;]&#96; Ask if that was why he was examining you&quot;))
(set: $noCase to (dm:1,&quot;&#39;Oh, no!&quot;,2,&quot; Not at all. I had been looking for you, though.&quot;,3,&quot; And your arrow helped in leading me to you!&quot;,4,&quot;
(text-colour:#ef5716)[His eyes dimmed as he arched an eyebrow, appearing to be bored by that revelation.]&quot;,5,&quot;(text-colour:#ef5716)[ His silence implored you for more explanation to fill the empty space.]&quot;,6,&quot;
&#39;…Ahah—well. I had heard about your search for the one slinging stars to the outer bounds.&quot;,7,&quot; Displacing them. And while there isn&#39;t anything morally or lawfully wrong about it,&quot;,8,&quot; it still feels off to me. And I was thinking maybe I could lend a hand?&#39;&quot;,9,&quot;
(text-colour:#ef5716)[He stayed as he was, apparently still looking for more.]&quot;,10,&quot;(text-colour:#ef5716)[ Perhaps he was difficult to sell on an idea?]&quot;,11,&quot;(text-colour:#ef5716)[ Or he wasn&#39;t too big on group efforts.]&quot;,12,&quot;
&#96;[&#96;a&#96;]&#96; Go into detail about your joy of exploration and fascination with the stars&quot;))
(set: $examineCase to (dm:1,&quot;&#39;Oh, is that what you were worried about? Why you looked so serious?&#39;&quot;,2,&quot;
(text-colour:#ef5716)[A small frown found its way to his face. &#39;That didn&#39;t answer my question.]&quot;,3,&quot;(text-colour:#ef5716)[ But…yes. It would do me no good if in my endeavors of stopping from harm to be done, I caused reckless harm.&#39;]&quot;,4,&quot;
&#39;Well then, you have no need to worry.&quot;,5,&quot; I&#39;m fine! It didn&#39;t even come close to hitting me.&quot;,6,&quot; But it did catch my eye.&#39;&quot;,7,&quot;
(text-colour:#ef5716)[His eyes dimmed as he arched an eyebrow, appearing to be bored by that revelation.]&quot;,8,&quot;(text-colour:#ef5716)[ His silence implored you for more explanation to fill the empty space.]&quot;,9,&quot;
&#39;…Ahah—well. I had heard about your search for the one slinging stars to the outer bounds.&quot;,10,&quot; Displacing them. And while there isn&#39;t anything morally or lawfully wrong about it,&quot;,11,&quot; it still feels off to me. And I was thinking maybe I could lend a hand?&#39;&quot;,12,&quot;
(text-colour:#ef5716)[He stayed as he was, apparently still looking for more.]&quot;,13,&quot;(text-colour:#ef5716)[ Perhaps he was difficult to sell on an idea?]&quot;,14,&quot;(text-colour:#ef5716)[ Or he wasn&#39;t too big on group efforts.]&quot;,15,&quot;
&#96;[&#96;a&#96;]&#96; Go into detail about your joy of exploration and fascination with the stars&quot;))
(set: $fascinate to (dm:1,&quot;&#39;…I&#39;m an adventurer. I usually go out alone—&#39;&quot;,2,&quot;
(text-colour: #ef5716)[&#39;Then you know all about how more efficient it is. Less risky—&#39;]&quot;,3,&quot;
&#39;Now I wouldn&#39;t say that!&quot;,4,&quot; It&#39;s nice to have someone to watch your back.&quot;,5,&quot; But if you&#39;d let me continue…&#39; You straightened your spine and continued to look into a stoic gaze.&quot;,6,&quot; Before he could argue, you went right on ahead. &#39;I usually do go on adventures alone.&quot;,7,&quot; But this is a problem bigger than me,&quot;,8,&quot; and it&#39;s even bigger than you.&quot;,9,&quot; And this isn&#39;t just some adventure, I recognize that.&quot;,10,&quot; But my heart would be in it in all fronts.&quot;,11,&quot; To pursue someone that&#39;s disrupting constellations, and for what?&quot;,12,&quot; I am a firm believer of each star being important in its place.&quot;,13,&quot; Like I wouldn&#39;t want to disrupt any of the stars that embody you.&quot;,14,&quot; I wouldn&#39;t know the larger impact, and I still don&#39;t.&quot;,15,&quot; I&#39;m not sure if the one behind it has considered it, either.&#39;&quot;,16,&quot;
(text-colour: #ef5716)[By the time you&#39;re done and taking a breath, the archer has gone back to being silent.]&quot;,17,&quot;(text-colour:#ef5716)[ Here you were, thinking you had rambled too much, and he&#39;s acting like he expected something more convincing.]&quot;,18,&quot;
&#39;Listen.&quot;,19,&quot; I&#39;m not going to force you to keep me along.&quot;,20,&quot; The fact of the matter is I&#39;m going, whether it&#39;s with you&quot;,21,&quot; or on my own.&quot;,22,&quot; But it would be more efficient to go together.&quot;,23,&quot; Again, I can watch your back and make sure we can get to the bottom of this.&quot;,24,&quot; I&#39;m not turning around and heading back home until I get to the bottom of this.&#39;&quot;,25,&quot;
(text-colour:#ef5716)[The archer lifted his bow and slung it over his back, turning on his heel and speeding away.]&quot;,26,&quot;(text-colour:#ef5716)[ He left trails of sparkles similarly to his arrows.]&quot;,27,&quot; 
Naturally, like bread crumbs, you followed them.&quot;,28,&quot; If he needed his distance and wasn&#39;t the talking sort, you would respect that.&quot;,29,&quot; And hey, this may very well be the best way to go about watching his back.&quot;,30,&quot; It was a little more literal than you would have chosen to mean it,&quot;,31,&quot; but it worked.&quot;,32,&quot; You managed to catch up enough to him to keep the back of his stars in sight.&quot;,33,&quot; 
You grew to be curious after a while, though.&quot;,34,&quot; Was this meant to be a test of patience?&quot;,35,&quot; To see if you would go the distance, and in fact not turn around?
To see if you weren&#39;t just in over your head and distracted by something shiny?&quot;,36,&quot; To see if you weren&#39;t just in over your head and distracted by something shiny?&quot;))
(set: $fascinateCont to (dm:1,&quot;It was tempting at times to get sidetracked.&quot;,2,&quot; You would see a misty planet that pulsed like your heart,&quot;,3,&quot; or another with tens of moons in orbit at greater speeds than you had measured before.&quot;,4,&quot; The pen in your pocket was itching to take notes, and you could even feel your hand start to reach for it.&quot;,5,&quot; But in doing so, you risked losing the archer.&quot;,6,&quot; You didn&#39;t have anything to prove to him.&quot;,7,&quot; That being said, it was reassuring to not be alone, to have someone who knew more of what they were doing,&quot;,8,&quot; and to have someone that likely had better tracking skills then you did.&quot;,9,&quot;
You were surprised when all of a sudden, the giant was starting to get bigger again.&quot;,10,&quot; He had paused, and it wasn&#39;t until you were next to him that you saw why.&quot;,11,&quot;
An asteroid belt crossed like heavy traffic in front of you.&quot;,12,&quot; There were a few times where you started to drift too close and the archer tapped your shoulder to push you back again.&quot;,13,&quot;
&#39;Oh, I remember this place.&quot;,14,&quot; It&#39;s the crossroads between the Ti Galaxy and this one.&#39;&quot;,15,&quot;
(text-colour:#ef5716)[&#39;…Is the Ti Galaxy home to the planet Dreadna?&#39;]&quot;,16,&quot;
&#39;No, but it&#39;s the quickest way to get there from here.&quot;,17,&quot; If we were to try to avoid the belt here and go down, we would be met with the Fox constellation.&quot;,18,&quot; Which typically wouldn&#39;t be a problem, but he likes to play his games before letting people go through.&quot;,19,&quot; He likes to think the galaxies revolve around him.&#39;&quot;,20,&quot;
(text-colour:#ef5716)[The archer&#39;s eyes glinted in what you would&#39;ve sworn was amusement, even if for just a second.]&quot;,21,&quot;(text-colour:#ef5716)[ &#39;Alright. How do we pass through here without my matter being scrambled?&#39;]&quot;,22,&quot;
Just as you were to give an answer, his hand was clamped around you and yanking you back further.&quot;,23,&quot; Luckily, you were still turned facing the way to see a giant ball of fire shooting up and away.&quot;,24,&quot; It was a marvel and a saving grace that the archer had reflexes,&quot;,25,&quot; otherwise you would&#39;ve been on the face of that star going who knows where.&quot;,26,&quot; In the very least, it broke up the belt enough so that he could hurriedly halt the rest and make room to get through.&quot;,27,&quot; And you were back to swiftly following after him.&quot;,28,&quot;
You grew to realize that you were far enough away that if you were to direct yourself downwards, the Fox shouldn&#39;t approach you.&quot;,29,&quot; But what were the chances the archer could hear your directions?
&#96;[&#96;a&#96;]&#96; Try calling for him anyway
&#96;[&#96;b&#96;]&#96; Continue going through this way&quot;))
(set: $callArcher to (dm:1,&quot;&#39;HEY! WE CAN START GOING DOWN HERE!&#39;&quot;,2,&quot; You encouraged a sonic boom burst to carry your voice a little further.&quot;,3,&quot; You were afraid it was all for not…until he plunged directly below him.&quot;,4,&quot;
Relief passed through you as you zipped after him, watching in disbelief as it appeared that he was freely falling due to a heavy gravity you knew not to be there.&quot;,5,&quot; Was this some magic trick? You had to try even more than before to keep up with him.&quot;,6,&quot; Once again, he came to a halt.&quot;,7,&quot; This time, you were afraid it had been due to some miscalculation on your part. A flitting feeling passed through you about how he would definitely leave you in stardust if you made him wait through the Fox&#39;s vexing riddles and games.&quot;,8,&quot;
But it was a constellation that you hadn&#39;t encountered yet that the archer had stricken a conversation up with.&quot;,9,&quot; You couldn&#39;t help but take out your pen and notepad now,&quot;,10,&quot; starting to outline the stunning amalgamation of stars before you.&quot;,11,&quot;
(text-colour:#f04675)[&#39;…I had no idea that someone was going around robbing stars. My friends tried insisting that I lost it, too.]&quot;,12,&quot;(text-colour:#f04675)[ That I had somehow lost my brightest star? As if!]&quot;,13,&quot;(text-colour:#f04675)[ How would I even lose a star? Especially without noticing that it was dimming…]&quot;,14,&quot;(text-colour:#f04675)[I can&#39;t believe I had started to believe them.&#39; She placed both hands behind her head, shimmering tears starting to trace paths down her face.]&quot;,15,&quot; 
She must have been a maker of some kind.&quot;,16,&quot; The stars that lined her hands shone brighter in some places than in others,&quot;,17,&quot; and some even appeared a bit cracked.&quot;,18,&quot;
(text-colour:#ef5716)[&#39;Do you know where you were or when it was that you had it last?&#39;]&quot;,19,&quot;
(text-colour:#f04675)[&#39;I know I had been watching the Dancers make their mark through the sky near Relai.]&quot;,20,&quot;(text-colour:#f04675)[ They&#39;re a traveling group and it&#39;s an opportunity you don&#39;t want to miss if you have it.&#39;]&quot;,21,&quot;
A few silent moments passed when you realized the archer may not know where Relai was.&quot;,22,&quot; &#39;It&#39;s near Dreadna.&#39; You offered quietly, making two sets of eyes look to you with sudden surprise as if neither had been expecting to see you there.&quot;,23,&quot;
(text-colour:#f04675)[&#39;Indeed…But I had been watching so intently.]&quot;,24,&quot;(text-colour:#f04675)[ I felt that something was off, but I couldn&#39;t tell what. Not until I saw my right palm.&#39;]&quot;,25,&quot;(text-colour:#f04675)[ She lifted it up for you to see.]&quot;,26,&quot;(text-colour:#f04675)[ And then her left. There was a star brighter than the rest in the center of that one, whereas her right had been blank in that spot.]&quot;,27,&quot;
You couldn&#39;t stop your jaw from dropping.&quot;,28,&quot; &#39;You&#39;re a planet creator! You—You…I&#39;ve never met one of you, before.&#39;&quot;,29,&quot;
(text-colour:#f04675)[Your recognition seemed to bring some amount of joy to her features.]&quot;,30,&quot;(text-colour:#f04675)[ &#39;You know what I do? Funny, I thought we&#39;d been long forgotten.]&quot;,31,&quot;(text-colour:#f04675)[ But yes…I would so love to know why someone thought it was necessary to steal right out from under my nose.&#39;]&quot;,32,&quot;
(text-colour: #ef5716)[&#39;So would I.&#39; The archer agreed]&quot;,33,&quot;(text-colour:#ef5716)[, looking downwards. If his glare could, you were sure there would be a blazing trail seeking out the one responsible.]&quot; ,34,&quot;
&#39;That&#39;s what we&#39;re doing, actually.&quot;,35,&quot; What we should uh…return to, as well.&#39; It was a small nudge,&quot;,36,&quot; but a necessary one. It made the giant&#39;s attention snap back as he nodded.&quot;,37,&quot;
(text-colour:#f04675)[&#39;Well, I won&#39;t keep you from finding the answers, then.]&quot;,38,&quot;(text-colour:#f04675)[ If there&#39;s any possibility I could get it back, it would be useful for my craft.]&quot;,39,&quot;(text-colour:#f04675)[ It helps me add more…uniquity.&#39; The stars of her right eye winked. &#39;Best of luck.&#39;]&quot;,40,&quot;
Your &#39;Thank you&#39; was cut short by being pulled down with the archer.&quot;,41,&quot; You knew he had been going fast before but MAN was it different actually going this speed.&quot;,42,&quot; Though it was also reassuring…&quot;,43,&quot;he had been holding back before. He hadn&#39;t wanted to just lose you and deal with it on his own.&quot;,44,&quot;
&#96;[&#96;a&#96;]&#96; Offer some advice for closing in on the Star Slinger
&#96;[&#96;b&#96;]&#96; Ask him about how he knew about the planet Dreadna but not much for anything else&quot;))
(set: $contWay to (dm:1,&quot;Although it would save a little bit more time, ultimately,&quot;,2,&quot; if you were to go down anywhere between here and lightyears from now, you could effectively get to the same place.&quot;,3,&quot; Not to mention,&quot;,4,&quot; if you were wrong and the Fox was actually in a different place that you recalled, it would add significantly more time.&quot;,5,&quot; So you kept quiet and let some more sights pass by.&quot;,6,&quot; Things had changed—even from what you could see from your home.&quot;,7,&quot; You wondered when you would be able to see things as they actually were, but knew that there was always going to be some delay.&quot;,8,&quot; It wasn&#39;t something you complained about, though.&quot;,9,&quot;
(text-colour: #ef5716)[Finally, the archer came to a halt and looked to you.]&quot;,10,&quot;(text-colour: #ef5716)[ &#39;Is this place sufficient to start heading down?&#39;]&quot;,11,&quot;
You nodded. Without any hesitation or signs of reluctance, he started to go straight down.&quot;,12,&quot; You had to pick up more speed to keep him in sight going down.&quot;,13, &quot;Which was odd—&quot;,14,&quot;but maybe he was starting to feel a time crunch.&quot;,15,&quot; It was reasonable, seeing as there was no way of telling how quickly his opponent was moving.&quot;,16,&quot;
You started to hum to yourself to keep occupied.&quot;,17,&quot; Something you had learned from a loved one was just how instrumental music could be to influence your pace.&quot;,18,&quot; This was a chase scene, and so it called for some epic music.&quot;,19,&quot; It never failed, and it wasn&#39;t going to start now. Foolproof!&quot;,20,&quot;
The stars around you were so inspired by your mini-concert that they started to whir.&quot;,21,&quot; Star dust encircled you before forming a makeup of a guitar.&quot;,22,&quot; The strings were plucking to what you were humming, so you didn&#39;t even have to worry about knowing your choice of tune by heart.&quot;,23,&quot;
Just as you were about to hit the peak and stick the landing,&quot;,24,&quot; you fell none-too-gracefully right onto the archer&#39;s hand&quot;,25,&quot; and the ear-wrenching sound of feedback reverberated throughout the area.&quot;,26,&quot; You flinched back as the guitar fell flat into sparkly dust in your hands.&quot;,27,&quot; You were half-expecting to get a stern talking to from your teammate when you noticed he wasn&#39;t even looking at you to begin with.&quot;,28,&quot; He was looking at something past you.&quot;,29,&quot;
You turned your head fast enough to give you whiplash,&quot;,30,&quot; and you were curious if you were just seeing the stars ahead for that reason or because that was what was coming.&quot;,31,&quot; Full steam ahead.&quot;,32,&quot; A gigantic dragon with a wingspan longer than the archer was tall.&quot;,33,&quot;
(text-colour:#2cda8b)[&#39;I was not aware that there would be such rambunctious travelers, this way.&#39;]&quot;,34,&quot;(text-colour:#2cda8b)[ The dragon&#39;s very tone was wise, and the quality of their voice put your music to shame.]&quot;,35,&quot;(text-colour:#2cda8b)[ It was so…tranquil. &#39;I thought it would be a quiet spot for some rest.&#39;]&quot;,36,&quot;
&#96;[&#96;a&#96;]&#96; Apologize
&#96;[&#96;b&#96;]&#96; Apologize AND draw this dragon out—the variance of stars on them was amazing.&quot;))
(set: $drawApolo to (dm:1,&quot;You instinctively reached for your pen and notepad,&quot;,2,&quot; wanting to seize the opportunity ahead of you.&quot;,3,&quot; You had heard of the great dragon constellations, but never thought yourself lucky enough to see one.&quot;,4,&quot; They held great power and might,&quot;,5,&quot; but were humble enough to never abuse it.&quot;,6,&quot; It made them very respected.&quot;,7,&quot; And this one was such a marvel to see. If you waited until later, there was no telling how true-to-life it would be. And you wanted to do the one you met justice.&quot;,8,&quot; And you wanted to do the one you met justice.&quot;))
(set: $Apolo to (dm:1,&quot;&#39;I&#39;m sorry about that. I needed some encouragement to keep up with him.&#39;&quot;,2,&quot; You gestured over your shoulder to the archer.&quot;,3,&quot; &#39;We&#39;re in the pursuit of a starry disruptor. Trying to reach where we believe they are before they are able to go anywhere else.&#39;&quot;,4,&quot;
(text-colour: #2cda8b)[The dragon folded their wings to the side, a bright puff of smoke flaring from their nostrils. &#39;A starry disruptor, you say?&#39;]&quot;,5,&quot;
(text-colour:#ef5716)[&#39;Yes. There is someone going around and catapulting stars away from their rightful place.]&quot;,6,&quot;(text-colour:#ef5716)[ What they&#39;re aiming for is hard to say for sure,]&quot;,7,&quot;(text-colour:#ef5716)[ but they should be counting their lucky stars that no one has been harmed yet.&#39;]&quot;,8,&quot;
(text-colour:#2cda8b)[&#39;Hmm…&#39; With a flick of their tail, the dragon leaned their head back and breathed fire upwards.]&quot;,9,&quot;(text-colour:#2cda8b)[ It was contained, the flames encircling back and inwards on themselves.]&quot;,10,&quot;(text-colour:#2cda8b)[ The longer it went on, the brighter and hotter the flames grew. There was a final point where what looked to be a very small star had formed right before your very eyes.]&quot;,11,&quot;(text-colour:#2cda8b)[ The dragon nudged it a little bit to the left, stretching out their spine in the process.]&quot;,12,&quot;(text-colour:#2cda8b)[ &#39;This is not the first I have heard of this snatcher of stars. The other times I&#39;ve heard of it, though, it seemed all over the place.&#39;]&quot;,13,&quot;
&#39;What do you mean?&#39;&quot;,14,&quot;
(text-colour:#2cda8b)[&#39;No one&#39;s been able to tell the exact moment they&#39;ve had a star taken.]&quot;,15,&quot;(text-colour:#2cda8b)[ It&#39;s like no one was there, which is why many tend to come to the resolve that they have lost it rather than having it taken from them.]&quot;,16,&quot;(text-colour:#2cda8b)[ They follow the less probable logic because they didn&#39;t see anything to believe otherwise.&#39;]&quot;,17,&quot;
(text-colour:#ef5716)[&#39;And you don&#39;t think that&#39;s wise to do?&#39;]&quot;,18,&quot;
(text-colour:#2cda8b)[&#39;Not at all. They are doing themselves a disservice.]&quot;,19,&quot;(text-colour:#2cda8b)[ I, for one, would like to know where the tip of my tail went. It was starting to dim…but I would&#39;ve liked to see it go.&#39;]&quot;,20,&quot;
You hadn&#39;t noticed it before, but automatically upon the mentioning, you looked to observe the dragon&#39;s tail.&quot;,21,&quot; It didn&#39;t stop at a point like its talons or the tips of its wings did.&quot;,22,&quot; This caused you to frown. &#39;I&#39;m sorry that it&#39;s gone without a trace.&#39;&quot;,23,&quot;
(text-colour:#2cda8b)[&#39;Me too.&#39;]&quot;,24,

&quot;(text-colour:#ef5716)[&#39;It won&#39;t be without a trace forever.&#39;]&quot;,25,&quot;(text-colour:#ef5716)[ There was a new certainty refreshed in the archer&#39;s voice, like he had finally hit his breaking point.]&quot;,26,&quot;(text-colour:#ef5716)[ &#39;We are going to find the perpetrator and ensure justice for everyone involved. You included.&#39;]&quot;,27,&quot;
(text-colour:#2cda8b)[Both of the dragon&#39;s eyebrows raised. It was hard to tell if it was from surprise or disbelief.]&quot;,28,&quot;(text-colour:#2cda8b)[ &#39;If that is the case…then all the power to you. I hope that you excel in your efforts.]&quot;,29,&quot;(text-colour:#2cda8b)[ However, I would be focused on if there were more major concerns for others involved.]&quot;,30,&quot;(text-colour:#2cda8b)[ Certainly, my missing star is less than ideal, but I have the grand gift of being capable of creating a new one when I so choose.&#39;]&quot;,31,&quot;
&#39;Why haven&#39;t you?&#39; You interjected before you could help yourself.&quot;,32,&quot; You were…curious.&quot;,33,&quot;
(text-colour:#2cda8b)[&#39;Why haven&#39;t I?&#39; The dragon mused.]&quot;,34,&quot;(text-colour:#2cda8b)[ &#39;I wish to allow myself some time. Time to dwell, time to plan, time to create.]&quot;,35,&quot;(text-colour:#2cda8b)[ I want to remember the past before pressing on and into the future.]&quot;,36,&quot;(text-colour:#2cda8b)[ Even then, I shall reminisce in what I had while registering what I have.&#39;]&quot;,37,&quot;
You were about to ask something else as you felt a starry hand encompass you.&quot;,38,&quot;
(text-colour:#ef5716)[&#39;Thank you. We really should be going now.&#39;]&quot;,39,&quot;
You were left to shout a similar thank you as the archer started to accelerate downward once again.&quot;,40,&quot;
&#96;[&#96;a&#96;]&#96; Offer some advice for closing in on the Star Slinger
&#96;[&#96;b&#96;]&#96; Ask him about how he knew about the planet Dreadna but not much for anything else&quot;))
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $allFalse is true)+(if: $index&lt;=23)[(set: $text to it + $Gateway&#39;s ($index))(if:$index is 23)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $Dreadna is true)[[[dreadna inquiry-&gt;Dreadna Inquiry]]]
	(else-if: $Advice is true)[[[offer advice-&gt;Offer Advice]]]
	(else-if: $Apologize is true)+(if:$index&lt;=40)[(set: $text to it + $Apolo&#39;s ($index))(if: $index is 40)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $ApoloDraw is true)+(if:$index&lt;=8)[(set:$text to it + $drawApolo&#39;s ($index))(if:$index is 8)[(set:$text to &quot;&quot;)(set:$index to 0)(set:$Apologize to true)]]
	(else-if: $continueWay is true)+(if: $index&lt;=36)[(set: $text to it + $contWay&#39;s ($index))(if: $index is 36)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $call is true)+(if:$index &lt;= 44)[(set: $text to it + $callArcher&#39;s ($index))(if: $index is 44)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set:$zPressed to true)]]
	(else-if: $fascinationCont is true)+(if:$index&lt;=29)[(set: $text to it + $fascinateCont&#39;s ($index))(if: $index is 29)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $fascination is true)+(if:$index &lt;=36)[(set:$text to it+ $fascinate&#39;s ($index))(if:$index is 36)[(set:$index to 0)(set:$text to &quot;&quot;)(set:$fascinationCont to true)]]
	(else-if: $examine is true)+(if:$index &lt;=15)[(set: $text to it + $examineCase&#39;s ($index))(if: $index is 15)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $assertNo is true)+(if: $index &lt;=12)[(set: $text to it + $noCase&#39;s ($index))(if: $index is 12)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $shootingStar is true)+(if: $index &lt;=23)[(set: $text to it + $withTail&#39;s ($index))(if: $index is 23)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
] ] ]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $shootingStar to true) (set:$allFalse to false)]
	(else-if: $Apologize is true)[(set:$Advice to true)]
	(else-if: $continueWay is true)[(set:$Apologize to true)]
	(else-if: $call is true)[(set:$Advice to true)]
	(else-if: $fascinationCont is true)[(set: $call to true)]
	(else-if: $examine is true)[(set: $fascination to true)]
	(else-if: $assertNo is true)[(set: $fascination to true)]
	(else-if: $shootingStar is true)[(set: $assertNo to true)]
]]
]
}
{
|bhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsB is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $examine to true) (set:$allFalse to false)]
	(else-if:$Apologize is true)[(set:$Dreadna to true)]
	(else-if:$continueWay is true)[(set:$ApoloDraw to true)]
	(else-if: $call is true)[(set:$Dreadna to true)]
	(else-if: $fascinationCont is true)[(set: $continueWay to true)]
	(else-if: $shootingStar is true)[(set: $examine to true)]
]]]
}
</tw-passagedata><tw-passagedata pid="8" name="Bunnies" tags="" position="587,905" size="100,100">(set: $timer to 0)(set: $text to &quot;&quot;)(set: $zPressed to false)(set: $beforeOptionsA to true)(set: $beforeOptionsB to true)(set: $index to 0)(set: $allFalse to true)(set: $flyLike to false)(set:$further to false)(set:$leapFrog to false)(set:$convene to false)(set:$shift to false)(set:$bunny to false)(set:$bear to false)
(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]]]
(set: $Gateway to (dm:1,&quot;It had to be no less than a conspiracy,&quot;,2,&quot; but it had popped into the realm of news more than once in the past few weeks.&quot;,3,&quot; How could it be possible for something so grand to get smaller once you got close enough to it?&quot;,4,&quot; And no less, there were reports of more than one.&quot;,5,&quot; As in…&quot;,6,&quot;a WHOLE BUNCH of bunny constellations that could seemingly do the impossible.&quot;,7,&quot; It was something that you wanted to see for yourself!&quot;,8,&quot; If nothing else, it would be an adorable time.&quot;,9,&quot; You had seen a number of animal constellations before,&quot;,10,&quot; and they were always such great stress relievers.&quot;,11,&quot;
The last time they had been spotted was just outside the Querical Galaxy,&quot;,12,&quot; which was a neighboring one of yours.&quot;,13,&quot; It shouldn&#39;t take too long to get there,&quot;,14,&quot; and hopefully you could deduce where to head after if they had just been passing by.&quot;,15,&quot; You packed away your main notebook that you drew and wrote about constellations in, as well as a few extra pens.&quot;,16,&quot; You would not get caught empty-handed,&quot;,17,&quot; nor would a dysfunctional writing utensil be your downfall!&quot;,18,&quot;
Once you had everything in your bag, you slung it over your shoulder and stepped out.&quot;,19,&quot; Immediately, you thrust yourself into the air.
&#96;[&#96;a&#96;]&#96; Fly like a superhero, with your arms and legs horizontal to your body. And your bag could even shift into a dazzling cape for good measure.&quot;))
(set: $Superhero to (dm:1,&quot;You extended your hands out in front of you and kept your palms flat and facing down.&quot;,2,&quot; Your legs and feet were an absolute unit behind you as you soared into and out of the orbit of your home, free in the beautiful serenity of space.&quot;,3,&quot; Your bag fluttered like a cape behind you whenever you made a grand exit like this,&quot;,4,&quot; and it left a twinkling trail behind you. You were told by friends that this would temporarily connect the dots of constellations for other people to see, which was apparently very cool.&quot;,5,&quot; You didn&#39;t doubt it, but it was still something nice to hear.&quot;,6,&quot;
People would see the connections between two distant figures and could connect with an image.&quot;,7,&quot; They could be moved by it, whether passively or actively.&quot;,8,&quot; You wondered how many phone calls or well-wishes came out of having this cape, and how many may be occurring this very second.&quot;,9,&quot; 
As you reached the outer ridge of your galaxy, you spotted the irregular form of Querical across the Blank Bridge.&quot;,10,&quot; It was composed of asteroid fragments that kept a steady pull between your galaxy and the other and moved only when everything else did.&quot;,11,&quot; It had gotten predictable over the years.&quot;,12,&quot;
Flying over the area, you noticed that some pieces were lower than others.&quot;,13,&quot; As if someone had skipped and landed on every few tracks, just to launch themselves off to another to see how far they could get.&quot;,14,&quot; When you looked back up in front of you, although presently weightless, you could&#39;ve sworn gravity was reaching out to grab you and ground you.&quot;,15,&quot; There were bunnies in the distance, alright, and they appeared to be a decent portion of the size of the galaxy you were about to venture into.&quot;,16,&quot;
&#96;[&#96;a&#96;]&#96; Go further ahead to see if these are the famous constellations&quot;))
(set:$FurtherAhead to (dm:1,&quot;Without a moment to lose, you continued on.&quot;,2,&quot; Every so often you would fill in a few more of the prominent stars of the rabbit ahead of you in your drawing.&quot;,3,&quot; Although you could hardly believe it,&quot;,4,&quot; the closer you got,&quot;,5,&quot; the smaller the creatures got.&quot;,6,&quot; The stars that composed them compacted together.&quot;,7,&quot; If you didn&#39;t know any better, you&#39;d say these were completely different constellations than the ones you were looking at before.&quot;,8,&quot; But if you lined up the colors of the stars and their placements…they were an exact match.&quot;,9,&quot;
You stopped only a few feet away, at which point they stood half as tall as you.&quot;,10,&quot; Their long ears were enough to make you feel all warm inside.&quot;,11,&quot; Some of them were floppy while others stood alert.&quot;,12,&quot; Some noses were twitching while others were playing leap frog across the way.&quot;,13,&quot;
&#96;[&#96;a&#96;]&#96; Go and play leap frog with bunnies!
&#96;[&#96;b&#96;]&#96; Introduce yourself to the floppy-eared celestials that looked to be convening&quot;))
(set:$Conve to (dm:1,&quot;You head towards the older group of constellations, careful in your approach.&quot;,2,&quot; You didn&#39;t want to frighten them away without getting the opportunity to speak with them.&quot;,3,&quot; By time you got there, they had made room in their circle for you and were remarkably tiny.&quot;,4,&quot; However, it sounded as though that did nothing to influence the volume of their voices.&quot;,5,&quot;
(text-colour:#723e12)[&#39;Hello there, traveler.&#39;]&quot;, 6,&quot;(text-colour:#723e12)[One with eyes brighter than even the young ones greeted you. &#39;What can we do for you?&#39;]&quot;,7,&quot;
&#39;H-Hi! I&#39;m just, as you said, a traveler.&quot;,8,&quot; An adventurer, even!&quot;,9,&quot; I like going out to see what all expanding corners of the universe have to offer.&quot;,10,&quot; I heard about constellations that shrunk the closer you got to them and well—&#39;&quot;,11,&quot;
(text-colour:#723e12)[&#39;You had to see us for yourself?&#39;]&quot;,12,&quot;
You nodded.&quot;,13,&quot; &#39;Exactly! It&#39;s something that I have never ever heard of before.&quot;,14,&quot; It was the kind of thing that I knew I had to check out.&quot;,15,&quot; How does it even work, anyways?&quot;,16,&quot; How does it make sense?&#39;&quot;,17,&quot;
(text-colour:#723e12)[&#39;I feel as though there are many things that make less sense than us.&#39; The rabbit mused, but continued on.]&quot;,18,&quot;(text-colour:#723e12)[ &#39;But we all began as what is perhaps considered the expected.]&quot;,19,&quot;(text-colour:#723e12)[ A group of large constellations that onlookers could see from a long distance away.]&quot;,20,&quot;(text-colour:#723e12)[ At one point, we realized, that the areas we were closer to were not much different than the ones we were farther from. In that…]&quot;,21,&quot;(text-colour:#723e12)[there was no way for them to see us.]&quot;,22,&quot;(text-colour:#723e12)[ Not completely]&quot;,23,&quot;(text-colour:#723e12)[, not as we were. They&#39;d have a whole other outlook with only seeing bits and pieces, if any.&#39;]&quot;,24,&quot;
(text-colour:#cc6d20)[&#39;We wanted to try to give the opportunity for more to see us!]&quot;,25,&quot;(text-colour:#cc6d20)[ We would hear the kinds of things people that saw us would say.]&quot;,26,&quot;(text-colour:#cc6d20)[ The one-sided conversations they would start. What if we could do that for more?]&quot;,27,&quot;(text-colour:#cc6d20)[ Some of us started to travel.]&quot;,28,&quot;(text-colour:#cc6d20)[ But there were some that would still not have the opportunity to see everything there is to see. Taking you, for example, as a traveler.]&quot;,29,&quot;
(text-colour:#cc6d20)[&#39;Well, just as when most things get larger the closer you are, but don&#39;t actually change in size…]&quot;,30,&quot;(text-colour:#cc6d20)[we are, very similarly, the same size always.]&quot;,31,&quot;(text-colour:#cc6d20)[ We make no change to ourselves or your perception.]&quot;,32,&quot;(text-colour:#cc6d20)[ We just want everyone to see it all and not have to leap to blind assumptions for something out of their control.&#39;]&quot;,33,&quot;
&#39;So you…exist as you are and just wish for others to have the opportunity to see that?&#39;&quot;,34,&quot;
(text-colour:#723e12)[&#39;Indeed. And while there are some things out of our control as well…]&quot;,35,&quot;(text-colour:#723e12)[We do everything in our power.]&quot;,36,&quot;(text-colour:#723e12)[ And what more could we expect from ourselves?&#39;]&quot;,37,&quot;
(text-colour:#cc6d20)[&#39;Now…why don&#39;t you go along and play with some of the younger ones.]&quot;,38,&quot;(text-colour:#cc6d20)[ They are always a fan of visitors.&#39;]
&#96;[&#96;a&#96;]&#96; Go and play leap frog with bunnies!&quot;))
(set:$FrogLeap to (dm:1,&quot;Although you were uncertain how the logistics of this would work,&quot;,2,&quot; you zipped over to the tousling lot playing leap frog.&quot;,3, &quot;You once again stopped, a little bit closer than previously, and asked the age-old question. &#39;May I join you?&#39;&quot;,4,&quot;
(text-colour:#97370f)[The crew of three turned their heads to you.]&quot;,5,&quot;(text-colour:#97370f)[ You saw the eyes of one twinkling, the ears of another twitch, and the third stand on its hind legs to beckon you closer with its two front legs. &#39;YEAH!&#39;]&quot;,6,&quot;
&#96;[&#96;a&#96;]&#96; Try to shift into a starry friend&quot;))
(set:$StarShift to (dm:1,&quot;To try to make it logistically easier, you set your bag in the space beside you and opened up your notebook.&quot;,2,&quot; Flipping through the pages, you tried to land on one that you think would stick.&quot;,3,&quot;
&#96;[&#96;a&#96;]&#96; Just go for a bunny!
&#96;[&#96;b&#96;]&#96; Turn into a bear cub!&quot;))
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $allFalse is true)+(if: $index&lt;=19)[(set: $text to it + $Gateway&#39;s ($index))(if:$index is 19)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
	(else-if: $bunny is true)[[[bunny shift-&gt;Bunny Shift]]]
	(else-if: $bear is true)[[[bear shift-&gt;Bear Shift]]]
	(else-if: $shift is true)+(if:$index&lt;=3)[(set:$text to it + $StarShift&#39;s ($index))(if:$index is 3)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set:$zPressed to true)]]
	(else-if: $leapFrog is true)+(if:$index &lt;=6)[(set:$text to it+ $FrogLeap&#39;s ($index))(if:$index is 6)[(set:$beforeOptionsA to false)(set:$zPressed to true)]]
	(else-if: $convene is true)+(if:$index &lt;=38)[(set: $text to it + $Conve&#39;s ($index))(if: $index is 38)[(set:$beforeOptionsA to false)(set:$zPressed to true)]]
	(else-if: $further is true)+(if: $index &lt;=13)[(set: $text to it + $FurtherAhead&#39;s ($index))(if: $index is 13)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $flyLike is true)+(if: $index &lt;=16)[(set: $text to it + $Superhero&#39;s ($index))(if: $index is 16)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
]]]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $flyLike to true) (set:$allFalse to false)]
	(else-if: $shift is true)[(set: $bunny to true)]
	(else-if: $leapFrog is true)[(set:$shift to true)]
	(else-if: $convene is true)[(set:$leapFrog to true)]
	(else-if: $further is true)[(set: $leapFrog to true)]
	(else-if: $flyLike is true)[(set: $further to true)]
]]
]
}
{
|bhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsB is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $convene to true) (set:$allFalse to false)]
	(else-if: $shift is true)[(set:$bear to true)]
	(else-if: $further is true)[(set: $convene to true)]
]]]
}</tw-passagedata><tw-passagedata pid="9" name="Offer Advice" tags="" position="161,1053" size="100,100">(set: $timer to 0)(set: $text to &quot;&quot;)(set: $zPressed to false)(set: $beforeOptionsA to true)(set: $beforeOptionsB to true)(set: $index to 0)(set: $allFalse to true)(set: $explainThineself to false)(set:$explainCatapulter to false)(set:$helpSpread to false)(set:$cameFor to false)
(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]]]
(set: $AdviceOffer to (dm:1,&quot;&#39;Ahem, so. Once we see Dreadna, we probably want to start heading in that direction.&#39;&quot;,2,&quot; You point out over the archer&#39;s left shoulder. &#39;Considering Relai is that way&#39;&quot;,3,&quot; you pointed the opposite way &#39;and it seems like the most recent report you have is Dreadna.&#39;&quot;,4,&quot; You directed the gesture roughly straight down.&quot;,5,&quot;
(text-colour:#ef5716)[He gave a look of acknowledgment.]&quot;,6, &quot;
&#39;I know you&#39;re getting into focus mode, alright?&quot;,7,&quot; But you need to do me a favor.&#39;&quot;,8,&quot;
(text-colour:#ef5716)[He said nothing, nor did he even give you a glance.]&quot;,9,&quot;
&#39;Don&#39;t lose sight of what you&#39;re here for at first sight of him, okay?&#39;&quot;,10,&quot;
(text-colour:#ef5716)[Still, nothing.]&quot;,11,&quot;(text-colour:#ef5716)[ But you had to hope that it was enough.]&quot;,12,&quot;(text-colour:#ef5716)[ That he had heard, even if he didn&#39;t want to respond.]&quot;,13,&quot;
Once the yellow planet of Dreadna with purple gas emitting from it came into view, the archer changed direction to where you had suggested.&quot;,14,&quot; Until you or him saw something, you&#39;d have to hope that the Star Slinger was on a one-track direction in wherever he was heading.&quot;,15,&quot; You took time to notice the things that changed since the last time you&#39;ve visited.&quot;,16,&quot; Not having to direct yourself offered the chance to look at it from a different angle. Seeing things blur past was strangely soothing.&quot;,17,&quot;
Maybe it was how the different stars and planets looked against the blanket of darkness.&quot;,18,&quot; Rather than being stagnant, when you moved, they seemed to move as well.&quot;,19,&quot; If they were close enough, they blended together to create even more colors and shapes that you could only dream of otherwise.&quot;,20,&quot; Perhaps it offered an insight of the Fox, for when everything moves as you do,&quot;,21,&quot; it can give the brief feeling that you&#39;re the center of it all.&quot;,22,&quot; It may not revolve around you, but the sights that you have are ones that you see.&quot;,23,&quot; There&#39;s no way of telling if everyone sees it the same way.&quot;,24,&quot;
You were finally going to discover why stars were being catapulted away from their source of origin.&quot;,25,&quot; You were going to find out why they were doing it without asking.&quot;,26,&quot;
As everything came to a halt around you, you knew you were stagnant once again.&quot;,27,&quot; The archer&#39;s hand fell.&quot;,28,&quot; You followed his sights to another figure that looked to be your size from this far away. They were looking at the stars.&quot;,29,&quot;
(text-colour:#ef5716)[The archer bounded soundlessly through the space, closing the remaining distance between them.]&quot;,30,&quot;(text-colour:#ef5716)[ He tucked his hand into his quiver of arrows, retrieving the bow from his back and stopping just seconds away.]&quot;,31,&quot;(text-colour:#ef5716)[ Before you could say anything against it, he nocked the arrow and released it.]&quot;,32,&quot; 
Not even the most powerful vacuums of space could silence your scream out in dismay.&quot;,33,&quot;
What you hadn&#39;t realized until opening your clenched eyes was the arrow hitting its mark—on the catapult itself.&quot;,34,&quot; The Star Slinger was off to the side, shocked.&quot;,35,&quot; He wasn&#39;t as tall as the archer, but he was still alarmingly taller than you.&quot;,36,&quot; 
(text-colour:#ef5716)[You could feel the archer&#39;s eyes on you.]&quot;,37,&quot;(text-colour:#ef5716)[ They spoke of hurt, disbelief,]&quot;,38,&quot;(text-colour:#ef5716)[ and you could see the switch to anger when they went back to the other celestial being here.]&quot;,39,&quot; 
&#96;[&#96;a&#96;]&#96; Explain yourself to the archer
&#96;[&#96;b&#96;]&#96; Allow the catapulter to explain himself&quot;))
(set:$explainingYourself to (dm:1,&quot;&#39;Wait—I…&#39; You zipped to be in front of the archer&#39;s face,&quot;,2,&quot; in between the two giants of this occupied vastness.&quot;,3,&quot; &#39;I didn&#39;t think that you would aim at him.&quot;,4,&quot; You were just quiet the whole time and didn&#39;t answer me before.&quot;,5,&quot; You scared me, is all. Don&#39;t scare him too.&#39;&quot;,6,&quot;
As you pivoted, you still saw splinters of the catapult spinning and moving farther and farther away from their point of origin.&quot;,7,&quot; The source was still flabbergasted, and paid little mind to your being here.&quot;,8,&quot; You moved forward, but you felt a pull back.&quot;,9,&quot;
(text-colour:#ef5716)[&#39;Mother has been looking for you, Sel.]&quot;,10,&quot;(text-colour:#ef5716)[ What in the heavens around us are you doing out here? Stealing from others and potentially causing harm is all I can see.&#39;]&quot;,11,&quot;
Sel? Mother? Wait a second.&quot;,12,&quot;
(text-colour: red)[&#39;I&#39;m not hurting anyone, Ollon.]&quot;,13,&quot;(text-colour: red)[ I always make sure the trajectory is fine.]&quot;,14,&quot;(text-colour: red)[ I just…&#39;]&quot;,15,&quot;
(text-colour:#ef5716)[&#39;You just what?&#39;]&quot;,16,&quot;
(text-colour: red)[&#39;I just…The universe keeps expanding.]&quot;,17,&quot;(text-colour:red)[ Faster and faster and faster…]&quot;,18,&quot;(text-colour:red)[faster than stars can be born.]&quot;,19,&quot;(text-colour:red)[ Anyone that goes out there is left with nothing!]&quot;,20,&quot;(text-colour:red)[ But look around us. We have so much to give.&#39;]&quot;,21,&quot;
(text-colour: #ef5716)[&#39;That means so much less when you&#39;re stealing it without even trying to ask for it first, Sel.&#39;]&quot;,22,&quot;
The more you listened and watched, the more you could see it.&quot;,23,&quot; There were similarities between the two constellations.&quot;,24,&quot; If they shared a creator, that would make even more sense.&quot;,25,&quot; It sounded like an older sibling reprimanding a younger one.&quot;,26,&quot; Had this been a race for the archer—Ollon&quot;,27,&quot;—to get to his brother before their mother got the chance?&quot;,28,&quot;
(text-colour:red)[&#39;I…I was afraid they&#39;d say no.&#39;]&quot;,29,&quot;
(text-colour:#ef5716)[&#39;If you were planning on stealing anyways, why would you be afraid of them saying no?&#39;]&quot;,30,&quot;
(text-colour:red)[&#39;I didn&#39;t want to steal.]&quot;,31,&quot;(text-colour:red)[ It sounds so bad when you put it like that!&#39;]&quot;,32,&quot;
(text-colour:#ef5716)[&#39;You&#39;re telling me! You&#39;re the one that did the stealing.&#39;]&quot;,33,&quot;
(text-colour:red)[&#39;I was in a hurry! Constellations move all the time]&quot;,34,&quot;(text-colour:red)[ and I wanted to get a few from all around.]&quot;,35,&quot;(text-colour:red)[ It looks really beautiful out there now, Ollon.&#39;]&quot;,36,&quot;
(text-colour:#ef5716)[&#39;You need to tell everyone you&#39;ve taken from. Before you go about asking anyone else.]&quot;,37,&quot;(text-colour:#ef5716)[ I mean it, Sel.]&quot;,38,&quot;(text-colour:#ef5716)[ It will even go easier if you let others help you in what you aim to do.&#39;]&quot;,39,&quot;(text-colour:#ef5716)[ Ollon turned away from a semi-sulking brother to face you. &#39;Thank you for your help in directions.]&quot;,40,&quot;(text-colour:#ef5716)[ I wouldn&#39;t want to keep you any longer.&#39;]
&#96;[&#96;a&#96;]&#96; Say that you&#39;ll help out in spreading the word about spreading star stuff
&#96;[&#96;b&#96;]&#96; Assure that this is what you came for, after all&quot;))
(set:$catapulterExplaining to (dm:1,&quot;&#39;Ahaha—&quot;,2,&quot;before we do anything too hasty. Star Slinger!&quot;,3,&quot; What is it that you mean to do here?&quot;,4,&quot; Because right now all it looks like is possible demolition and robbing from others like creators!&quot;,5,&quot; I&#39;m not sure how that would ever be something you would want to do.&quot;,6,&quot; Especially when you&#39;re made up of star stuff, yourself.&quot;,7,&quot; Couldn&#39;t it harm you if you lose too much?&#39;&quot;,8,&quot;
(text-colour:red)[The catapulter finally looked away from his broken machine, something akin to a pout sprouting on his face.]&quot;,9,&quot;(text-colour:red)[ &#39;I never take away that much.]&quot;,10,&quot;(text-colour:red)[ I would never dream to take away that much!]&quot;,11,&quot;(text-colour:red)[ You didn&#39;t tell them that I&#39;d try that, did you Ollon? You know me better than that!&#39;]&quot;,12,&quot;
The name Ollon made you falter.&quot;,13,&quot; And the fact that his eyes sought the archer&#39;s desperately now,&quot;,14,&quot; and didn&#39;t pay any attention to yours. These two KNEW each other?&quot;,15,&quot; And you were just finding out about that now?&quot;,16,&quot;
(text-colour:#ef5716)[&#39;Of course I didn&#39;t say anything like that, Sel, but you&#39;ve been behaving recklessly.]&quot;,17,&quot;(text-colour:#ef5716)[ Do you know how much effort has gone into finding you?]&quot;,18,&quot;(text-colour:#ef5716)[ Mother insisted that the others try finding you first before I could go out,]&quot;,19,&quot;(text-colour:#ef5716)[ and even then it took extra convincing.&#39;]&quot;,20,&quot;
The more you listened and watched, the more you could see it.&quot;,21,&quot; There were similarities between the two constellations.&quot;,22,&quot; If they shared a creator, that would make even more sense.&quot;,23,&quot; It sounded like an older sibling reprimanding a younger one.&quot;,24,&quot; Ollon and Sel…&quot;,25,&quot;
(text-colour:red)[&#39;I…I didn&#39;t mean to cause any trouble, honest!]&quot;,26,&quot;(text-colour:red)[ I just wanted to spread the warmth.]&quot;,27,&quot;(text-colour:red)[ I did even take one of mine.]&quot;,28,&quot;(text-colour:red)[ I&#39;m not missing it, and neither will anyone else for theirs.]&quot;,29,&quot;(text-colour:red)[ The universe continues to expand quicker.]&quot;,30,&quot;(text-colour:red)[ The cold reaches and placates and festers so much quicker than warmth can keep up with.]&quot;,31,&quot;(text-colour:red)[ I just wanted to send some stars out. And it&#39;s…it&#39;s beautiful!]&quot;,32,&quot;(text-colour:red)[ Life can enjoy it.&#39;]&quot;,33,&quot;
(text-colour:#ef5716)[&#39;You stole from people, Sel.]&quot;,34,&quot;(text-colour:#ef5716)[ You didn&#39;t even ask to see, first!]&quot;,35,&quot;(text-colour:#ef5716)[ You just took them as you saw fit to send them off to never be seen again.]&quot;,36,&quot;(text-colour:#ef5716)[ That will make people care and worry.]&quot;,37,&quot;(text-colour:#ef5716)[ They don&#39;t know your intentions are good when you&#39;re being so sneaky about it.&#39;]&quot;,38,&quot;
(text-colour:red)[&#39;But that&#39;s the exact opposite of what I mean to do!]&quot;,39,&quot;(text-colour:red)[ You know that! Why can&#39;t you explain it—&#39;]
(text-colour:#ef5716)[&#39;Because that&#39;s on you.]&quot;,40,&quot;(text-colour:#ef5716)[ It is not my responsibility.]&quot;,41,&quot;(text-colour:#ef5716)[ It&#39;s on you to hold yourself accountable, and you owe those you&#39;ve taken from an actual explanation.]&quot;,42,&quot;(text-colour:#ef5716)[ That way there isn&#39;t news of a Star Thief and rumors of danger lurking about,]&quot;,43,&quot;(text-colour:#ef5716)[ causing everyone to panic, when there really is no reason to. You&#39;re harmless,]&quot;,44,&quot;(text-colour:#ef5716)[ I know that, but you need to show others that too.]&quot;,45,&quot;(text-colour:#ef5716)[ Kindness can&#39;t be properly wielded as one side to a double-edged sword.]&quot;,46,&quot;(text-colour:#ef5716)[ It can&#39;t be taken seriously, then.&#39; Ollon turned away from a semi-sulking brother to face you.]&quot;,47,&quot;(text-colour:#ef5716)[ &#39;Thank you for your help in directions. I wouldn&#39;t want to keep you any longer.&#39;]
&#96;[&#96;a&#96;]&#96; Say that you&#39;ll help out in spreading the word about spreading star stuff
&#96;[&#96;b&#96;]&#96; Assure that this is what you came for, after all&quot;))
(set: $spreadWord to (dm:1,&quot;&#39;No no, it&#39;s fine. I came out here looking to put a stop to disruption.&quot;,2,&quot; And I think I can do that even more if I help.&#39;&quot;,3,&quot;
(text-colour:red)[Sel picked his head up.]&quot;,4,&quot;(text-colour:red)[ &#39;If…If you help?&#39;]&quot;,5,&quot;
You gave a smile. &#39;Yeah.&quot;,6,&quot; I think your intentions are really cool.&quot;,7,&quot; I like the idea of spreading goodness. The overall delivery needs some work, but&quot;,8,&quot;…I&#39;m free for as long as I want to be.&quot;,9,&quot; Part of the pros of being an explorer.&#39;&quot;,10,&quot; You both turned to the archer, giving a fine set of puppy dog eyes.&quot;,11,&quot;
(text-colour:#ef5716)[The lack of amusement from before returned in his current look.]&quot;,12,&quot;(text-colour:#ef5716)[ Oh yeah, he was not impressed at all.]&quot;,13,&quot;(text-colour:#ef5716)[ Regardless, he looked to you expectantly.]&quot;,14,&quot;(text-colour:#ef5716)[ &#39;It&#39;s not like anything I&#39;ll say will stop you.]&quot;,15,&quot;(text-colour:#ef5716)[ And sometimes it&#39;s nice to have others to watch your back.&#39;]&quot;))
(set: $thisIsWhatI to (dm:1,&quot;&#39;Don&#39;t worry about it, really!&quot;,2,&quot; Why else did I come out here but for the very answers we&#39;ve uncovered.&quot;,3,&quot; And more!&quot;,4,&quot; You never told me you were related to the one we were hunting down.&quot;,5,&quot; Here I was thinking I&#39;d have to stop a showdown.&#39;&quot;,6,&quot;
(text-colour:red)[Sel looked to you with an amused glint that really made it clear he and Ollon were related.]&quot;,7,&quot;(text-colour:red)[ &#39;Hunting me down?]&quot;,8,&quot;(text-colour:red)[ I thought that was something we just did for show, back in the day.&#39;]&quot;,9,&quot;
(text-colour:#ef5716)[Ollon shook his head. &#39;Hunting you down is putting it intensely.]&quot;,10,&quot;(text-colour:#ef5716)[ But it was for show for them.]&quot;,11,&quot;(text-colour:#ef5716)[ They took your offense more seriously than even I had.&#39;]&quot;,12,&quot;
You looked away meekly.&quot;,13,&quot; Had you really been that much?&quot;,14,&quot;
(text-colour:red)[&#39;Well…maybe that&#39;s a good thing.]&quot;,15,&quot;(text-colour:red)[ I think if it was just you here,]&quot;,16,&quot;(text-colour:red)[ I wouldn&#39;t be as inclined to listen.&#39;]&quot;,17,&quot;(text-colour:red)[ The smaller giant shifted to be in front of you.]&quot;,18,&quot;(text-colour:red)[ &#39;Thank you for making sure he had someone along.]&quot;,19,&quot;(text-colour:red)[ I always get worried when he goes off alone.&#39;]&quot;,20,&quot;
(text-colour:#ef5716)[&#39;You get—]&quot;,21,&quot;(text-colour:#ef5716)[what do you mean you get worried?&#39;]&quot;,22,&quot;(text-colour:#ef5716)[ Ollon made it seem like it was the most incredulous thought ever proposed.]&quot;,23,&quot;
(text-colour:red)[&#39;Just because I&#39;m the younger one, doesn&#39;t mean I don&#39;t get concerned about you every once in a while.]&quot;,24,&quot;(text-colour:red)[ You go all lone ranger mode!]&quot;,25,&quot;(text-colour:red)[ You make it difficult for people to watch out for you even from a distance.]&quot;,26,&quot;(text-colour:red)[ We just like to make sure you&#39;re okay.&#39;]&quot;,27,&quot;
You tilted your head in watching the conversation play out.&quot;,28,&quot; &#39;There&#39;s at least more time for now to watch out for one another up close.&quot;,29,&quot; We can all go around spreading the word of shifting some things.&quot;,30,&quot; Expanding with the universe, perhaps?&quot;,31,&quot; I know constellations like the Dancers like to move all the time.&quot;,32,&quot; And it&#39;s not like it&#39;s a forever thing.&#39;&quot;,33,&quot;
(text-colour:red)[Sel&#39;s eyes brightened to new levels that you had no other choice but to look away from.]&quot;,34,&quot;(text-colour:red)[ &#39;Really?]&quot;,35,&quot;(text-colour:red)[ Really really really?]&quot;,36,&quot;(text-colour:red)[ OLLON! Can you, can you please?]&quot;,37,&quot;(text-colour:red)[ I&#39;ll be the one to tell the people I&#39;ve taken from already, but please come along with?&#39;]&quot;,38,&quot;
(text-colour:#ef5716)[The lack of amusement you associated with him since the moment you met returned in his current look.]&quot;,39,&quot;(text-colour:#ef5716)[ Oh yeah,]&quot;,40,&quot;(text-colour:#ef5716)[ he was not impressed at all. Regardless, he looked to you expectantly.]&quot;,41,&quot;(text-colour:#ef5716)[ &#39;It&#39;s not like anything I&#39;ll say will stop you.]&quot;,42,&quot;(text-colour:#ef5716)[ And sometimes it&#39;s nice to know that others are willing to support me.&#39;]&quot;))
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $allFalse is true)+(if: $index&lt;=39)[(set: $text to it + $AdviceOffer&#39;s ($index))(if:$index is 39)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $cameFor is true)+(if:$index &lt;=42)[(set:$text to it+ $thisIsWhatI&#39;s ($index))(if:$index is 42)[[[end card -&gt; The End]]]]
	(else-if: $helpSpread is true)+(if:$index &lt;=15)[(set: $text to it + $spreadWord&#39;s ($index))(if: $index is 15)[[[end card -&gt; The End]]]]
	(else-if: $explainCatapulter is true)+(if: $index &lt;=47)[(set: $text to it + $catapulterExplaining&#39;s ($index))(if: $index is 47)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
	(else-if: $explainThineself is true)+(if: $index &lt;=40)[(set: $text to it + $explainingYourself&#39;s ($index))(if: $index is 40)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
] ] ]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $explainThineself to true) (set:$allFalse to false)]
	(else-if: $explainCatapulter is true)[(set: $helpSpread to true)]
	(else-if: $explainThineself is true)[(set: $helpSpread to true)]
]]
]
}
{
|bhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsB is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(if: $allFalse is true)[(set: $explainCatapulter to true) (set:$allFalse to false)]
	(else-if: $explainThineself is true)[(set: $cameFor to true)]
	(else-if: $explainCatapulter is true)[(set: $cameFor to true)]
]]]
}</tw-passagedata><tw-passagedata pid="10" name="Dreadna Inquiry" tags="" position="339,1057" size="100,100">(set: $timer to 0)(set: $text to &quot;&quot;)(set: $zPressed to false)(set: $beforeOptionsA to true)(set: $index to 0)(set:$Advice to false)
(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]]]
(set: $DreadInquiry to (dm:1,&quot;&#39;So. I was curious—&quot;,2,&quot;you evidently aren&#39;t from around here.&quot;,3,&quot; Or too close to here.&quot;,4,&quot; But you managed to know about Dreadna.&quot;,5,&quot; Not even nearby systems or planets to Dreadna,&quot;,6,&quot; just…Dreadna.&#39;&quot;,7,&quot;
(text-colour:#ef5716)[&#39;Must you keep saying Dreadna?]&quot;,8,&quot;(text-colour:#ef5716)[ It&#39;s rather dreadful.&#39;]&quot;,9,&quot;
You start to laugh at the remark.&quot;,10,&quot; And because you couldn&#39;t help yourself: &#39;Dreadna.&#39;&quot;,11,&quot; You laughed again at the groan turned silent and proceeded.&quot;,12,&quot; &#39;It just tends to be the case that everyone knows about everyone in all these neighboring galaxies.&quot;,13,&quot; Especially if they know a planet or two.&quot;,14,&quot; So…what&#39;s up with that?&#39;&quot;,15,&quot;
(text-colour:#ef5716)[Although you had reason to be momentarily tentative considering he may not answer thanks to your dreadful Dreadna scheme,]&quot;,16,&quot;(text-colour:#ef5716)[ the moments swiftly passed when he took a breath to explain. &#39;I am not from around here.]&quot;,17,&quot;(text-colour:#ef5716)[ I came here from the Snofal Galaxy.]&quot;,18,&quot;(text-colour:#ef5716)[ Because that&#39;s how far the catapulter has traveled, that is how far I traveled.]&quot;,19,&quot;(text-colour:#ef5716)[ I knew about…]&quot;,20,&quot;(text-colour:#ef5716)[that planet]&quot;,21,&quot;(text-colour:#ef5716)[…since a few galaxies over from here.]&quot;,22,&quot;(text-colour:#ef5716)[ It&#39;s one of the smaller, spiral ones.]&quot;,23,&quot;(text-colour:#ef5716)[ But they were talking about someone that sounded like my culprit hurrying through after a star went missing.]&quot;,24,&quot;(text-colour:#ef5716)[ And based on where he was heading—&#39;]
&#39;It looked like Dreadna was the dreary and dramatic destination.&#39;&quot;,25,&quot;
(text-colour:#ef5716)[His eyes narrowed at you. &#39;I&#39;m curious how much more enjoyable this would be if I was left alone to my own thoughts.&#39;]&quot;,26,&quot;
&#96;[&#96;a&#96;]&#96; Offer some advice for closing in on the Star Slinger&quot;))
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $Advice is true)[[[offerAdvice-&gt;Offer Advice]]]
(else-if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $index&lt;=26)[(set: $text to it + $DreadInquiry&#39;s ($index))(if:$index is 26)[(set:$beforeOptionsA to false)(set: $zPressed to true)]]
] ] ]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(set:$Advice to true)
]]
]
}</tw-passagedata><tw-passagedata pid="11" name=" The End" tags="" position="424,1220" size="100,100">(align:&quot;=&gt;&lt;=&quot;)+(box:&quot;X&quot;)[(text-style:&quot;underline&quot;,&quot;outline&quot;)[
#The Story Continues With You]]</tw-passagedata><tw-passagedata pid="12" name="Bunny Shift" tags="" position="512,1055" size="100,100">(set: $timer to 0)(set: $text to &quot;&quot;)(set: $zPressed to false)(set: $beforeOptionsA to true)(set: $beforeOptionsB to true)(set: $index to 0)(set: $allFalse to true)(set: $bunnyCont to false)(set:$tag to false)(set:$pat to false)
(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]]]
(set: $BunnyShift to (dm:1,&quot;Nothing struck a chord with you on your rapid trip down memory lane.&quot;,2,&quot; So, you closed the notebook with an animated thud that inspired an eruption of laughter from the animals.&quot;,3,&quot; It was a sound of pure delight that made you start to chuckle too.&quot;,4,&quot; You pushed it off to the side in space as well and focused on one of the bunnies in front of you.&quot;,5,&quot;
True to form, you started to shift into a creature of the stars.&quot;,6,&quot; Although you couldn&#39;t see it, you could feel the hair on your head start to morph with your ears to form longer, floppy ones.&quot;,7,&quot; Your nose started to shrink,&quot;,8,&quot; but not nearly as much as your hands or feet.&quot;,9,&quot; To top it off, you got a nice round tail.&quot;,10,&quot; Wherever you stood, tiny sparkles were left.&quot;,11,&quot; It gained a good set of (text-colour:#97370f)[&#39;Ooos&#39;] and (text-colour:#97370f)[&#39;Aaahs&#39;] from the crowd.&quot;,12,&quot;
Yet, when you got closer, the other bunnies still shrunk.&quot;,13,&quot; Luckily—so did you!&quot;,14,&quot; Apparently, you had managed to access that ability in your transformation.&quot;,15,&quot; And if the adorableness wasn&#39;t enough already, seeing the tiny bunnies was a prize.&quot;,16,&quot; They looked to get wings like little pixies,&quot;,17,&quot; tiny sparks, but mighty ones at that.&quot;,18,&quot; When they started back up again, you were surprised with how much distance they were able to travel in so little time when they were so small! But when you started to move towards them, you were much the same.&quot;,19,&quot; But when you started to move towards them, you were much the same.&quot;))
(set: $BunnyShiftCont to (dm:1,&quot;When all three had already taken their turn leaping, they called out to you urgently.&quot;,2,&quot; Gladly complying, you bounded forward with your four mini legs and pressed off the back of the first rabbit.&quot;,3,&quot; If you thought you were weightless before, it was nothing in comparison to now.&quot;,4,&quot; Your ears were still going up by time you were on your way down to do it again with the second bunny.&quot;,5,&quot; And on the third, you had so much momentum and so much energy going into the jump, you landed incredibly far away from the three&quot;,6,&quot;…you could actually see them as a few feet tall again!&quot;,7,&quot;
(text-colour:#97370f)[They laughed so hard that they fell on their backs, rolling around in the space matter around them.] &quot;,8,&quot;
(text-colour:#97370f)[&#39;I don&#39;t think any of us ever managed to do that!]&quot;,9,&quot;(text-colour:#97370f)[ Even though, trust me, we tried.&#39;]&quot;,10,&quot;(text-colour:#97370f)[ The one previously speaking suddenly bounded towards you, only to leap over you.]&quot;,11,&quot;(text-colour:#97370f)[ You heard a squeal that made you turn your head.]&quot;,12,&quot;
(text-colour:#e86a8c)[A basset hound dog constellation was right in your face, its nose booping you and lifting your further up.]&quot;,13,&quot;(text-colour:#e86a8c)[ Big, dark eyes focused on you, and immediately you could see the tail start to wag.]&quot;,14,&quot;(text-colour:#e86a8c)[ Probably…no…definitely faster than you could&#39;ve ever hoped to move.]&quot;,15,&quot;(text-colour:#e86a8c)[ It went lightyears a second!]&quot;,16,&quot;(text-colour:#e86a8c)[ Although you hadn&#39;t crossed paths before, it was looking at you like you were the one it had been expecting and hoping to see.]&quot;,17,&quot;(text-colour:#e86a8c)[ The excitement in the space was so palpable that you couldn&#39;t contain it!]&quot;,18,&quot;(text-colour:#e86a8c)[ And neither could anyone else.]&quot;,19,&quot;
&#96;[&#96;a&#96;]&#96; Play tag with the dog
&#96;[&#96;b&#96;]&#96; Turn back into your regular form to give the dog some pats.&quot;))
(set: $PlayTag to (dm:1,&quot;The first thing that came to mind was the first thing you said.&quot;,2,&quot; &#39;TAG! You&#39;re it!&#39;&quot;,3,&quot; You hurriedly dove off of the dog&#39;s nose and heard some tiny shouts and hollers of the bunnies.&quot;,4,&quot;
(text-colour:#e86a8c)[Apparently, the dog got the memo right away and went straight into action.]&quot;,5,&quot;(text-colour:#e86a8c)[ It turned to the nearest rabbit and started to dash towards it.]&quot;,6,&quot;(text-colour:#e86a8c)[ The dog had no right to move as fast as it did, but at least you didn&#39;t have to worry about the rabbits being entirely too fast for it.]&quot;,7,&quot;
(text-colour:#e86a8c)[When one bunny was deemed to be too far, the basset would lift its nose into the air to sniff out the nearest one,]&quot;,8,&quot;(text-colour:#e86a8c)[ which it proceeded to bound to with no inhibitions.]&quot;,9,&quot;(text-colour:#e86a8c)[ Every so often it would trip over its long ears that put all of the rabbits&#39; ears to shame, but that hardly served to slow it down.]&quot;,10,&quot;
You decide to get right back in on the fun times,&quot;,11,&quot; zooming towards the dog and veering off at just the right second.&quot;,12,&quot; You did what you had aimed—getting its attention turned to you.&quot;,13,&quot;
(text-colour:#e86a8c)[Tipping its head back and letting out a howl, the dog honed onto you and begun the chase.]&quot;,14,&quot;
Luckily, in its moment of howling, you were able to see the spectacle it had produced.&quot;,15,&quot; Any of the planets that were in sight had specks around them that grew in brightness.&quot;,16,&quot; The closer ones made it easy to tell that they were moons.&quot;,17,&quot; The dog&#39;s howl made the moonbeams shine out at various angles. It was a whole light show!&quot;,18,&quot;
It was when they dimmed and the dog was mere feet away that you zoomed downwards, trying to catch the dog up on quick turns.&quot;,19,&quot; It slid and skidded, but it was great in redirecting itself.&quot;,20,&quot; 
You started to wonder how the bunnies did it!&quot;,21,&quot; You were starting to tire yourself out, and you presently couldn&#39;t tell if the dog&#39;s tail was going faster, or your heart.&quot;,22,&quot; Just as you were pulling a quick halt, the basset was rounding from the other direction to meet you.&quot;,23,&quot;
You could hear it breathing heavy just as you were.&quot;,24,&quot; You didn&#39;t move now, nor did you when it dipped its forehead to tentatively meet yours.&quot;,25,&quot; You could feel yourself being grounded back to reality, as the space and stars around you turned to the grassy fields of your front yard.&quot;,26,&quot; You expanded back out into your human form.&quot;,27,&quot; You were sitting and out of breath with your basset hound in front of you, forehead to forehead.&quot;,28,&quot; The big brown eyes made you melt every time, without fail.&quot;,29,&quot; And there was that tail that thumped against the ground.&quot;,30,&quot; Bringing your dog into a hug was the only next step to take.&quot;,31,&quot;
The best part about your greatest imaginary feats was when you could incorporate them into your reality.&quot;))
(set: $PetDog to (dm:1,&quot;Although the time as a constellation creature had been enjoyable,&quot;,2,&quot; you couldn&#39;t resist the urge to dedicate all of your attention to this star speckled friend.&quot;,3,&quot; Its whiskers were like little rays from the sun, where you could so distinctly feel their warmth.&quot;,4,&quot;
You transformed back into your usual form, extending your hand towards the celestial animal.&quot;,5,&quot; It nodded to you in confirmation of wanting to be pet before you started to do so.&quot;,6,&quot; You immediately started by rubbing its head, but quickly went to scratching behind its long ears. Warmth&quot;,7,&quot; and immeasurable, pure love poured from the dog that honestly looked like it was living its best life.&quot;,8,&quot; When you moved on to scratching its long back, tiny specks of star stuff started to be shed and went off into all directions of space.&quot;,9,&quot; You could hear tiny sneezes from the bunnies that stayed close by, and one much bigger sneeze from the dog in front of you.&quot;,10,&quot;
&#39;Bless you!&#39; You said with a chuckle, moving onto rubbing its belly.&quot;,11,&quot;
(text-colour: #e86a8c)[The basset gladly complied in making it easy, laying down and rolling onto its back for optimal access.]&quot;,12,&quot;(text-colour:#e86a8c)[ It even stuck its tongue out to make a goofy upside-down face, which made you make a face of your own.]&quot;,13,&quot;(text-colour:#e86a8c)[ The dog replied with a blink before wagging its tail in approval again.]&quot;,14,&quot;(text-colour: #e86a8c)[ When you smiled, it only wagged its tail faster.]&quot;,15,&quot;
You could tell you could spend all day like this.&quot;,16,&quot; The dog probably could, too, which made you surprised when it rolled back onto its feet.&quot;,17,&quot; The surprise didn&#39;t last for too long—&quot;,18,&quot;as in the next moment, the animal was on your lap, although it wasn&#39;t quiet small enough to be a lap dog.&quot;,19,&quot; It would have to do!&quot;,20,&quot; And now, under dog law, you weren&#39;t allowed to move.&quot;,21,&quot;
(text-colour:#e86a8c)[Resting its head in your lap, the dog started to softly snore not too long after.]&quot;,22,&quot;(text-colour:#e86a8c)[ It had been playing with the bunnies in their trip across the universe a lot recently!]&quot;,23,&quot;(text-colour:#e86a8c)[ After all, the older constellations trusted it to keep the younger ones occupied and having a good time.]&quot;,24,&quot;(text-colour:#e86a8c)[ It didn&#39;t even wakeup to your continuation of pets, nor when the bunnies flew in for snuggle time as well.]&quot;,25,&quot;
You sighed, perfectly content in a still moment.&quot;,26,&quot; So content that the world around you melted away.&quot;,27,&quot; The vast, dark sky faded into the scenery of your Florida Room.&quot;,28,&quot; When you looked out the window behind you, you could see the insane amount of snow.&quot;,29,&quot; The fire was on and there was music playing from the TV.&quot;,30,&quot; When you looked down, you saw your beautiful and loving basset hound sleeping on your lap,&quot;,31,&quot; cuddled in for a night at home.&quot;,32,&quot; It was always happiest when it could see you.&quot;,33,&quot;
The best part about your greatest imaginary feats was when you could incorporate them into your reality.&quot;))
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $allFalse is true)+(if: $index&lt;=19)[(set: $text to it + $BunnyShift&#39;s ($index))(if:$index is 19)[(set:$allFalse to false)(set:$index to 0)(set: $text to &quot;&quot;)(set:$bunnyCont to true)]]
	(else-if: $pat is true)+(if:$index &lt;=33)[(set: $text to it + $PetDog&#39;s ($index))(if: $index is 33)[[[end card -&gt; The End]]]]
	(else-if: $tag is true)+(if: $index &lt;=31)[(set: $text to it + $PlayTag&#39;s ($index))(if: $index is 31)[[[end card-&gt; The End]]]]
	(else-if: $bunnyCont is true)+(if: $index &lt;=19)[(set: $text to it + $BunnyShiftCont&#39;s ($index))(if: $index is 19)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
] ] ]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(set: $tag to true)
]]
]
}
{
|bhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsB is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(set: $pat to true)
]]]
}
</tw-passagedata><tw-passagedata pid="13" name="Bear Shift" tags="" position="662,1055" size="100,100">(set: $timer to 0)(set: $text to &quot;&quot;)(set: $zPressed to false)(set: $beforeOptionsA to true)(set: $beforeOptionsB to true)(set: $index to 0)(set: $allFalse to true)(set: $bearCont to false)(set:$tag to false)(set:$pat to false)
(live:1)[$text(set: $timer to it+1)]
(live:2s)[(if: $zPressed is false)+(if: $timer&gt;400)[(text-style:&quot;fade-in-out&quot;)[Press z to continue.]]]
(set: $BearShift to (dm:1,&quot;Through your ventures of flipping through past constellations you&#39;ve seen, you did come across one of interest.&quot;,2,&quot; One of the classics,&quot;,3,&quot; and perhaps even one of your favorites that you&#39;ve seen,&quot;,4,&quot; inspired you to turn into a bear cub.&quot;,5,&quot; Of course, you wouldn&#39;t go for a size nearly as large as the ones you had seen,&quot;,6,&quot; but you would utilize the makeup of the one you had interacted with.&quot;,7,&quot;
Satisfied, you let your book lay suspended in front of you.&quot;,8,&quot; Tapping the page, you had an &#39;aha!&#39; moment to make this more fun.&quot;,9,&quot; Looking to each of the three bunnies surrounding you, you encouraged their help.&quot;,10,&quot; &#39;Come one, come all, for you are going to help me with a magic trick!&#39;&quot;,11,&quot;
(text-colour:#97370f)[The bunnies gasped! They had heard of magic in their travels,]&quot;,12,&quot;(text-colour:#97370f)[ but they had never stopped for long enough to see what that had meant.]&quot;,13,&quot;(text-colour:#97370f)[ They were completely attentive to you and your words.]&quot;,14,&quot;
&#39;Excellent. Now, when I say three,&quot;,15,&quot; I want you to be the ones to say the magic words.&quot;,16,&quot; Does anyone know what those are?&#39;&quot;,17,&quot;
(text-colour:#97370f)[&#39;Please!&#39;]&quot;,18,&quot;(text-colour:#97370f)[ &#39;Thank you!&#39;]&quot;,19,&quot;(text-colour:#97370f)[ &#39;The magic words!&#39; The last one gained a giggle from the others.]&quot;,20,&quot;
&#39;Ah, those are all excellent choices!&quot;,21,&quot; But the magic word to make my transformation work is URSAMA!&quot;,22,&quot; And you need to say it just like that for it to work.&quot;,23,&quot; You have to feel it!&quot;,24,&quot; You must believe in its power,&quot;,25,&quot; and in yours. Are you ready?&#39;&quot;,26,&quot;
(text-colour:#97370f)[They all nodded enthusiastically.]&quot;,27,&quot;
&#39;One…&quot;,28,&quot;two…&#39;&quot;,29,&quot; You could tell they were holding their breaths for you to say three.&quot;,30,&quot; So you waited just a few more beats…&quot;,31,&quot; &#39;THREE!&#39;&quot;,32,&quot;
(text-colour:#97370f)[&#39;URSAMA URSAMA URSAMA URSAAAAAAAAMAAAAAAAA!!!&#39; They leapt around you, trying to decide what angle they would best be able to tell if it worked was at.]&quot;,33,&quot;(text-colour:#97370f)[ They leapt around you, trying to decide what angle they would best be able to tell if it worked was at.]&quot;))
(set: $BearShiftCont to (dm:1,&quot;Satisfied with the amount of energy, you envisioned yourself as the bear cub.&quot;,2,&quot; Your ears started to shrink and round off more,&quot;,3,&quot; and fur started to sprout all over. It felt really fuzzy and warm, like a comfy sweater.&quot;,4,&quot; Your hands changed to paws and you had tiny claws that could do no harm.&quot;,5,&quot; A growl made the stars composing you switch with one of the others nearby.&quot;,6,&quot; Looking back to the bunnies, your lips curled into a smile at their amazement.&quot;,7,&quot; 
(text-colour:#97370f)[&#39;HOW DID YOU DO THAT?&#39;]&quot;,8,&quot;(text-colour:#97370f)[ &#39;I WANT TO DO THAT!&#39;]&quot;,9,&quot;(text-colour:#97370f)[ &#39;TEACH US YOUR WAYS!&#39;]&quot;,10,&quot;
You sighed. &#39;I told you, it&#39;s magic!&quot;,11,&quot; And I&#39;m not quite sure you could do it.&quot;,12,&quot; But don&#39;t worry!&quot;,13,&quot; You have your own magic that&#39;s just as incredible.&#39;&quot;,14,&quot; You winked a star and started towards them.&quot;,15,&quot; They still shrunk, but they stopped when they were about your size.&quot;,16,&quot; Interesting…&quot;,17,&quot;
&#39;Ready for some more leap frog?&#39;&quot;,18,&quot;
(text-colour:#97370f)[To answer, one bounded and leapt over another.]&quot;,19,&quot;(text-colour:#97370f)[ The third followed with leaping over both. &#39;Come on, Magic!&#39;]&quot;,20,&quot;
Holding appreciation for the reference, you didn&#39;t waste any time in following through.&quot;,21,&quot; You pushed off of one and let yourself be suspended long enough to do some somersaults through space.&quot;,22,&quot; You landed back into a running start to do the same with the second,&quot;,23,&quot; but this time striking different along the way down.&quot;,24,&quot; As you went for the third, at the last moment, the bunny flipped onto its back.&quot;,25,&quot; Your paws met theirs, and they propelled you even higher and further.&quot;,26,&quot; &#39;WAHOOOO!&#39;&quot;,27,&quot;
(text-colour:#97370f)[&#39;WOW! That worked a lot better than when we tried it earlier.&#39;]&quot;,28,&quot;(text-colour:#97370f)[ The comments from the bunnies didn&#39;t go unheard, their volume well exceeding even their current size.]&quot;,29,&quot;
As you were spiraling down, however,&quot;,30,&quot; before you could return to their side,&quot;,31,&quot; you were cushioned by a long-bodied basset hound constellation that was trotting along towards the bunnies.&quot;,32,&quot;
(text-colour:#97370f)[Various gasps originated from each of them as they came over to give hugs to the dog, who stood and basked in the attention.]&quot;,33,&quot;
(text-colour:#e86a8c)[It cautiously started to sniff at your face.] &quot;,34,&quot;(text-colour:#e86a8c)[Whatever it was trying to determine in doing so, it looked to be satisfied, for it booped your nose and continued to enjoy the appreciation from the other celestial animals.]&quot;,35,&quot;(text-colour:#e86a8c)[ Every so often, it would lift a paw to pat one of their heads.]&quot;,36,&quot;
&#96;[&#96;a&#96;]&#96; Play tag with the dog
&#96;[&#96;b&#96;]&#96; Turn back into your regular form to give the dog some pats.&quot;))
(set: $PlayTag to (dm:1,&quot;The first thing that came to mind was the first thing you said.&quot;,2,&quot; &#39;TAG! You&#39;re it!&#39;&quot;,3,&quot; You hurriedly dove off of the dog&#39;s nose and heard some tiny shouts and hollers of the bunnies.&quot;,4,&quot;
(text-colour:#e86a8c)[Apparently, the dog got the memo right away and went straight into action.]&quot;,5,&quot;(text-colour:#e86a8c)[ It turned to the nearest rabbit and started to dash towards it.]&quot;,6,&quot;(text-colour:#e86a8c)[ The dog had no right to move as fast as it did, but at least you didn&#39;t have to worry about the rabbits being entirely too fast for it.]&quot;,7,&quot;
(text-colour:#e86a8c)[When one bunny was deemed to be too far, the basset would lift its nose into the air to sniff out the nearest one,]&quot;,8,&quot;(text-colour:#e86a8c)[ which it proceeded to bound to with no inhibitions.]&quot;,9,&quot;(text-colour:#e86a8c)[ Every so often it would trip over its long ears that put all of the rabbits&#39; ears to shame, but that hardly served to slow it down.]&quot;,10,&quot;
You decide to get right back in on the fun times,&quot;,11,&quot; zooming towards the dog and veering off at just the right second.&quot;,12,&quot; You did what you had aimed—getting its attention turned to you.&quot;,13,&quot;
(text-colour:#e86a8c)[Tipping its head back and letting out a howl, the dog honed onto you and begun the chase.]&quot;,14,&quot;
Luckily, in its moment of howling, you were able to see the spectacle it had produced.&quot;,15,&quot; Any of the planets that were in sight had specks around them that grew in brightness.&quot;,16,&quot; The closer ones made it easy to tell that they were moons.&quot;,17,&quot; The dog&#39;s howl made the moonbeams shine out at various angles. It was a whole light show!&quot;,18,&quot;
It was when they dimmed and the dog was mere feet away that you zoomed downwards, trying to catch the dog up on quick turns.&quot;,19,&quot; It slid and skidded, but it was great in redirecting itself.&quot;,20,&quot; 
You started to wonder how the bunnies did it!&quot;,21,&quot; You were starting to tire yourself out, and you presently couldn&#39;t tell if the dog&#39;s tail was going faster, or your heart.&quot;,22,&quot; Just as you were pulling a quick halt, the basset was rounding from the other direction to meet you.&quot;,23,&quot;
You could hear it breathing heavy just as you were.&quot;,24,&quot; You didn&#39;t move now, nor did you when it dipped its forehead to tentatively meet yours.&quot;,25,&quot; You could feel yourself being grounded back to reality, as the space and stars around you turned to the grassy fields of your front yard.&quot;,26,&quot; You expanded back out into your human form.&quot;,27,&quot; You were sitting and out of breath with your basset hound in front of you, forehead to forehead.&quot;,28,&quot; The big brown eyes made you melt every time, without fail.&quot;,29,&quot; And there was that tail that thumped against the ground.&quot;,30,&quot; Bringing your dog into a hug was the only next step to take.&quot;,31,&quot;
The best part about your greatest imaginary feats was when you could incorporate them into your reality.&quot;))
(set: $PetDog to (dm:1,&quot;Although the time as a constellation creature had been enjoyable,&quot;,2,&quot; you couldn&#39;t resist the urge to dedicate all of your attention to this star speckled friend.&quot;,3,&quot; Its whiskers were like little rays from the sun, where you could so distinctly feel their warmth.&quot;,4,&quot;
You transformed back into your usual form, extending your hand towards the celestial animal.&quot;,5,&quot; It nodded to you in confirmation of wanting to be pet before you started to do so.&quot;,6,&quot; You immediately started by rubbing its head, but quickly went to scratching behind its long ears. Warmth&quot;,7,&quot; and immeasurable, pure love poured from the dog that honestly looked like it was living its best life.&quot;,8,&quot; When you moved on to scratching its long back, tiny specks of star stuff started to be shed and went off into all directions of space.&quot;,9,&quot; You could hear tiny sneezes from the bunnies that stayed close by, and one much bigger sneeze from the dog in front of you.&quot;,10,&quot;
&#39;Bless you!&#39; You said with a chuckle, moving onto rubbing its belly.&quot;,11,&quot;
(text-colour: #e86a8c)[The basset gladly complied in making it easy, laying down and rolling onto its back for optimal access.]&quot;,12,&quot;(text-colour:#e86a8c)[ It even stuck its tongue out to make a goofy upside-down face, which made you make a face of your own.]&quot;,13,&quot;(text-colour:#e86a8c)[ The dog replied with a blink before wagging its tail in approval again.]&quot;,14,&quot;(text-colour: #e86a8c)[ When you smiled, it only wagged its tail faster.]&quot;,15,&quot;
You could tell you could spend all day like this.&quot;,16,&quot; The dog probably could, too, which made you surprised when it rolled back onto its feet.&quot;,17,&quot; The surprise didn&#39;t last for too long—&quot;,18,&quot;as in the next moment, the animal was on your lap, although it wasn&#39;t quiet small enough to be a lap dog.&quot;,19,&quot; It would have to do!&quot;,20,&quot; And now, under dog law, you weren&#39;t allowed to move.&quot;,21,&quot;
(text-colour:#e86a8c)[Resting its head in your lap, the dog started to softly snore not too long after.]&quot;,22,&quot;(text-colour:#e86a8c)[ It had been playing with the bunnies in their trip across the universe a lot recently!]&quot;,23,&quot;(text-colour:#e86a8c)[ After all, the older constellations trusted it to keep the younger ones occupied and having a good time.]&quot;,24,&quot;(text-colour:#e86a8c)[ It didn&#39;t even wakeup to your continuation of pets, nor when the bunnies flew in for snuggle time as well.]&quot;,25,&quot;
You sighed, perfectly content in a still moment.&quot;,26,&quot; So content that the world around you melted away.&quot;,27,&quot; The vast, dark sky faded into the scenery of your Florida Room.&quot;,28,&quot; When you looked out the window behind you, you could see the insane amount of snow.&quot;,29,&quot; The fire was on and there was music playing from the TV.&quot;,30,&quot; When you looked down, you saw your beautiful and loving basset hound sleeping on your lap,&quot;,31,&quot; cuddled in for a night at home.&quot;,32,&quot; It was always happiest when it could see you.&quot;,33,&quot;
The best part about your greatest imaginary feats was when you could incorporate them into your reality.&quot;))
{
|zhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is true)+(if: $beforeOptionsB is true)[
	(set: $timer to 0)
	(set: $index to it + 1)
    (if: $allFalse is true)+(if: $index&lt;=33)[(set: $text to it + $BearShift&#39;s ($index))(if:$index is 33)[(set:$allFalse to false)(set:$index to 0)(set: $text to &quot;&quot;)(set:$bearCont to true)]]
	(else-if: $pat is true)+(if:$index &lt;=33)[(set: $text to it + $PetDog&#39;s ($index))(if: $index is 33)[[[end card -&gt; The End]]]]
	(else-if: $tag is true)+(if: $index &lt;=31)[(set: $text to it + $PlayTag&#39;s ($index))(if: $index is 31)[[[end card-&gt; The End]]]]
	(else-if: $bearCont is true)+(if: $index &lt;=36)[(set: $text to it + $BearShiftCont&#39;s ($index))(if: $index is 36)[(set:$beforeOptionsA to false)(set:$beforeOptionsB to false)(set: $zPressed to true)]]
] ] ]
}
{
|ahotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsA is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(set: $tag to true)
]]
]
}
{
|bhotkey&gt;[ (link-repeat: &quot;hotkey&quot;)[
(if: $beforeOptionsB is false)[
	(set: $text to &quot;&quot;)
	(set: $zPressed to false)
	(set: $index to 0)
	(set: $beforeOptionsA to true)
	(set: $beforeOptionsB to true)
	(set: $pat to true)
]]]
}
</tw-passagedata></tw-storydata>
<script title="Twine engine code" data-main="harlowe">"use strict";var _slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}!function(){
/**
 * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/almond/LICENSE
 */var requirejs,require,define,root,factory;!function(e){var t,n,r,a,i={},o={},s={},c={},u=Object.prototype.hasOwnProperty,l=[].slice,p=/\.js$/;function f(e,t){return u.call(e,t)}function d(e,t){var n,r,a,i,o,c,u,l,f,d,h,y=t&&t.split("/"),m=s.map,g=m&&m["*"]||{};if(e){for(o=(e=e.split("/")).length-1,s.nodeIdCompat&&p.test(e[o])&&(e[o]=e[o].replace(p,"")),"."===e[0].charAt(0)&&y&&(e=y.slice(0,y.length-1).concat(e)),f=0;f<e.length;f++)if("."===(h=e[f]))e.splice(f,1),f-=1;else if(".."===h){if(0===f||1===f&&".."===e[2]||".."===e[f-1])continue;f>0&&(e.splice(f-1,2),f-=2)}e=e.join("/")}if((y||g)&&m){for(f=(n=e.split("/")).length;f>0;f-=1){if(r=n.slice(0,f).join("/"),y)for(d=y.length;d>0;d-=1)if((a=m[y.slice(0,d).join("/")])&&(a=a[r])){i=a,c=f;break}if(i)break;!u&&g&&g[r]&&(u=g[r],l=f)}!i&&u&&(i=u,c=l),i&&(n.splice(0,c,i),e=n.join("/"))}return e}function h(t,r){return function(){var a=l.call(arguments,0);return"string"!=typeof a[0]&&1===a.length&&a.push(null),n.apply(e,a.concat([t,r]))}}function y(e){return function(t){i[e]=t}}function m(n){if(f(o,n)){var r=o[n];delete o[n],c[n]=!0,t.apply(e,r)}if(!f(i,n)&&!f(c,n))throw new Error("No "+n);return i[n]}function g(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function v(e){return e?g(e):[]}r=function(e,t){var n,r,a=g(e),i=a[0],o=t[1];return e=a[1],i&&(n=m(i=d(i,o))),i?e=n&&n.normalize?n.normalize(e,(r=o,function(e){return d(e,r)})):d(e,o):(i=(a=g(e=d(e,o)))[0],e=a[1],i&&(n=m(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},a={require:function(e){return h(e)},exports:function(e){var t=i[e];return void 0!==t?t:i[e]={}},module:function(e){return{id:e,uri:"",exports:i[e],config:function(e){return function(){return s&&s.config&&s.config[e]||{}}}(e)}}},t=function(t,n,s,u){var l,p,d,g,b,w,T,S=[],x=void 0===s?"undefined":_typeof(s);if(w=v(u=u||t),"undefined"===x||"function"===x){for(n=!n.length&&s.length?["require","exports","module"]:n,b=0;b<n.length;b+=1)if("require"===(p=(g=r(n[b],w)).f))S[b]=a.require(t);else if("exports"===p)S[b]=a.exports(t),T=!0;else if("module"===p)l=S[b]=a.module(t);else if(f(i,p)||f(o,p)||f(c,p))S[b]=m(p);else{if(!g.p)throw new Error(t+" missing "+p);g.p.load(g.n,h(u,!0),y(p),{}),S[b]=i[p]}d=s?s.apply(i[t],S):void 0,t&&(l&&l.exports!==e&&l.exports!==i[t]?i[t]=l.exports:d===e&&T||(i[t]=d))}else t&&(i[t]=s)},requirejs=require=n=function(i,o,c,u,l){if("string"==typeof i)return a[i]?a[i](o):m(r(i,v(o)).f);if(!i.splice){if((s=i).deps&&n(s.deps,s.callback),!o)return;o.splice?(i=o,o=c,c=null):i=e}return o=o||function(){},"function"==typeof c&&(c=u,u=l),u?t(e,i,o,c):setTimeout(function(){t(e,i,o,c)},4),n},n.config=function(e){return n(e)},requirejs._defined=i,(define=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),f(i,e)||f(o,e)||(o[e]=[e,t,n])}).amd={jQuery:!0}}(),define("almond",function(){}),
/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
root=this,factory=function(){var e,t,n=Function.call.bind(Function.apply),r=Function.call.bind(Function.call),a=Array.isArray,i=Object.keys,o=function(e){try{return e(),!1}catch(e){return!0}},s=function(e){try{return e()}catch(e){return!1}},c=(e=o,function(){return!n(e,this,arguments)}),u=!!Object.defineProperty&&!o(function(){return Object.defineProperty({},"x",{get:function(){}})}),l="foo"===function(){}.name,p=Function.call.bind(Array.prototype.forEach),f=Function.call.bind(Array.prototype.reduce),d=Function.call.bind(Array.prototype.filter),h=Function.call.bind(Array.prototype.some),y=function(e,t,n,r){!r&&t in e||(u?Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n}):e[t]=n)},m=function(e,t,n){p(i(t),function(r){var a=t[r];y(e,r,a,!!n)})},g=Function.call.bind(Object.prototype.toString),v="function"==typeof/abc/?function(e){return"function"==typeof e&&"[object Function]"===g(e)}:function(e){return"function"==typeof e},b=function(e,t,n){if(!u)throw new TypeError("getters require true ES5 support");Object.defineProperty(e,t,{configurable:!0,enumerable:!1,get:n})},w=function(e,t,n){if(!u)throw new TypeError("getters require true ES5 support");var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,{configurable:r.configurable,enumerable:r.enumerable,get:function(){return e[t]},set:function(n){e[t]=n}})},T=function(e,t,n){if(u){var r=Object.getOwnPropertyDescriptor(e,t);r.value=n,Object.defineProperty(e,t,r)}else e[t]=n},S=function(e,t,n){u?Object.defineProperty(e,t,n):"value"in n&&(e[t]=n.value)},x=function(e,t){t&&v(t.toString)&&y(e,"toString",t.toString.bind(t),!0)},k=Object.create||function(e,t){var n=function(){};n.prototype=e;var r=new n;return void 0!==t&&i(t).forEach(function(e){S(r,e,t[e])}),r},O=function(e,t){return!!Object.setPrototypeOf&&s(function(){var n=function t(n){var r=new e(n);return Object.setPrototypeOf(r,t.prototype),r};return Object.setPrototypeOf(n,e),n.prototype=k(e.prototype,{constructor:{value:n}}),t(n)})},j=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}(),A=j.isFinite,C=Function.call.bind(String.prototype.indexOf),E=Function.apply.bind(Array.prototype.indexOf),_=Function.call.bind(Array.prototype.concat),N=Function.call.bind(String.prototype.slice),P=Function.call.bind(Array.prototype.push),I=Function.apply.bind(Array.prototype.push),M=Function.call.bind(Array.prototype.shift),D=Math.max,R=Math.min,L=Math.floor,q=Math.abs,F=Math.exp,V=Math.log,H=Math.sqrt,z=Function.call.bind(Object.prototype.hasOwnProperty),$=function(){},B=j.Map,W=B&&B.prototype.delete,U=B&&B.prototype.get,G=B&&B.prototype.has,X=B&&B.prototype.set,Y=j.Symbol||{},J=Y.species||"@@species",K=Number.isNaN||function(e){return e!=e},Z=Number.isFinite||function(e){return"number"==typeof e&&A(e)},Q=v(Math.sign)?Math.sign:function(e){var t=Number(e);return 0===t?t:K(t)?t:t<0?-1:1},ee=function(e){var t=Number(e);return t<-1||K(t)?NaN:0===t||t===1/0?t:-1===t?-1/0:1+t-1==0?t:t*(V(1+t)/(1+t-1))},te=function(e){return"[object Arguments]"===g(e)},ne=te(arguments)?te:function(e){return null!==e&&"object"===(void 0===e?"undefined":_typeof(e))&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==g(e)&&"[object Function]"===g(e.callee)},re=function(e){return null===e||"function"!=typeof e&&"object"!==(void 0===e?"undefined":_typeof(e))},ae=function(e){return"[object String]"===g(e)},ie=function(e){return"[object RegExp]"===g(e)},oe=function(e){return"function"==typeof j.Symbol&&"symbol"===(void 0===e?"undefined":_typeof(e))},se=function(e,t,n){var r=e[t];y(e,t,n,!0),x(e[t],r)},ce="function"==typeof Y&&"function"==typeof Y.for&&oe(Y()),ue=oe(Y.iterator)?Y.iterator:"_es6-shim iterator_";j.Set&&"function"==typeof(new j.Set)["@@iterator"]&&(ue="@@iterator"),j.Reflect||y(j,"Reflect",{},!0);var le,pe=j.Reflect,fe=String,de="undefined"!=typeof document&&document?document.all:null,he=null==de?function(e){return null==e}:function(e){return null==e&&e!==de},ye={Call:function(e,t){var r=arguments.length>2?arguments[2]:[];if(!ye.IsCallable(e))throw new TypeError(e+" is not a function");return n(e,t,r)},RequireObjectCoercible:function(e,t){if(he(e))throw new TypeError(t||"Cannot call method on "+e);return e},TypeIsObject:function(e){return null!=e&&!0!==e&&!1!==e&&("function"==typeof e||"object"===(void 0===e?"undefined":_typeof(e))||e===de)},ToObject:function(e,t){return Object(ye.RequireObjectCoercible(e,t))},IsCallable:v,IsConstructor:function(e){return ye.IsCallable(e)},ToInt32:function(e){return ye.ToNumber(e)>>0},ToUint32:function(e){return ye.ToNumber(e)>>>0},ToNumber:function(e){if("[object Symbol]"===g(e))throw new TypeError("Cannot convert a Symbol value to a number");return+e},ToInteger:function(e){var t=ye.ToNumber(e);return K(t)?0:0!==t&&Z(t)?(t>0?1:-1)*L(q(t)):t},ToLength:function(e){var t=ye.ToInteger(e);return t<=0?0:t>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t},SameValue:function(e,t){return e===t?0!==e||1/e==1/t:K(e)&&K(t)},SameValueZero:function(e,t){return e===t||K(e)&&K(t)},IsIterable:function(e){return ye.TypeIsObject(e)&&(void 0!==e[ue]||ne(e))},GetIterator:function(e){if(ne(e))return new t(e,"value");var n=ye.GetMethod(e,ue);if(!ye.IsCallable(n))throw new TypeError("value is not an iterable");var r=ye.Call(n,e);if(!ye.TypeIsObject(r))throw new TypeError("bad iterator");return r},GetMethod:function(e,t){var n=ye.ToObject(e)[t];if(!he(n)){if(!ye.IsCallable(n))throw new TypeError("Method not callable: "+t);return n}},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var n=ye.GetMethod(e,"return");if(void 0!==n){var r,a;try{r=ye.Call(n,e)}catch(e){a=e}if(!t){if(a)throw a;if(!ye.TypeIsObject(r))throw new TypeError("Iterator's return method returned a non-object.")}}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!ye.TypeIsObject(t))throw new TypeError("bad iterator");return t},IteratorStep:function(e){var t=ye.IteratorNext(e);return!ye.IteratorComplete(t)&&t},Construct:function(e,t,n,r){var a=void 0===n?e:n;if(!r&&pe.construct)return pe.construct(e,t,a);var i=a.prototype;ye.TypeIsObject(i)||(i=Object.prototype);var o=k(i),s=ye.Call(e,o,t);return ye.TypeIsObject(s)?s:o},SpeciesConstructor:function(e,t){var n=e.constructor;if(void 0===n)return t;if(!ye.TypeIsObject(n))throw new TypeError("Bad constructor");var r=n[J];if(he(r))return t;if(!ye.IsConstructor(r))throw new TypeError("Bad @@species");return r},CreateHTML:function(e,t,n,r){var a=ye.ToString(e),i="<"+t;""!==n&&(i+=" "+n+'="'+ye.ToString(r).replace(/"/g,"&quot;")+'"');return i+">"+a+"</"+t+">"},IsRegExp:function(e){if(!ye.TypeIsObject(e))return!1;var t=e[Y.match];return void 0!==t?!!t:ie(e)},ToString:function(e){return fe(e)}};if(u&&ce){var me=function(e){if(oe(Y[e]))return Y[e];var t=Y.for("Symbol."+e);return Object.defineProperty(Y,e,{configurable:!1,enumerable:!1,writable:!1,value:t}),t};if(!oe(Y.search)){var ge=me("search"),ve=String.prototype.search;y(RegExp.prototype,ge,function(e){return ye.Call(ve,e,[this])});se(String.prototype,"search",function(e){var t=ye.RequireObjectCoercible(this);if(!he(e)){var n=ye.GetMethod(e,ge);if(void 0!==n)return ye.Call(n,e,[t])}return ye.Call(ve,t,[ye.ToString(e)])})}if(!oe(Y.replace)){var be=me("replace"),we=String.prototype.replace;y(RegExp.prototype,be,function(e,t){return ye.Call(we,e,[this,t])});se(String.prototype,"replace",function(e,t){var n=ye.RequireObjectCoercible(this);if(!he(e)){var r=ye.GetMethod(e,be);if(void 0!==r)return ye.Call(r,e,[n,t])}return ye.Call(we,n,[ye.ToString(e),t])})}if(!oe(Y.split)){var Te=me("split"),Se=String.prototype.split;y(RegExp.prototype,Te,function(e,t){return ye.Call(Se,e,[this,t])});se(String.prototype,"split",function(e,t){var n=ye.RequireObjectCoercible(this);if(!he(e)){var r=ye.GetMethod(e,Te);if(void 0!==r)return ye.Call(r,e,[n,t])}return ye.Call(Se,n,[ye.ToString(e),t])})}var xe=oe(Y.match),ke=xe&&((le={})[Y.match]=function(){return 42},42!=="a".match(le));if(!xe||ke){var Oe=me("match"),je=String.prototype.match;y(RegExp.prototype,Oe,function(e){return ye.Call(je,e,[this])});se(String.prototype,"match",function(e){var t=ye.RequireObjectCoercible(this);if(!he(e)){var n=ye.GetMethod(e,Oe);if(void 0!==n)return ye.Call(n,e,[t])}return ye.Call(je,t,[ye.ToString(e)])})}}var Ae=function(e,t,n){x(t,e),Object.setPrototypeOf&&Object.setPrototypeOf(e,t),u?p(Object.getOwnPropertyNames(e),function(r){r in $||n[r]||w(e,r,t)}):p(Object.keys(e),function(r){r in $||n[r]||(t[r]=e[r])}),t.prototype=e.prototype,T(e.prototype,"constructor",t)},Ce=function(){return this},Ee=function(e){u&&!z(e,J)&&b(e,J,Ce)},_e=function(e,t){var n=t||function(){return this};y(e,ue,n),!e[ue]&&oe(ue)&&(e[ue]=n)},Ne=function(e,t,n){if(function(e,t,n){u?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:n}):e[t]=n}(e,t,n),!ye.SameValue(e[t],n))throw new TypeError("property is nonconfigurable")},Pe=function(e,t,n,r){if(!ye.TypeIsObject(e))throw new TypeError("Constructor requires `new`: "+t.name);var a=t.prototype;ye.TypeIsObject(a)||(a=n);var i=k(a);for(var o in r)if(z(r,o)){var s=r[o];y(i,o,s,!0)}return i};if(String.fromCodePoint&&1!==String.fromCodePoint.length){var Ie=String.fromCodePoint;se(String,"fromCodePoint",function(e){return ye.Call(Ie,this,arguments)})}var Me={fromCodePoint:function(e){for(var t,n=[],r=0,a=arguments.length;r<a;r++){if(t=Number(arguments[r]),!ye.SameValue(t,ye.ToInteger(t))||t<0||t>1114111)throw new RangeError("Invalid code point "+t);t<65536?P(n,String.fromCharCode(t)):(t-=65536,P(n,String.fromCharCode(55296+(t>>10))),P(n,String.fromCharCode(t%1024+56320)))}return n.join("")},raw:function(e){var t=ye.ToObject(e,"bad callSite"),n=ye.ToObject(t.raw,"bad raw value"),r=n.length,a=ye.ToLength(r);if(a<=0)return"";for(var i,o,s,c,u=[],l=0;l<a&&(i=ye.ToString(l),s=ye.ToString(n[i]),P(u,s),!(l+1>=a));)o=l+1<arguments.length?arguments[l+1]:"",c=ye.ToString(o),P(u,c),l+=1;return u.join("")}};String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&se(String,"raw",Me.raw),m(String,Me);var De={repeat:function(e){var t=ye.ToString(ye.RequireObjectCoercible(this)),n=ye.ToInteger(e);if(n<0||n>=1/0)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");return function e(t,n){if(n<1)return"";if(n%2)return e(t,n-1)+t;var r=e(t,n/2);return r+r}(t,n)},startsWith:function(e){var t=ye.ToString(ye.RequireObjectCoercible(this));if(ye.IsRegExp(e))throw new TypeError('Cannot call method "startsWith" with a regex');var n,r=ye.ToString(e);arguments.length>1&&(n=arguments[1]);var a=D(ye.ToInteger(n),0);return N(t,a,a+r.length)===r},endsWith:function(e){var t=ye.ToString(ye.RequireObjectCoercible(this));if(ye.IsRegExp(e))throw new TypeError('Cannot call method "endsWith" with a regex');var n,r=ye.ToString(e),a=t.length;arguments.length>1&&(n=arguments[1]);var i=void 0===n?a:ye.ToInteger(n),o=R(D(i,0),a);return N(t,o-r.length,o)===r},includes:function(e){if(ye.IsRegExp(e))throw new TypeError('"includes" does not accept a RegExp');var t,n=ye.ToString(e);return arguments.length>1&&(t=arguments[1]),-1!==C(this,n,t)},codePointAt:function(e){var t=ye.ToString(ye.RequireObjectCoercible(this)),n=ye.ToInteger(e),r=t.length;if(n>=0&&n<r){var a=t.charCodeAt(n);if(a<55296||a>56319||n+1===r)return a;var i=t.charCodeAt(n+1);return i<56320||i>57343?a:1024*(a-55296)+(i-56320)+65536}}};if(String.prototype.includes&&!1!=="a".includes("a",1/0)&&se(String.prototype,"includes",De.includes),String.prototype.startsWith&&String.prototype.endsWith){var Re=o(function(){return"/a/".startsWith(/a/)}),Le=s(function(){return!1==="abc".startsWith("a",1/0)});Re&&Le||(se(String.prototype,"startsWith",De.startsWith),se(String.prototype,"endsWith",De.endsWith))}ce&&(s(function(){var e=/a/;return e[Y.match]=!1,"/a/".startsWith(e)})||se(String.prototype,"startsWith",De.startsWith),s(function(){var e=/a/;return e[Y.match]=!1,"/a/".endsWith(e)})||se(String.prototype,"endsWith",De.endsWith),s(function(){var e=/a/;return e[Y.match]=!1,"/a/".includes(e)})||se(String.prototype,"includes",De.includes));m(String.prototype,De);var qe=["\t\n\v\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join(""),Fe=new RegExp("(^["+qe+"]+)|(["+qe+"]+$)","g"),Ve=function(){return ye.ToString(ye.RequireObjectCoercible(this)).replace(Fe,"")},He=["\x85","\u200b","\ufffe"].join(""),ze=new RegExp("["+He+"]","g"),$e=/^[-+]0x[0-9a-f]+$/i,Be=He.trim().length!==He.length;y(String.prototype,"trim",Ve,Be);var We=function(e){return{value:e,done:0===arguments.length}},Ue=function(e){ye.RequireObjectCoercible(e),this._s=ye.ToString(e),this._i=0};Ue.prototype.next=function(){var e=this._s,t=this._i;if(void 0===e||t>=e.length)return this._s=void 0,We();var n,r,a=e.charCodeAt(t);return r=a<55296||a>56319||t+1===e.length?1:(n=e.charCodeAt(t+1))<56320||n>57343?1:2,this._i=t+r,We(e.substr(t,r))},_e(Ue.prototype),_e(String.prototype,function(){return new Ue(this)});var Ge={from:function(e){var t,n,a,i,o,s,c=this;if(arguments.length>1&&(t=arguments[1]),void 0===t)n=!1;else{if(!ye.IsCallable(t))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(a=arguments[2]),n=!0}if(void 0!==(ne(e)||ye.GetMethod(e,ue))){o=ye.IsConstructor(c)?Object(new c):[];var u,l,p=ye.GetIterator(e);for(s=0;!1!==(u=ye.IteratorStep(p));){l=u.value;try{n&&(l=void 0===a?t(l,s):r(t,a,l,s)),o[s]=l}catch(e){throw ye.IteratorClose(p,!0),e}s+=1}i=s}else{var f,d=ye.ToObject(e);for(i=ye.ToLength(d.length),o=ye.IsConstructor(c)?Object(new c(i)):new Array(i),s=0;s<i;++s)f=d[s],n&&(f=void 0===a?t(f,s):r(t,a,f,s)),Ne(o,s,f)}return o.length=i,o},of:function(){for(var e=arguments.length,t=this,n=a(t)||!ye.IsCallable(t)?new Array(e):ye.Construct(t,[e]),r=0;r<e;++r)Ne(n,r,arguments[r]);return n.length=e,n}};m(Array,Ge),Ee(Array),m((t=function(e,t){this.i=0,this.array=e,this.kind=t}).prototype,{next:function(){var e=this.i,n=this.array;if(!(this instanceof t))throw new TypeError("Not an ArrayIterator");if(void 0!==n)for(var r=ye.ToLength(n.length);e<r;e++){var a,i=this.kind;return"key"===i?a=e:"value"===i?a=n[e]:"entry"===i&&(a=[e,n[e]]),this.i=e+1,We(a)}return this.array=void 0,We()}}),_e(t.prototype),Array.of===Ge.of||function(){var e=function(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&2===t.length}()||se(Array,"of",Ge.of);var Xe={copyWithin:function(e,t){var n,r=ye.ToObject(this),a=ye.ToLength(r.length),i=ye.ToInteger(e),o=ye.ToInteger(t),s=i<0?D(a+i,0):R(i,a),c=o<0?D(a+o,0):R(o,a);arguments.length>2&&(n=arguments[2]);var u=void 0===n?a:ye.ToInteger(n),l=u<0?D(a+u,0):R(u,a),p=R(l-c,a-s),f=1;for(c<s&&s<c+p&&(f=-1,c+=p-1,s+=p-1);p>0;)c in r?r[s]=r[c]:delete r[s],c+=f,s+=f,p-=1;return r},fill:function(e){var t,n;arguments.length>1&&(t=arguments[1]),arguments.length>2&&(n=arguments[2]);var r=ye.ToObject(this),a=ye.ToLength(r.length);t=ye.ToInteger(void 0===t?0:t);for(var i=(n=ye.ToInteger(void 0===n?a:n))<0?a+n:n,o=t<0?D(a+t,0):R(t,a);o<a&&o<i;++o)r[o]=e;return r},find:function(e){var t=ye.ToObject(this),n=ye.ToLength(t.length);if(!ye.IsCallable(e))throw new TypeError("Array#find: predicate must be a function");for(var a,i=arguments.length>1?arguments[1]:null,o=0;o<n;o++)if(a=t[o],i){if(r(e,i,a,o,t))return a}else if(e(a,o,t))return a},findIndex:function(e){var t=ye.ToObject(this),n=ye.ToLength(t.length);if(!ye.IsCallable(e))throw new TypeError("Array#findIndex: predicate must be a function");for(var a=arguments.length>1?arguments[1]:null,i=0;i<n;i++)if(a){if(r(e,a,t[i],i,t))return i}else if(e(t[i],i,t))return i;return-1},keys:function(){return new t(this,"key")},values:function(){return new t(this,"value")},entries:function(){return new t(this,"entry")}};if(Array.prototype.keys&&!ye.IsCallable([1].keys().next)&&delete Array.prototype.keys,Array.prototype.entries&&!ye.IsCallable([1].entries().next)&&delete Array.prototype.entries,Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ue]&&(m(Array.prototype,{values:Array.prototype[ue]}),oe(Y.unscopables)&&(Array.prototype[Y.unscopables].values=!0)),l&&Array.prototype.values&&"values"!==Array.prototype.values.name){var Ye=Array.prototype.values;se(Array.prototype,"values",function(){return ye.Call(Ye,this,arguments)}),y(Array.prototype,ue,Array.prototype.values,!0)}m(Array.prototype,Xe),1/[!0].indexOf(!0,-0)<0&&y(Array.prototype,"indexOf",function(e){var t=E(this,arguments);return 0===t&&1/t<0?0:t},!0),_e(Array.prototype,function(){return this.values()}),Object.getPrototypeOf&&_e(Object.getPrototypeOf([].values()));var Je,Ke=s(function(){return 0===Array.from({length:-1}).length}),Ze=1===(Je=Array.from([0].entries())).length&&a(Je[0])&&0===Je[0][0]&&0===Je[0][1];if(Ke&&Ze||se(Array,"from",Ge.from),!s(function(){return Array.from([0],void 0)})){var Qe=Array.from;se(Array,"from",function(e){return arguments.length>1&&void 0!==arguments[1]?ye.Call(Qe,this,arguments):r(Qe,this,e)})}var et=-(Math.pow(2,32)-1),tt=function(e,t){var n={length:et};return n[t?(n.length>>>0)-1:0]=!0,s(function(){return r(e,n,function(){throw new RangeError("should not reach here")},[]),!0})};if(!tt(Array.prototype.forEach)){var nt=Array.prototype.forEach;se(Array.prototype,"forEach",function(e){return ye.Call(nt,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.map)){var rt=Array.prototype.map;se(Array.prototype,"map",function(e){return ye.Call(rt,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.filter)){var at=Array.prototype.filter;se(Array.prototype,"filter",function(e){return ye.Call(at,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.some)){var it=Array.prototype.some;se(Array.prototype,"some",function(e){return ye.Call(it,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.every)){var ot=Array.prototype.every;se(Array.prototype,"every",function(e){return ye.Call(ot,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.reduce)){var st=Array.prototype.reduce;se(Array.prototype,"reduce",function(e){return ye.Call(st,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.reduceRight,!0)){var ct=Array.prototype.reduceRight;se(Array.prototype,"reduceRight",function(e){return ye.Call(ct,this.length>=0?this:[],arguments)})}var ut=8!==Number("0o10"),lt=2!==Number("0b10"),pt=h(He,function(e){return 0===Number(e+0+e)});if(ut||lt||pt){var ft=Number,dt=/^0b[01]+$/i,ht=/^0o[0-7]+$/i,yt=dt.test.bind(dt),mt=ht.test.bind(ht),gt=ze.test.bind(ze),vt=$e.test.bind($e),bt=function(){var e=function(t){var n;"string"==typeof(n=arguments.length>0?re(t)?t:function(e){var t;if("function"==typeof e.valueOf&&(t=e.valueOf(),re(t)))return t;if("function"==typeof e.toString&&(t=e.toString(),re(t)))return t;throw new TypeError("No default value")}(t):0)&&(n=ye.Call(Ve,n),yt(n)?n=parseInt(N(n,2),2):mt(n)?n=parseInt(N(n,2),8):(gt(n)||vt(n))&&(n=NaN));var r=this,a=s(function(){return ft.prototype.valueOf.call(r),!0});return r instanceof e&&!a?new ft(n):ft(n)};return e}();Ae(ft,bt,{}),m(bt,{NaN:ft.NaN,MAX_VALUE:ft.MAX_VALUE,MIN_VALUE:ft.MIN_VALUE,NEGATIVE_INFINITY:ft.NEGATIVE_INFINITY,POSITIVE_INFINITY:ft.POSITIVE_INFINITY}),Number=bt,T(j,"Number",bt)}var wt=Math.pow(2,53)-1;m(Number,{MAX_SAFE_INTEGER:wt,MIN_SAFE_INTEGER:-wt,EPSILON:2.220446049250313e-16,parseInt:j.parseInt,parseFloat:j.parseFloat,isFinite:Z,isInteger:function(e){return Z(e)&&ye.ToInteger(e)===e},isSafeInteger:function(e){return Number.isInteger(e)&&q(e)<=Number.MAX_SAFE_INTEGER},isNaN:K}),y(Number,"parseInt",j.parseInt,Number.parseInt!==j.parseInt),1===[,1].find(function(){return!0})&&se(Array.prototype,"find",Xe.find),0!==[,1].findIndex(function(){return!0})&&se(Array.prototype,"findIndex",Xe.findIndex);var Tt,St,xt,kt=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),Ot=function(e,t){u&&kt(e,t)&&Object.defineProperty(e,t,{enumerable:!1})},jt=function(){for(var e=Number(this),t=arguments.length,n=t-e,r=new Array(n<0?0:n),a=e;a<t;++a)r[a-e]=arguments[a];return r},At=function(e){return function(t,n){return t[n]=e[n],t}},Ct=function(e,t){var n,r=i(Object(t));return ye.IsCallable(Object.getOwnPropertySymbols)&&(n=d(Object.getOwnPropertySymbols(Object(t)),kt(t))),f(_(r,n||[]),At(t),e)},Et={assign:function(e,t){var n=ye.ToObject(e,"Cannot convert undefined or null to object");return f(ye.Call(jt,1,arguments),Ct,n)},is:function(e,t){return ye.SameValue(e,t)}};if(Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}}()&&se(Object,"assign",Et.assign),m(Object,Et),u){var _t={setPrototypeOf:function(e,t){var n,a=function(e,t){return function(e,t){if(!ye.TypeIsObject(e))throw new TypeError("cannot set prototype on a non-object");if(null!==t&&!ye.TypeIsObject(t))throw new TypeError("can only set prototype to an object or null"+t)}(e,t),r(n,e,t),e};try{n=e.getOwnPropertyDescriptor(e.prototype,"__proto__").set,r(n,{},null)}catch(t){if(e.prototype!=={}.__proto__)return;n=function(e){this.__proto__=e},a.polyfill=a(a({},null),e.prototype)instanceof e}return a}(Object)};m(Object,_t)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&(Tt=Object.create(null),St=Object.getPrototypeOf,xt=Object.setPrototypeOf,Object.getPrototypeOf=function(e){var t=St(e);return t===Tt?null:t},Object.setPrototypeOf=function(e,t){return xt(e,null===t?Tt:t)},Object.setPrototypeOf.polyfill=!1),!!o(function(){return Object.keys("foo")})){var Nt=Object.keys;se(Object,"keys",function(e){return Nt(ye.ToObject(e))}),i=Object.keys}if(o(function(){return Object.keys(/a/g)})){var Pt=Object.keys;se(Object,"keys",function(e){if(ie(e)){var t=[];for(var n in e)z(e,n)&&P(t,n);return t}return Pt(e)}),i=Object.keys}if(Object.getOwnPropertyNames&&!!o(function(){return Object.getOwnPropertyNames("foo")})){var It="object"===("undefined"==typeof window?"undefined":_typeof(window))?Object.getOwnPropertyNames(window):[],Mt=Object.getOwnPropertyNames;se(Object,"getOwnPropertyNames",function(e){var t=ye.ToObject(e);if("[object Window]"===g(t))try{return Mt(t)}catch(e){return _([],It)}return Mt(t)})}if(Object.getOwnPropertyDescriptor&&!!o(function(){return Object.getOwnPropertyDescriptor("foo","bar")})){var Dt=Object.getOwnPropertyDescriptor;se(Object,"getOwnPropertyDescriptor",function(e,t){return Dt(ye.ToObject(e),t)})}if(Object.seal&&!!o(function(){return Object.seal("foo")})){var Rt=Object.seal;se(Object,"seal",function(e){return ye.TypeIsObject(e)?Rt(e):e})}if(Object.isSealed&&!!o(function(){return Object.isSealed("foo")})){var Lt=Object.isSealed;se(Object,"isSealed",function(e){return!ye.TypeIsObject(e)||Lt(e)})}if(Object.freeze&&!!o(function(){return Object.freeze("foo")})){var qt=Object.freeze;se(Object,"freeze",function(e){return ye.TypeIsObject(e)?qt(e):e})}if(Object.isFrozen&&!!o(function(){return Object.isFrozen("foo")})){var Ft=Object.isFrozen;se(Object,"isFrozen",function(e){return!ye.TypeIsObject(e)||Ft(e)})}if(Object.preventExtensions&&!!o(function(){return Object.preventExtensions("foo")})){var Vt=Object.preventExtensions;se(Object,"preventExtensions",function(e){return ye.TypeIsObject(e)?Vt(e):e})}if(Object.isExtensible&&!!o(function(){return Object.isExtensible("foo")})){var Ht=Object.isExtensible;se(Object,"isExtensible",function(e){return!!ye.TypeIsObject(e)&&Ht(e)})}if(Object.getPrototypeOf&&!!o(function(){return Object.getPrototypeOf("foo")})){var zt=Object.getPrototypeOf;se(Object,"getPrototypeOf",function(e){return zt(ye.ToObject(e))})}var $t,Bt=u&&(($t=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags"))&&ye.IsCallable($t.get));if(u&&!Bt){b(RegExp.prototype,"flags",function(){if(!ye.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");var e="";return this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e})}var Wt,Ut=u&&s(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),Gt=ce&&u&&((Wt=/./)[Y.match]=!1,RegExp(Wt)===Wt),Xt=s(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),Yt=Xt&&s(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!Xt||!Yt){var Jt=RegExp.prototype.toString;y(RegExp.prototype,"toString",function(){var e=ye.RequireObjectCoercible(this);return ie(e)?r(Jt,e):"/"+fe(e.source)+"/"+fe(e.flags)},!0),x(RegExp.prototype.toString,Jt)}if(u&&(!Ut||Gt)){var Kt=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,Zt=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},Qt=ye.IsCallable(Zt.get)?Zt.get:function(){return this.source},en=RegExp,tn=function e(t,n){var r=ye.IsRegExp(t);return this instanceof e||!r||void 0!==n||t.constructor!==e?ie(t)?new e(ye.Call(Qt,t),void 0===n?ye.Call(Kt,t):n):(r&&(t.source,void 0===n&&t.flags),new en(t,n)):t};Ae(en,tn,{$input:!0}),RegExp=tn,T(j,"RegExp",tn)}if(u){var nn={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};p(i(nn),function(e){e in RegExp&&!(nn[e]in RegExp)&&b(RegExp,nn[e],function(){return RegExp[e]})})}Ee(RegExp);var rn=1/Number.EPSILON,an=Math.pow(2,-23),on=Math.pow(2,127)*(2-an),sn=Math.pow(2,-126),cn=Math.E,un=Math.LOG2E,ln=Math.LOG10E,pn=Number.prototype.clz;delete Number.prototype.clz;var fn={acosh:function(e){var t=Number(e);if(K(t)||e<1)return NaN;if(1===t)return 0;if(t===1/0)return t;var n=1/(t*t);if(t<2)return ee(t-1+H(1-n)*t);var r=t/2;return ee(r+H(1-n)*r-1)+1/un},asinh:function(e){var t=Number(e);if(0===t||!A(t))return t;var n=q(t),r=n*n,a=Q(t);return n<1?a*ee(n+r/(H(r+1)+1)):a*(ee(n/2+H(1+1/r)*n/2-1)+1/un)},atanh:function(e){var t=Number(e);if(0===t)return t;if(-1===t)return-1/0;if(1===t)return 1/0;if(K(t)||t<-1||t>1)return NaN;var n=q(t);return Q(t)*ee(2*n/(1-n))/2},cbrt:function(e){var t=Number(e);if(0===t)return t;var n,r=t<0;return r&&(t=-t),n=t===1/0?1/0:(t/((n=F(V(t)/3))*n)+2*n)/3,r?-n:n},clz32:function(e){var t=Number(e),n=ye.ToUint32(t);return 0===n?32:pn?ye.Call(pn,n):31-L(V(n+.5)*un)},cosh:function(e){var t=Number(e);if(0===t)return 1;if(K(t))return NaN;if(!A(t))return 1/0;var n=F(q(t)-1);return(n+1/(n*cn*cn))*(cn/2)},expm1:function(e){var t=Number(e);if(t===-1/0)return-1;if(!A(t)||0===t)return t;if(q(t)>.5)return F(t)-1;for(var n=t,r=0,a=1;r+n!==r;)r+=n,n*=t/(a+=1);return r},hypot:function(e,t){for(var n=0,r=0,a=0;a<arguments.length;++a){var i=q(Number(arguments[a]));r<i?(n*=r/i*(r/i),n+=1,r=i):n+=i>0?i/r*(i/r):i}return r===1/0?1/0:r*H(n)},log2:function(e){return V(e)*un},log10:function(e){return V(e)*ln},log1p:ee,sign:Q,sinh:function(e){var t=Number(e);if(!A(t)||0===t)return t;var n=q(t);if(n<1){var r=Math.expm1(n);return Q(t)*r*(1+1/(r+1))/2}var a=F(n-1);return Q(t)*(a-1/(a*cn*cn))*(cn/2)},tanh:function(e){var t=Number(e);return K(t)||0===t?t:t>=20?1:t<=-20?-1:(Math.expm1(t)-Math.expm1(-t))/(F(t)+F(-t))},trunc:function(e){var t=Number(e);return t<0?-L(-t):L(t)},imul:function(e,t){var n=ye.ToUint32(e),r=ye.ToUint32(t),a=65535&n,i=65535&r;return a*i+((n>>>16&65535)*i+a*(r>>>16&65535)<<16>>>0)|0},fround:function(e){var t=Number(e);if(0===t||t===1/0||t===-1/0||K(t))return t;var n=Q(t),r=q(t);if(r<sn)return n*(r/sn/an+rn-rn)*sn*an;var a=(1+an/Number.EPSILON)*r,i=a-(a-r);return i>on||K(i)?n*(1/0):n*i}},dn=function(e,t,n){return q(1-e/t)/Number.EPSILON<(n||8)};m(Math,fn),y(Math,"sinh",fn.sinh,Math.sinh(710)===1/0),y(Math,"cosh",fn.cosh,Math.cosh(710)===1/0),y(Math,"log1p",fn.log1p,-1e-17!==Math.log1p(-1e-17)),y(Math,"asinh",fn.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7)),y(Math,"asinh",fn.asinh,Math.asinh(1e300)===1/0),y(Math,"atanh",fn.atanh,0===Math.atanh(1e-300)),y(Math,"tanh",fn.tanh,-2e-17!==Math.tanh(-2e-17)),y(Math,"acosh",fn.acosh,Math.acosh(Number.MAX_VALUE)===1/0),y(Math,"acosh",fn.acosh,!dn(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON))),y(Math,"cbrt",fn.cbrt,!dn(Math.cbrt(1e-300),1e-100)),y(Math,"sinh",fn.sinh,-2e-17!==Math.sinh(-2e-17));var hn=Math.expm1(10);y(Math,"expm1",fn.expm1,hn>22025.465794806718||hn<22025.465794806718);var yn=Math.round,mn=0===Math.round(.5-Number.EPSILON/4)&&1===Math.round(Number.EPSILON/3.99-.5),gn=[rn+1,2*rn-1].every(function(e){return Math.round(e)===e});y(Math,"round",function(e){var t=L(e);return e-t<.5?t:-1===t?-0:t+1},!mn||!gn),x(Math.round,yn);var vn=Math.imul;-5!==Math.imul(4294967295,5)&&(Math.imul=fn.imul,x(Math.imul,vn)),2!==Math.imul.length&&se(Math,"imul",function(e,t){return ye.Call(vn,Math,arguments)});var bn,wn,Tn=function(){var e=j.setTimeout;if("function"==typeof e||"object"===(void 0===e?"undefined":_typeof(e))){ye.IsPromise=function(e){return!!ye.TypeIsObject(e)&&void 0!==e._promise};var t,n=function(e){if(!ye.IsConstructor(e))throw new TypeError("Bad promise constructor");var t=this;if(t.resolve=void 0,t.reject=void 0,t.promise=new e(function(e,n){if(void 0!==t.resolve||void 0!==t.reject)throw new TypeError("Bad Promise implementation!");t.resolve=e,t.reject=n}),!ye.IsCallable(t.resolve)||!ye.IsCallable(t.reject))throw new TypeError("Bad promise constructor")};"undefined"!=typeof window&&ye.IsCallable(window.postMessage)&&(t=function(){var e=[];return window.addEventListener("message",function(t){if(t.source===window&&"zero-timeout-message"===t.data){if(t.stopPropagation(),0===e.length)return;M(e)()}},!0),function(t){P(e,t),window.postMessage("zero-timeout-message","*")}});var a,i,o,s,c,u=ye.IsCallable(j.setImmediate)?j.setImmediate:"object"===("undefined"==typeof process?"undefined":_typeof(process))&&process.nextTick?process.nextTick:(a=j.Promise,(i=a&&a.resolve&&a.resolve())&&function(e){return i.then(e)}||(ye.IsCallable(t)?t():function(t){e(t,0)})),l=function(e){return e},p=function(e){throw e},f={},d=function(e,t,n){u(function(){h(e,t,n)})},h=function(e,t,n){var r,a;if(t===f)return e(n);try{r=e(n),a=t.resolve}catch(e){r=e,a=t.reject}a(r)},y=function(e,t){var n=e._promise,r=n.reactionLength;if(r>0&&(d(n.fulfillReactionHandler0,n.reactionCapability0,t),n.fulfillReactionHandler0=void 0,n.rejectReactions0=void 0,n.reactionCapability0=void 0,r>1))for(var a=1,i=0;a<r;a++,i+=3)d(n[i+0],n[i+2],t),e[i+0]=void 0,e[i+1]=void 0,e[i+2]=void 0;n.result=t,n.state=1,n.reactionLength=0},g=function(e,t){var n=e._promise,r=n.reactionLength;if(r>0&&(d(n.rejectReactionHandler0,n.reactionCapability0,t),n.fulfillReactionHandler0=void 0,n.rejectReactions0=void 0,n.reactionCapability0=void 0,r>1))for(var a=1,i=0;a<r;a++,i+=3)d(n[i+1],n[i+2],t),e[i+0]=void 0,e[i+1]=void 0,e[i+2]=void 0;n.result=t,n.state=2,n.reactionLength=0},v=function(e){var t=!1;return{resolve:function(n){var r;if(!t){if(t=!0,n===e)return g(e,new TypeError("Self resolution"));if(!ye.TypeIsObject(n))return y(e,n);try{r=n.then}catch(t){return g(e,t)}if(!ye.IsCallable(r))return y(e,n);u(function(){w(e,n,r)})}},reject:function(n){if(!t)return t=!0,g(e,n)}}},b=function(e,t,n,a){e===s?r(e,t,n,a,f):r(e,t,n,a)},w=function(e,t,n){var r=v(e),a=r.resolve,i=r.reject;try{b(n,t,a,i)}catch(e){i(e)}},T=c=function(e){if(!(this instanceof c))throw new TypeError('Constructor Promise requires "new"');if(this&&this._promise)throw new TypeError("Bad construction");if(!ye.IsCallable(e))throw new TypeError("not a valid resolver");var t=Pe(this,c,o,{_promise:{result:void 0,state:0,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),n=v(t),r=n.reject;try{e(n.resolve,r)}catch(e){r(e)}return t};o=T.prototype;var S=function(e,t,n,r){var a=!1;return function(i){a||(a=!0,t[e]=i,0==--r.count&&(0,n.resolve)(t))}};return m(T,{all:function(e){var t=this;if(!ye.TypeIsObject(t))throw new TypeError("Promise is not object");var r,a,i=new n(t);try{return function(e,t,n){for(var r,a,i=e.iterator,o=[],s={count:1},c=0;;){try{if(!1===(r=ye.IteratorStep(i))){e.done=!0;break}a=r.value}catch(t){throw e.done=!0,t}o[c]=void 0;var u=t.resolve(a),l=S(c,o,n,s);s.count+=1,b(u.then,u,l,n.reject),c+=1}0==--s.count&&(0,n.resolve)(o);return n.promise}(a={iterator:r=ye.GetIterator(e),done:!1},t,i)}catch(e){var o=e;if(a&&!a.done)try{ye.IteratorClose(r,!0)}catch(e){o=e}return(0,i.reject)(o),i.promise}},race:function(e){var t=this;if(!ye.TypeIsObject(t))throw new TypeError("Promise is not object");var r,a,i=new n(t);try{return function(e,t,n){for(var r,a,i,o=e.iterator;;){try{if(!1===(r=ye.IteratorStep(o))){e.done=!0;break}a=r.value}catch(t){throw e.done=!0,t}i=t.resolve(a),b(i.then,i,n.resolve,n.reject)}return n.promise}(a={iterator:r=ye.GetIterator(e),done:!1},t,i)}catch(e){var o=e;if(a&&!a.done)try{ye.IteratorClose(r,!0)}catch(e){o=e}return(0,i.reject)(o),i.promise}},reject:function(e){if(!ye.TypeIsObject(this))throw new TypeError("Bad promise constructor");var t=new n(this);return(0,t.reject)(e),t.promise},resolve:function(e){var t=this;if(!ye.TypeIsObject(t))throw new TypeError("Bad promise constructor");if(ye.IsPromise(e)&&e.constructor===t)return e;var r=new n(t);return(0,r.resolve)(e),r.promise}}),m(o,{catch:function(e){return this.then(null,e)},then:function(e,t){if(!ye.IsPromise(this))throw new TypeError("not a promise");var r,a=ye.SpeciesConstructor(this,T);r=arguments.length>2&&arguments[2]===f&&a===T?f:new n(a);var i,o=ye.IsCallable(e)?e:l,s=ye.IsCallable(t)?t:p,c=this._promise;if(0===c.state){if(0===c.reactionLength)c.fulfillReactionHandler0=o,c.rejectReactionHandler0=s,c.reactionCapability0=r;else{var u=3*(c.reactionLength-1);c[u+0]=o,c[u+1]=s,c[u+2]=r}c.reactionLength+=1}else if(1===c.state)i=c.result,d(o,r,i);else{if(2!==c.state)throw new TypeError("unexpected Promise state");i=c.result,d(s,r,i)}return r.promise}}),f=new n(T),s=o.then,T}}();if(j.Promise&&(delete j.Promise.accept,delete j.Promise.defer,delete j.Promise.prototype.chain),"function"==typeof Tn){m(j,{Promise:Tn});var Sn=O(j.Promise,function(e){return e.resolve(42).then(function(){})instanceof e}),xn=!o(function(){return j.Promise.reject(42).then(null,5).then(null,$)}),kn=o(function(){return j.Promise.call(3,$)}),On=function(e){var t=e.resolve(5);t.constructor={};var n=e.resolve(t);try{n.then(null,$).then(null,$)}catch(e){return!0}return t===n}(j.Promise),jn=u&&(bn=0,wn=Object.defineProperty({},"then",{get:function(){bn+=1}}),Promise.resolve(wn),1===bn),An=function e(t){var n=new Promise(t);t(3,function(){}),this.then=n.then,this.constructor=e};An.prototype=Promise.prototype,An.all=Promise.all;var Cn=s(function(){return!!An.all([1,2])});if(Sn&&xn&&kn&&!On&&jn&&!Cn||(Promise=Tn,se(j,"Promise",Tn)),1!==Promise.all.length){var En=Promise.all;se(Promise,"all",function(e){return ye.Call(En,this,arguments)})}if(1!==Promise.race.length){var _n=Promise.race;se(Promise,"race",function(e){return ye.Call(_n,this,arguments)})}if(1!==Promise.resolve.length){var Nn=Promise.resolve;se(Promise,"resolve",function(e){return ye.Call(Nn,this,arguments)})}if(1!==Promise.reject.length){var Pn=Promise.reject;se(Promise,"reject",function(e){return ye.Call(Pn,this,arguments)})}Ot(Promise,"all"),Ot(Promise,"race"),Ot(Promise,"resolve"),Ot(Promise,"reject"),Ee(Promise)}var In,Mn,Dn=function(e){var t=i(f(e,function(e,t){return e[t]=!0,e},{}));return e.join(":")===t.join(":")},Rn=Dn(["z","a","bb"]),Ln=Dn(["z",1,"a","3",2]);if(u){var qn=function(e,t){return t||Rn?he(e)?"^"+ye.ToString(e):"string"==typeof e?"$"+e:"number"==typeof e?Ln?e:"n"+e:"boolean"==typeof e?"b"+e:null:null},Fn=function(){return Object.create?Object.create(null):{}},Vn=function(e,t,n){if(a(n)||ae(n))p(n,function(e){if(!ye.TypeIsObject(e))throw new TypeError("Iterator value "+e+" is not an entry object");t.set(e[0],e[1])});else if(n instanceof e)r(e.prototype.forEach,n,function(e,n){t.set(n,e)});else{var i,o;if(!he(n)){if(o=t.set,!ye.IsCallable(o))throw new TypeError("bad map");i=ye.GetIterator(n)}if(void 0!==i)for(;;){var s=ye.IteratorStep(i);if(!1===s)break;var c=s.value;try{if(!ye.TypeIsObject(c))throw new TypeError("Iterator value "+c+" is not an entry object");r(o,t,c[0],c[1])}catch(e){throw ye.IteratorClose(i,!0),e}}}},Hn=function(e,t,n){if(a(n)||ae(n))p(n,function(e){t.add(e)});else if(n instanceof e)r(e.prototype.forEach,n,function(e){t.add(e)});else{var i,o;if(!he(n)){if(o=t.add,!ye.IsCallable(o))throw new TypeError("bad set");i=ye.GetIterator(n)}if(void 0!==i)for(;;){var s=ye.IteratorStep(i);if(!1===s)break;var c=s.value;try{r(o,t,c)}catch(e){throw ye.IteratorClose(i,!0),e}}}},zn={Map:function(){var e={},t=function(e,t){this.key=e,this.value=t,this.next=null,this.prev=null};t.prototype.isRemoved=function(){return this.key===e};var n,a=function(e,t){if(!ye.TypeIsObject(e)||!function(e){return!!e._es6map}(e))throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+ye.ToString(e))},i=function(e,t){a(e,"[[MapIterator]]"),this.head=e._head,this.i=this.head,this.kind=t};_e(i.prototype={isMapIterator:!0,next:function(){if(!this.isMapIterator)throw new TypeError("Not a MapIterator");var e,t=this.i,n=this.kind,r=this.head;if(void 0===this.i)return We();for(;t.isRemoved()&&t!==r;)t=t.prev;for(;t.next!==r;)if(!(t=t.next).isRemoved())return e="key"===n?t.key:"value"===n?t.value:[t.key,t.value],this.i=t,We(e);return this.i=void 0,We()}});var o=function e(){if(!(this instanceof e))throw new TypeError('Constructor Map requires "new"');if(this&&this._es6map)throw new TypeError("Bad construction");var r=Pe(this,e,n,{_es6map:!0,_head:null,_map:B?new B:null,_size:0,_storage:Fn()}),a=new t(null,null);return a.next=a.prev=a,r._head=a,arguments.length>0&&Vn(e,r,arguments[0]),r};return b(n=o.prototype,"size",function(){if(void 0===this._size)throw new TypeError("size method called on incompatible Map");return this._size}),m(n,{get:function(e){var t;a(this,"get");var n=qn(e,!0);if(null!==n)return(t=this._storage[n])?t.value:void 0;if(this._map)return(t=U.call(this._map,e))?t.value:void 0;for(var r=this._head,i=r;(i=i.next)!==r;)if(ye.SameValueZero(i.key,e))return i.value},has:function(e){a(this,"has");var t=qn(e,!0);if(null!==t)return void 0!==this._storage[t];if(this._map)return G.call(this._map,e);for(var n=this._head,r=n;(r=r.next)!==n;)if(ye.SameValueZero(r.key,e))return!0;return!1},set:function(e,n){a(this,"set");var r,i=this._head,o=i,s=qn(e,!0);if(null!==s){if(void 0!==this._storage[s])return this._storage[s].value=n,this;r=this._storage[s]=new t(e,n),o=i.prev}else this._map&&(G.call(this._map,e)?U.call(this._map,e).value=n:(r=new t(e,n),X.call(this._map,e,r),o=i.prev));for(;(o=o.next)!==i;)if(ye.SameValueZero(o.key,e))return o.value=n,this;return r=r||new t(e,n),ye.SameValue(-0,e)&&(r.key=0),r.next=this._head,r.prev=this._head.prev,r.prev.next=r,r.next.prev=r,this._size+=1,this},delete:function(t){a(this,"delete");var n=this._head,r=n,i=qn(t,!0);if(null!==i){if(void 0===this._storage[i])return!1;r=this._storage[i].prev,delete this._storage[i]}else if(this._map){if(!G.call(this._map,t))return!1;r=U.call(this._map,t).prev,W.call(this._map,t)}for(;(r=r.next)!==n;)if(ye.SameValueZero(r.key,t))return r.key=e,r.value=e,r.prev.next=r.next,r.next.prev=r.prev,this._size-=1,!0;return!1},clear:function(){a(this,"clear"),this._map=B?new B:null,this._size=0,this._storage=Fn();for(var t=this._head,n=t,r=n.next;(n=r)!==t;)n.key=e,n.value=e,r=n.next,n.next=n.prev=t;t.next=t.prev=t},keys:function(){return a(this,"keys"),new i(this,"key")},values:function(){return a(this,"values"),new i(this,"value")},entries:function(){return a(this,"entries"),new i(this,"key+value")},forEach:function(e){a(this,"forEach");for(var t=arguments.length>1?arguments[1]:null,n=this.entries(),i=n.next();!i.done;i=n.next())t?r(e,t,i.value[1],i.value[0],this):e(i.value[1],i.value[0],this)}}),_e(n,n.entries),o}(),Set:function(){var e,t=function(e,t){if(!ye.TypeIsObject(e)||!function(e){return e._es6set&&void 0!==e._storage}(e))throw new TypeError("Set.prototype."+t+" called on incompatible receiver "+ye.ToString(e))},n=function t(){if(!(this instanceof t))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var n=Pe(this,t,e,{_es6set:!0,"[[SetData]]":null,_storage:Fn()});if(!n._es6set)throw new TypeError("bad set");return arguments.length>0&&Hn(t,n,arguments[0]),n};e=n.prototype;var a=function(e){if(!e["[[SetData]]"]){var t=new zn.Map;e["[[SetData]]"]=t,p(i(e._storage),function(e){var n=function(e){var t=e;if("^null"===t)return null;if("^undefined"!==t){var n=t.charAt(0);return"$"===n?N(t,1):"n"===n?+N(t,1):"b"===n?"btrue"===t:+t}}(e);t.set(n,n)}),e["[[SetData]]"]=t}e._storage=null};b(n.prototype,"size",function(){return t(this,"size"),this._storage?i(this._storage).length:(a(this),this["[[SetData]]"].size)}),m(n.prototype,{has:function(e){var n;return t(this,"has"),this._storage&&null!==(n=qn(e))?!!this._storage[n]:(a(this),this["[[SetData]]"].has(e))},add:function(e){var n;return t(this,"add"),this._storage&&null!==(n=qn(e))?(this._storage[n]=!0,this):(a(this),this["[[SetData]]"].set(e,e),this)},delete:function(e){var n;if(t(this,"delete"),this._storage&&null!==(n=qn(e))){var r=z(this._storage,n);return delete this._storage[n]&&r}return a(this),this["[[SetData]]"].delete(e)},clear:function(){t(this,"clear"),this._storage&&(this._storage=Fn()),this["[[SetData]]"]&&this["[[SetData]]"].clear()},values:function(){return t(this,"values"),a(this),new o(this["[[SetData]]"].values())},entries:function(){return t(this,"entries"),a(this),new o(this["[[SetData]]"].entries())},forEach:function(e){t(this,"forEach");var n=arguments.length>1?arguments[1]:null,i=this;a(i),this["[[SetData]]"].forEach(function(t,a){n?r(e,n,a,a,i):e(a,a,i)})}}),y(n.prototype,"keys",n.prototype.values,!0),_e(n.prototype,n.prototype.values);var o=function(e){this.it=e};return o.prototype={isSetIterator:!0,next:function(){if(!this.isSetIterator)throw new TypeError("Not a SetIterator");return this.it.next()}},_e(o.prototype),n}()};if(j.Set&&!Set.prototype.delete&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys)&&(j.Set=zn.Set),j.Map||j.Set){s(function(){return 2===new Map([[1,2]]).get(1)})||(j.Map=function e(){if(!(this instanceof e))throw new TypeError('Constructor Map requires "new"');var t=new B;return arguments.length>0&&Vn(e,t,arguments[0]),delete t.constructor,Object.setPrototypeOf(t,j.Map.prototype),t},j.Map.prototype=k(B.prototype),y(j.Map.prototype,"constructor",j.Map,!0),x(j.Map,B));var $n=new Map,Bn=((Mn=new Map([[1,0],[2,0],[3,0],[4,0]])).set(-0,Mn),Mn.get(0)===Mn&&Mn.get(-0)===Mn&&Mn.has(0)&&Mn.has(-0)),Wn=$n.set(1,2)===$n;Bn&&Wn||se(Map.prototype,"set",function(e,t){return r(X,this,0===e?0:e,t),this}),Bn||(m(Map.prototype,{get:function(e){return r(U,this,0===e?0:e)},has:function(e){return r(G,this,0===e?0:e)}},!0),x(Map.prototype.get,U),x(Map.prototype.has,G));var Un=new Set,Gn=Set.prototype.delete&&Set.prototype.add&&Set.prototype.has&&((In=Un).delete(0),In.add(-0),!In.has(0)),Xn=Un.add(1)===Un;if(!Gn||!Xn){var Yn=Set.prototype.add;Set.prototype.add=function(e){return r(Yn,this,0===e?0:e),this},x(Set.prototype.add,Yn)}if(!Gn){var Jn=Set.prototype.has;Set.prototype.has=function(e){return r(Jn,this,0===e?0:e)},x(Set.prototype.has,Jn);var Kn=Set.prototype.delete;Set.prototype.delete=function(e){return r(Kn,this,0===e?0:e)},x(Set.prototype.delete,Kn)}var Zn=O(j.Map,function(e){var t=new e([]);return t.set(42,42),t instanceof e}),Qn=Object.setPrototypeOf&&!Zn,er=function(){try{return!(j.Map()instanceof j.Map)}catch(e){return e instanceof TypeError}}();0===j.Map.length&&!Qn&&er||(j.Map=function e(){if(!(this instanceof e))throw new TypeError('Constructor Map requires "new"');var t=new B;return arguments.length>0&&Vn(e,t,arguments[0]),delete t.constructor,Object.setPrototypeOf(t,e.prototype),t},j.Map.prototype=B.prototype,y(j.Map.prototype,"constructor",j.Map,!0),x(j.Map,B));var tr=O(j.Set,function(e){var t=new e([]);return t.add(42,42),t instanceof e}),nr=Object.setPrototypeOf&&!tr,rr=function(){try{return!(j.Set()instanceof j.Set)}catch(e){return e instanceof TypeError}}();if(0!==j.Set.length||nr||!rr){var ar=j.Set;j.Set=function e(){if(!(this instanceof e))throw new TypeError('Constructor Set requires "new"');var t=new ar;return arguments.length>0&&Hn(e,t,arguments[0]),delete t.constructor,Object.setPrototypeOf(t,e.prototype),t},j.Set.prototype=ar.prototype,y(j.Set.prototype,"constructor",j.Set,!0),x(j.Set,ar)}var ir=new j.Map,or=!s(function(){return ir.keys().next().done});if(("function"!=typeof j.Map.prototype.clear||0!==(new j.Set).size||0!==ir.size||"function"!=typeof j.Map.prototype.keys||"function"!=typeof j.Set.prototype.keys||"function"!=typeof j.Map.prototype.forEach||"function"!=typeof j.Set.prototype.forEach||c(j.Map)||c(j.Set)||"function"!=typeof ir.keys().next||or||!Zn)&&m(j,{Map:zn.Map,Set:zn.Set},!0),j.Set.prototype.keys!==j.Set.prototype.values&&y(j.Set.prototype,"keys",j.Set.prototype.values,!0),_e(Object.getPrototypeOf((new j.Map).keys())),_e(Object.getPrototypeOf((new j.Set).keys())),l&&"has"!==j.Set.prototype.has.name){var sr=j.Set.prototype.has;se(j.Set.prototype,"has",function(e){return r(sr,this,e)})}}m(j,zn),Ee(j.Map),Ee(j.Set)}var cr=function(e){if(!ye.TypeIsObject(e))throw new TypeError("target must be an object")},ur={apply:function(){return ye.Call(ye.Call,null,arguments)},construct:function(e,t){if(!ye.IsConstructor(e))throw new TypeError("First argument must be a constructor.");var n=arguments.length>2?arguments[2]:e;if(!ye.IsConstructor(n))throw new TypeError("new.target must be a constructor.");return ye.Construct(e,t,n,"internal")},deleteProperty:function(e,t){if(cr(e),u){var n=Object.getOwnPropertyDescriptor(e,t);if(n&&!n.configurable)return!1}return delete e[t]},has:function(e,t){return cr(e),t in e}};Object.getOwnPropertyNames&&Object.assign(ur,{ownKeys:function(e){cr(e);var t=Object.getOwnPropertyNames(e);return ye.IsCallable(Object.getOwnPropertySymbols)&&I(t,Object.getOwnPropertySymbols(e)),t}});var lr=function(e){return!o(e)};if(Object.preventExtensions&&Object.assign(ur,{isExtensible:function(e){return cr(e),Object.isExtensible(e)},preventExtensions:function(e){return cr(e),lr(function(){return Object.preventExtensions(e)})}}),u){var pr=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(!r){var a=Object.getPrototypeOf(e);if(null===a)return;return pr(a,t,n)}return"value"in r?r.value:r.get?ye.Call(r.get,n):void 0},fr=function(e,t,n,a){var i=Object.getOwnPropertyDescriptor(e,t);if(!i){var o=Object.getPrototypeOf(e);if(null!==o)return fr(o,t,n,a);i={value:void 0,writable:!0,enumerable:!0,configurable:!0}}return"value"in i?!!i.writable&&(!!ye.TypeIsObject(a)&&(Object.getOwnPropertyDescriptor(a,t)?pe.defineProperty(a,t,{value:n}):pe.defineProperty(a,t,{value:n,writable:!0,enumerable:!0,configurable:!0}))):!!i.set&&(r(i.set,a,n),!0)};Object.assign(ur,{defineProperty:function(e,t,n){return cr(e),lr(function(){return Object.defineProperty(e,t,n)})},getOwnPropertyDescriptor:function(e,t){return cr(e),Object.getOwnPropertyDescriptor(e,t)},get:function(e,t){cr(e);var n=arguments.length>2?arguments[2]:e;return pr(e,t,n)},set:function(e,t,n){cr(e);var r=arguments.length>3?arguments[3]:e;return fr(e,t,n,r)}})}if(Object.getPrototypeOf){var dr=Object.getPrototypeOf;ur.getPrototypeOf=function(e){return cr(e),dr(e)}}if(Object.setPrototypeOf&&ur.getPrototypeOf){Object.assign(ur,{setPrototypeOf:function(e,t){if(cr(e),null!==t&&!ye.TypeIsObject(t))throw new TypeError("proto must be an object or null");return t===pe.getPrototypeOf(e)||!(pe.isExtensible&&!pe.isExtensible(e))&&(!function(e,t){for(var n=t;n;){if(e===n)return!0;n=ur.getPrototypeOf(n)}return!1}(e,t)&&(Object.setPrototypeOf(e,t),!0))}})}Object.keys(ur).forEach(function(e){!function(e,t){ye.IsCallable(j.Reflect[e])?s(function(){return j.Reflect[e](1),j.Reflect[e](NaN),j.Reflect[e](!0),!0})&&se(j.Reflect,e,t):y(j.Reflect,e,t)}(e,ur[e])});var hr=j.Reflect.getPrototypeOf;if(l&&hr&&"getPrototypeOf"!==hr.name&&se(j.Reflect,"getPrototypeOf",function(e){return r(hr,j.Reflect,e)}),j.Reflect.setPrototypeOf&&s(function(){return j.Reflect.setPrototypeOf(1,{}),!0})&&se(j.Reflect,"setPrototypeOf",ur.setPrototypeOf),j.Reflect.defineProperty&&(s(function(){var e=!j.Reflect.defineProperty(1,"test",{value:1}),t="function"!=typeof Object.preventExtensions||!j.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})||se(j.Reflect,"defineProperty",ur.defineProperty)),j.Reflect.construct&&(s(function(){var e=function(){};return j.Reflect.construct(function(){},[],e)instanceof e})||se(j.Reflect,"construct",ur.construct)),"Invalid Date"!==String(new Date(NaN))){var yr=Date.prototype.toString;se(Date.prototype,"toString",function(){var e=+this;return e!=e?"Invalid Date":ye.Call(yr,this)})}var mr={anchor:function(e){return ye.CreateHTML(this,"a","name",e)},big:function(){return ye.CreateHTML(this,"big","","")},blink:function(){return ye.CreateHTML(this,"blink","","")},bold:function(){return ye.CreateHTML(this,"b","","")},fixed:function(){return ye.CreateHTML(this,"tt","","")},fontcolor:function(e){return ye.CreateHTML(this,"font","color",e)},fontsize:function(e){return ye.CreateHTML(this,"font","size",e)},italics:function(){return ye.CreateHTML(this,"i","","")},link:function(e){return ye.CreateHTML(this,"a","href",e)},small:function(){return ye.CreateHTML(this,"small","","")},strike:function(){return ye.CreateHTML(this,"strike","","")},sub:function(){return ye.CreateHTML(this,"sub","","")},sup:function(){return ye.CreateHTML(this,"sup","","")}};p(Object.keys(mr),function(e){var t=String.prototype[e],n=!1;if(ye.IsCallable(t)){var a=r(t,"",' " '),i=_([],a.match(/"/g)).length;n=a!==a.toLowerCase()||i>2}else n=!0;n&&se(String.prototype,e,mr[e])});var gr=function(){if(!ce)return!1;var e="object"===("undefined"==typeof JSON?"undefined":_typeof(JSON))&&"function"==typeof JSON.stringify?JSON.stringify:null;if(!e)return!1;if(void 0!==e(Y()))return!0;if("[null]"!==e([Y()]))return!0;var t={a:Y()};return t[Y()]=!0,"{}"!==e(t)}(),vr=s(function(){return!ce||"{}"===JSON.stringify(Object(Y()))&&"[{}]"===JSON.stringify([Object(Y())])});if(gr||!vr){var br=JSON.stringify;se(JSON,"stringify",function(e){if("symbol"!==(void 0===e?"undefined":_typeof(e))){var t;arguments.length>1&&(t=arguments[1]);var n=[e];if(a(t))n.push(t);else{var i=ye.IsCallable(t)?t:null;n.push(function(e,t){var n=i?r(i,this,e,t):t;if("symbol"!==(void 0===n?"undefined":_typeof(n)))return oe(n)?At({})(n):n})}return arguments.length>2&&n.push(arguments[2]),br.apply(this,n)}})}return j},"function"==typeof define&&define.amd?define("es6-shim",factory):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=factory():root.returnExports=factory(),function(e,t){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){var n=[],r=Object.getPrototypeOf,a=n.slice,i=n.flat?function(e){return n.flat.call(e)}:function(e){return n.concat.apply([],e)},o=n.push,s=n.indexOf,c={},u=c.toString,l=c.hasOwnProperty,p=l.toString,f=p.call(Object),d={},h=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},y=function(e){return null!=e&&e===e.window},m=e.document,g={type:!0,src:!0,nonce:!0,noModule:!0};function v(e,t,n){var r,a,i=(n=n||m).createElement("script");if(i.text=e,t)for(r in g)(a=t[r]||t.getAttribute&&t.getAttribute(r))&&i.setAttribute(r,a);n.head.appendChild(i).parentNode.removeChild(i)}function b(e){return null==e?e+"":"object"===(void 0===e?"undefined":_typeof(e))||"function"==typeof e?c[u.call(e)]||"object":void 0===e?"undefined":_typeof(e)}var w=function e(t,n){return new e.fn.init(t,n)};function T(e){var t=!!e&&"length"in e&&e.length,n=b(e);return!h(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}w.fn=w.prototype={jquery:"3.5.1",constructor:w,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(w.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(w.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,a,i,o=arguments[0]||{},s=1,c=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[s]||{},s++),"object"===(void 0===o?"undefined":_typeof(o))||h(o)||(o={}),s===c&&(o=this,s--);s<c;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&o!==r&&(u&&r&&(w.isPlainObject(r)||(a=Array.isArray(r)))?(n=o[t],i=a&&!Array.isArray(n)?[]:a||w.isPlainObject(n)?n:{},a=!1,o[t]=w.extend(u,i,r)):void 0!==r&&(o[t]=r));return o},w.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==u.call(e))&&(!(t=r(e))||"function"==typeof(n=l.call(t,"constructor")&&t.constructor)&&p.call(n)===f)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){v(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(T(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(T(Object(e))?w.merge(n,"string"==typeof e?[e]:e):o.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:s.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,a=e.length;r<n;r++)e[a++]=t[r];return e.length=a,e},grep:function(e,t,n){for(var r=[],a=0,i=e.length,o=!n;a<i;a++)!t(e[a],a)!==o&&r.push(e[a]);return r},map:function(e,t,n){var r,a,o=0,s=[];if(T(e))for(r=e.length;o<r;o++)null!=(a=t(e[o],o,n))&&s.push(a);else for(o in e)null!=(a=t(e[o],o,n))&&s.push(a);return i(s)},guid:1,support:d}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){c["[object "+t+"]"]=t.toLowerCase()});var S=function(e){var t,n,r,a,i,o,s,c,u,l,p,f,d,h,y,m,g,v,b,w="sizzle"+1*new Date,T=e.document,S=0,x=0,k=ce(),O=ce(),j=ce(),A=ce(),C=function(e,t){return e===t&&(p=!0),0},E={}.hasOwnProperty,_=[],N=_.pop,P=_.push,I=_.push,M=_.slice,D=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",q="(?:\\\\[\\da-fA-F]{1,6}"+L+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",F="\\["+L+"*("+q+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+q+"))|)"+L+"*\\]",V=":("+q+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+F+")*)|.*)\\)|)",H=new RegExp(L+"+","g"),z=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),$=new RegExp("^"+L+"*,"+L+"*"),B=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),W=new RegExp(L+"|>"),U=new RegExp(V),G=new RegExp("^"+q+"$"),X={ID:new RegExp("^#("+q+")"),CLASS:new RegExp("^\\.("+q+")"),TAG:new RegExp("^("+q+"|[*])"),ATTR:new RegExp("^"+F),PSEUDO:new RegExp("^"+V),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,J=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+L+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ae=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ie=function(){f()},oe=we(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{I.apply(_=M.call(T.childNodes),T.childNodes),_[T.childNodes.length].nodeType}catch(e){I={apply:_.length?function(e,t){P.apply(e,M.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function se(e,t,r,a){var i,s,u,l,p,h,g,v=t&&t.ownerDocument,T=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==T&&9!==T&&11!==T)return r;if(!a&&(f(t),t=t||d,y)){if(11!==T&&(p=Q.exec(e)))if(i=p[1]){if(9===T){if(!(u=t.getElementById(i)))return r;if(u.id===i)return r.push(u),r}else if(v&&(u=v.getElementById(i))&&b(t,u)&&u.id===i)return r.push(u),r}else{if(p[2])return I.apply(r,t.getElementsByTagName(e)),r;if((i=p[3])&&n.getElementsByClassName&&t.getElementsByClassName)return I.apply(r,t.getElementsByClassName(i)),r}if(n.qsa&&!A[e+" "]&&(!m||!m.test(e))&&(1!==T||"object"!==t.nodeName.toLowerCase())){if(g=e,v=t,1===T&&(W.test(e)||B.test(e))){for((v=ee.test(e)&&ge(t.parentNode)||t)===t&&n.scope||((l=t.getAttribute("id"))?l=l.replace(re,ae):t.setAttribute("id",l=w)),s=(h=o(e)).length;s--;)h[s]=(l?"#"+l:":scope")+" "+be(h[s]);g=h.join(",")}try{return I.apply(r,v.querySelectorAll(g)),r}catch(t){A(e,!0)}finally{l===w&&t.removeAttribute("id")}}}return c(e.replace(z,"$1"),t,r,a)}function ce(){var e=[];return function t(n,a){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=a}}function ue(e){return e[w]=!0,e}function le(e){var t=d.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function pe(e,t){for(var n=e.split("|"),a=n.length;a--;)r.attrHandle[n[a]]=t}function fe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function de(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function he(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ye(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&oe(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function me(e){return ue(function(t){return t=+t,ue(function(n,r){for(var a,i=e([],n.length,t),o=i.length;o--;)n[a=i[o]]&&(n[a]=!(r[a]=n[a]))})})}function ge(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=se.support={},i=se.isXML=function(e){var t=e.namespaceURI,n=(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},f=se.setDocument=function(e){var t,a,o=e?e.ownerDocument||e:T;return o!=d&&9===o.nodeType&&o.documentElement?(h=(d=o).documentElement,y=!i(d),T!=d&&(a=d.defaultView)&&a.top!==a&&(a.addEventListener?a.addEventListener("unload",ie,!1):a.attachEvent&&a.attachEvent("onunload",ie)),n.scope=le(function(e){return h.appendChild(e).appendChild(d.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),n.attributes=le(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=le(function(e){return e.appendChild(d.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Z.test(d.getElementsByClassName),n.getById=le(function(e){return h.appendChild(e).id=w,!d.getElementsByName||!d.getElementsByName(w).length}),n.getById?(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var n,r,a,i=t.getElementById(e);if(i){if((n=i.getAttributeNode("id"))&&n.value===e)return[i];for(a=t.getElementsByName(e),r=0;i=a[r++];)if((n=i.getAttributeNode("id"))&&n.value===e)return[i]}return[]}}),r.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],a=0,i=t.getElementsByTagName(e);if("*"===e){for(;n=i[a++];)1===n.nodeType&&r.push(n);return r}return i},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&y)return t.getElementsByClassName(e)},g=[],m=[],(n.qsa=Z.test(d.querySelectorAll))&&(le(function(e){var t;h.appendChild(e).innerHTML="<a id='"+w+"'></a><select id='"+w+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+L+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+L+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+w+"-]").length||m.push("~="),(t=d.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||m.push("\\["+L+"*name"+L+"*="+L+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+w+"+*").length||m.push(".#.+[+~]"),e.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")}),le(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=d.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+L+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),h.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=Z.test(v=h.matches||h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&le(function(e){n.disconnectedMatch=v.call(e,"*"),v.call(e,"[s!='']:x"),g.push("!=",V)}),m=m.length&&new RegExp(m.join("|")),g=g.length&&new RegExp(g.join("|")),t=Z.test(h.compareDocumentPosition),b=t||Z.test(h.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},C=t?function(e,t){if(e===t)return p=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e==d||e.ownerDocument==T&&b(T,e)?-1:t==d||t.ownerDocument==T&&b(T,t)?1:l?D(l,e)-D(l,t):0:4&r?-1:1)}:function(e,t){if(e===t)return p=!0,0;var n,r=0,a=e.parentNode,i=t.parentNode,o=[e],s=[t];if(!a||!i)return e==d?-1:t==d?1:a?-1:i?1:l?D(l,e)-D(l,t):0;if(a===i)return fe(e,t);for(n=e;n=n.parentNode;)o.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;o[r]===s[r];)r++;return r?fe(o[r],s[r]):o[r]==T?-1:s[r]==T?1:0},d):d},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(f(e),n.matchesSelector&&y&&!A[t+" "]&&(!g||!g.test(t))&&(!m||!m.test(t)))try{var r=v.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){A(t,!0)}return se(t,d,null,[e]).length>0},se.contains=function(e,t){return(e.ownerDocument||e)!=d&&f(e),b(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=d&&f(e);var a=r.attrHandle[t.toLowerCase()],i=a&&E.call(r.attrHandle,t.toLowerCase())?a(e,t,!y):void 0;return void 0!==i?i:n.attributes||!y?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},se.escape=function(e){return(e+"").replace(re,ae)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,r=[],a=0,i=0;if(p=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(C),p){for(;t=e[i++];)t===e[i]&&(a=r.push(i));for(;a--;)e.splice(r[a],1)}return l=null,e},a=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=a(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=a(t);return n},(r=se.selectors={cacheLength:50,createPseudo:ue,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return X.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&U.test(n)&&(t=o(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=k[e+" "];return t||(t=new RegExp("(^|"+L+")"+e+"("+L+"|$)"))&&k(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var a=se.attr(r,e);return null==a?"!="===t:!t||(a+="","="===t?a===n:"!="===t?a!==n:"^="===t?n&&0===a.indexOf(n):"*="===t?n&&a.indexOf(n)>-1:"$="===t?n&&a.slice(-n.length)===n:"~="===t?(" "+a.replace(H," ")+" ").indexOf(n)>-1:"|="===t&&(a===n||a.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,a){var i="nth"!==e.slice(0,3),o="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===a?function(e){return!!e.parentNode}:function(t,n,c){var u,l,p,f,d,h,y=i!==o?"nextSibling":"previousSibling",m=t.parentNode,g=s&&t.nodeName.toLowerCase(),v=!c&&!s,b=!1;if(m){if(i){for(;y;){for(f=t;f=f[y];)if(s?f.nodeName.toLowerCase()===g:1===f.nodeType)return!1;h=y="only"===e&&!h&&"nextSibling"}return!0}if(h=[o?m.firstChild:m.lastChild],o&&v){for(b=(d=(u=(l=(p=(f=m)[w]||(f[w]={}))[f.uniqueID]||(p[f.uniqueID]={}))[e]||[])[0]===S&&u[1])&&u[2],f=d&&m.childNodes[d];f=++d&&f&&f[y]||(b=d=0)||h.pop();)if(1===f.nodeType&&++b&&f===t){l[e]=[S,d,b];break}}else if(v&&(b=d=(u=(l=(p=(f=t)[w]||(f[w]={}))[f.uniqueID]||(p[f.uniqueID]={}))[e]||[])[0]===S&&u[1]),!1===b)for(;(f=++d&&f&&f[y]||(b=d=0)||h.pop())&&((s?f.nodeName.toLowerCase()!==g:1!==f.nodeType)||!++b||(v&&((l=(p=f[w]||(f[w]={}))[f.uniqueID]||(p[f.uniqueID]={}))[e]=[S,b]),f!==t)););return(b-=a)===r||b%r==0&&b/r>=0}}},PSEUDO:function(e,t){var n,a=r.pseudos[e]||r.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[w]?a(t):a.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?ue(function(e,n){for(var r,i=a(e,t),o=i.length;o--;)e[r=D(e,i[o])]=!(n[r]=i[o])}):function(e){return a(e,0,n)}):a}},pseudos:{not:ue(function(e){var t=[],n=[],r=s(e.replace(z,"$1"));return r[w]?ue(function(e,t,n,a){for(var i,o=r(e,null,a,[]),s=e.length;s--;)(i=o[s])&&(e[s]=!(t[s]=i))}):function(e,a,i){return t[0]=e,r(t,null,i,n),t[0]=null,!n.pop()}}),has:ue(function(e){return function(t){return se(e,t).length>0}}),contains:ue(function(e){return e=e.replace(te,ne),function(t){return(t.textContent||a(t)).indexOf(e)>-1}}),lang:ue(function(e){return G.test(e||"")||se.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=y?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ye(!1),disabled:ye(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return K.test(e.nodeName)},input:function(e){return J.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:me(function(){return[0]}),last:me(function(e,t){return[t-1]}),eq:me(function(e,t,n){return[n<0?n+t:n]}),even:me(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:me(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:me(function(e,t,n){for(var r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e}),gt:me(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=de(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=he(t);function ve(){}function be(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function we(e,t,n){var r=t.dir,a=t.next,i=a||r,o=n&&"parentNode"===i,s=x++;return t.first?function(t,n,a){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,a);return!1}:function(t,n,c){var u,l,p,f=[S,s];if(c){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,c))return!0}else for(;t=t[r];)if(1===t.nodeType||o)if(l=(p=t[w]||(t[w]={}))[t.uniqueID]||(p[t.uniqueID]={}),a&&a===t.nodeName.toLowerCase())t=t[r]||t;else{if((u=l[i])&&u[0]===S&&u[1]===s)return f[2]=u[2];if(l[i]=f,f[2]=e(t,n,c))return!0}return!1}}function Te(e){return e.length>1?function(t,n,r){for(var a=e.length;a--;)if(!e[a](t,n,r))return!1;return!0}:e[0]}function Se(e,t,n,r,a){for(var i,o=[],s=0,c=e.length,u=null!=t;s<c;s++)(i=e[s])&&(n&&!n(i,r,a)||(o.push(i),u&&t.push(s)));return o}function xe(e,t,n,r,a,i){return r&&!r[w]&&(r=xe(r)),a&&!a[w]&&(a=xe(a,i)),ue(function(i,o,s,c){var u,l,p,f=[],d=[],h=o.length,y=i||function(e,t,n){for(var r=0,a=t.length;r<a;r++)se(e,t[r],n);return n}(t||"*",s.nodeType?[s]:s,[]),m=!e||!i&&t?y:Se(y,f,e,s,c),g=n?a||(i?e:h||r)?[]:o:m;if(n&&n(m,g,s,c),r)for(u=Se(g,d),r(u,[],s,c),l=u.length;l--;)(p=u[l])&&(g[d[l]]=!(m[d[l]]=p));if(i){if(a||e){if(a){for(u=[],l=g.length;l--;)(p=g[l])&&u.push(m[l]=p);a(null,g=[],u,c)}for(l=g.length;l--;)(p=g[l])&&(u=a?D(i,p):f[l])>-1&&(i[u]=!(o[u]=p))}}else g=Se(g===o?g.splice(h,g.length):g),a?a(null,o,g,c):I.apply(o,g)})}function ke(e){for(var t,n,a,i=e.length,o=r.relative[e[0].type],s=o||r.relative[" "],c=o?1:0,l=we(function(e){return e===t},s,!0),p=we(function(e){return D(t,e)>-1},s,!0),f=[function(e,n,r){var a=!o&&(r||n!==u)||((t=n).nodeType?l(e,n,r):p(e,n,r));return t=null,a}];c<i;c++)if(n=r.relative[e[c].type])f=[we(Te(f),n)];else{if((n=r.filter[e[c].type].apply(null,e[c].matches))[w]){for(a=++c;a<i&&!r.relative[e[a].type];a++);return xe(c>1&&Te(f),c>1&&be(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(z,"$1"),n,c<a&&ke(e.slice(c,a)),a<i&&ke(e=e.slice(a)),a<i&&be(e))}f.push(n)}return Te(f)}return ve.prototype=r.filters=r.pseudos,r.setFilters=new ve,o=se.tokenize=function(e,t){var n,a,i,o,s,c,u,l=O[e+" "];if(l)return t?0:l.slice(0);for(s=e,c=[],u=r.preFilter;s;){for(o in n&&!(a=$.exec(s))||(a&&(s=s.slice(a[0].length)||s),c.push(i=[])),n=!1,(a=B.exec(s))&&(n=a.shift(),i.push({value:n,type:a[0].replace(z," ")}),s=s.slice(n.length)),r.filter)!(a=X[o].exec(s))||u[o]&&!(a=u[o](a))||(n=a.shift(),i.push({value:n,type:o,matches:a}),s=s.slice(n.length));if(!n)break}return t?s.length:s?se.error(e):O(e,c).slice(0)},s=se.compile=function(e,t){var n,a=[],i=[],s=j[e+" "];if(!s){for(t||(t=o(e)),n=t.length;n--;)(s=ke(t[n]))[w]?a.push(s):i.push(s);(s=j(e,function(e,t){var n=t.length>0,a=e.length>0,i=function(i,o,s,c,l){var p,h,m,g=0,v="0",b=i&&[],w=[],T=u,x=i||a&&r.find.TAG("*",l),k=S+=null==T?1:Math.random()||.1,O=x.length;for(l&&(u=o==d||o||l);v!==O&&null!=(p=x[v]);v++){if(a&&p){for(h=0,o||p.ownerDocument==d||(f(p),s=!y);m=e[h++];)if(m(p,o||d,s)){c.push(p);break}l&&(S=k)}n&&((p=!m&&p)&&g--,i&&b.push(p))}if(g+=v,n&&v!==g){for(h=0;m=t[h++];)m(b,w,o,s);if(i){if(g>0)for(;v--;)b[v]||w[v]||(w[v]=N.call(c));w=Se(w)}I.apply(c,w),l&&!i&&w.length>0&&g+t.length>1&&se.uniqueSort(c)}return l&&(S=k,u=T),b};return n?ue(i):i}(i,a))).selector=e}return s},c=se.select=function(e,t,n,a){var i,c,u,l,p,f="function"==typeof e&&e,d=!a&&o(e=f.selector||e);if(n=n||[],1===d.length){if((c=d[0]=d[0].slice(0)).length>2&&"ID"===(u=c[0]).type&&9===t.nodeType&&y&&r.relative[c[1].type]){if(!(t=(r.find.ID(u.matches[0].replace(te,ne),t)||[])[0]))return n;f&&(t=t.parentNode),e=e.slice(c.shift().value.length)}for(i=X.needsContext.test(e)?0:c.length;i--&&(u=c[i],!r.relative[l=u.type]);)if((p=r.find[l])&&(a=p(u.matches[0].replace(te,ne),ee.test(c[0].type)&&ge(t.parentNode)||t))){if(c.splice(i,1),!(e=a.length&&be(c)))return I.apply(n,a),n;break}}return(f||s(e,d))(a,t,!y,n,!t||ee.test(e)&&ge(t.parentNode)||t),n},n.sortStable=w.split("").sort(C).join("")===w,n.detectDuplicates=!!p,f(),n.sortDetached=le(function(e){return 1&e.compareDocumentPosition(d.createElement("fieldset"))}),le(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||pe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&le(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||pe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),le(function(e){return null==e.getAttribute("disabled")})||pe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(e);w.find=S,w.expr=S.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=S.uniqueSort,w.text=S.getText,w.isXMLDoc=S.isXML,w.contains=S.contains,w.escapeSelector=S.escape;var x=function(e,t,n){for(var r=[],a=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(a&&w(e).is(n))break;r.push(e)}return r},k=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},O=w.expr.match.needsContext;function j(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function C(e,t,n){return h(t)?w.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?w.grep(e,function(e){return e===t!==n}):"string"!=typeof t?w.grep(e,function(e){return s.call(t,e)>-1!==n}):w.filter(t,e,n)}w.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},w.fn.extend({find:function(e){var t,n,r=this.length,a=this;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;t<r;t++)if(w.contains(a[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)w.find(e,a[t],n);return r>1?w.uniqueSort(n):n},filter:function(e){return this.pushStack(C(this,e||[],!1))},not:function(e){return this.pushStack(C(this,e||[],!0))},is:function(e){return!!C(this,"string"==typeof e&&O.test(e)?w(e):e||[],!1).length}});var E,_=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,n){var r,a;if(!e)return this;if(n=n||E,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:_.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:m,!0)),A.test(r[1])&&w.isPlainObject(t))for(r in t)h(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(a=m.getElementById(r[2]))&&(this[0]=a,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):h(e)?void 0!==n.ready?n.ready(e):e(w):w.makeArray(e,this)}).prototype=w.fn,E=w(m);var N=/^(?:parents|prev(?:Until|All))/,P={children:!0,contents:!0,next:!0,prev:!0};function I(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,a=this.length,i=[],o="string"!=typeof e&&w(e);if(!O.test(e))for(;r<a;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){i.push(n);break}return this.pushStack(i.length>1?w.uniqueSort(i):i)},index:function(e){return e?"string"==typeof e?s.call(w(e),this[0]):s.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x(e,"parentNode")},parentsUntil:function(e,t,n){return x(e,"parentNode",n)},next:function(e){return I(e,"nextSibling")},prev:function(e){return I(e,"previousSibling")},nextAll:function(e){return x(e,"nextSibling")},prevAll:function(e){return x(e,"previousSibling")},nextUntil:function(e,t,n){return x(e,"nextSibling",n)},prevUntil:function(e,t,n){return x(e,"previousSibling",n)},siblings:function(e){return k((e.parentNode||{}).firstChild,e)},children:function(e){return k(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(j(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},function(e,t){w.fn[e]=function(n,r){var a=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(a=w.filter(r,a)),this.length>1&&(P[e]||w.uniqueSort(a),N.test(e)&&a.reverse()),this.pushStack(a)}});var M=/[^\x20\t\r\n\f]+/g;function D(e){return e}function R(e){throw e}function L(e,t,n,r){var a;try{e&&h(a=e.promise)?a.call(e).done(t).fail(n):e&&h(a=e.then)?a.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}w.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return w.each(e.match(M)||[],function(e,n){t[n]=!0}),t}(e):w.extend({},e);var t,n,r,a,i=[],o=[],s=-1,c=function(){for(a=a||e.once,r=t=!0;o.length;s=-1)for(n=o.shift();++s<i.length;)!1===i[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=i.length,n=!1);e.memory||(n=!1),t=!1,a&&(i=n?[]:"")},u={add:function(){return i&&(n&&!t&&(s=i.length-1,o.push(n)),function t(n){w.each(n,function(n,r){h(r)?e.unique&&u.has(r)||i.push(r):r&&r.length&&"string"!==b(r)&&t(r)})}(arguments),n&&!t&&c()),this},remove:function(){return w.each(arguments,function(e,t){for(var n;(n=w.inArray(t,i,n))>-1;)i.splice(n,1),n<=s&&s--}),this},has:function(e){return e?w.inArray(e,i)>-1:i.length>0},empty:function(){return i&&(i=[]),this},disable:function(){return a=o=[],i=n="",this},disabled:function(){return!i},lock:function(){return a=o=[],n||t||(i=n=""),this},locked:function(){return!!a},fireWith:function(e,n){return a||(n=[e,(n=n||[]).slice?n.slice():n],o.push(n),t||c()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},w.extend({Deferred:function(t){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],r="pending",a={state:function(){return r},always:function(){return i.done(arguments).fail(arguments),this},catch:function(e){return a.then(null,e)},pipe:function(){var e=arguments;return w.Deferred(function(t){w.each(n,function(n,r){var a=h(e[r[4]])&&e[r[4]];i[r[1]](function(){var e=a&&a.apply(this,arguments);e&&h(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,a?[e]:arguments)})}),e=null}).promise()},then:function(t,r,a){var i=0;function o(t,n,r,a){return function(){var s=this,c=arguments,u=function(){var e,u;if(!(t<i)){if((e=r.apply(s,c))===n.promise())throw new TypeError("Thenable self-resolution");u=e&&("object"===(void 0===e?"undefined":_typeof(e))||"function"==typeof e)&&e.then,h(u)?a?u.call(e,o(i,n,D,a),o(i,n,R,a)):(i++,u.call(e,o(i,n,D,a),o(i,n,R,a),o(i,n,D,n.notifyWith))):(r!==D&&(s=void 0,c=[e]),(a||n.resolveWith)(s,c))}},l=a?u:function(){try{u()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,l.stackTrace),t+1>=i&&(r!==R&&(s=void 0,c=[e]),n.rejectWith(s,c))}};t?l():(w.Deferred.getStackHook&&(l.stackTrace=w.Deferred.getStackHook()),e.setTimeout(l))}}return w.Deferred(function(e){n[0][3].add(o(0,e,h(a)?a:D,e.notifyWith)),n[1][3].add(o(0,e,h(t)?t:D)),n[2][3].add(o(0,e,h(r)?r:R))}).promise()},promise:function(e){return null!=e?w.extend(e,a):a}},i={};return w.each(n,function(e,t){var o=t[2],s=t[5];a[t[1]]=o.add,s&&o.add(function(){r=s},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),o.add(t[3].fire),i[t[0]]=function(){return i[t[0]+"With"](this===i?void 0:this,arguments),this},i[t[0]+"With"]=o.fireWith}),a.promise(i),t&&t.call(i,i),i},when:function(e){var t=arguments.length,n=t,r=Array(n),i=a.call(arguments),o=w.Deferred(),s=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?a.call(arguments):n,--t||o.resolveWith(r,i)}};if(t<=1&&(L(e,o.done(s(n)).resolve,o.reject,!t),"pending"===o.state()||h(i[n]&&i[n].then)))return o.then();for(;n--;)L(i[n],s(n),o.reject);return o.promise()}});var q=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&q.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout(function(){throw t})};var F=w.Deferred();function V(){m.removeEventListener("DOMContentLoaded",V),e.removeEventListener("load",V),w.ready()}w.fn.ready=function(e){return F.then(e).catch(function(e){w.readyException(e)}),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||F.resolveWith(m,[w]))}}),w.ready.then=F.then,"complete"===m.readyState||"loading"!==m.readyState&&!m.documentElement.doScroll?e.setTimeout(w.ready):(m.addEventListener("DOMContentLoaded",V),e.addEventListener("load",V));var H=function e(t,n,r,a,i,o,s){var c=0,u=t.length,l=null==r;if("object"===b(r))for(c in i=!0,r)e(t,n,c,r[c],!0,o,s);else if(void 0!==a&&(i=!0,h(a)||(s=!0),l&&(s?(n.call(t,a),n=null):(l=n,n=function(e,t,n){return l.call(w(e),n)})),n))for(;c<u;c++)n(t[c],r,s?a:a.call(t[c],c,n(t[c],r)));return i?t:l?n.call(t):u?n(t[0],r):o},z=/^-ms-/,$=/-([a-z])/g;function B(e,t){return t.toUpperCase()}function W(e){return e.replace(z,"ms-").replace($,B)}var U=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=w.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},U(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,a=this.cache(e);if("string"==typeof t)a[W(t)]=n;else for(r in t)a[W(r)]=t[r];return a},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][W(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(W):(t=W(t))in r?[t]:t.match(M)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||w.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var X=new G,Y=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:J.test(e)?JSON.parse(e):e)}(n)}catch(e){}Y.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return Y.hasData(e)||X.hasData(e)},data:function(e,t,n){return Y.access(e,t,n)},removeData:function(e,t){Y.remove(e,t)},_data:function(e,t,n){return X.access(e,t,n)},_removeData:function(e,t){X.remove(e,t)}}),w.fn.extend({data:function(e,t){var n,r,a,i=this[0],o=i&&i.attributes;if(void 0===e){if(this.length&&(a=Y.get(i),1===i.nodeType&&!X.get(i,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&0===(r=o[n].name).indexOf("data-")&&(r=W(r.slice(5)),Z(i,r,a[r]));X.set(i,"hasDataAttrs",!0)}return a}return"object"===(void 0===e?"undefined":_typeof(e))?this.each(function(){Y.set(this,e)}):H(this,function(t){var n;if(i&&void 0===t)return void 0!==(n=Y.get(i,e))?n:void 0!==(n=Z(i,e))?n:void 0;this.each(function(){Y.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Y.remove(this,e)})}}),w.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=X.get(e,t),n&&(!r||Array.isArray(n)?r=X.access(e,t,w.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,a=n.shift(),i=w._queueHooks(e,t);"inprogress"===a&&(a=n.shift(),r--),a&&("fx"===t&&n.unshift("inprogress"),delete i.stop,a.call(e,function(){w.dequeue(e,t)},i)),!r&&i&&i.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return X.get(e,n)||X.access(e,n,{empty:w.Callbacks("once memory").add(function(){X.remove(e,[t+"queue",n])})})}}),w.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?w.queue(this[0],e):void 0===t?this:this.each(function(){var n=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&w.dequeue(this,e)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,a=w.Deferred(),i=this,o=this.length,s=function(){--r||a.resolveWith(i,[i])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(n=X.get(i[o],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),a.promise(t)}});var Q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ee=new RegExp("^(?:([+-])=|)("+Q+")([a-z%]*)$","i"),te=["Top","Right","Bottom","Left"],ne=m.documentElement,re=function(e){return w.contains(e.ownerDocument,e)},ae={composed:!0};ne.getRootNode&&(re=function(e){return w.contains(e.ownerDocument,e)||e.getRootNode(ae)===e.ownerDocument});var ie=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&re(e)&&"none"===w.css(e,"display")};function oe(e,t,n,r){var a,i,o=20,s=r?function(){return r.cur()}:function(){return w.css(e,t,"")},c=s(),u=n&&n[3]||(w.cssNumber[t]?"":"px"),l=e.nodeType&&(w.cssNumber[t]||"px"!==u&&+c)&&ee.exec(w.css(e,t));if(l&&l[3]!==u){for(c/=2,u=u||l[3],l=+c||1;o--;)w.style(e,t,l+u),(1-i)*(1-(i=s()/c||.5))<=0&&(o=0),l/=i;l*=2,w.style(e,t,l+u),n=n||[]}return n&&(l=+l||+c||0,a=n[1]?l+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=l,r.end=a)),a}var se={};function ce(e){var t,n=e.ownerDocument,r=e.nodeName,a=se[r];return a||(t=n.body.appendChild(n.createElement(r)),a=w.css(t,"display"),t.parentNode.removeChild(t),"none"===a&&(a="block"),se[r]=a,a)}function ue(e,t){for(var n,r,a=[],i=0,o=e.length;i<o;i++)(r=e[i]).style&&(n=r.style.display,t?("none"===n&&(a[i]=X.get(r,"display")||null,a[i]||(r.style.display="")),""===r.style.display&&ie(r)&&(a[i]=ce(r))):"none"!==n&&(a[i]="none",X.set(r,"display",n)));for(i=0;i<o;i++)null!=a[i]&&(e[i].style.display=a[i]);return e}w.fn.extend({show:function(){return ue(this,!0)},hide:function(){return ue(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ie(this)?w(this).show():w(this).hide()})}});var le,pe,fe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;le=m.createDocumentFragment().appendChild(m.createElement("div")),(pe=m.createElement("input")).setAttribute("type","radio"),pe.setAttribute("checked","checked"),pe.setAttribute("name","t"),le.appendChild(pe),d.checkClone=le.cloneNode(!0).cloneNode(!0).lastChild.checked,le.innerHTML="<textarea>x</textarea>",d.noCloneChecked=!!le.cloneNode(!0).lastChild.defaultValue,le.innerHTML="<option></option>",d.option=!!le.lastChild;var ye={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function me(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&j(e,t)?w.merge([e],n):n}function ge(e,t){for(var n=0,r=e.length;n<r;n++)X.set(e[n],"globalEval",!t||X.get(t[n],"globalEval"))}ye.tbody=ye.tfoot=ye.colgroup=ye.caption=ye.thead,ye.th=ye.td,d.option||(ye.optgroup=ye.option=[1,"<select multiple='multiple'>","</select>"]);var ve=/<|&#?\w+;/;function be(e,t,n,r,a){for(var i,o,s,c,u,l,p=t.createDocumentFragment(),f=[],d=0,h=e.length;d<h;d++)if((i=e[d])||0===i)if("object"===b(i))w.merge(f,i.nodeType?[i]:i);else if(ve.test(i)){for(o=o||p.appendChild(t.createElement("div")),s=(de.exec(i)||["",""])[1].toLowerCase(),c=ye[s]||ye._default,o.innerHTML=c[1]+w.htmlPrefilter(i)+c[2],l=c[0];l--;)o=o.lastChild;w.merge(f,o.childNodes),(o=p.firstChild).textContent=""}else f.push(t.createTextNode(i));for(p.textContent="",d=0;i=f[d++];)if(r&&w.inArray(i,r)>-1)a&&a.push(i);else if(u=re(i),o=me(p.appendChild(i),"script"),u&&ge(o),n)for(l=0;i=o[l++];)he.test(i.type||"")&&n.push(i);return p}var we=/^key/,Te=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Se=/^([^.]*)(?:\.(.+)|)/;function xe(){return!0}function ke(){return!1}function Oe(e,t){return e===function(){try{return m.activeElement}catch(e){}}()==("focus"===t)}function je(e,t,n,r,a,i){var o,s;if("object"===(void 0===t?"undefined":_typeof(t))){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)je(e,s,n,r,t[s],i);return e}if(null==r&&null==a?(a=n,r=n=void 0):null==a&&("string"==typeof n?(a=r,r=void 0):(a=r,r=n,n=void 0)),!1===a)a=ke;else if(!a)return e;return 1===i&&(o=a,(a=function(e){return w().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=w.guid++)),e.each(function(){w.event.add(this,t,a,r,n)})}function Ae(e,t,n){n?(X.set(e,t,!1),w.event.add(e,t,{namespace:!1,handler:function(e){var r,i,o=X.get(this,t);if(1&e.isTrigger&&this[t]){if(o.length)(w.event.special[t]||{}).delegateType&&e.stopPropagation();else if(o=a.call(arguments),X.set(this,t,o),r=n(this,t),this[t](),o!==(i=X.get(this,t))||r?X.set(this,t,!1):i={},o!==i)return e.stopImmediatePropagation(),e.preventDefault(),i.value}else o.length&&(X.set(this,t,{value:w.event.trigger(w.extend(o[0],w.Event.prototype),o.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===X.get(e,t)&&w.event.add(e,t,xe)}w.event={global:{},add:function(e,t,n,r,a){var i,o,s,c,u,l,p,f,d,h,y,m=X.get(e);if(U(e))for(n.handler&&(n=(i=n).handler,a=i.selector),a&&w.find.matchesSelector(ne,a),n.guid||(n.guid=w.guid++),(c=m.events)||(c=m.events=Object.create(null)),(o=m.handle)||(o=m.handle=function(t){return void 0!==w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match(M)||[""]).length;u--;)d=y=(s=Se.exec(t[u])||[])[1],h=(s[2]||"").split(".").sort(),d&&(p=w.event.special[d]||{},d=(a?p.delegateType:p.bindType)||d,p=w.event.special[d]||{},l=w.extend({type:d,origType:y,data:r,handler:n,guid:n.guid,selector:a,needsContext:a&&w.expr.match.needsContext.test(a),namespace:h.join(".")},i),(f=c[d])||((f=c[d]=[]).delegateCount=0,p.setup&&!1!==p.setup.call(e,r,h,o)||e.addEventListener&&e.addEventListener(d,o)),p.add&&(p.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),a?f.splice(f.delegateCount++,0,l):f.push(l),w.event.global[d]=!0)},remove:function(e,t,n,r,a){var i,o,s,c,u,l,p,f,d,h,y,m=X.hasData(e)&&X.get(e);if(m&&(c=m.events)){for(u=(t=(t||"").match(M)||[""]).length;u--;)if(d=y=(s=Se.exec(t[u])||[])[1],h=(s[2]||"").split(".").sort(),d){for(p=w.event.special[d]||{},f=c[d=(r?p.delegateType:p.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=i=f.length;i--;)l=f[i],!a&&y!==l.origType||n&&n.guid!==l.guid||s&&!s.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(f.splice(i,1),l.selector&&f.delegateCount--,p.remove&&p.remove.call(e,l));o&&!f.length&&(p.teardown&&!1!==p.teardown.call(e,h,m.handle)||w.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)w.event.remove(e,d+t[u],n,r,!0);w.isEmptyObject(c)&&X.remove(e,"handle events")}},dispatch:function(e){var t,n,r,a,i,o,s=new Array(arguments.length),c=w.event.fix(e),u=(X.get(this,"events")||Object.create(null))[c.type]||[],l=w.event.special[c.type]||{};for(s[0]=c,t=1;t<arguments.length;t++)s[t]=arguments[t];if(c.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,c)){for(o=w.event.handlers.call(this,c,u),t=0;(a=o[t++])&&!c.isPropagationStopped();)for(c.currentTarget=a.elem,n=0;(i=a.handlers[n++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!1!==i.namespace&&!c.rnamespace.test(i.namespace)||(c.handleObj=i,c.data=i.data,void 0!==(r=((w.event.special[i.origType]||{}).handle||i.handler).apply(a.elem,s))&&!1===(c.result=r)&&(c.preventDefault(),c.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,c),c.result}},handlers:function(e,t){var n,r,a,i,o,s=[],c=t.delegateCount,u=e.target;if(c&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(i=[],o={},n=0;n<c;n++)void 0===o[a=(r=t[n]).selector+" "]&&(o[a]=r.needsContext?w(a,this).index(u)>-1:w.find(a,this,null,[u]).length),o[a]&&i.push(r);i.length&&s.push({elem:u,handlers:i})}return u=this,c<t.length&&s.push({elem:u,handlers:t.slice(c)}),s},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:h(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return fe.test(t.type)&&t.click&&j(t,"input")&&Ae(t,"click",xe),!1},trigger:function(e){var t=this||e;return fe.test(t.type)&&t.click&&j(t,"input")&&Ae(t,"click"),!0},_default:function(e){var t=e.target;return fe.test(t.type)&&t.click&&j(t,"input")&&X.get(t,"click")||j(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?xe:ke,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:ke,isPropagationStopped:ke,isImmediatePropagationStopped:ke,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=xe,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=xe,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=xe,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&we.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&Te.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},function(e,t){w.event.special[e]={setup:function(){return Ae(this,e,Oe),!1},trigger:function(){return Ae(this,e),!0},delegateType:t}}),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,a=e.handleObj;return r&&(r===this||w.contains(this,r))||(e.type=a.origType,n=a.handler.apply(this,arguments),e.type=t),n}}}),w.fn.extend({on:function(e,t,n,r){return je(this,e,t,n,r)},one:function(e,t,n,r){return je(this,e,t,n,r,1)},off:function(e,t,n){var r,a;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,w(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"===(void 0===e?"undefined":_typeof(e))){for(a in e)this.off(a,t,e[a]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=ke),this.each(function(){w.event.remove(this,e,n,t)})}});var Ce=/<script|<style|<link/i,Ee=/checked\s*(?:[^=]|=\s*.checked.)/i,_e=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ne(e,t){return j(e,"table")&&j(11!==t.nodeType?t:t.firstChild,"tr")&&w(e).children("tbody")[0]||e}function Pe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Ie(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Me(e,t){var n,r,a,i,o,s;if(1===t.nodeType){if(X.hasData(e)&&(s=X.get(e).events))for(a in X.remove(t,"handle events"),s)for(n=0,r=s[a].length;n<r;n++)w.event.add(t,a,s[a][n]);Y.hasData(e)&&(i=Y.access(e),o=w.extend({},i),Y.set(t,o))}}function De(e,t,n,r){t=i(t);var a,o,s,c,u,l,p=0,f=e.length,y=f-1,m=t[0],g=h(m);if(g||f>1&&"string"==typeof m&&!d.checkClone&&Ee.test(m))return e.each(function(a){var i=e.eq(a);g&&(t[0]=m.call(this,a,i.html())),De(i,t,n,r)});if(f&&(o=(a=be(t,e[0].ownerDocument,!1,e,r)).firstChild,1===a.childNodes.length&&(a=o),o||r)){for(c=(s=w.map(me(a,"script"),Pe)).length;p<f;p++)u=a,p!==y&&(u=w.clone(u,!0,!0),c&&w.merge(s,me(u,"script"))),n.call(e[p],u,p);if(c)for(l=s[s.length-1].ownerDocument,w.map(s,Ie),p=0;p<c;p++)u=s[p],he.test(u.type||"")&&!X.access(u,"globalEval")&&w.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?w._evalUrl&&!u.noModule&&w._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):v(u.textContent.replace(_e,""),u,l))}return e}function Re(e,t,n){for(var r,a=t?w.filter(t,e):e,i=0;null!=(r=a[i]);i++)n||1!==r.nodeType||w.cleanData(me(r)),r.parentNode&&(n&&re(r)&&ge(me(r,"script")),r.parentNode.removeChild(r));return e}w.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,a,i,o,s,c,u,l=e.cloneNode(!0),p=re(e);if(!(d.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(o=me(l),r=0,a=(i=me(e)).length;r<a;r++)s=i[r],c=o[r],void 0,"input"===(u=c.nodeName.toLowerCase())&&fe.test(s.type)?c.checked=s.checked:"input"!==u&&"textarea"!==u||(c.defaultValue=s.defaultValue);if(t)if(n)for(i=i||me(e),o=o||me(l),r=0,a=i.length;r<a;r++)Me(i[r],o[r]);else Me(e,l);return(o=me(l,"script")).length>0&&ge(o,!p&&me(e,"script")),l},cleanData:function(e){for(var t,n,r,a=w.event.special,i=0;void 0!==(n=e[i]);i++)if(U(n)){if(t=n[X.expando]){if(t.events)for(r in t.events)a[r]?w.event.remove(n,r):w.removeEvent(n,r,t.handle);n[X.expando]=void 0}n[Y.expando]&&(n[Y.expando]=void 0)}}}),w.fn.extend({detach:function(e){return Re(this,e,!0)},remove:function(e){return Re(this,e)},text:function(e){return H(this,function(e){return void 0===e?w.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return De(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ne(this,e).appendChild(e)})},prepend:function(){return De(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ne(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return De(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return De(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(me(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return H(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ce.test(e)&&!ye[(de.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(me(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return De(this,arguments,function(t){var n=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(me(this)),n&&n.replaceChild(t,this))},e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){w.fn[e]=function(e){for(var n,r=[],a=w(e),i=a.length-1,s=0;s<=i;s++)n=s===i?this:this.clone(!0),w(a[s])[t](n),o.apply(r,n.get());return this.pushStack(r)}});var Le=new RegExp("^("+Q+")(?!px)[a-z%]+$","i"),qe=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},Fe=function(e,t,n){var r,a,i={};for(a in t)i[a]=e.style[a],e.style[a]=t[a];for(a in r=n.call(e),t)e.style[a]=i[a];return r},Ve=new RegExp(te.join("|"),"i");function He(e,t,n){var r,a,i,o,s=e.style;return(n=n||qe(e))&&(""!==(o=n.getPropertyValue(t)||n[t])||re(e)||(o=w.style(e,t)),!d.pixelBoxStyles()&&Le.test(o)&&Ve.test(t)&&(r=s.width,a=s.minWidth,i=s.maxWidth,s.minWidth=s.maxWidth=s.width=o,o=n.width,s.width=r,s.minWidth=a,s.maxWidth=i)),void 0!==o?o+"":o}function ze(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function t(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ne.appendChild(u).appendChild(l);var t=e.getComputedStyle(l);r="1%"!==t.top,c=12===n(t.marginLeft),l.style.right="60%",o=36===n(t.right),a=36===n(t.width),l.style.position="absolute",i=12===n(l.offsetWidth/3),ne.removeChild(u),l=null}}function n(e){return Math.round(parseFloat(e))}var r,a,i,o,s,c,u=m.createElement("div"),l=m.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",d.clearCloneStyle="content-box"===l.style.backgroundClip,w.extend(d,{boxSizingReliable:function(){return t(),a},pixelBoxStyles:function(){return t(),o},pixelPosition:function(){return t(),r},reliableMarginLeft:function(){return t(),c},scrollboxSize:function(){return t(),i},reliableTrDimensions:function(){var t,n,r,a;return null==s&&(t=m.createElement("table"),n=m.createElement("tr"),r=m.createElement("div"),t.style.cssText="position:absolute;left:-11111px",n.style.height="1px",r.style.height="9px",ne.appendChild(t).appendChild(n).appendChild(r),a=e.getComputedStyle(n),s=parseInt(a.height)>3,ne.removeChild(t)),s}}))}();var $e=["Webkit","Moz","ms"],Be=m.createElement("div").style,We={};function Ue(e){var t=w.cssProps[e]||We[e];return t||(e in Be?e:We[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=$e.length;n--;)if((e=$e[n]+t)in Be)return e}(e)||e)}var Ge=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ye={position:"absolute",visibility:"hidden",display:"block"},Je={letterSpacing:"0",fontWeight:"400"};function Ke(e,t,n){var r=ee.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ze(e,t,n,r,a,i){var o="width"===t?1:0,s=0,c=0;if(n===(r?"border":"content"))return 0;for(;o<4;o+=2)"margin"===n&&(c+=w.css(e,n+te[o],!0,a)),r?("content"===n&&(c-=w.css(e,"padding"+te[o],!0,a)),"margin"!==n&&(c-=w.css(e,"border"+te[o]+"Width",!0,a))):(c+=w.css(e,"padding"+te[o],!0,a),"padding"!==n?c+=w.css(e,"border"+te[o]+"Width",!0,a):s+=w.css(e,"border"+te[o]+"Width",!0,a));return!r&&i>=0&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-i-c-s-.5))||0),c}function Qe(e,t,n){var r=qe(e),a=(!d.boxSizingReliable()||n)&&"border-box"===w.css(e,"boxSizing",!1,r),i=a,o=He(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Le.test(o)){if(!n)return o;o="auto"}return(!d.boxSizingReliable()&&a||!d.reliableTrDimensions()&&j(e,"tr")||"auto"===o||!parseFloat(o)&&"inline"===w.css(e,"display",!1,r))&&e.getClientRects().length&&(a="border-box"===w.css(e,"boxSizing",!1,r),(i=s in e)&&(o=e[s])),(o=parseFloat(o)||0)+Ze(e,t,n||(a?"border":"content"),i,r,o)+"px"}function et(e,t,n,r,a){return new et.prototype.init(e,t,n,r,a)}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=He(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var a,i,o,s=W(t),c=Xe.test(t),u=e.style;if(c||(t=Ue(s)),o=w.cssHooks[t]||w.cssHooks[s],void 0===n)return o&&"get"in o&&void 0!==(a=o.get(e,!1,r))?a:u[t];"string"===(i=void 0===n?"undefined":_typeof(n))&&(a=ee.exec(n))&&a[1]&&(n=oe(e,t,a),i="number"),null!=n&&n==n&&("number"!==i||c||(n+=a&&a[3]||(w.cssNumber[s]?"":"px")),d.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),o&&"set"in o&&void 0===(n=o.set(e,n,r))||(c?u.setProperty(t,n):u[t]=n))}},css:function(e,t,n,r){var a,i,o,s=W(t);return Xe.test(t)||(t=Ue(s)),(o=w.cssHooks[t]||w.cssHooks[s])&&"get"in o&&(a=o.get(e,!0,n)),void 0===a&&(a=He(e,t,r)),"normal"===a&&t in Je&&(a=Je[t]),""===n||n?(i=parseFloat(a),!0===n||isFinite(i)?i||0:a):a}}),w.each(["height","width"],function(e,t){w.cssHooks[t]={get:function(e,n,r){if(n)return!Ge.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Qe(e,t,r):Fe(e,Ye,function(){return Qe(e,t,r)})},set:function(e,n,r){var a,i=qe(e),o=!d.scrollboxSize()&&"absolute"===i.position,s=(o||r)&&"border-box"===w.css(e,"boxSizing",!1,i),c=r?Ze(e,t,r,s,i):0;return s&&o&&(c-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(i[t])-Ze(e,t,"border",!1,i)-.5)),c&&(a=ee.exec(n))&&"px"!==(a[3]||"px")&&(e.style[t]=n,n=w.css(e,t)),Ke(0,n,c)}}}),w.cssHooks.marginLeft=ze(d.reliableMarginLeft,function(e,t){if(t)return(parseFloat(He(e,"marginLeft"))||e.getBoundingClientRect().left-Fe(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),w.each({margin:"",padding:"",border:"Width"},function(e,t){w.cssHooks[e+t]={expand:function(n){for(var r=0,a={},i="string"==typeof n?n.split(" "):[n];r<4;r++)a[e+te[r]+t]=i[r]||i[r-2]||i[0];return a}},"margin"!==e&&(w.cssHooks[e+t].set=Ke)}),w.fn.extend({css:function(e,t){return H(this,function(e,t,n){var r,a,i={},o=0;if(Array.isArray(t)){for(r=qe(e),a=t.length;o<a;o++)i[t[o]]=w.css(e,t[o],!1,r);return i}return void 0!==n?w.style(e,t,n):w.css(e,t)},e,t,arguments.length>1)}}),w.Tween=et,et.prototype={constructor:et,init:function(e,t,n,r,a,i){this.elem=e,this.prop=n,this.easing=a||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=i||(w.cssNumber[n]?"":"px")},cur:function(){var e=et.propHooks[this.prop];return e&&e.get?e.get(this):et.propHooks._default.get(this)},run:function(e){var t,n=et.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):et.propHooks._default.set(this),this}},et.prototype.init.prototype=et.prototype,et.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||!w.cssHooks[e.prop]&&null==e.elem.style[Ue(e.prop)]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},et.propHooks.scrollTop=et.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=et.prototype.init,w.fx.step={};var tt,nt,rt=/^(?:toggle|show|hide)$/,at=/queueHooks$/;function it(){nt&&(!1===m.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(it):e.setTimeout(it,w.fx.interval),w.fx.tick())}function ot(){return e.setTimeout(function(){tt=void 0}),tt=Date.now()}function st(e,t){var n,r=0,a={height:e};for(t=t?1:0;r<4;r+=2-t)a["margin"+(n=te[r])]=a["padding"+n]=e;return t&&(a.opacity=a.width=e),a}function ct(e,t,n){for(var r,a=(ut.tweeners[t]||[]).concat(ut.tweeners["*"]),i=0,o=a.length;i<o;i++)if(r=a[i].call(n,t,e))return r}function ut(e,t,n){var r,a,i=0,o=ut.prefilters.length,s=w.Deferred().always(function(){delete c.elem}),c=function(){if(a)return!1;for(var t=tt||ot(),n=Math.max(0,u.startTime+u.duration-t),r=1-(n/u.duration||0),i=0,o=u.tweens.length;i<o;i++)u.tweens[i].run(r);return s.notifyWith(e,[u,r,n]),r<1&&o?n:(o||s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:t,originalOptions:n,startTime:tt||ot(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(a)return this;for(a=!0;n<r;n++)u.tweens[n].run(1);return t?(s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u,t])):s.rejectWith(e,[u,t]),this}}),l=u.props;for(!function(e,t){var n,r,a,i,o;for(n in e)if(a=t[r=W(n)],i=e[n],Array.isArray(i)&&(a=i[1],i=e[n]=i[0]),n!==r&&(e[r]=i,delete e[n]),(o=w.cssHooks[r])&&"expand"in o)for(n in i=o.expand(i),delete e[r],i)n in e||(e[n]=i[n],t[n]=a);else t[r]=a}(l,u.opts.specialEasing);i<o;i++)if(r=ut.prefilters[i].call(u,e,l,u.opts))return h(r.stop)&&(w._queueHooks(u.elem,u.opts.queue).stop=r.stop.bind(r)),r;return w.map(l,ct,u),h(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),w.fx.timer(w.extend(c,{elem:e,anim:u,queue:u.opts.queue})),u}w.Animation=w.extend(ut,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return oe(n.elem,e,ee.exec(t),n),n}]},tweener:function(e,t){h(e)?(t=e,e=["*"]):e=e.match(M);for(var n,r=0,a=e.length;r<a;r++)n=e[r],ut.tweeners[n]=ut.tweeners[n]||[],ut.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,a,i,o,s,c,u,l,p="width"in t||"height"in t,f=this,d={},h=e.style,y=e.nodeType&&ie(e),m=X.get(e,"fxshow");for(r in n.queue||(null==(o=w._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,s=o.empty.fire,o.empty.fire=function(){o.unqueued||s()}),o.unqueued++,f.always(function(){f.always(function(){o.unqueued--,w.queue(e,"fx").length||o.empty.fire()})})),t)if(a=t[r],rt.test(a)){if(delete t[r],i=i||"toggle"===a,a===(y?"hide":"show")){if("show"!==a||!m||void 0===m[r])continue;y=!0}d[r]=m&&m[r]||w.style(e,r)}if((c=!w.isEmptyObject(t))||!w.isEmptyObject(d))for(r in p&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(u=m&&m.display)&&(u=X.get(e,"display")),"none"===(l=w.css(e,"display"))&&(u?l=u:(ue([e],!0),u=e.style.display||u,l=w.css(e,"display"),ue([e]))),("inline"===l||"inline-block"===l&&null!=u)&&"none"===w.css(e,"float")&&(c||(f.done(function(){h.display=u}),null==u&&(l=h.display,u="none"===l?"":l)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",f.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),c=!1,d)c||(m?"hidden"in m&&(y=m.hidden):m=X.access(e,"fxshow",{display:u}),i&&(m.hidden=!y),y&&ue([e],!0),f.done(function(){for(r in y||ue([e]),X.remove(e,"fxshow"),d)w.style(e,r,d[r])})),c=ct(y?m[r]:0,r,f),r in m||(m[r]=c.start,y&&(c.end=c.start,c.start=0))}],prefilter:function(e,t){t?ut.prefilters.unshift(e):ut.prefilters.push(e)}}),w.speed=function(e,t,n){var r=e&&"object"===(void 0===e?"undefined":_typeof(e))?w.extend({},e):{complete:n||!n&&t||h(e)&&e,duration:e,easing:n&&t||t&&!h(t)&&t};return w.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in w.fx.speeds?r.duration=w.fx.speeds[r.duration]:r.duration=w.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){h(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ie).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var a=w.isEmptyObject(e),i=w.speed(t,n,r),o=function(){var t=ut(this,w.extend({},e),i);(a||X.get(this,"finish"))&&t.stop(!0)};return o.finish=o,a||!1===i.queue?this.each(o):this.queue(i.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each(function(){var t=!0,a=null!=e&&e+"queueHooks",i=w.timers,o=X.get(this);if(a)o[a]&&o[a].stop&&r(o[a]);else for(a in o)o[a]&&o[a].stop&&at.test(a)&&r(o[a]);for(a=i.length;a--;)i[a].elem!==this||null!=e&&i[a].queue!==e||(i[a].anim.stop(n),t=!1,i.splice(a,1));!t&&n||w.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=X.get(this),r=n[e+"queue"],a=n[e+"queueHooks"],i=w.timers,o=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),a&&a.stop&&a.stop.call(this,!0),t=i.length;t--;)i[t].elem===this&&i[t].queue===e&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,a){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(st(t,!0),e,r,a)}}),w.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(tt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),tt=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){nt||(nt=!0,it())},w.fx.stop=function(){nt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,n){return t=w.fx&&w.fx.speeds[t]||t,n=n||"fx",this.queue(n,function(n,r){var a=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(a)}})},function(){var e=m.createElement("input"),t=m.createElement("select").appendChild(m.createElement("option"));e.type="checkbox",d.checkOn=""!==e.value,d.optSelected=t.selected,(e=m.createElement("input")).value="t",e.type="radio",d.radioValue="t"===e.value}();var lt,pt=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return H(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,n){var r,a,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return void 0===e.getAttribute?w.prop(e,t,n):(1===i&&w.isXMLDoc(e)||(a=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?lt:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):a&&"set"in a&&void 0!==(r=a.set(e,n,t))?r:(e.setAttribute(t,n+""),n):a&&"get"in a&&null!==(r=a.get(e,t))?r:null==(r=w.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!d.radioValue&&"radio"===t&&j(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,a=t&&t.match(M);if(a&&1===e.nodeType)for(;n=a[r++];)e.removeAttribute(n)}}),lt={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,t){var n=pt[t]||w.find.attr;pt[t]=function(e,t,r){var a,i,o=t.toLowerCase();return r||(i=pt[o],pt[o]=a,a=null!=n(e,t,r)?o:null,pt[o]=i),a}});var ft=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;function ht(e){return(e.match(M)||[]).join(" ")}function yt(e){return e.getAttribute&&e.getAttribute("class")||""}function mt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(M)||[]}w.fn.extend({prop:function(e,t){return H(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[w.propFix[e]||e]})}}),w.extend({prop:function(e,t,n){var r,a,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return 1===i&&w.isXMLDoc(e)||(t=w.propFix[t]||t,a=w.propHooks[t]),void 0!==n?a&&"set"in a&&void 0!==(r=a.set(e,n,t))?r:e[t]=n:a&&"get"in a&&null!==(r=a.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):ft.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),d.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this}),w.fn.extend({addClass:function(e){var t,n,r,a,i,o,s,c=0;if(h(e))return this.each(function(t){w(this).addClass(e.call(this,t,yt(this)))});if((t=mt(e)).length)for(;n=this[c++];)if(a=yt(n),r=1===n.nodeType&&" "+ht(a)+" "){for(o=0;i=t[o++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");a!==(s=ht(r))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,a,i,o,s,c=0;if(h(e))return this.each(function(t){w(this).removeClass(e.call(this,t,yt(this)))});if(!arguments.length)return this.attr("class","");if((t=mt(e)).length)for(;n=this[c++];)if(a=yt(n),r=1===n.nodeType&&" "+ht(a)+" "){for(o=0;i=t[o++];)for(;r.indexOf(" "+i+" ")>-1;)r=r.replace(" "+i+" "," ");a!==(s=ht(r))&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=void 0===e?"undefined":_typeof(e),r="string"===n||Array.isArray(e);return"boolean"==typeof t&&r?t?this.addClass(e):this.removeClass(e):h(e)?this.each(function(n){w(this).toggleClass(e.call(this,n,yt(this),t),t)}):this.each(function(){var t,a,i,o;if(r)for(a=0,i=w(this),o=mt(e);t=o[a++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==e&&"boolean"!==n||((t=yt(this))&&X.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":X.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+ht(yt(n))+" ").indexOf(t)>-1)return!0;return!1}});var gt=/\r/g;w.fn.extend({val:function(e){var t,n,r,a=this[0];return arguments.length?(r=h(e),this.each(function(n){var a;1===this.nodeType&&(null==(a=r?e.call(this,n,w(this).val()):e)?a="":"number"==typeof a?a+="":Array.isArray(a)&&(a=w.map(a,function(e){return null==e?"":e+""})),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,a,"value")||(this.value=a))})):a?(t=w.valHooks[a.type]||w.valHooks[a.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(a,"value"))?n:"string"==typeof(n=a.value)?n.replace(gt,""):null==n?"":n:void 0}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:ht(w.text(e))}},select:{get:function(e){var t,n,r,a=e.options,i=e.selectedIndex,o="select-one"===e.type,s=o?null:[],c=o?i+1:a.length;for(r=i<0?c:o?i:0;r<c;r++)if(((n=a[r]).selected||r===i)&&!n.disabled&&(!n.parentNode.disabled||!j(n.parentNode,"optgroup"))){if(t=w(n).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var n,r,a=e.options,i=w.makeArray(t),o=a.length;o--;)((r=a[o]).selected=w.inArray(w.valHooks.option.get(r),i)>-1)&&(n=!0);return n||(e.selectedIndex=-1),i}}}}),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},d.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),d.focusin="onfocusin"in e;var vt=/^(?:focusinfocus|focusoutblur)$/,bt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(t,n,r,a){var i,o,s,c,u,p,f,d,g=[r||m],v=l.call(t,"type")?t.type:t,b=l.call(t,"namespace")?t.namespace.split("."):[];if(o=d=s=r=r||m,3!==r.nodeType&&8!==r.nodeType&&!vt.test(v+w.event.triggered)&&(v.indexOf(".")>-1&&(v=(b=v.split(".")).shift(),b.sort()),u=v.indexOf(":")<0&&"on"+v,(t=t[w.expando]?t:new w.Event(v,"object"===(void 0===t?"undefined":_typeof(t))&&t)).isTrigger=a?2:3,t.namespace=b.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:w.makeArray(n,[t]),f=w.event.special[v]||{},a||!f.trigger||!1!==f.trigger.apply(r,n))){if(!a&&!f.noBubble&&!y(r)){for(c=f.delegateType||v,vt.test(c+v)||(o=o.parentNode);o;o=o.parentNode)g.push(o),s=o;s===(r.ownerDocument||m)&&g.push(s.defaultView||s.parentWindow||e)}for(i=0;(o=g[i++])&&!t.isPropagationStopped();)d=o,t.type=i>1?c:f.bindType||v,(p=(X.get(o,"events")||Object.create(null))[t.type]&&X.get(o,"handle"))&&p.apply(o,n),(p=u&&o[u])&&p.apply&&U(o)&&(t.result=p.apply(o,n),!1===t.result&&t.preventDefault());return t.type=v,a||t.isDefaultPrevented()||f._default&&!1!==f._default.apply(g.pop(),n)||!U(r)||u&&h(r[v])&&!y(r)&&((s=r[u])&&(r[u]=null),w.event.triggered=v,t.isPropagationStopped()&&d.addEventListener(v,bt),r[v](),t.isPropagationStopped()&&d.removeEventListener(v,bt),w.event.triggered=void 0,s&&(r[u]=s)),t.result}},simulate:function(e,t,n){var r=w.extend(new w.Event,n,{type:e,isSimulated:!0});w.event.trigger(r,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}}),d.focusin||w.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){w.event.simulate(t,e.target,w.event.fix(e))};w.event.special[t]={setup:function(){var r=this.ownerDocument||this.document||this,a=X.access(r,t);a||r.addEventListener(e,n,!0),X.access(r,t,(a||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,a=X.access(r,t)-1;a?X.access(r,t,a):(r.removeEventListener(e,n,!0),X.remove(r,t))}}});var wt=e.location,Tt={guid:Date.now()},St=/\?/;w.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+t),n};var xt=/\[\]$/,kt=/\r?\n/g,Ot=/^(?:submit|button|image|reset|file)$/i,jt=/^(?:input|select|textarea|keygen)/i;function At(e,t,n,r){var a;if(Array.isArray(t))w.each(t,function(t,a){n||xt.test(e)?r(e,a):At(e+"["+("object"===(void 0===a?"undefined":_typeof(a))&&null!=a?t:"")+"]",a,n,r)});else if(n||"object"!==b(t))r(e,t);else for(a in t)At(e+"["+a+"]",t[a],n,r)}w.param=function(e,t){var n,r=[],a=function(e,t){var n=h(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){a(this.name,this.value)});else for(n in e)At(n,e[n],t,a);return r.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&jt.test(this.nodeName)&&!Ot.test(e)&&(this.checked||!fe.test(e))}).map(function(e,t){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(kt,"\r\n")}}):{name:t.name,value:n.replace(kt,"\r\n")}}).get()}});var Ct=/%20/g,Et=/#.*$/,_t=/([?&])_=[^&]*/,Nt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Pt=/^(?:GET|HEAD)$/,It=/^\/\//,Mt={},Dt={},Rt="*/".concat("*"),Lt=m.createElement("a");function qt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,a=0,i=t.toLowerCase().match(M)||[];if(h(n))for(;r=i[a++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Ft(e,t,n,r){var a={},i=e===Dt;function o(s){var c;return a[s]=!0,w.each(e[s]||[],function(e,s){var u=s(t,n,r);return"string"!=typeof u||i||a[u]?i?!(c=u):void 0:(t.dataTypes.unshift(u),o(u),!1)}),c}return o(t.dataTypes[0])||!a["*"]&&o("*")}function Vt(e,t){var n,r,a=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((a[n]?e:r||(r={}))[n]=t[n]);return r&&w.extend(!0,e,r),e}Lt.href=wt.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:wt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(wt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Vt(Vt(e,w.ajaxSettings),t):Vt(w.ajaxSettings,e)},ajaxPrefilter:qt(Mt),ajaxTransport:qt(Dt),ajax:function(t,n){"object"===(void 0===t?"undefined":_typeof(t))&&(n=t,t=void 0),n=n||{};var r,a,i,o,s,c,u,l,p,f,d=w.ajaxSetup({},n),h=d.context||d,y=d.context&&(h.nodeType||h.jquery)?w(h):w.event,g=w.Deferred(),v=w.Callbacks("once memory"),b=d.statusCode||{},T={},S={},x="canceled",k={readyState:0,getResponseHeader:function(e){var t;if(u){if(!o)for(o={};t=Nt.exec(i);)o[t[1].toLowerCase()+" "]=(o[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=o[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return u?i:null},setRequestHeader:function(e,t){return null==u&&(e=S[e.toLowerCase()]=S[e.toLowerCase()]||e,T[e]=t),this},overrideMimeType:function(e){return null==u&&(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(u)k.always(e[k.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||x;return r&&r.abort(t),O(0,t),this}};if(g.promise(k),d.url=((t||d.url||wt.href)+"").replace(It,wt.protocol+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(M)||[""],null==d.crossDomain){c=m.createElement("a");try{c.href=d.url,c.href=c.href,d.crossDomain=Lt.protocol+"//"+Lt.host!=c.protocol+"//"+c.host}catch(e){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=w.param(d.data,d.traditional)),Ft(Mt,d,n,k),u)return k;for(p in(l=w.event&&d.global)&&0==w.active++&&w.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Pt.test(d.type),a=d.url.replace(Et,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(Ct,"+")):(f=d.url.slice(a.length),d.data&&(d.processData||"string"==typeof d.data)&&(a+=(St.test(a)?"&":"?")+d.data,delete d.data),!1===d.cache&&(a=a.replace(_t,"$1"),f=(St.test(a)?"&":"?")+"_="+Tt.guid+++f),d.url=a+f),d.ifModified&&(w.lastModified[a]&&k.setRequestHeader("If-Modified-Since",w.lastModified[a]),w.etag[a]&&k.setRequestHeader("If-None-Match",w.etag[a])),(d.data&&d.hasContent&&!1!==d.contentType||n.contentType)&&k.setRequestHeader("Content-Type",d.contentType),k.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Rt+"; q=0.01":""):d.accepts["*"]),d.headers)k.setRequestHeader(p,d.headers[p]);if(d.beforeSend&&(!1===d.beforeSend.call(h,k,d)||u))return k.abort();if(x="abort",v.add(d.complete),k.done(d.success),k.fail(d.error),r=Ft(Dt,d,n,k)){if(k.readyState=1,l&&y.trigger("ajaxSend",[k,d]),u)return k;d.async&&d.timeout>0&&(s=e.setTimeout(function(){k.abort("timeout")},d.timeout));try{u=!1,r.send(T,O)}catch(e){if(u)throw e;O(-1,e)}}else O(-1,"No Transport");function O(t,n,o,c){var p,f,m,T,S,x=n;u||(u=!0,s&&e.clearTimeout(s),r=void 0,i=c||"",k.readyState=t>0?4:0,p=t>=200&&t<300||304===t,o&&(T=function(e,t,n){for(var r,a,i,o,s=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(a in s)if(s[a]&&s[a].test(r)){c.unshift(a);break}if(c[0]in n)i=c[0];else{for(a in n){if(!c[0]||e.converters[a+" "+c[0]]){i=a;break}o||(o=a)}i=i||o}if(i)return i!==c[0]&&c.unshift(i),n[i]}(d,k,o)),!p&&w.inArray("script",d.dataTypes)>-1&&(d.converters["text script"]=function(){}),T=function(e,t,n,r){var a,i,o,s,c,u={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)u[o.toLowerCase()]=e.converters[o];for(i=l.shift();i;)if(e.responseFields[i]&&(n[e.responseFields[i]]=t),!c&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=i,i=l.shift())if("*"===i)i=c;else if("*"!==c&&c!==i){if(!(o=u[c+" "+i]||u["* "+i]))for(a in u)if((s=a.split(" "))[1]===i&&(o=u[c+" "+s[0]]||u["* "+s[0]])){!0===o?o=u[a]:!0!==u[a]&&(i=s[0],l.unshift(s[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+c+" to "+i}}}return{state:"success",data:t}}(d,T,k,p),p?(d.ifModified&&((S=k.getResponseHeader("Last-Modified"))&&(w.lastModified[a]=S),(S=k.getResponseHeader("etag"))&&(w.etag[a]=S)),204===t||"HEAD"===d.type?x="nocontent":304===t?x="notmodified":(x=T.state,f=T.data,p=!(m=T.error))):(m=x,!t&&x||(x="error",t<0&&(t=0))),k.status=t,k.statusText=(n||x)+"",p?g.resolveWith(h,[f,x,k]):g.rejectWith(h,[k,x,m]),k.statusCode(b),b=void 0,l&&y.trigger(p?"ajaxSuccess":"ajaxError",[k,d,p?f:m]),v.fireWith(h,[k,x]),l&&(y.trigger("ajaxComplete",[k,d]),--w.active||w.event.trigger("ajaxStop")))}return k},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,t){w[t]=function(e,n,r,a){return h(n)&&(a=a||r,r=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:a,data:n,success:r},w.isPlainObject(e)&&e))}}),w.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),w._evalUrl=function(e,t,n){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){w.globalEval(e,t,n)}})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(h(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return h(e)?this.each(function(t){w(this).wrapInner(e.call(this,t))}):this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=h(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){w(this).replaceWith(this.childNodes)}),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Ht={0:200,1223:204},zt=w.ajaxSettings.xhr();d.cors=!!zt&&"withCredentials"in zt,d.ajax=zt=!!zt,w.ajaxTransport(function(t){var n,r;if(d.cors||zt&&!t.crossDomain)return{send:function(a,i){var o,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)s[o]=t.xhrFields[o];for(o in t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||a["X-Requested-With"]||(a["X-Requested-With"]="XMLHttpRequest"),a)s.setRequestHeader(o,a[o]);n=function(e){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?i(0,"error"):i(s.status,s.statusText):i(Ht[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),w.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),w.ajaxTransport("script",function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(r,a){t=w("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&a("error"===e.type?404:200,e.type)}),m.head.appendChild(t[0])},abort:function(){n&&n()}}});var $t,Bt=[],Wt=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Bt.pop()||w.expando+"_"+Tt.guid++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(t,n,r){var a,i,o,s=!1!==t.jsonp&&(Wt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Wt.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return a=t.jsonpCallback=h(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Wt,"$1"+a):!1!==t.jsonp&&(t.url+=(St.test(t.url)?"&":"?")+t.jsonp+"="+a),t.converters["script json"]=function(){return o||w.error(a+" was not called"),o[0]},t.dataTypes[0]="json",i=e[a],e[a]=function(){o=arguments},r.always(function(){void 0===i?w(e).removeProp(a):e[a]=i,t[a]&&(t.jsonpCallback=n.jsonpCallback,Bt.push(a)),o&&h(i)&&i(o[0]),o=i=void 0}),"script"}),d.createHTMLDocument=(($t=m.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===$t.childNodes.length),w.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(d.createHTMLDocument?((r=(t=m.implementation.createHTMLDocument("")).createElement("base")).href=m.location.href,t.head.appendChild(r)):t=m),i=!n&&[],(a=A.exec(e))?[t.createElement(a[1])]:(a=be([e],t,i),i&&i.length&&w(i).remove(),w.merge([],a.childNodes)));var r,a,i},w.fn.load=function(e,t,n){var r,a,i,o=this,s=e.indexOf(" ");return s>-1&&(r=ht(e.slice(s)),e=e.slice(0,s)),h(t)?(n=t,t=void 0):t&&"object"===(void 0===t?"undefined":_typeof(t))&&(a="POST"),o.length>0&&w.ajax({url:e,type:a||"GET",dataType:"html",data:t}).done(function(e){i=arguments,o.html(r?w("<div>").append(w.parseHTML(e)).find(r):e)}).always(n&&function(e,t){o.each(function(){n.apply(this,i||[e.responseText,t,e])})}),this},w.expr.pseudos.animated=function(e){return w.grep(w.timers,function(t){return e===t.elem}).length},w.offset={setOffset:function(e,t,n){var r,a,i,o,s,c,u=w.css(e,"position"),l=w(e),p={};"static"===u&&(e.style.position="relative"),s=l.offset(),i=w.css(e,"top"),c=w.css(e,"left"),("absolute"===u||"fixed"===u)&&(i+c).indexOf("auto")>-1?(o=(r=l.position()).top,a=r.left):(o=parseFloat(i)||0,a=parseFloat(c)||0),h(t)&&(t=t.call(e,n,w.extend({},s))),null!=t.top&&(p.top=t.top-s.top+o),null!=t.left&&(p.left=t.left-s.left+a),"using"in t?t.using.call(e,p):("number"==typeof p.top&&(p.top+="px"),"number"==typeof p.left&&(p.left+="px"),l.css(p))}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){w.offset.setOffset(this,e,t)});var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],a={top:0,left:0};if("fixed"===w.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===w.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((a=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),a.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-a.top-w.css(r,"marginTop",!0),left:t.left-a.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===w.css(e,"position");)e=e.offsetParent;return e||ne})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;w.fn[e]=function(r){return H(this,function(e,r,a){var i;if(y(e)?i=e:9===e.nodeType&&(i=e.defaultView),void 0===a)return i?i[t]:e[r];i?i.scrollTo(n?i.pageXOffset:a,n?a:i.pageYOffset):e[r]=a},e,r,arguments.length)}}),w.each(["top","left"],function(e,t){w.cssHooks[t]=ze(d.pixelPosition,function(e,n){if(n)return n=He(e,t),Le.test(n)?w(e).position()[t]+"px":n})}),w.each({Height:"height",Width:"width"},function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){w.fn[r]=function(a,i){var o=arguments.length&&(n||"boolean"!=typeof a),s=n||(!0===a||!0===i?"margin":"border");return H(this,function(t,n,a){var i;return y(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===a?w.css(t,n,s):w.style(t,n,a,s)},t,o?a:void 0,o)}})}),w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}});var Ut=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),h(e))return r=a.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(a.call(arguments)))}).guid=e.guid=e.guid||w.guid++,i},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=j,w.isFunction=h,w.isWindow=y,w.camelCase=W,w.type=b,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},w.trim=function(e){return null==e?"":(e+"").replace(Ut,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return w});var Gt=e.jQuery,Xt=e.$;return w.noConflict=function(t){return e.$===w&&(e.$=Xt),t&&e.jQuery===w&&(e.jQuery=Gt),w},void 0===t&&(e.jQuery=e.$=w),w}),define("jqueryplugins",["jquery"],function(e){e.prototype.extend({popAttr:function(e){var t=this.attr(e);return this.removeAttr(e),t},popData:function(e){var t=this.data(e);return this.removeData(e),t},tag:function(){return this[0]&&this[0].tagName&&this[0].tagName.toLowerCase()},textNodes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return 1===this.length&&this[0]instanceof Text?[this[0]]:this.get().concat(this.contents().get(),this.find(e).contents().get()).filter(function(e,t,n){return e instanceof Text&&n.indexOf(e)===t}).sort(function(e,t){return 2&e.compareDocumentPosition(t)?1:-1})},findAndFilter:function(e){return this.filter(e).add(this.find(e))}})}),function(){var e=void 0,t={};function n(){for(var e=0;e<arguments.length;e++)for(var t in arguments[e])this[t]=arguments[e][t]}function r(e,t){e.childAt=e.childAt||{};for(var n=t.start;n<t.end;n+=1)e.childAt[n]=t}function a(e,t,n,r){return!(e.canFollow&&!(e.canFollow.indexOf(n&&n.type)>-1)||e.cannotFollow&&(-1!==e.cannotFollow.indexOf(n&&n.type)||e.cannotFollow.indexOf("text")>-1&&r)||e.peek&&e.peek.toLowerCase()!==t.slice(0,e.peek.length).toLowerCase())}function i(e){for(var n=e.innerText,r=[],i=0,s=i,c=n.length,u=null;i<c;){for(var l=n.slice(i),p=(r.length?r[0]:e).innerMode,f=0,d=p.length;f<d;f+=1){var h=t[p[f]];if(a(h,l,u,s<i)&&h.pattern.test(l)){var y=h.pattern.exec(l),m=h.fn(y),g=!1,v=0;if(m.matches){for(;v<r.length;v+=1){var b=r[v].type;if(b in m.matches){g=!0;break}0===b.indexOf("verbatim")&&(b="verbatimOpener"),m.cannotCross&&m.cannotCross.indexOf(b)>-1&&(v=r.length-1)}if(v>=r.length&&!m.isFront)continue}s<i&&e.addChild({type:"text",text:n.slice(s,i),innerMode:p}),s=i+=(u=e.addChild(m)).text.length,g&&(o(e,u,r[v]),r=r.slice(v+1)),u.isFrontToken()&&r.unshift(u);break}}f===d&&(i+=1,null===u&&(u={type:"text"}))}for(s<i&&e.addChild({type:"text",text:n.slice(s,i),innerMode:(r.length?r[0]:e).innerMode});r.length>0;)r.shift().demote();return e}function o(e,t,n){var a=e.children.indexOf(t),i=e.children.indexOf(n);t.children=e.children.splice(i+1,a-(i+1)),t.children.forEach(function(e){r(t,e)}),t.type=t.matches[n.type],t.innerText="";for(var o=0,s=t.children.length;o<s;o++)t.innerText+=t.children[o].text;t.start=n.start,t.text=n.text+t.innerText+t.text,Object.keys(n).forEach(function(e){Object.hasOwnProperty.call(t,e)||(t[e]=n[e])}),t.isFront&&(t.isFront=!1),e.children.splice(i,1),r(e,t)}n.prototype={constructor:n,addChild:function(e){var t=this.lastChildEnd(),a=new n({start:t,end:e.text&&t+e.text.length,children:[]},e);return a.innerText&&i(a),this.children.push(a),r(this,a),a},firstChild:function(){return this.children&&this.children[0]||null},lastChild:function(){return this.children&&this.children[this.children.length-1]||null},lastChildEnd:function(){var e=this.lastChild();return e?e.end:this.start+Math.max(0,this.text.indexOf(this.innerText))},tokenAt:function(e){if(e<this.start||e>=this.end)return null;if(this.childAt)return this.childAt[e]&&this.childAt[e].tokenAt(e)||this;if(this.children.length)for(var t=0;t<this.children.length;t+=1){var n=this.children[t].tokenAt(e);if(n)return n}return this},pathAt:function(e){if(e<this.start||e>=this.end)return[];if(this.childAt)return(this.childAt[e]&&this.childAt[e].pathAt(e)||[]).concat(this);var t=[];if(this.children.length)for(var n=0;n<this.children.length;n+=1){var r=this.children[n].pathAt(e);if(r.length){t.concat(r);break}}return t.concat(this)},nearestTokenAt:function(e){return e<this.start||e>=this.end?null:this.children?this.children.reduce(function(t,n){return t||(e>=n.start&&e<n.end?n:null)},null):this},everyLeaf:function(e){return this.children&&0!==this.children.length?this.children.reduce(function(t,n){return t&&n.everyLeaf(e)},!0):!!e(this)},isWhitespace:function(){return this.everyLeaf(function(e){return"whitespace"===e.type||!e.text.trim()})},isFrontToken:function(){return this.isFront},isBackToken:function(){return"matches"in this},demote:function(){this.type="text"},error:function(e){this.type="error",this.message=e},toString:function(){var e=this.type+"("+this.start+"\u2192"+this.end+")";return this.children&&this.children.length>0&&(e+="["+this.children+"]"),e}},e={lex:function(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"start";return i(new n({type:"root",start:r||0,end:t.length,text:t,innerText:t,children:[],childAt:{},innerMode:e.modes[a]}))},rules:t,modes:{}},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=e:"function"==typeof define&&define.amd?define("lexer",[],function(){return e}):this&&this.loaded?(this.modules||(this.modules={}),this.modules.Lexer=e):this.TwineLexer=e}.call(eval("this")||("undefined"!=typeof global?global:window)),function(){var e;function t(e){return e&&"object"===(void 0===e?"undefined":_typeof(e))?(Object.keys(e).forEach(function(n){e[n]=t(e[n])}),e):(e+"").replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function n(e){return function(){return"("+e+Array.apply(0,arguments).join("|")+")"}}var r=n("?:"),a=n("?!"),i=n("?="),o="[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",s=o.replace("*","+"),c="\\b",u="[\\w\\-\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",l=u.replace("\\-",""),p=r("\\n","$"),f=o+"(\\*+)"+s,d=o+"((?:0\\.)+)"+s,h=o+"-{3,}"+o+p,y=o+"(==+>|<=+|=+><=+|<==+>)"+o+p,m=o+"(=+\\|+|\\|+=+|=+\\|+=+|\\|=+\\|)"+o+p,g={opener:"\\[\\[(?!\\[)",text:"("+function(){return"[^"+Array.apply(0,arguments).map(t).join("")+"]*"}("]")+")",rightSeparator:r("\\->","\\|"),leftSeparator:"<\\-",closer:"\\]\\]",legacySeparator:"\\|",legacyText:"("+r("[^\\|\\]]","\\]"+a("\\]"))+"+)"},v=l+"*"+l.replace("\\w","a-zA-Z")+l+"*",b="\\$("+v+")",w="_("+v+")",T="'s"+s+"("+v+")",S="("+v+")"+s+"of"+c+a("it\\b"),x="'s"+s,k=r("it","time","visits?","exits?","pos")+c,O="its"+s+"("+v+")",j="its"+s,A="("+v+")"+s+"of"+s+"it"+c,C="of\\b"+s+"it"+c,E={opener:"\\(",name:"("+r("\\$","_")+"?"+u+"+):"+a("\\/"),closer:"\\)"},_=r("=<","=>","[gl]te?\\b","n?eq\\b","isnot\\b","are\\b","x\\b","isa\\b","or"+s+"a"+c),N="[a-zA-Z][\\w\\-]*",P="(?:\"[^\"]*\"|'[^']*'|[^'\">])*?",I="\\|("+u+"+)(>|\\))",M="(<|\\()("+u+"+)\\|",D="\\b(\\d+(?:\\.\\d+)?(?:[eE][+\\-]?\\d+)?)"+a("m?s")+c;g.main=g.opener+r(g.text+g.rightSeparator,g.text.replace("*","*?")+g.leftSeparator)+g.text,e={upperLetter:"[A-Z\\u00c0-\\u00de\\u0150\\u0170]",lowerLetter:"[a-z0-9_\\-\\u00df-\\u00ff\\u0151\\u0171]",anyLetter:u,anyLetterStrict:l,whitespace:s.replace("[","[\\n\\r"),escapedLine:"\\\\\\n\\\\?|\\n\\\\",br:"\\n(?!\\\\)",commentFront:"\x3c!--",commentBack:"--\x3e",tag:"<\\/?"+N+P+">",tagPeek:"<",scriptStyleTag:"<("+r("script","style","textarea")+")"+P+">[^]*?<\\/\\1>",scriptStyleTagOpener:"<",url:"("+r("https?","mailto","javascript","ftp","data")+":\\/\\/[^\\s<]+[^<.,:;\"')\\]\\s])",bullet:"\\*",hr:h,heading:"[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*(#{1,6})[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",align:y,column:m,bulleted:f,numbered:d,strikeOpener:t("~~"),italicOpener:t("//"),boldOpener:t("''"),supOpener:t("^^"),strongFront:t("**"),strongBack:t("**"),emFront:t("*"),emBack:t("*"),verbatimOpener:"`+",collapsedFront:"{",collapsedBack:"}",hookAppendedFront:"\\["+a("=+"),hookPrependedFront:I+"\\["+a("=+"),hookFront:"\\["+a("=+"),hookBack:"\\]"+a(M),hookAppendedBack:"\\]"+M,unclosedHook:"\\[=+",unclosedHookPrepended:I+"\\[=+",unclosedCollapsed:"\\{=+",passageLink:g.main+g.closer,passageLinkPeek:"[[",legacyLink:g.opener+g.legacyText+g.legacySeparator+g.legacyText+g.closer,legacyLinkPeek:"[[",simpleLink:g.opener+g.legacyText+g.closer,simpleLinkPeek:"[[",macroFront:E.opener+i(E.name),macroFrontPeek:"(",macroName:E.name,groupingFront:"\\("+a(E.name),groupingFrontPeek:"(",groupingBack:"\\)",twine1Macro:"<<[^>\\s]+\\s*(?:\\\\.|'(?:[^'\\\\]*\\\\.)*[^'\\\\]*'|\"(?:[^\"\\\\]*\\\\.)*[^\"\\\\]*\"|[^'\"\\\\>]|>(?!>))*>>",twine1MacroPeek:"<<",validPropertyName:v,property:T,propertyPeek:"'s",belongingProperty:S,possessiveOperator:x,belongingOperator:"of\\b",belongingOperatorPeek:"of",itsOperator:j,itsOperatorPeek:"its",belongingItOperator:C,belongingItOperatorPeek:"of",variable:b,variablePeek:"$",tempVariable:w,tempVariablePeek:"_",hookName:"\\?("+u+"+)\\b",hookNamePeek:"?",cssTime:"(\\d+\\.?\\d*|\\d*\\.?\\d+)(m?s)\\b",colour:r(r("Red","Orange","Yellow","Lime","Green","Cyan","Aqua","Blue","Navy","Purple","Fuchsia","Magenta","White","Gray","Grey","Black","Transparent"),"#[\\dA-Fa-f]{3}(?:[\\dA-Fa-f]{3})?"),datatype:r("alnum","alphanumeric","any(?:case)?","array","bool(?:ean)?","changer","colou?r","const","command","dm","data"+r("map","type","set"),"ds","digit","gradient","empty","even","int"+a("o")+"(?:eger)?","lambda","lowercase","macro","linebreak","num(?:ber)?","odd","str(?:ing)?","uppercase","whitespace")+c,number:D,boolean:r("true","false")+c,identifier:k,itsProperty:O,itsPropertyPeek:"its",belongingItProperty:A,escapedStringChar:"\\\\[^\\n]",singleStringOpener:"'",doubleStringOpener:'"',singleStringCloser:"'",doubleStringCloser:'"',is:"is"+a(s+"not"+c,s+"an?"+c,s+"in"+c,s+"<",s+">")+c,isNot:"is"+s+"not"+a(s+r("an?","in")+c)+c,isA:"is"+s+"an?"+c,isNotA:"is"+s+"not"+s+"an?"+c,matches:"matches\\b",doesNotMatch:"does"+s+"not"+s+"match"+c,and:"and\\b",or:"or\\b",not:"not\\b",inequality:"((?:is(?:"+s+"not)?"+o+")*)("+r("<(?!=)","<=",">(?!=)",">=")+")",isIn:"is"+s+"in"+c,contains:"contains\\b",doesNotContain:"does"+s+"not"+s+"contain"+c,isNotIn:"is"+s+"not"+s+"in"+c,addition:t("+")+a("="),subtraction:t("-")+a("=","type"),multiplication:t("*")+a("="),division:r("/","%")+a("="),comma:",",spread:"\\.\\.\\."+a("\\."),to:r("to\\b","="),into:"into\\b",making:"making\\b",where:"where\\b",when:"when\\b",via:"via\\b",each:"each\\b",augmentedAssign:r("\\+","\\-","\\*","\\/","%")+"=",bind:"2?bind\\b",typeSignature:t("-type")+c,incorrectOperator:_},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=e:"function"==typeof define&&define.amd?define("patterns",[],function(){return e}):this&&this.loaded?(this.modules||(this.modules={}),this.modules.Patterns=e):this.Patterns=e}.call(eval("this")||("undefined"!=typeof global?global:window)),function(){var e=void 0;Object.assign=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var t=Object.keys,n=Object.assign;function r(r){return Object.freeze({lex:function(r){function a(e){return e=e||"innerText",function(t){var n=t.reduceRight(function(e,t,n){return e||(n?t:"")},""),r={};return r[e]=n,r}}function i(e,t){var n={};return n[e]=t,function(){return{isFront:!0,matches:n,cannotCross:["verbatimOpener"]}}}var o=Object.bind(0,null);function s(e,t){return Object.keys(t).forEach(function(n){var r=t[n].fn;t[n].fn=function(t){var a=r(t);return a.text||(a.text=t[0]),a.type||(a.type=n),a.innerMode||(a.innerMode=e),a}}),t}var c=[],u=[],l=[],p=s(c,{hr:{fn:o},bulleted:{fn:function(e){return{depth:e[1].length}}},numbered:{fn:function(e){return{depth:e[1].length/2}}},heading:{fn:function(e){return{depth:e[1].length}}},align:{fn:function(e){var t=void 0,n=e[1],r=n.indexOf("><");return~r?25===(t=Math.round(r/(n.length-2)*50))&&(t="center"):"<"===n[0]&&">"===n.slice(-1)?t="justify":n.indexOf(">")>-1?t="right":n.indexOf("<")>-1&&(t="left"),{align:t}}},column:{fn:function(e){var t=void 0,n=e[1],r=n.indexOf("|");return r&&r<n.length-1?t="center":"|"===n[0]&&"|"===n.slice(-1)?t="none":r===n.length-1?t="right":r||(t="left"),{column:t,width:/\|+/.exec(n)[0].length,marginLeft:/^=*/.exec(n)[0].length,marginRight:/=*$/.exec(n)[0].length}}}});t(p).forEach(function(e){p[e].canFollow=[null,"br","hr","bulleted","numbered","heading","align","column","escapedLine"],p[e].cannotFollow=["text"]});var f=s(c,{twine1Macro:{fn:function(){return{type:"error",message:"Harlowe macros use a different syntax to Twine 1, SugarCube, and Yarn macros."}}},emBack:{fn:function(){return{matches:{emFront:"em"},cannotCross:["verbatimOpener"]}}},strongBack:{fn:function(){return{matches:{strongFront:"strong"},cannotCross:["verbatimOpener"]}}},strongFront:{fn:function(){return{isFront:!0}}},emFront:{fn:function(){return{isFront:!0}}},boldOpener:{fn:i("boldOpener","bold")},italicOpener:{fn:i("italicOpener","italic")},strikeOpener:{fn:i("strikeOpener","strike")},supOpener:{fn:i("supOpener","sup")},commentFront:{fn:function(){return{isFront:!0}}},commentBack:{fn:function(){return{matches:{commentFront:"comment"}}}},scriptStyleTag:{fn:o},tag:{fn:o},url:{fn:o},hookPrependedFront:{fn:function(e){return{name:e[1],hidden:")"===e[2],isFront:!0,tagPosition:"prepended"}}},hookFront:{fn:function(){return{isFront:!0}}},hookBack:{fn:function(){return{matches:{hookPrependedFront:"hook",hookFront:"hook"},cannotCross:["verbatimOpener"]}}},hookAppendedBack:{fn:function(e){return{name:e[2],hidden:"("===e[1],tagPosition:"appended",matches:{hookFront:"hook"},cannotCross:["verbatimOpener"]}}},unclosedHook:{fn:o},unclosedHookPrepended:{fn:function(e){return{type:"unclosedHook",name:e[1],hidden:")"===e[2]}}},verbatimOpener:{fn:function(e){var t=e[0].length,n={};return n["verbatim"+t]="verbatim",{type:"verbatim"+t,isFront:!0,matches:n}}},unclosedCollapsed:{fn:o},collapsedFront:{fn:function(){return{isFront:!0}}},collapsedBack:{fn:function(){return{matches:{collapsedFront:"collapsed"},cannotCross:["verbatimOpener"]}}},escapedLine:{fn:o},legacyLink:{fn:function(e){return{type:"twineLink",innerText:e[1],passage:e[2],innerMode:c}}},br:{fn:o}}),d=n(s(u,{macroFront:{fn:function(e){return{isFront:!0,name:e[1]}}},groupingBack:{fn:function(){return{matches:{groupingFront:"grouping",macroFront:"macro"},cannotCross:["singleStringOpener","doubleStringOpener"]}}},passageLink:{fn:function(e){var t=e[1]||"",n=e[2]||"",r=e[3]||"";return{type:"twineLink",innerText:n?r:t,passage:t?r:n,innerMode:c}}},simpleLink:{fn:function(e){return{type:"twineLink",innerText:e[1]||"",passage:e[1]||"",innerMode:c}}},variable:{cannotFollow:["macroFront"],fn:a("name")},tempVariable:{cannotFollow:["macroFront"],fn:a("name")}}),{hookFront:f.hookFront,hookBack:f.hookBack}),h=s(u,n({macroName:{canFollow:["macroFront"],fn:a("name")},groupingFront:{fn:function(){return{isFront:!0}}},property:{fn:a("name"),canFollow:["variable","hookName","property","tempVariable","colour","itsProperty","belongingItProperty","macro","grouping","string","datatype","hook","boolean","number"]},possessiveOperator:{fn:o},itsProperty:{cannotFollow:["text"],fn:a("name")},itsOperator:{cannotFollow:["text"],fn:o},belongingItProperty:{cannotFollow:["text"],fn:a("name")},belongingItOperator:{cannotFollow:["text"],fn:o},belongingProperty:{cannotFollow:["text"],fn:a("name")},belongingOperator:{cannotFollow:["text"],fn:o},escapedStringChar:{fn:function(){return{type:"text"}}},singleStringOpener:{fn:function(){return{isFront:!0,matches:{singleStringOpener:"string"},innerMode:l}}},doubleStringOpener:{fn:function(){return{isFront:!0,matches:{doubleStringOpener:"string"},innerMode:l}}},hookName:{fn:a("name")},cssTime:{fn:function(e){return{value:+e[1]*("s"===e[2].toLowerCase()?1e3:1)}}},datatype:{cannotFollow:["text"],fn:function(e){return{name:e[0].toLowerCase()}}},colour:{cannotFollow:["text"],fn:function(e){var t=e[0].toLowerCase(),n={red:"e61919",orange:"e68019",yellow:"e5e619",lime:"80e619",green:"19e619",cyan:"19e5e6",aqua:"19e5e6",blue:"197fe6",navy:"1919e6",purple:"7f19e6",fuchsia:"e619e5",magenta:"e619e5",white:"fff",black:"000",gray:"888",grey:"888"};return{colour:Object.hasOwnProperty.call(n,t)?"#"+n[t]:t}}},number:{fn:function(e){return{value:parseFloat(e[0])}}},inequality:{fn:function(e){return{operator:e[2],negate:e[1].indexOf("not")>-1}}},augmentedAssign:{fn:function(e){return{operator:e[0][0]}}},identifier:{fn:a("name"),cannotFollow:["text"]},whitespace:{fn:o,cannotFollow:"text"},incorrectOperator:{fn:function(e){var t={"=>":">=","=<":"<=",gte:">=",lte:"<=",gt:">",lt:"<",eq:"is",isnot:"is not",neq:"is not",isa:"is a",are:"is",x:"*","or a":"or"}[e[0].toLowerCase().replace(/\s+/g," ")];return{type:"error",message:"Please say "+(t?"'"+t+"'":"something else")+" instead of '"+e[0]+"'.",explanation:"In the interests of readability, I want certain operators to be in a specific form."}},cannotFollow:"text"}},["boolean","is","to","into","where","when","via","making","each","and","or","not","isNot","contains","doesNotContain","isIn","isA","isNotA","isNotIn","matches","doesNotMatch","bind"].reduce(function(e,t){return e[t]={fn:o,cannotFollow:["text"]},e},{}),["comma","spread","typeSignature","addition","subtraction","multiplication","division"].reduce(function(e,t){return e[t]={fn:o},e},{}))),y=s(l,{singleStringCloser:h.singleStringOpener,doubleStringCloser:h.doubleStringOpener,escapedStringChar:h.escapedStringChar});c.push.apply(c,_toConsumableArray(t(p)).concat(_toConsumableArray(t(d)),_toConsumableArray(t(f)))),u.push.apply(u,_toConsumableArray(t(d)).concat(_toConsumableArray(t(h)))),l.push.apply(l,_toConsumableArray(t(y)));var m=n({},p,f,d,h,y);t(m).forEach(function(t){var n=e[t];m[t].pattern="string"!=typeof n?n:RegExp("^(?:"+n+")","i"),e[t+"Peek"]&&(m[t].peek=e[t+"Peek"])}),n(r.rules,m);var g=r.modes;return g.start=g.markup=c,g.macro=u,g.string=l,r}(r).lex,Patterns:e})}"object"===("undefined"==typeof module?"undefined":_typeof(module))?(e=require("./patterns"),module.exports=r(require("./lexer"))):"function"==typeof define&&define.amd?define("markup",["lexer","patterns"],function(t,n){return e=n,r(t)}):this&&this.loaded&&this.modules?(e=this.modules.Patterns,this.modules.Markup=r(this.modules.Lexer)):(e=this.Patterns,this.TwineMarkup=r(this.TwineLexer))}.call(eval("this")||("undefined"!=typeof global?global:window)),define("utils/polyfills",[],function(){var e=Array.prototype;"function"!=typeof e.includes&&(e.includes=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!Number.isNaN(t)&&Number.isFinite(n)&&void 0!==t)return e.indexOf.call(this,t,n)>-1;var r=Object(this),a=parseInt(r.length);if(a<=0)return!1;for(var i=n>=0?n:Math.max(0,a+n);i<a;){if(Object.is(t,r[i]))return!0;i+=1}return!1}),!window.Symbol&&(window.Symbol={iterator:"_es6-shim iterator_"})}),define("utils",["jquery","markup","utils/polyfills"],function(e){var t=String.fromCharCode,n="audio,blockquote,canvas,div,h1,h2,h3,h4,h5,hr,ol,p,pre,table,ul,video,tw-align,tw-story,tw-passage,tw-sidebar,tw-columns,tw-column,tw-meter".split(","),r="a,b,i,em,strong,sup,sub,abbr,acronym,s,strike,del,big,small,script,img,button,input,tw-link,tw-broken-link,tw-verbatim,tw-collapsed,tw-error,tw-colour,tw-icon".split(","),a=["audio"],i=[function(e){return t(e)!==t(e).toLowerCase()},function(e){return t(e)!==t(e).toUpperCase()},function(e){return t(e).toLowerCase()!==t(e).toUpperCase()}].map(function(e){return"["+Array.from(Array(57343)).map(function(e,t){return t}).filter(e).map(function(e,n,r){return e===r[n-1]+1&&e===r[n+1]-1?"-":t(e)}).join("").replace(/\-+/g,"-")+"]"}),o=_slicedToArray(i,3),s=o[0],c=o[1],u=o[2];function l(e){return"instant"===e?0:800}var p=void 0,f=[],d={},h=0,y={},m=0,g={},v=void 0;function b(e,t,n,r,a){var i=null,o=0,s=t+n;function c(n){1&e[0].compareDocumentPosition(document)&&(s=0),i&&(s-=n-i,o+=n-i),i=n,r>0&&h+m>0&&(s-=r,e.css("animation-delay",(v.cssTimeUnit(e.css("animation-delay"))||0)-r+"ms")),s<=0?a(o):requestAnimationFrame(c),s<=t&&e.css("visibility","")}s?requestAnimationFrame(c):c()}return e(document.documentElement).on("keydown keyup mousedown mouseup",function(e){var t=e.key,n=e.button,r=e.type.includes("down"),a=t?d:y,i=t&&v.insensitiveName(t)||n;a[i]&&!r?t?h=Math.max(h-1,0):m=Math.max(m-1,0):!a[i]&&r&&(t?h+=1:m+=1),a[i]=r}).on("mousemove",function(e){var t=e.pageX,n=e.pageY;g.x=t,g.y=n}),v={lockProperty:function(e,t,n){var r=Object.create({configurable:0,writable:0});return n&&(r.value=n),Object.defineProperty(e,t,r),e},permutations:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=t.length,a=[[].concat(t)],i=Array(r).fill(0),o=1,s=void 0,c=void 0;o<r;)i[o]<o?(s=o%2&&i[o],c=t[o],t[o]=t[s],t[s]=c,++i[o],o=1,a.push([].concat(t))):(i[o]=0,++o);return a},shuffled:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t,n){var r=Math.random()*(n+1)|0;return r===n?e.push(t):(e.push(e[r]),e[r]=t),e},[])},matMul:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i;if(r.length>0)return(i=v).matMul.apply(i,[v.matMul(e,t)].concat(r));if(!t)return e;for(var o=[],s=0;s<e.length;s++){o[s]=[];for(var c=0;c<t[0].length;c++){for(var u=0,l=0;l<e[0].length;l++)u+=e[s][l]*t[l][c];o[s][c]=u}}return o},cssTimeUnit:function(e){return"ms"===(e=e.toLowerCase()).slice(-2)?+e.slice(0,-2)||0:"s"===e.slice(-1)&&1e3*+e.slice(0,-1)||0},nth:function(e){var t=(+e+"").slice(-1);return e+("1"===t?"st":"2"===t?"nd":"3"===t?"rd":"th")},plural:function(e,t){return e+" "+t+(e>1?"s":"")},andList:function(e){return 1===e.length?e[0]:e.slice(0,-1).join(", ")+" and "+e[e.length-1]},realWhitespace:"[ \\n\\r\\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]",anyRealLetter:"[\\dA-Za-z\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",anyUppercase:s,anyLowercase:c,anyCasedLetter:u,anyNewline:"(?:\\n|\\r|\\r\\n)",unescape:function(e){return e.replace(/&(?:amp|lt|gt|quot|nbsp|zwnj|#39|#96);/g,function(e){return{"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'","&nbsp;":String.fromCharCode(160),"&zwnj;":String.fromCharCode(8204)}[e]})},escape:function(e){return e.replace(/[&><"']/g,function(e){return{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"}[e]})},insensitiveName:function(e){return(e+"").toLowerCase().replace(/-|_/g,"")},allKeysDown:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return d[e]})},someKeysDown:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function(e){return d[e]})},buttonsDown:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return y[e]})},anyInputDown:function(){return h+m>0},mouseCoords:g,parentColours:function(e){for(var t={colour:null,backgroundColour:null},n=/^\w+a\(.+?,\s*0\s*\)$|^transparent$/;e.length&&e[0]!==document;e=e.parent()){if(!t.backgroundColour){var r=e.css("background-color");r.match(n)||(t.backgroundColour=r)}if(!t.colour){var a=e.css("color");a.match(n)||(t.colour=a)}if(t.colour&&t.backgroundColour)return t}return{colour:"#fff",backgroundColour:"#000"}},childrenProbablyInline:function(e){var t=[];return[].every.call(e.findAndFilter("*"),function(e){return!!(e.hidden||/none|inline/.test(e.style.display)||/display: (none|inline)/.test(e.getAttribute("style")))||!n.includes(e.tagName.toLowerCase())&&!/display: (?!none|inline|inherit|unset)/.test(e.getAttribute("style"))&&(!!r.includes(e.tagName.toLowerCase())||(t.push(e),!0))})&&t.every(function(e){return window.getComputedStyle(e).display.includes("inline")})},transitionReplace:function(t,n,r){var a=t.closest("tw-hook");a.length>0&&(t=a);var i=e("<tw-transition-container>").css("position","relative");i.insertBefore(t.first());var o=void 0;n&&(o=e("<tw-transition-container>").appendTo(i),n.appendTo(o));var s=e("<tw-transition-container>").css("position","absolute").prependTo(i);t.detach().appendTo(s),v.transitionOut(s,r),n&&v.transitionIn(o,r,function(){o.unwrap().children().first().unwrap()})},transitionOut:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;0!==e.length&&(n=n||l(t),(e.length>1||!v.childrenProbablyInline(e)||!["tw-hook","tw-passage","tw-expression"].includes(e.tag()))&&(e=e.wrapAll("<tw-transition-container>").parent()),o&&e.css("transform-origin",o),e.attr("data-t8n",t).addClass("transition-out").css({"animation-duration":n+"ms","animation-delay":r-i+"ms"}),requestAnimationFrame(function(){v.childrenProbablyInline(e)?e.css("display","inline"):e.parent().is("tw-backdrop,tw-story")||e[0].setAttribute("style",e[0].getAttribute("style")+"display:block !important;width:100%")}),b(e,n,r-i,a,function(){e.remove()}))},transitionIn:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;if(0!==t.length){r=r||l(n);var u=t.length>1||!v.childrenProbablyInline(t)||!["tw-hook","tw-passage","tw-expression"].includes(t.tag());u&&(t=t.wrapAll("<tw-transition-container>").parent()),c&&t.css("transform-origin",c),t.attr("data-t8n",n).addClass("transition-in").css(Object.assign({"animation-duration":r+"ms","animation-delay":i-s+"ms"},i-s?{visibility:"hidden"}:{})),requestAnimationFrame(function(){v.childrenProbablyInline(t)?t.css("display","inline"):t.parent().is("tw-backdrop,tw-story")||t[0].setAttribute("style",t[0].getAttribute("style")+"display:block !important;width:100%")}),b(t,r,i-s,o,function(n){var r=0===t.filter(a.join(",")).length;u&&r?(t.find("tw-transition-container").each(function(t,r){(r=e(r)).css("animation-delay",v.cssTimeUnit(r.css("animation-delay")||0)-n+"ms")}),t.contents().unwrap()):t.removeClass("transition-in").removeAttr("data-t8n")})}},debounce:function(e){var t=void 0,n=void 0,r=0,a=function a(){Date.now()-r>300?(t=0,e.apply(void 0,_toConsumableArray(n))):t=requestAnimationFrame(a)};return function(){r=Date.now(),n=arguments,t&&cancelAnimationFrame(t),t=requestAnimationFrame(a)}},impossible:function(e,t){window.console&&console.error(e+"(): "+t)},assertMustHave:function(e,t){if(window.console)for(var n=0;n<t.length;n+=1)t[n]in e||console.error("Assertion failed: object lacks property "+t[n])},assertOnlyHas:function(e,t){if(window.console)for(var n in e)t.includes(n)||console.error("Assertion failed: object had unexpected property '"+n+"'!")},onStartup:function(e){f?f.push(e):e()},get storyElement(){return p}},e(function(){p=e("tw-story"),f.forEach(function(e){return e()}),f=null}),Object.freeze(v)}),define("utils/naturalsort",[],function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:String;return function(n,r){var a,i,o,s,c=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,u=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,p=/^0/,f=t(n).trim(),d=t(r).trim(),h=f.replace(c,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),y=d.replace(c,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=parseInt(f.match(l))||1!==h.length&&f.match(u)&&Date.parse(f),g=parseInt(d.match(l))||m&&d.match(u)&&Date.parse(d)||null;if(e&&window.Intl&&window.Intl.Collator&&(o=window.Intl.Collator(e)),g){if(m<g)return-1;if(m>g)return 1}for(var v=0,b=Math.max(h.length,y.length);v<b;v++){if(a=!(h[v]||"").match(p)&&parseFloat(h[v])||h[v]||0,i=!(y[v]||"").match(p)&&parseFloat(y[v])||y[v]||0,isNaN(a)!==isNaN(i))return isNaN(a)?1:-1;if((void 0===a?"undefined":_typeof(a))!==(void 0===i?"undefined":_typeof(i)))a+="",i+="";else if("string"==typeof a&&o&&0!==(s=o.compare(a,i)))return s;if(a<i)return-1;if(a>i)return 1}return 0}}}),define("twinescript/compiler",["utils"],function(e){var t=e.impossible,n=JSON.stringify;function r(e,t){for(var n=0;n<e.length;n+=1)if(t.includes(e[n].type))return n;return NaN}function a(e,t){var n=[];return e.length?([["error"],["comma"],["to","into"],["where","when","via"],["making","each"],["typeSignature"],["augmentedAssign"],["and","or"],["is","isNot"],["contains","doesNotContain","isIn","isNotIn"],["isA","isNotA","matches","doesNotMatch"],["inequality"],["addition","subtraction"],["multiplication","division"],{rightAssociative:["spread","bind"]},{rightAssociative:["not","positive","negative"]},{rightAssociative:["belongingProperty","belongingItProperty","belongingOperator","belongingItOperator"]},["property","itsProperty","possessiveOperator","itsOperator"],["twineLink"],["macro"],["grouping"]]["most"===t?"reverse":"valueOf"]().some(function(t){var a=void 0;if(a=t.rightAssociative?r(e,t.rightAssociative):function(e,t){return e.length-1-r.apply(void 0,[[].concat(_toConsumableArray(e)).reverse(),t])}(e,t),!Number.isNaN(a)&&a>-1)return n=[e[a],a],!0}),n):n}function i(e){if("inequality"===e.type){var t=e.operator;return e.negate?{">":"<=","<":">=",">=":"<","<=":">"}[t]:t}return e.type}function o(e){var t=i(e);return{">":"<","<":">",">=":"<=","<=":">=",contains:"isIn",doesNotContain:"isNotIn",isIn:"contains",isA:"typifies",typifies:"isA",isNotA:"untypifies",untypifies:"isNotA"}[t]||t}var s=["inequality","is","isNot","isIn","contains","doesNotContain","isNotIn","isA","typifies","isNotA","untypifies","matches","doesNotMatch"];return function e(r){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=c.isVarRef,l=c.isTypedVar,p=c.whitespaceError,f=c.elidedComparison,d=c.testNeedsRight,h="Operations.Identifiers.it";if(!(r=[].concat(r)).length)return u&&p?"TwineError.create('operation',"+n(p)+")":"";var y=void 0;if(1===r.length){var m=(y=r[0]).type;if("identifier"===m)return u?"VarRef.create(Operations.Identifiers,"+n(y.text)+")":"Operations.Identifiers."+y.text.toLowerCase()+" ";if("variable"===m||"tempVariable"===m){var g="VarRef.create("+("tempVariable"===m?"section.stackTop.tempV":"State.v")+"ariables,"+n(y.name)+")"+(u||l?"":".get()");return l?"TypedVar.create(Datatype.create('any'),"+g+")":g}if("hookName"===m)return"HookSet.create({type:'name', data:'"+y.name+"'}) ";if("string"===m)return y.text.replace(/\n/g,"\\n");if("hook"===m)return"CodeHook.create("+n(y.text.slice(1,-1))+","+n(y.html||"")+")";if("colour"===m)return"Colour.create("+n(y.colour)+")";if("datatype"===m)return"Datatype.create("+n(y.name)+")";if("blockedValue"===m)return"section.blockedValue()";if("root"===m)return e(y.children);if("whitespace"===m&&u&&p)return"TwineError.create('operation',"+n(p)+")"}var v,b=a(r,"least"),w=_slicedToArray(b,2);y=w[0],v=w[1];var T=(y||{}).type,S=r.slice(0,v),x=r.slice(v+1),k=function(e,t){return{isVarRef:!0,isTypedVar:t,whitespaceError:"I need usable data to be on the "+e+' of "'+y.text+'".'}},O="must",j="mustn't",A="may",C=void 0,E=void 0,_="",N="",P="",I=O,M=O,D=!1;if(T)if("comma"===T)N=",",M=A;else if("spread"===T)_="Operations.makeSpreader(",P=")",I=A;else if("bind"===T)_="VarBind.create(",E=e(x,k("right")),P=(y.text.startsWith("2")?",'two way'":"")+")",I=j;else if("to"===T)_="Operations.makeAssignmentRequest(Operations.setIt(",E=e(x,k("right")),N="),",C=e(S,k("left",!0)),P=",'to')";else if("into"===T)_="Operations.makeAssignmentRequest(",E=e(S,k("left")),N=",Operations.setIt(",C=e(x,k("right",!0)),P="),'into')";else if("typeSignature"===T)_="TypedVar.create(",N=",",E=e(x,k("right")),P=")",l=!1;else if("where"===T||"when"===T||"via"===T)_="Lambda.create(",C=e(S,{isVarRef:!0,whitespaceError:null}).trim()||"undefined",N=","+n(y.type)+",",E=n(e(x)),P=","+n(r.map(function(e){return e.text}).join(""))+")";else if("making"===T||"each"===T)"each"===T?(_="Lambda.create(",E=e(x,k("right")).trim(),P=",'where','true',"+n(r.map(function(e){return e.text}).join(""))+")",I=A):(_="Lambda.create(",C=e(S,{isVarRef:!0,whitespaceError:null}).trim()||"undefined",N=","+n(y.type)+",",E=e(x,k("right")).trim(),P=","+n(r.map(function(e){return e.text}).join(""))+")");else if("augmentedAssign"===T)_="Operations.makeAssignmentRequest(",C=e(S,k("left")),N=",",E="Operations["+n(y.operator)+"]("+e(S)+","+e(x)+")",P=","+n(y.operator)+")";else if("and"===T||"or"===T){var R=function e(t){var n=a(t,"least"),r=_slicedToArray(n,2),i=r[0],o=r[1];if(i)return s.includes(i.type)?i:["and","or"].includes(i.type)?e(t.slice(0,o))||e(t.slice(o+1)):void 0},L=R(S),q=R(x),F="TwineError.create('operation', 'This use of \"is not\" and \""+T+"\" is grammatically ambiguous','Maybe try rewriting this as \"__ is not __ "+T+" __ is not __\"') ";if(_="Operations."+T+"(",N=",",P=")",f===y.type)_=P="",C=e(S,{isVarRef:u,elidedComparison:f}).trim(),E=e(x,{elidedComparison:f}).trim();else if(L&&!q){var V=L,H=n(i(V));if("isNot"===V.type||"isNotA"===V.type||"untypifies"===V.type)return F;E="Operations.elidedComparisonOperator("+n(y.type)+","+H+","+e(x,{elidedComparison:T})+")"}else if(!L&&q){var z=q,$=r.indexOf(z),B=n(o(z));if("isNot"===z.type||"isNotA"===z.type||"untypifies"===z.type)return F;E="Operations.elidedComparisonOperator("+n(y.type)+","+B+","+e(S,{elidedComparison:T})+")",C=e([].concat(_toConsumableArray(r.slice($+1)),[Object.assign(Object.create(z),_defineProperty({},"inequality"===z.type?"operator":"type",o(z)))],_toConsumableArray(r.slice(v+1,$))))}u=!1}else if(s.includes(T))D=!0,u=!1,_="Operations["+n(i(y))+"](",N=",",P=")";else if("addition"===T||"subtraction"===T){if(!e(S,{testNeedsRight:!0}).trim())return y.type={addition:"positive",subtraction:"negative"}[T],e(r,{isVarRef:u,whitespaceError:p,elidedComparison:f,testNeedsRight:d});u=!1,_="Operations["+n(y.text)+"](",N=",",P=")"}else if("multiplication"===T||"division"===T)u=!1,_="Operations["+n(y.text)+"](",N=",",P=")";else if("positive"===T||"negative"===T)u=!1,C="negative"===T?"-1":"1",_="Operations['*'](",N=",",P=")";else if("not"===T)_="Operations.not(",E=e(x),P=")",I=A;else if("belongingProperty"===T)_="VarRef.create(",E=e(x,k("right")),P=","+n(y.name)+")"+(u?"":".get()"),I=A;else if("belongingOperator"===T||"belongingItOperator"===T)C=y.type.includes("It")?h:e(x,k("right")),E=e(S),_="VarRef.create(",N=",{computed:true,value:",P="})"+(u?"":".get()");else if("property"===T)_="VarRef.create(",C=e(S,k("left")),P=","+n(y.name)+")"+(u?"":".get()"),M=A;else if("itsProperty"===T||"belongingItProperty"===T)_="VarRef.create(",C=h,P=","+n(y.name)+")"+(u?"":".get()"),I=M=A;else if("possessiveOperator"===T||"itsOperator"===T)y.type.includes("it")&&(C=h,I=A),_="VarRef.create(",N=",{computed:true,value:",P="})"+(u?"":".get()"),l=!1;else if("twineLink"===T)N='Macros.run("link-goto", [section,'+n(y.innerText)+","+n(y.passage)+"])",I=M=j;else if("macro"===T){var W=y.children[0],U="$"===W.text[0]||"_"===W.text[0];"macroName"===W.type||U||t("Compiler.compile","macro token had no macroName child token"),N="Macros.run"+(U?"Custom":"")+"("+(U?"VarRef.create("+("_"===W.text[0]?"section.stackTop.tempV":"State.v")+"ariables,"+n(W.text.trim().slice(1,-1))+").get()":'"'+y.name+'"')+", [section,"+e(y.children.slice(1),{isTypedVar:l})+"])",I=M=j}else if("grouping"===T)N="("+e(y.children,{isVarRef:u})+")",I=M=j;else if("error"===T)return"TwineError.create('syntax',"+n(y.message)+(y.explanation?", "+n(y.explanation):"")+")";return v>-1?(C=(C||e(S,{isVarRef:u,isTypedVar:l})).trim(),E=(E||e(x)).trim(),D&&!C&&(C=h),I===O&&!C||M===O&&!E?d&&M&&!E?"":"TwineError.create('operation','I need usable code to be "+(I===O?"left ":"")+(I===O&&M===O?"and ":"")+(M===O?"right ":"")+'of "'+y.text+"\"')":I===j&&C||M===j&&E?"TwineError.create('operation','There can't be code to the "+(I===j?"left ":"")+(I===j&&M===j?"or ":"")+(M===j?"right ":"")+'of "'+y.text+"\"')":_+C+N+E+P):1===r.length?(("value"in r[0]?r[0].value:r[0].text)+"").trim()||" ":r.reduce(function(t,n){return t+e(n,{isVarRef:u,isTypedVar:l})},"")}}),define("internaltypes/twineerror",["jquery","utils"],function(e,t){var n=t.impossible,r=t.escape;e(document.documentElement).on("click","tw-folddown",function(t){var n=t.target;for((n=e(n)).toggleClass("open");n&&!n.next().length;)n=n.parent();n&&n.next().toggle()});var a={syntax:"The markup seems to contain a mistake.",saving:"I tried to save or load the game, but I couldn't do it.",operation:"I tried to perform an operation on some data, but the data's type was incorrect.",macrocall:"I tried to use a macro, but its call wasn't written correctly.",datatype:"I tried to use a macro, but was given the wrong type of data to it.",custommacro:"I tried to use a custom macro, but its code hook had a mistake in it.",infinite:"I almost ended up doing the same thing over and over, forever.",property:"I tried to access a value in a string/array/datamap, but I couldn't find it.",unimplemented:"I currently don't have this particular feature. I'm sorry.",javascript:"This error message was reported by your browser's Javascript engine. I don't understand it either, but it usually means that an expression was badly written.",propagated:"Click the 'Open' button to see the code hook as it was executed.",user:"This is a custom error created by (error:). It usually means you used a custom macro incorrectly.",assertion:"This command exists to provide a helpful error if a certain important condition wasn't true."},i={error:[],warning:[]},o={create:function(e,t,r,i){return t&&"string"==typeof t||n("TwineError.create","has a bad message string"),r||e in a||n("TwineError.create","no error explanation given"),"user"!==e&&(t=t[0].toUpperCase()+t.slice(1)),Object.assign(Object.create(this),{type:e,message:t,explanation:r,source:void 0,innerDOM:i,appendTitleText:!1})},fromError:function(e){return o.create("javascript","\u2615 "+e.message)},containsError:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return e||(t instanceof Error?t:o.isPrototypeOf(t)?t:!!Array.isArray(t)&&o.containsError.apply(o,_toConsumableArray(t)))},!1)},createWarning:function(e,t){return Object.assign(this.create(e,t),{warning:!0})},render:function(n){var o=this;n=n||this.source||"";var s=e("<tw-error class='"+("javascript"===this.type?"javascript ":"")+(this.warning?"warning":"error")+"' title='"+r(n)+"'>"+r(this.message+(this.appendTitleText?" "+n:""))+"</tw-error>"),c=e("<tw-error-explanation>").text(this.explanation||a[this.type]).hide(),u=e("<tw-folddown tabindex=0>");return this.innerDOM&&e("<tw-open-button>").on("click",function(){var n=e("<tw-backdrop><tw-dialog></tw-backdrop>");n.find("tw-dialog").prepend(o.innerDOM,e("<tw-link tabindex=0>OK</tw-link>").on("click",function(){o.innerDOM.detach(),n.remove()}).wrap("<tw-dialog-links>").parent()),t.storyElement.prepend(n)}).appendTo(s),s.append(u).append(c),s.data("TwineError",this),i.error.forEach(function(e){return e(o,n)}),s},on:function(e,t){if(e in i)return"function"!=typeof t||i[e].includes(t)||i[e].push(t),o;n("TwineError.on","invalid event name")}};return o}),define("renderer",["utils","markup","twinescript/compiler","internaltypes/twineerror"],function(e,t,n,r){var a=e.escape,i=e.impossible,o=e.insensitiveName,s=void 0;function c(e,t){return"<"+t+">"+e+"</"+t+">"}function u(e,t){var n=s.render(e.children);return n&&c(n,t)}var l,p,f="text-align: center; max-width:50%; ",d=RegExp(t.Patterns.macroFront+t.Patterns.macroName,"ig");return s={options:{debug:!1,blockerMacros:[],metadataMacros:[]},preprocess:function(e){var a=s.options.metadataMacros;if(!(e.match(d)||[]).some(function(e){return a.some(function(t){return o(e.slice(1,-1))===t})}))return{};var i=!1,c={};return t.lex(e).children.forEach(function e(t){if("macro"===t.type){if(a.some(function(e){return t.name===e})){if(r.isPrototypeOf(c[t.name]))return;if(i)return void(c[t.name]=r.create("syntax","The ("+t.name+":) macro can't appear after non-metadata macros."));if(c[t.name])return void(c[t.name]=r.create("syntax","There is more than one ("+t.name+":) macro."));c[t.name]={code:n(t),source:t.text}}else i=!0;t.children.forEach(function e(t){"macro"===t.type&&a.some(function(e){return t.name===e})?c[t.name]=r.create("syntax","The ("+t.name+":) macro can't be inside another macro."):t.children.forEach(e)})}else t.children.forEach(e)}),c},exec:(l=void 0,p=void 0,function(e){return"string"!=typeof e?(i("Renderer.exec","source was not a string, but "+(void 0===e?"undefined":_typeof(e))),""):e===l?p:(l=e,p=s.render(t.lex(e).children))}),render:function e(i){var l="",p=[];if(!i)return l;for(var d=i.length,h=0;h<d;h+=1){var y=i[h];switch(y.type){case"error":l+=r.create("syntax",y.message,y.explanation).render(a(y.text))[0].outerHTML;break;case"numbered":case"bulleted":var m="numbered"===y.type?"ol":"ul";l+="<"+m+">";for(var g=1;h<d&&i[h];){if("br"===i[h].type){if(l+="</li>",!i[h+1]||i[h+1].type!==y.type)break}else i[h].type===y.type?(l+=("<"+m+">").repeat(Math.max(0,i[h].depth-g)),l+=("</"+m+">").repeat(Math.max(0,g-i[h].depth)),l+="<li>",g=i[h].depth):l+=e([i[h]]);h+=1}l+=("</"+m+">").repeat(g+1);break;case"align":for(;y&&"align"===y.type;){var v=y.align,b=h+=1;if("left"===v){h-=1;break}for(;h<d&&i[h]&&"align"!==i[h].type;)h+=1;var w=e(i.slice(b,h)),T="";switch(v){case"center":T+=f+"margin-left: auto; margin-right: auto;";break;case"justify":case"right":T+="text-align: "+v+";";break;default:+v&&(T+=f+"margin-left: "+v+"%;")}l+="<tw-align "+(T?'style="'+T+'"':"")+">"+w+"</tw-align>\n",y=i[h]}break;case"column":for(var S=[];y&&"column"===y.type;){var x=y.column,k=h+=1;if("none"===x){h-=1;break}for(;h<d&&i[h]&&"column"!==i[h].type;)h+=1;S.push({text:y.text,type:x,body:e(i.slice(k,h)),width:y.width,marginLeft:y.marginLeft,marginRight:y.marginRight}),y=i[h]}S.length&&function(){var e=S.reduce(function(e,t){return e+t.width},0);l+="<tw-columns>"+S.map(function(t){return"<tw-column type="+t.type+'  style="width:'+t.width/e*100+"%; margin-left: "+t.marginLeft+"em; margin-right: "+t.marginRight+'em;">'+t.body+"</tw-column>\n"}).join("")+"</tw-columns>"}();break;case"heading":for(l+="<h"+y.depth+">";++h<d&&i[h];){if("br"===i[h].type){l+="</h"+y.depth+">";break}l+=e([i[h]])}break;case"br":if(!p.length||/td|th/.test(p[0])){l+="<br>";for(var O=i[h+1];O&&("br"===O.type||"tag"===O.type&&/^<br\b/i.test(O.text));)l+="<tw-consecutive-br"+("tag"===O.type?" data-raw":"")+"></tw-consecutive-br>",O=i[(h+=1)+1]}break;case"hr":l+="<hr>";break;case"escapedLine":case"comment":break;case"inlineUrl":l+='<a class="link" href="'+a(y.text)+'">'+y.text+"</a>";break;case"scriptStyleTag":case"tag":var j=y.text.toLowerCase();/^<\/?(?:table|thead|tbody|tr|tfoot|td|th)\b/.test(j)&&p[y.text.startsWith("</")?"shift":"unshift"](j),l+=y.text.startsWith("</")?y.text:y.text.replace(/>$/," data-raw>");break;case"sub":case"sup":case"strong":case"em":l+=u(y,y.type);break;case"strike":l+=u(y,"s");break;case"bold":l+=u(y,"b");break;case"italic":l+=u(y,"i");break;case"twineLink":var A=_slicedToArray(t.lex("(link-goto:"+JSON.stringify(y.innerText)+","+JSON.stringify(y.passage)+")").children,1)[0];l+='<tw-expression type="macro" name="link-goto"'+(s.options.debug?' title="'+a(y.text)+'"':"")+' js="'+a(n(A))+'"></tw-expression>';break;case"hook":l+="<tw-hook "+(y.hidden?"hidden ":"")+(y.name?'name="'+o(y.name)+'"':"")+(s.options.debug&&y.name?' title="Hook: ?'+y.name+'"':"")+' source="'+a(y.innerText)+'"></tw-hook>';break;case"unclosedHook":return l+="<tw-hook "+(y.hidden?"hidden ":"")+(y.name?'name="'+o(y.name)+'"':"")+'source="'+a(i.slice(h+1,d).map(function(e){return e.text}).join(""))+'"></tw-hook>';case"verbatim":l+=c(a(y.innerText).replace(/\n/g,"<br>"),"tw-verbatim");break;case"collapsed":l+=u(y,"tw-collapsed");break;case"unclosedCollapsed":return l+="<tw-collapsed>"+e(i.slice(h+1,d))+"</tw-collapsed>";case"variable":case"tempVariable":case"macro":var C=function(){var t=[],i=[];if("macro"===y.type&&function n(r){"string"!==r.type&&"hook"!==r.type&&r.children.every(n);var a=r.firstChild();if("macro"===r.type&&a&&"macroName"===a.type&&s.options.blockerMacros.includes(o(a.text.slice(0,-1))))t.push(r);else if("hook"===r.type){if(!r.everyLeaf(function(e){return"error"!==e.type||(i.push(e),!1)}))return!1;r.html=e(r.children)}return!0}(y),i.length)return{v:r.create("syntax","This code hook's markup contained "+i.length+" error"+(i.length?"s":"")+":<br>\u2014"+i.map(function(e){return e.message}).join("<br>\u2014")).render(a(y.text))[0].outerHTML};var c=t.length&&t.map(function(e){var t=n(e);return e.type="blockedValue",t});l+='<tw-expression type="'+y.type+'" name="'+a(y.name||y.text)+'"'+(s.options.debug?' title="'+a(y.text)+'"':"")+(t.length?' blockers="'+a(JSON.stringify(c))+'"':"")+' js="'+a(n(y))+'"></tw-expression>',t.forEach(function(e){return e.type="macro"})}();if("object"===(void 0===C?"undefined":_typeof(C)))return C.v;break;default:l+=y.children&&y.children.length?e(y.children):y.text}}return l}},Object.freeze(s)}),define("passages",["jquery","utils/naturalsort","utils","markup","renderer","internaltypes/twineerror"],function(e,t,n,r,a,i){var o=n.unescape,s=n.onStartup,c=Object.assign;function u(e){var t=o(e.html()),n=a.preprocess(t);return c(new Map([["source",t],["tags",(e.attr("tags")||"").split(/\s/)||[]],["name",e.attr("name")]]),{TwineScript_TypeName:"a passage datamap",TwineScript_ObjectName:"a passage datamap",metadata:n})}var l=c(new Map,{TwineScript_ObjectName:"the Passages datamap",getTagged:function(e){var n=t("en",function(e){return e.get("name")}),r=[];return this.forEach(function(t){var n=t instanceof Map&&t.get("tags");Array.isArray(n)&&n.includes(e)&&r.push(t)}),r.sort(n)},getStorylets:function(e,n){var r=n?n.filter(e,[].concat(_toConsumableArray(l.values()))):[].concat(_toConsumableArray(l.values()));if(i.containsError(r))return r;var a=[],o=-1/0,s=r.reduce(function(t,n){if(t)return t;var r=n.get("storylet");if(r){var s=e.speculate(r,n.get("name"),"a (storylet:) macro");if(i.containsError(s))return s.message="There's an error in the storylet passage \""+n.get("name")+'":\n'+s.message,s.source=r.TwineScript_ToSource(),s;if(s){var c=n.get("exclusivity");o=Math.max(o,"number"==typeof c?c:0),a.push(n)}}},void 0);if(s)return s;var c=t("en");return a.filter(function(e){var t=e.get("exclusivity");return(t="number"==typeof t?t:0)===o}).sort(function(e,t){var n=e.get("urgency"),r=t.get("urgency");return(n="number"==typeof n?n:0)!==(r="number"==typeof r?r:0)?r-n:c(e.get("name"),t.get("name"))})},allStorylets:function(){return[].concat(_toConsumableArray(l.values())).filter(function(e){return e.get("storylet")})},loadMetadata:function(e){var t=[];return l.forEach(function(n){n.metadata&&Object.keys(n.metadata).forEach(function(r){if(i.containsError(n.metadata[r]))t.push(n.metadata[r]);else{var a=n.metadata[r],o=a.code,s=a.source,c=e.speculate(o,n.get("name"),"a ("+r+":) macro"),u='In "'+n.get("name")+'":\n';if(i.containsError(c))return c.message=u+c.message,c.source=s,void t.push(c);c instanceof Map?c.forEach(function(e,t){return l(t,e)}):l(r,c)}function l(e,r){n.has(e)?t.push(i.create("syntax","This passage's datamap already has a '"+JSON.stringify(e)+"' data name.")):n.set(e,r)}}),n.metadata=void 0}),t},hasValid:function(e){var t=this.get(e);return t&&t instanceof Map&&t.has("source")},create:u});return s(function(){Array.from(e("tw-storydata > tw-passagedata")).forEach(function(t){t=e(t),l.set(t.attr("name"),new u(t))})}),l}),define("utils/operationutils",["utils/naturalsort","utils","internaltypes/twineerror","patterns"],function(e,t,n,r){var a=t.impossible,i=t.nth,o=t.insensitiveName,s=t.permutations,c=r.validPropertyName,u="object",l="boolean",p="string",f="number",d="function";function h(e){return!!e&&((void 0===e?"undefined":_typeof(e))===u||(void 0===e?"undefined":_typeof(e))===d)}function y(e){return e&&Object.getPrototypeOf(e)===Object.prototype}function m(e){return Array.isArray(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":(void 0===e?"undefined":_typeof(e))===p?p:e&&(void 0===e?"undefined":_typeof(e))===u?u:""}function g(e){if(!h(e))return e;if(_typeof(e.TwineScript_Clone)===d)return e.TwineScript_Clone();if(Array.isArray(e))return[].concat(_toConsumableArray(e));if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if((void 0===e?"undefined":_typeof(e))===d)return Object.assign(e.bind(),e);switch(Object.getPrototypeOf(e)){case Object.prototype:return Object.assign({},e);case null:return Object.assign(Object.create(null),e)}return a("OperationUtils.clone","The value "+e+" cannot be cloned!"),e}function v(e){return h(e)&&"TwineScript_ObjectName"in e?e.TwineScript_ObjectName:Array.isArray(e)?"an array":e instanceof Map?"a datamap":e instanceof Set?"a dataset":(void 0===e?"undefined":_typeof(e))===l?"the boolean value '"+e+"'":(void 0===e?"undefined":_typeof(e))===p||(void 0===e?"undefined":_typeof(e))===f?"the "+(void 0===e?"undefined":_typeof(e))+" "+JSON.stringify(e):void 0===e?"an empty variable":"...whatever this is"}function b(e,t){return(void 0===e?"undefined":_typeof(e))!==u&&(void 0===t?"undefined":_typeof(t))!==u?e===t:Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every(function(e,n){return b(t[n],e)}):e instanceof Map&&t instanceof Map?b(Array.from(e.entries()).sort(),Array.from(t.entries()).sort()):e instanceof Set&&t instanceof Set?b([].concat(_toConsumableArray(e)),[].concat(_toConsumableArray(t))):e&&_typeof(e.TwineScript_is)===d?e.TwineScript_is(t):e&&(void 0===e?"undefined":_typeof(e))===u&&t&&(void 0===t?"undefined":_typeof(t))===u&&y(e)&&y(t)?b(Object.getOwnPropertyNames(e).map(function(t){return[t,e[t]]}),Object.getOwnPropertyNames(t).map(function(e){return[e,t[e]]})):Object.is(e,t)}return Object.freeze({isObject:h,isPureObject:y,singleTypeCheck:function e(t,n){if(null===n)return void 0===t;var r=void 0===t?"undefined":_typeof(t);if((void 0===n?"undefined":_typeof(n))!==d&&n.pattern){if("optional"===n.pattern||"zero or more"===n.pattern)return void 0===t||e(t,n.innerType);if("either"===n.pattern)return n.innerType.some(function(n){return e(t,n)});if("lambda"===n.pattern&&e(t,n.innerType))return n.clauses.includes("where")==="where"in t&&n.clauses.includes("making")==="making"in t&&n.clauses.includes("via")==="via"in t&&n.clauses.includes("with")==="with"in t;if("insensitive set"===n.pattern)return n.innerType.includes(o(t));if("range"===n.pattern)return n.range(t);if("wrapped"===n.pattern)return e(t,n.innerType)}return(void 0===n||void 0!==t)&&("anything"===n.TwineScript_TypeName&&void 0!==t&&!t.TwineScript_Unstorable||"everything"===n.TwineScript_TypeName&&void 0!==t||(n===String?r===p:n===Boolean?r===l:n===parseInt?r===f&&!Number.isNaN(t)&&!(t+"").includes("."):n===Number?r===f&&!Number.isNaN(t):n===Array?Array.isArray(t):n===Map||n===Set?t instanceof n:Object.isPrototypeOf.call(n,t)))},isValidDatamapName:function(e,t){if(e instanceof Map||a("isValidDatamapName","called with non-Map"),n.containsError(t))return t;if((void 0===t?"undefined":_typeof(t))!==p&&(void 0===t?"undefined":_typeof(t))!==f)return n.create("property","Only strings and numbers can be used as data names for "+v(e)+", not "+v(t)+".");var r=(void 0===t?"undefined":_typeof(t))===p?+t:""+t;return!(!Number.isNaN(r)&&e.has(r))||n.create("property","You mustn't use both "+v(t)+" and "+v(r)+" as data names in the same datamap.")},collectionType:m,isSequential:function(e){return(void 0===e?"undefined":_typeof(e))===p||Array.isArray(e)||_typeof(e.hooks)===d},unstorableValue:function e(t){return t&&t.TwineScript_Unstorable&&t||Array.isArray(t)&&t.find(e)||t instanceof Map&&[].concat(_toConsumableArray(t.values())).find(e)||t instanceof Set&&[].concat(_toConsumableArray(t)).find(e)},clone:g,objectName:v,typeName:function e(t){var n=y(t);if(n&&t.innerType)return t.typeName?t.typeName:"insensitive set"===t.pattern?"a case-insensitive string name":"either"===t.pattern?(Array.isArray(t.innerType)||a("typeName",'"either" pattern had non-array inner type'),t.innerType.map(e).join(" or ")):"optional"===t.pattern?"(optional) "+e(t.innerType):e(t.innerType);if(n&&t.pattern&&"range"===t.pattern){if(t.name)return t.name;var r=t.min,i=t.max;return"a"+(r>0?" positive":"")+(t.integer?" whole":"")+" number"+(0===r?" between 0 and "+i:i<1/0?" up to "+i:"")}return t===String||t===Number||t===Boolean?"a "+_typeof(t()):t===parseInt?"a whole number":t===Map?"a datamap":t===Set?"a dataset":t===Array?"an array":h(t)&&"TwineScript_TypeName"in t?t.TwineScript_TypeName:v(t)},typeID:function(e){var t=void 0===e?"undefined":_typeof(e);return[l,p,f].includes(t)?t:Array.isArray(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":e.TwineScript_TypeID||""},toSource:function t(r,o){var s=n.containsError(r);return s&&a("toSource","received a TwineError: "+s.message),_typeof(r.TwineScript_ToSource)===d?r.TwineScript_ToSource():y(r)&&"first"in r&&"last"in r?(r.first<0?(-1!==r.first?i(-r.first):"")+"last":i(r.first+1))+"to"+(r.last<0?(-1!==r.last?i(-r.last):"")+"last":i(r.last+1)):Array.isArray(r)?"(a:"+("property"===o?r.map(function(e){return e+(e>0)}):r).map(t)+")":r instanceof Map?"(dm:"+Array.from(r.entries()).sort(function(t,n){return[t[0],n[0]].sort(e("en"))[0]===t[0]?-1:1}).map(function(e){return e.map(t)})+")":r instanceof Set?"(ds:"+Array.from(r).sort(e("en")).map(t)+")":(void 0===r?"undefined":_typeof(r))===f&&"property"===o?r<0?-1===r?"last":i(-r)+"last":i(r+1):(void 0===r?"undefined":_typeof(r))===p&&"property"===o?RegExp(c).test(r)?r:"("+JSON.stringify(r)+")":JSON.stringify(r)},is:b,contains:function(e,t){if(e||""===e){if((void 0===e?"undefined":_typeof(e))===p)return(void 0===t?"undefined":_typeof(t))!==p?n.create("operation",v(e)+" can only contain strings, not "+v(t)+"."):e.includes(t);if(Array.isArray(e))return e.some(function(e){return b(e,t)});if(e instanceof Set||e instanceof Map)return Array.from(e.keys()).some(function(e){return b(e,t)})}return n.create("operation",v(e)+" cannot contain any values, let alone "+v(t))},isA:function(e,t){return _typeof(t.TwineScript_IsTypeOf)===d?t.TwineScript_IsTypeOf(e):n.create("operation",'"is a" should only be used to compare type names, not '+v(t)+".")},matches:function e(t,r){var a=!1;if(t&&_typeof(t.TwineScript_IsTypeOf)===d){var i=t.TwineScript_IsTypeOf(r);if(n.containsError(i))return i;a|=i}if(r&&_typeof(r.TwineScript_IsTypeOf)===d){var o=r.TwineScript_IsTypeOf(t);if(n.containsError(o))return o;a|=o}if(a)return!0;if(Array.isArray(t)&&Array.isArray(r)){for(var c=0,u=0,l=!0;l&&c<t.length&&u<r.length;){var p=t[c],f=r[u];if(p.rest){for(;u<r.length&&e(p,f);)f=r[u+=1];c+=1}else if(f.rest){for(;c<t.length&&e(p,f);)p=t[c+=1];u+=1}else e(p,f)?(c+=1,u+=1):l=!1}return l&&c>=t.length&&u>=r.length}return t instanceof Map&&r instanceof Map?e(Array.from(t.entries()).sort(),Array.from(r.entries()).sort()):t instanceof Set&&r instanceof Set?(t=[].concat(_toConsumableArray(t)),s.apply(void 0,_toConsumableArray(r)).some(function(n){return e(t,n)})):b(t,r)},subset:function e(t,r,a){if(!r||!a)return n.create("macrocall","The sub"+m(t)+" index value must not be "+(r&&a)+".");var i=(void 0===t?"undefined":_typeof(t))===p;if(i&&(t=Array.from(t)),r<0&&(r=Math.max(0,t.length+r+1)),a<0&&(a=Math.max(0,t.length+a+1)),r>a)return e(arguments[0],a,r);var o=t.slice(r>0?r-1:r,a).map(g);return i?o.join(""):o},range:function e(t,n){if(t>n)return e(n,t);var r=[t];for(n-=t;n-- >0;)r.push(++t);return r},printBuiltinValue:function e(t){return n.containsError(t)?t:t&&_typeof(t.TwineScript_Print)===d?t.TwineScript_Print():t instanceof Map?(t=Array.from(t.entries()),n.containsError(t)?t:t.reduce(function(t,n){var r=_slicedToArray(n,2),a=r[0],i=r[1];return t+"<tr><td>`"+e(a)+"`</td><td>`"+e(i)+"`</td></tr>"},"<table class=datamap>")+"</table>"):t instanceof Set?Array.from(t.values()).map(e)+"":Array.isArray(t)?t.map(e)+"":t&&_typeof(t.jquery)===p?t:h(t)?n.create("unimplemented","I don't know how to print this value yet."):t+""},unique:function(e,t,n){return!n.slice(t+1).some(function(t){return b(e,t)})}})}),define("utils/renderutils",["jquery","utils","renderer"],function(e,t,n){var r=RegExp(t.realWhitespace+"+"),a=RegExp(t.realWhitespace+"+","g");function i(e,t,n){var r=e.textContent.length;if(!(t>=r)){var a=void 0,i=[a=0===t?e:e.splitText(t)];return n&&(n<=0&&(n=r-n),n<r&&i.push(a.splitText(n-t))),i}}var o,s=(o=void 0,function(){if(void 0!==o)return o;var t=e("<p>");return t[0].normalize?(t.append(document.createTextNode("0-"),document.createTextNode("2"),document.createTextNode(""))[0].normalize(),o=1===t.contents().length):o=!1});var c="tw-collapsed,[collapsing=true]";var u=/^(=*)([^=]+)=*$/;return Object.freeze({dialog:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=r.section,i=r.parent,o=void 0===i?t.storyElement:i,s=r.cd,c=r.message,u=void 0===c?"":c,l=r.defaultValue,p=r.buttons,f=void 0===p?[{name:"OK",confirm:!0,callback:Object}]:p,d=e("<tw-backdrop><tw-dialog>"+(l||""===l?"<input type=text style='display:block;margin:0 auto'></input>\n":"")+"<tw-dialog-links>"+(f.length?f.reduce(function(e,t,n){var r=t.name;return e+"<tw-link style='margin:0 "+(n===f.length-1?"0 0 0.5em":0===n?"0.5em 0 0":"0.5em")+"' tabindex=0>"+r+"</tw-link>"},""):"<tw-link tabindex=0>"+f[0].name+"</tw-link>")+"</tw-dialog-links></tw-dialog></tw-backdrop>"),h=d.find("tw-dialog");if(o.append(d),a){a.renderInto(u,h,Object.assign({},s,{append:"prepend"}));var y=s&&s.transition&&d.find("tw-dialog > tw-transition-container");y&&y.length&&y.appendTo(d).append(h.prepend(y.contents().detach()))}else h.prepend(n.exec(u));if(l){var m=d.find("input").last();m.val(l).on("keypress",function(e){13===e.which&&(d.remove(),f.filter(function(e){return e.confirm}).forEach(function(e){return e.callback()}))}),setTimeout(function(){return m.focus()},100)}return f.reverse().forEach(function(t,n){e(d.find("tw-link").get(-n-1)).on("click",function(){d.remove(),t.callback()})}),d},realWhitespace:r,textNodeToChars:function(e){var t=[].concat(_toConsumableArray(e.textContent));return 1===t.length?[e]:t.reduce(function(e,t){return t.match(r)&&e.length&&e[e.length-1].match(r)?e[e.length-1]+=t:e.push(t),e},[]).reduce(function(t,n){var r=e;return n.length<e.textContent.length&&(e=e.splitText(n.length)),t.concat(r)},[])},findTextInNodes:function e(t,n){var r=[],a="",o=[];if(!t.length||!n)return o;for(;t.length>0;){r.push(t[0]),a+=t[0].textContent,t.shift();var s=a.indexOf(n);if(s>-1){for(var c,u=a.length-(s+n.length);s>=r[0].textContent.length;)s-=r[0].textContent.length,r.shift();if(1===r.length){var l=i(r[0],s,s+n.length);o.push(l[0]),l[1]&&t.unshift(l[1]);break}o.push(i(r[0],s,r[0].length)[0]),(c=o).push.apply(c,_toConsumableArray(r.slice(1,-1)));var p=i(r[r.length-1],0,r[r.length-1].textContent.length-u);o.push(p[0]),p[1]&&t.unshift(p[1]),o=o.filter(Boolean);break}}return[o].concat(_toConsumableArray(e(t,n)))},collapse:function(t){function n(t){return 0===e(this||t).parentsUntil(c).filter("tw-verbatim, tw-expression, [collapsing=false]").length}var r=function e(t){var n=t[0],r=t.parent();if(!r.length||t.findAndFilter("tw-story").length)return null;var a=r.textNodes().filter(function(e){var t=e.compareDocumentPosition(n);return 4&t&&!(8&t)});return(a=a[a.length-1])||e(r)}(t);e(r).parents(c).length||(r=null);var i=function e(t){var n=t[0],r=t.parent();if(!r.length||t.findAndFilter("tw-story").length)return null;var a=r.textNodes().filter(function(e){var t=e.compareDocumentPosition(n);return 2&t&&!(8&t)})[0];return a||e(r)}(t);e(i).parents(c).length||(i=null);var o="br:not([data-raw]),tw-consecutive-br:not([data-raw])";t.find(o).filter(n).replaceWith(document.createTextNode(" "));var u=(t=e(t.get().map(function(t){return e(t).filter(n).is(o)?e(document.createTextNode(" ")).replaceAll(t)[0]:t}))).textNodes(),l=0;u.reduce(function(e,t){return n(t)?(t.textContent=t.textContent.replace(a," ")," "!==t.textContent[0]||e&&e.textContent&&!(e.textContent.search(/\s$/)>-1)||(t.textContent=t.textContent.slice(1)),t):document.createTextNode("A")},r),[].concat(_toConsumableArray(u)).reverse().every(function(e){return!!n(e)&&(e.textContent.match(/^\s*$/)?(l+=e.textContent.length,e.textContent="",!0):(e.textContent=e.textContent.replace(/\s+$/,function(e){return l+=e.length,""}),!1))}),l>0&&i&&(u[u.length-1].textContent+=" "),t[0]&&s()&&t[0].normalize()},geomStringRegExp:u,geomParse:function(e){var t=e.length,n=u.exec(e)||[],r=_slicedToArray(n,3),a=r[0],i=r[1],o=r[2];return a?{marginLeft:i.length/t*100,size:o.length/t*100}:{marginLeft:0,size:0}}})}),define("datatypes/hookset",["jquery","utils","utils/renderutils","utils/operationutils"],function(e,t,n,r){var a=n.textNodeToChars,i=n.realWhitespace,o=n.findTextInNodes,s=r.toSource;function c(n){var r=n.dom,s=e();this.next&&(s=s.add(c.call(this.next,n)));var u=function(t,n){if(Array.isArray(n))return n.reduce(function(e,n){return e.add(t.get(n))},e());if(n&&"object"===(void 0===n?"undefined":_typeof(n))&&"first"in n&&"last"in n){var r=n.first,o=n.last,s=t.length;r<0&&(r+=s),o<0&&(o+=s);for(var c=[t.get(r)];r!==o;)r+=Math.sign(o-r),c.push(t.get(r));return e(c)}if("string"==typeof n){if("chars"===n){var u=[],l=!0,p=!1,f=void 0;try{for(var d,h=t.textNodes(":not(tw-error, tw-error *)")[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var y=d.value,m=!0,g=!1,v=void 0;try{for(var b,w=a(y)[Symbol.iterator]();!(m=(b=w.next()).done);m=!0){var T=b.value;T.textContent.match(i)||u.push(T)}}catch(e){g=!0,v=e}finally{try{!m&&w.return&&w.return()}finally{if(g)throw v}}}}catch(e){p=!0,f=e}finally{try{!l&&h.return&&h.return()}finally{if(p)throw f}}return e(u)}if("links"===n)return t.findAndFilter("tw-link, .enchantment-link");if("visited"===n)return t.findAndFilter("tw-link.visited");if("lines"===n){var S=t.findAndFilter("br:not(tw-sidebar *),tw-consecutive-br:not(tw-sidebar *)").get(),x=[[]];return t.textNodes(":not(tw-error, tw-error *):not(tw-sidebar, tw-sidebar *)").forEach(function(e){S.length&&2&e.compareDocumentPosition(S[0])&&(S.shift(),x.push([])),x[x.length-1]=x[x.length-1].concat(e)}),x=x.map(function(t){return t.map(function(n){for(var r=n.parentNode;e(r).textNodes().every(function(e){return t.includes(e)})&&!t.every(function(t){return e(r).has(t).length});){r=(n=r).parentNode}return n})}),e(x.map(function(t){return e(t).wrapAll("<tw-pseudo-hook>").parent()[0]}))}}return e(t.get(n))};if(this.selector){var l=void 0;if("string"===this.selector.type)l=function(t,n){var r=o(n.textNodes(),t),a=e();return r.forEach(function(t){a=a.add(e(t).wrapAll("<tw-pseudo-hook>").parent())}),a}(this.selector.data,r);else{if("base"===this.selector.type)return s.add(u(c.call(this.selector.data,n),this.property));var p=function(e){var n='tw-hook[name="'+(e=t.insensitiveName(e).replace(/"/g,"&quot;"))+'"],tw-enchantment[name="'+e+'"]';return n+={page:", tw-story",passage:", tw-passage",sidebar:", tw-sidebar",link:", tw-link, .enchantment-link"}[e]||""}(this.selector.data);l=r.findAndFilter(p).add(r.parentsUntil(t.storyElement.parent())).filter(p)}s=this.property?s.add(u(l,this.property)):s.add(l)}return s}function u(e){if(!e)return[];var n=e.selector,r=e.property,a=e.next;return[JSON.stringify(["base"===n.type?u(n.data):t.insensitiveName(n.data),r])].concat(_toConsumableArray(u(a))).sort()}var l=Object.freeze({forEach:function(t,n){var r=c.call(this,t).each(function(t){n(e(this),t)});return t.dom.findAndFilter("tw-pseudo-hook").contents().unwrap(),r},hooks:function(e){return c.call(this,e)},get TwineScript_ObjectName(){return this.property||this.next?"a complex hook name":"?"+this.selector.data+" (a hook name)"},TwineScript_TypeID:"hookName",TwineScript_TypeName:"a hook name (like ?this)",TwineScript_Unstorable:!0,TwineScript_ToSource:function(){var e="",n=this.selector,r=n.type,a=n.data;return"name"===r?a.match(RegExp("^"+t.anyRealLetter+"+$"))?e+="?"+a:e+="(hooks-named:"+JSON.stringify(a)+")":"string"===r?e+=JSON.stringify(a):"base"===r&&(e+=a.TwineScript_ToSource()+"'s "+s(this.property,"property")),this.next&&(e+=" + "+this.next.TwineScript_ToSource()),e},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t},TwineScript_is:function(e){return u(this)+""==u(e)+""},TwineScript_GetProperty:function(e){return l.create({type:"base",data:this},e,void 0)},TwineScript_Properties:["chars","links","lines","visited"],TwineScript_Clone:function(){return l.create(this.selector,this.property,this.next)},create:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return Object.assign(Object.create(this||l),{selector:Object.freeze(e),property:t,next:n})},from:function(e){return l.isPrototypeOf(e)||"string"==typeof e||t.impossible("HookSet.from() was given a non-HookSet non-string."),l.isPrototypeOf(e)?e:l.create({type:"string",data:e})}});return l}),define("internaltypes/changedescriptor",["jquery","utils","renderer","datatypes/hookset"],function(e,t,n,r){var a=t.assertOnlyHas,i=t.impossible,o=t.transitionIn,s=n.exec,c=Object.assign,u=Object.keys,l=Object.create,p=Object.seal,f=function(e){return e.split(/\n/g).reduce(function(e,t,n,r){var a=r.length;return e.concat(document.createTextNode(t),n!==a-1&&document.createElement(t.length?"br":"tw-consecutive-br"))},[])},d=void 0,h={source:"",appendSource:null,enabled:!0,enablers:null,verbatim:!1,target:null,append:"",newTargets:null,transition:"",transitionTime:null,transitionDeferred:!1,transitionDelay:0,transitionSkip:0,transitionOrigin:null,loopVars:null,styles:null,attr:null,data:null,innerEnchantments:null,section:null,timestamp:0,summary:function(){var e=this;return["source","appendSource","enabled","verbatim","target","append","newTargets","transition","transitionTime","transitionDeferred","transitionDelay","transitionSkip","transitionOrigin","innerEnchantments","enablers"].filter(function(t){return e.hasOwnProperty(t)}).concat([this.attr.length&&"attr",this.styles.length&&"styles",u(this.loopVars).length&&"loopVars",u(this.data).length&&"data"].filter(Boolean))},create:function(e,t){var n=c(l(this),{attr:[].concat(this.attr||[]),styles:[].concat(this.styles||[]),loopVars:this.loopVars||{},data:this.data||{}},e);return t&&t.run(n),n},update:function(){var e=this,t=this.section,n=this.newTargets,a=this.transition,i=this.transitionDeferred,s=this.append,c=this.target;"function"==typeof c&&(c=c());var l=function(t){if(Array.isArray(e.styles)&&e.styles.length>0){var n=e.styles.reduce(function(e,t){return u(t).forEach(function(n){var r=t[n];e[+("function"==typeof r)].push(_defineProperty({},n,r))}),e},[[],[]]),r=_slicedToArray(n,2),a=r[0],i=r[1];a.forEach(function(e){return t.css(e)}),setTimeout(function(){i.forEach(function(e){return t.css(e)})})}e.attr&&e.attr.forEach(function(e){return t.attr(e)}),e.data&&t.data(e.data)};if(Array.isArray(n)&&n.length&&(c=n.map(function(e){return e.target})),[].concat(c).forEach(function(e){r.isPrototypeOf(e)?e.forEach(t,l):l(e)}),a&&!i&&!s){var p=c,f=void 0;do{!(f=p.data("timestamp"))&&(p=p.parent())}while(!f&&p.length);o(c,a,this.transitionTime,this.transitionDelay,this.transitionSkip,f?Date.now()-f:0,this.transitionOrigin)}},render:function(){var t=this,n=this.source,u=this.transition,l=this.transitionTime,p=this.transitionDeferred,y=this.enabled,m=this.enablers,g=this.data,v=this.section,b=this.newTargets,w=this.innerEnchantments,T=this.appendSource,S=this.target,x=this.target,k=this.append;if("function"==typeof S&&(S=S()),a(this,d),!k)return i("ChangeDescriptor.render","This doesn't have an 'append' method chosen."),e();if(m&&m.length){var O=m[0],j=O.descriptor,A=O.changer,C=j.render();if(A){var E=h.create({section:v,target:C});A.run(E),E.update()}return C}if(!y||void 0!==S.attr("hidden"))return h.create({target:S,attr:this.attr.filter(function(e){return!("style"in e)}),data:c({},g,{originalSource:n,hidden:!0})}).update(),e();if(Array.isArray(b)&&b.length&&(S=b),!S)return i("ChangeDescriptor.render","ChangeDescriptor has source but not a target!"),e();var _=e();if([].concat(S).filter(function(e){return!e.jquery}).map(function(e){var t=k,n=void 0;if(e.target&&e.append){var r=e;t=r.append,n=r.before,e=e.target}return{elements:e.hooks(v,x).filter(function(){return!(n&&1&this.compareDocumentPosition(document)&&2&this.compareDocumentPosition(x[0]))}),append:t}},[]).forEach(function(n){var r=n.elements,a=n.append;r.each(function(n,r){r=e(r),_=_.add(t.create({target:r,append:a,newTargets:null}).render()),r.filter("tw-pseudo-hook").contents().unwrap()})}),_.length||Array.isArray(S)||r.isPrototypeOf(S))return _;if(!(k in S)){if("replace"!==k)return i("ChangeDescriptor.render","The target doesn't have a '"+k+"' method."),e();S[0]instanceof Text?k="replaceWith":(S.empty(),k="append")}return S[0]instanceof Text&&("append"===k&&(k="after"),"prepend"===k&&(k="before")),_=e(n&&(this.verbatim?f(n):e.parseHTML(s(n),document,!0))),Array.isArray(T)&&T.forEach(function(n){var r=n.source,a=n.append,i=e(t.verbatim?f(r):e.parseHTML(s(r),document,!0));_="append"===a?_.add(i):"prepend"===a?i.add(_):i}),S[k](_.length?_:void 0),S.data("timestamp",Date.now()),this.update(),u&&!p&&o("replace"===k?S:_,u,l,this.transitionDelay,this.transitionSkip,this.expedite,this.transitionOrigin),w&&w.map(function(e){return e(S)}).forEach(function(e){return v.addEnchantment(e)}),_}};return d=u(h),p(h)}),define("datatypes/changercommand",["utils","utils/operationutils","internaltypes/changedescriptor","internaltypes/twineerror"],function(e,t,n,r){var a=e.impossible,i=t.is,o=t.toSource,s={},c={TwineScript_TypeID:"changer",TwineScript_TypeName:"a changer",TwineScript_Print:function(){return"`[A ("+this.macroName+":) changer]`"},TwineScript_ToSource:function(){return"("+this.macroName+":"+("else"===this.name?"":this.params.map(o))+")"+(this.next?"+"+this.next.TwineScript_ToSource():"")},summary:function(){var e=n.create();return this.run(e),e.summary()},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(t)||a("ChangerCommand.create","params was not an array but "+t),Object.assign(Object.create(this),{macroName:e,params:t,next:n,TwineScript_ObjectName:"a ("+e+":) changer"})},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t},TwineScript_is:function(e){if(c.isPrototypeOf(e))return this.macroName===e.macroName&&i(this.params,e.params)&&i(this.next,e.next)},TwineScript_Clone:function(){for(var e=this.create(this.macroName,this.params,this.next),t=e;t.next;)t=t.next=t.next.TwineScript_Clone();return e},run:function(e){var t=s[this.macroName].apply(s,[e].concat(_toConsumableArray(this.params)));if(r.containsError(t))return t;this.next&&this.next.run(e)},register:function(e,t){s[e]=t}};return Object.freeze(c)}),define("state",["utils","passages","datatypes/changercommand","internaltypes/twineerror","utils/operationutils","markup","twinescript/compiler"],function(e,t,n,r,a,i,o){var s=e.impossible,c=a.objectName,u=a.toSource,l=i.lex,p=Object.assign,f=Object.create,d=["localStorage","sessionStorage"].map(function(e){try{return!!window[e]&&(window[e].setItem("test","1"),window[e].removeItem("test"),!0)}catch(e){return!1}}),h=p(f(null),{TwineScript_ObjectName:"this story's variables",TwineScript_TypeDefs:f(null),TwineScript_VariableStore:!0,TwineScript_MockVisits:null}),y={passage:"",variables:h,create:function(e,t){var n=f(y);return n.passage=e||"",n.variables=p(f(this.variables),t),n}},m=[],g=-1,v=y.create(),b=void 0,w={forward:[],back:[],load:[]},T=void 0;function S(e){v=(m[g]||y).create(e),function(){if(T.hasSessionStorage){var e=T.serialise();if("string"==typeof e)try{sessionStorage.setItem("Saved Session",e)}catch(e){return}}}()}return T=p({get passage(){return v.passage},get variables(){return v.variables},get pastLength(){return g},get futureLength(){return m.length-1-g},get mockVisits(){return v.variables.TwineScript_MockVisits||[]},set mockVisits(e){v.variables.TwineScript_MockVisits=e},passageNameVisited:function(e){var n=0;if(!t.get(e))return 0;for(var r=0;r<=g;r++)n+=+(e===m[r].passage);return n},passageNameLastVisited:function(e){if(!t.get(e))return 1/0;if(e===v.passage)return 0;for(var n=g;n>0;n--)if(m[n].passage===e)return g-n+1;return 1/0},pastPassageNames:function(){for(var e=[],t=g-1;t>=0;t--)e.unshift(m[t].passage);return e},timelinePassageNames:function(){return m.map(function(e){return e.passage})},play:function(e){v||s("State.play","present is undefined!"),v.passage=e,m=m.slice(0,g+1).concat(v),g+=1,S(e),w.forward.forEach(function(t){return t(e)})},rewind:function(e){var t=1,n=!1;if(e)if("string"==typeof e){if((t=this.passageNameLastVisited(e))===1/0)return}else"number"==typeof e&&(t=e);for(;t>0&&g>0;t--)n=!0,g-=1;return n&&(S(m[g].passage),w.back.forEach(function(e){return e()})),n},fastForward:function(e){var t=1,n=!1;for("number"==typeof e&&(t=e);t>0&&m.length>0;t--)n=!0,g+=1;return n&&(S(m[g].passage),w.forward.forEach(function(e){return e(m[g].passage,"fastForward")})),n},on:function(e,t){if(e in w)return"function"!=typeof t||w[e].includes(t)||w[e].push(t),T;s("State.on","invalid event name")},reset:function(){m=[],g=-1,v=y.create(),b=void 0,w.load.forEach(function(e){return e(m)})},hasStorage:d[0],hasSessionStorage:d[1]},function(){function e(e,t){Object.keys(t).forEach(function(n){return!n.startsWith("TwineScript_")&&(t[n]=e.eval(o(l(t[n],0,"macro"))))})}return{serialise:function(){var e=m.slice(0,g+1),t=e.map(function(e){return Object.keys(e.variables).filter(function(t){return e.variables[t]&&(n=e.variables[t],a=void 0===n?"undefined":_typeof(n),!(!r.containsError(n)&&("function"==typeof n.TwineScript_ToSource||Array.isArray(n)||n instanceof Map||n instanceof Set||"string"===a||"number"===a||"boolean"===a||Object.isPrototypeOf.call(h.TwineScript_TypeDefs,n))));var n,a}).map(function(t){return[t,e.variables[t]]})});if(b||(b=t.reduce(function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1];return e||a&&[a,i,n+1]},void 0)),b){var n=_slicedToArray(b,3),a=n[0],i=n[1],o=n[2];return r.create("saving","The variable $"+a+" holds "+c(i)+" (which is, or contains, a complex data value) on turn "+o+"; the game can no longer be saved.")}try{return JSON.stringify(e,function(e,t){return this.TwineScript_VariableStore?"TwineScript_TypeDefs"===e?Object.keys(t).reduce(function(e,n){return e[n]=u(t[n]),e},{}):u(t):t})}catch(e){return!1}},deserialise:function(n,r){var a,i=void 0,o=h,s="The save data is unintelligible.";try{i=JSON.parse(r)}catch(e){return Error(s)}return Array.isArray(i)?(a=(i=i.map(function(r){if("object"!==(void 0===r?"undefined":_typeof(r))||!r.hasOwnProperty("passage")||!r.hasOwnProperty("variables"))return Error(s);if(!t.hasValid(r.passage))return Error("The data refers to a passage named '"+r.passage+"', but it isn't in this story.");if(r.variables=p(f(o),r.variables),Object.hasOwnProperty.call(r.variables,"TwineScript_TypeDefs")){var a=r.variables.TwineScript_TypeDefs=p(f(o.TwineScript_TypeDefs),r.variables.TwineScript_TypeDefs);try{e(n,a)}catch(e){return Error(s)}}try{e(n,r.variables)}catch(e){return Error(s)}return o=r.variables,p(f(y),r)})).find(function(e){return e instanceof Error}))?a:(m=i,w.load.forEach(function(e){return e(m)}),g=m.length-1,S(m[g].passage),!0):Error(s)}}}()),Object.seal(y),Object.freeze(T)}),define("internaltypes/varref",["state","internaltypes/twineerror","utils","utils/operationutils","datatypes/hookset"],function(e,t,n,r,a){var i=n.impossible,o=n.andList,s=n.nth,c=r.is,u=r.isObject,l=r.toSource,p=r.isSequential,f=r.objectName,d=r.typeName,h=r.clone,y=r.isValidDatamapName,m=r.subset,g=r.collectionType,v=r.unstorableValue,b=r.matches,w=void 0,T=0,S={set:[],delete:[]};function x(e,n){var r=void 0;if(e instanceof Map&&(r=t.containsError(y(e,n))))return r;if(p(e)){var i=void 0,s="You can only access position strings/numbers ('4th', 'last', '2ndlast', (2), etc.) or slices ('1stTo2ndlast', '3rdTo5th'), ",c="You can't access the '0th' or '0thlast' position of "+f(e)+".";if("number"==typeof n){if(0===n)return t.create("property","You can't access elements at position 0 of "+f(e)+".","Only positive and negative position values exist.");n>0&&(n-=1)}else if("string"==typeof n&&(i=/^(\d+)(?:st|[nr]d|th)last$/i.exec(n))){if("0"===i[1])return t.create("property",c);n=-i[1]}else if("string"==typeof n&&(i=/^(\d+)(?:st|[nr]d|th)$/i.exec(n))){if("0"===i[1])return t.create("property",c);n=i[1]-1}else if("string"==typeof n&&(i=/^(?:(\d+)(?:st|[nr]d|th)(last)?|last)to(?:(\d+)(?:st|[nr]d|th)(last)?|last)$/i.exec(n))){var u=_slicedToArray(i,5),l=u[1],d=void 0===l?0:l,h=u[2],m=u[3],g=void 0===m?0:m;n={last:g=u[4]?-g:g-1,first:d=h?-d:d-1}}else if("last"===n)n=-1;else if("random"===n){if(!e.length)return t.create("property","I can't get a random value from "+f(e)+", because it's empty");n=Math.random()*Array.from(e).length|0}else{if(a.isPrototypeOf(e)&&!a.TwineScript_Properties.includes(n))return t.create("property",s+o(a.TwineScript_Properties.map(function(e){return"'"+e+"'"}))+" of "+f(e)+", not "+f(n)+".");if(!["length","any","all","start","end","random"].includes(n)&&!a.isPrototypeOf(e))return t.create("property",s+"'length', 'any', 'all', 'start', 'end', and 'random' of "+f(e)+", not "+f(n)+".")}}else if(e instanceof Set){if(!["length","any","all"].includes(n))return t.create("property","You can only get the 'length', 'any' and 'all' of "+f(e)+".","To check contained values, use the 'contains' operator.");"length"===n&&(n="size")}else{if(Array.isArray(e.TwineScript_Properties)&&!e.TwineScript_Properties.includes(n))return t.create("property","You can only get the "+o(e.TwineScript_Properties.map(function(e){return"'"+e+"'"}))+" of "+f(e)+", not "+f(n)+".");if("number"==typeof e||"boolean"==typeof e)return t.create("property","You can't get data values from "+f(e)+".")}return n}function k(e,t){return t-0<0&&Math.abs(t)<=e.length?e.length+(t-0):t}function O(e,t){if(void 0===e)return e;if(e instanceof Map||w.isPrototypeOf(e))return e.get(t);if(("any"===t||"all"===t||"start"===t||"end"===t)&&!e.TwineScript_VariableStoreName)return function(e,t){var n="'"+t+"' value"+("any"===t?"":"s")+" of ";return{determiner:t,array:[].concat(_toConsumableArray(e)),string:"string"==typeof e&&e,TwineScript_ObjectName:n+f(e),TwineScript_TypeName:n+"a data structure",TwineScript_Unstorable:!0,TwineScript_Print:function(){return"`["+this.TwineScript_TypeName+"]`"}}}(e,t);if("string"==typeof e&&(e=[].concat(_toConsumableArray(e))),p(e)&&Number.isFinite(t)&&(t=k(e,t)),e.TwineScript_GetProperty)return e.TwineScript_GetProperty(t);var n=e[t];return"function"!=typeof n?n:void 0}function j(e){if(e.computed){var t=e.value;return w.isPrototypeOf(t)&&(t=t.get()),"string"==typeof t?"('"+t+"')":"("+t+")"}return"number"==typeof e?s(e):"'"+e+"'"}function A(n,r,i){if(n.TwineScript_VariableStore){if(n.TwineScript_TypeDefs&&r in n.TwineScript_TypeDefs){var o=n.TwineScript_TypeDefs[r];if("const"===o.name){if(void 0!==n[r])return t.create("operation","I can't alter "+(n===e.variables?"$":"_")+r+" because it's been restricted to a constant value.","This variable can't be changed for the rest of the story.")}else if(!b(o,i))return t.create("operation","I can't set "+(n===e.variables?"$":"_")+r+" to "+d(i)+" because it's been restricted to "+l(o)+"-type data.","You can restrict a variable or data name by giving a typed variable to (set:) or (put:).")}return!0}return Array.isArray(r)?r.map(function(e){return A(n,e)}):n instanceof Map?"string"==typeof r||t.create("operation",f(n)+" can only have string data names, not "+f(r)+"."):p(n)?["length","random","any","all","start","end"].includes(r)?t.create("operation","I can't forcibly alter the '"+r+"' of "+f(n)+".","start"===r||"end"===r?"Alter the values at actual positions, like 1st or 2ndlast, rather than just the '"+r+"'.":void 0):+r==(0|r)||t.create("property",f(n)+" can only have position keys ('3rd', '1st', (5), etc.), not "+j(r)+"."):n.TwineScript_Identifiers&&r in n?t.create("keyword","I can't alter the value of the '"+r+"' identifier.","You can only alter data in variables and hooks, not fixed identifiers."):t.create("operation","I can't modify "+f(n),n instanceof Set?"You should use an (array:) if you need to modify the data inside this dataset.":a.isPrototypeOf(n)?"You should alter hooks indirectly using macros like (replace:) or (enchant:).":void 0)}function C(e,t,n){var r=t;e instanceof Map?e.set(t,n):(p(e)&&(t=k(e,t)),e.TwineScript_Set?e.TwineScript_Set(t):e[t]=n),S.set.forEach(function(t){return t(e,r,n)})}function E(e,t){var n=t;p(e)&&(t=k(e,t)),Array.isArray(e)&&/^(?:[1-9]\d*|0)$/.exec(t)?e.splice(t,1):e instanceof Map||e instanceof Set?e.delete(t):delete e[t],S.delete.forEach(function(t){return t(e,n)})}function _(e){return Object.assign(Object.create(w),{error:e})}function N(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r;if(r&&"object"===(void 0===r?"undefined":_typeof(r))&&"last"in r&&"first"in r){if(a.isPrototypeOf(n))return n.TwineScript_GetProperty(r);var s=r.first,c=r.last;return m(n,s+(s>=0),c+(c>=0))}if(Array.isArray(r))return a.isPrototypeOf(n)?n.TwineScript_GetProperty(r):r.map(function(e){return N(n,e,e)})["string"==typeof n?"join":"valueOf"]("");var u=O(n,r);if(void 0===u){if(n===e.variables)return T;if(n.TwineScript_VariableStore)return t.create("property","There isn't a temp variable named _"+i+" in this place.","Temp variables only exist inside the same passage and hook in which they're (set:).");if(Array.isArray(n)&&"number"==typeof r)return t.create("property","This array of "+n.length+" elements doesn't have a "+j(i)+" element.",n.length?"It contains: "+o(n.map(f))+".":"The array is empty.");var l=Array.from("function"==typeof n.keys&&n.keys());return t.create("property","I can't find a "+j(i)+" data name in "+f(n),n instanceof Map&&l.length?"Its names include: "+o(l)+".":void 0)}return u}function P(e,n){var r=this,a=this.compiledPropertyChain.reduce(function(e,t){var n=void 0;return n=0===e.length?r.object:N.apply(void 0,_toConsumableArray(e[e.length-1])),e.push([n,t])&&e},[]).reduceRight(e,n);return t.containsError(a)?a:void 0}return w=Object.freeze({get:function(){return this.error?this.error:N(this.compiledPropertyChain.slice(0,-1).reduce(function(e,t){return N(e,t)},this.object),this.compiledPropertyChain.slice(-1)[0],this.propertyChain.slice(-1)[0])},set:function(n){var r=this;return this.error?this.error:!this.object||this.object.TwineScript_VariableStore||this.object.TwineScript_Identifiers?P.call(this,function(n,a,i){var o,s=_slicedToArray(a,2),c=s[0],l=s[1];if(o=t.containsError(n,c,l)||t.containsError(A(c,l,n)))return o;var d;if(d=v(n))return t.create("operation",f(n)+" can't be stored"+(g(n)?" because it holds "+f(d)+".":""));if(i>0)c=h(c);else if(c.TwineScript_VariableStore&&c!==e.variables){for(var y=c;y.TwineScript_VariableStore&&!y.hasOwnProperty(l);)y=Object.getPrototypeOf(y);y.TwineScript_VariableStore&&(c=y)}if("string"==typeof c){if("string"!=typeof n)return t.create("datatype","I can't put this non-string value, "+f(n)+", in a string.");if(n.length!==(Array.isArray(l)?l.length:1))return t.create("datatype",f(n)+"is not the right length to fit into this string location.");c=[].concat(_toConsumableArray(c));var m=[].concat(_toConsumableArray(n));[].concat(l).forEach(function(e){0+e<0&&(e=c.length+(0+e)),c=[].concat(_toConsumableArray(c.slice(0,e)),[m.shift()],_toConsumableArray(c.slice(e+1)))}),c=c.join("")}else u(c)&&(void 0!==n.TwineScript_KnownName&&(n.TwineScript_KnownName=r.TwineScript_ObjectName),Array.isArray(l)&&p(n)?("string"==typeof n&&(n=[].concat(_toConsumableArray(n))),l.map(function(e,t){return[e,n[t]]}).forEach(function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return C(c,n,r)})):C(c,l,n));return c},n):t.create("macrocall","I can't (set:) "+f(this)+", if the "+(f(this.object).match(/ (.+$)/)||["","value"])[1]+" isn't stored in a variable.","Modifying data structures that aren't in variables won't change the game state at all.")},delete:function(){return this.error?this.error:P.call(this,function(e,n,r){var a,i=_slicedToArray(n,2),o=i[0],s=i[1];if(a=t.containsError(e,o,s)||t.containsError(A(o,s)))return a;if(r>0&&(o=h(o)),null===e){var c="string"==typeof o;c&&(o=[].concat(_toConsumableArray(o))),Array.isArray(s)?(p(o)&&(s=[].concat(_toConsumableArray(new Set(s)))).sort(function(e,t){return k(o,t)-k(o,e)}),s.forEach(function(e){return E(o,e)})):E(o,s),c&&(o=o.join(""))}else C(o,s,e);return o},null)},defineType:function(e){var n=this.object,r=this.compiledPropertyChain;if(!n||!n.TwineScript_VariableStore||1!==r.length||!n.TwineScript_TypeDefs)return t.create("unimplemented","I can only restrict the datatypes of variables, not data names or anything else.");var a=r[0];Object.hasOwnProperty.call(n,"TwineScript_TypeDefs")||(n.TwineScript_TypeDefs=Object.create(n.TwineScript_TypeDefs));var i=n.TwineScript_TypeDefs,o=i[a];if(o&&!c(o,e))return t.create("operation","I can't redefine the type of "+f(this)+" to "+(e.TwineScript_ObjectName||d(e))+", as it is already "+(o.TwineScript_ObjectName||d(o))+".");i[a]=e,"const"===e.name&&(n[a]=void 0)},matches:function(e,t){return this.object===e&&this.compiledPropertyChain[0]===t},getName:function(){return this.compiledPropertyChain[0]},create:function(e,n){var r=void 0;if(r=t.containsError(e))return _(r);n=[].concat(n),w.isPrototypeOf(e)&&(n=e.propertyChain.concat(n),e=e.object);var a=function(e,n){return n.reduce(function(r,a,i){var o;return a.computed&&(a=a.value),w.isPrototypeOf(a)&&(a=a.get()),a=Array.isArray(a)?a.map(function(t){return x(e,t)}):x(e,a),(o=t.containsError(r,a))?o:(i<n.length-1&&(e=N(e,a)),r.push(a),r)},[])}(e,n);return(r=t.containsError(a))?_(r):Object.assign(Object.create(w),{object:e,propertyChain:n,compiledPropertyChain:a})},TwineScript_ToSource:function(){var t=this,n=function(e,n){return!n&&t.object.TwineScript_VariableStore?e:j(e)};return(this.object===e.variables?"$":this.object.TwineScript_VariableStore?"_":f(this.object)+"'s ")+(1===this.propertyChain.length?n(this.propertyChain[0]):this.propertyChain.reduce(function(e,t,r){return e+"'s "+n(t,r)}))},get TwineScript_ObjectName(){return this.TwineScript_ToSource()+(this.object.TwineScript_VariableStoreName?" in "+this.object.TwineScript_VariableStoreName:"")},on:function(e,t){if(e in S)return"function"!=typeof t||S[e].includes(t)||S[e].push(t),w;i("VarRef.on","invalid event name")}})}),define("internaltypes/varscope",[],function(){return Object.seal({TwineScript_ObjectName:"the temporary variables",TwineScript_VariableStore:!0,TwineScript_TypeDefs:Object.create(null)})}),define("internaltypes/twinenotifier",["jquery","utils"],function(e,t){var n=t.impossible,r={create:function(e){return e||n("TwineNotifier.create","called with only 1 string."),Object.assign(Object.create(r),{message:e})},render:function(){return e("<tw-notifier>").attr("message",this.message)}};return r}),define("datatypes/custommacro",["jquery","utils/operationutils","internaltypes/changedescriptor","internaltypes/varref","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(e,t,n,r,a,i,o){var s=t.objectName,c=t.typeName,u=t.matches,l=Object.assign,p=Object.create,f=function(t){return function(c){for(var u=arguments.length,f=Array(u>1?u-1:0),d=1;d<u;d++)f[d-1]=arguments[d];t.called+=1;var h=t.varNames,y=t.params,m=t.body,g=l(p(a),{TwineScript_VariableStoreName:t.TwineScript_ObjectName+" call #"+t.called,TwineScript_TypeDefs:p(null)}),v=[],b=0;f.forEach(function(e,t){var n=h[b];g.TwineScript_TypeDefs[n]=y[b].datatype.rest?y[b].datatype.create("array"):y[b].datatype;var a=r.create(g,n);if(y[b].datatype.rest){var i=(g[n]||[]).concat([e]);if(t<f.length-1)return void(g[n]=i);a.set(i)}else a.set(e),b+=1;v.push(o.create(s(a)+" is now "+s(g[n])))}),f.length&&(b+=1),y[b]&&y[b].datatype.rest&&(r.create(g,h[b]).set([]),g.TwineScript_TypeDefs[name]=y[b].datatype.create("array"));var w=void 0,T=e("<p>").append(m.html),S=c.stack.length;for(c.stack.unshift({tempVariables:g,dom:T,output:function(e){w=e}}),c.execute();c.stack.length>S;)c.stack.shift();var x,k,O=T.find("tw-error");return O.length?(T.prepend(v.map(function(e){return e.render()}),"<br>"),i.create("propagated",O.length+" error"+(O.length>1?"s":"")+" occurred when running "+t.TwineScript_ObjectName+".",void 0,T)):void 0===w?i.create("custommacro",t.TwineScript_ObjectName+" didn't output any data or hooks using (output:) or (output-data:)."):n.isPrototypeOf(w)?(x=w,k=l({TwineScript_TypeID:"command",TwineScript_ObjectName:"a custom command",TwineScript_TypeName:"a custom command",TwineScript_Print:function(){return"`[a custom command]`"},TwineScript_Attach:function(e){return e.run(x),k},TwineScript_Run:function(){return x}})):w}},d=Object.freeze({TwineScript_TypeID:"macro",TwineScript_TypeName:"a custom macro",get TwineScript_ObjectName(){return this.TwineScript_KnownName?"the "+this.TwineScript_KnownName+" macro":"a custom macro"},TwineScript_GetProperty:function(e){if("params"===e)return[].concat(_toConsumableArray(this.params))},TwineScript_Properties:["params"],TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},TwineScript_Clone:function(){return l(p(d),this)},TwineScript_ToSource:function(){return"(macro:"+this.params.map(function(e){return e.TwineScript_ToSource()}).concat("")+this.body.TwineScript_ToSource()+")"},create:function(e,t){var n=l(p(this),{params:e,called:0,varNames:e.map(function(e){return e.varRef.propertyChain[0]}),typeSignature:e.map(function(e){var t=void 0;return t=e.datatype.toTypeSignatureObject?e.datatype.toTypeSignatureObject({rest:e.rest}):{pattern:"range",range:function(t){return u(e.datatype,t)},name:c(e.datatype)},e.rest?{pattern:"zero or more",innerType:t}:t}),body:t,TwineScript_KnownName:""});return n.fn=f(n),n}});return d}),define("datatypes/lambda",["utils/operationutils","internaltypes/varscope","internaltypes/varref","internaltypes/twineerror"],function(e,t,n,r){var a=e.objectName,i=Object.freeze({TwineScript_TypeID:"lambda",TwineScript_TypeName:"a lambda",get TwineScript_ObjectName(){return'a "'+("making"in this?"making ... ":"")+("where"in this?"where ... ":"")+("when"in this?"when ... ":"")+("via"in this?"via ... ":"")+'" lambda'},TwineScript_Print:function(){return"`[A lambda]`"},TwineScript_is:function(e){return e===this},TwineScript_ToSource:function(){return this.source},TypeSignature:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"lambda",innerType:i,clauses:t,typeName:'a "'+t.concat("").join(" ...")+'" lambda'}},TwineScript_Clone:function(){return Object.assign(Object.create(i),this)},create:function(e,o,s,c){var u=void 0;function l(e){var r=e&&e.varRef?e.varRef:e;return void 0===r||r&&n.isPrototypeOf(r)&&t.isPrototypeOf(r.object)&&1===r.propertyChain.length}if("making"===o&&!l(s))return r.create("syntax","I need a temp variable, or typed temp variable, to the right of '"+o+"', not "+a(s)+".");if(r.containsError(e))return e;if(i.isPrototypeOf(e)){if("when"===o||"when"in e)return r.create("syntax","A 'when' lambda cannot have any other clauses, such as '"+o+"'.");if(o in e&&("where"!==o||"true"!==e[o]))return r.create("syntax","This lambda has two '"+o+"' clauses.");u=e}else{if("when"===o&&void 0!==e)return r.create("syntax","A 'when' lambda shouldn't begin with a temp variable (just use 'when' followed by the condition).");if(!l(e))return r.create("syntax","This lambda needs to start with a single temp variable, or typed temp variable, not "+a(e)+".");(u=Object.create(this)).loop=e||""}return u.source=c.trim(),u[o]=s,u.making&&u.making.getName()===(u.loop&&u.loop.getName())?r.create("syntax","This lambda has two variables named '"+u.loop.getName()+"'.","Lambdas should have all-unique parameter names."):u},apply:function(e,n){var a=n.loop,i=n.pos,o=n.making,s=n.ignoreVia,c=n.tempVariables;function u(e,t){if(e)if("datatype"in e&&"varRef"in e){var n=e.varRef.create(c,e.varRef.propertyChain);n.defineType(e.datatype);var a=n.set(t);if(r.containsError(a))return a}else c[e.getName()]=t}c=c||Object.create(e.stack.length?e.stackTop.tempVariables:t);var l=u(this.loop,a)||u(this.making,o);if(r.containsError(l))return l;e.stack.unshift(Object.assign(Object.create(e.stackTop||null),{tempVariables:c,lambdaPos:this.when?void 0:i}));var p=e.eval("Operations");!a||this.making||this.when?p.initialiseIt(r.create("operation","I can't use 'it', or an implied 'it', in "+this.TwineScript_ObjectName)):p.initialiseIt(a);var f=!s&&this.via,d=e.eval("where"in this||"when"in this?"Operations.where("+(this.where||this.when)+","+(f||"true")+",null)":f||"true");return e.stack.shift(),d},filter:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=void 0,o=t.reduce(function(t,o,s){if(i=r.containsError(t))return i;var c=n.apply(e,{loop:o,pos:s+1,ignoreVia:!0,tempVariables:a});return(i=r.containsError(c))?i:t.concat(c?[o]:[])},[]);return(i=r.containsError(o))?i:o}});return i}),define("datatypes/codehook",["internaltypes/twineerror","renderer"],function(e,t){var n=t.exec;return Object.freeze({TwineScript_TypeName:"a code hook",TwineScript_ObjectName:"a code hook",TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return"["+this.source+"]"},create:function(t,r){r||(r=n(t));var a=e.containsError(r);return a||Object.assign(Object.create(this),{source:t,html:r})}})}),define("datatypes/colour",["jquery","utils"],function(e,t){var n=t.matMul,r=Math.max,a=Math.min,i=Math.sin,o=Math.cos,s=Math.pow,c=Math.round,u=Math.floor,l=Math.atan2,p=Math.cbrt,f=Math.sqrt,d=Math.PI,h=Object.assign,y=Object.create,m=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,g=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,v=y(null);function b(e){var t=e.r,n=e.g,i=e.b,o=e.a,s=r(t/=255,n/=255,i/=255),u=a(t,n,i),l=(s+u)/2,p=s-u;if(s===u)return{h:0,s:0,l:l};var f=void 0;switch(s){case t:f=(n-i)/p+(n<i?6:0);break;case n:f=(i-t)/p+2;break;case i:f=(t-n)/p+4}return{h:f=c(60*f),s:l>.5?p/(2-s-u):p/(s+u),l:l,a:o}}var w=[.96422,1,.82521],T=24389/27,S=216/24389,x=function(e){return e.map(function(e){return[e]})},k=function(e){return e.map(function(e){return e[0]})};function O(e){var t=e.l,r=e.c,a=e.h,c=e.a;t*=100;var u=[];u[1]=(t+16)/116,u[0]=r*o(a*d/180)/500+u[1],u[2]=u[1]-r*i(a*d/180)/200;var l=[s(u[0],3)>S?s(u[0],3):(116*u[0]-16)/T,t>T*S?s((t+16)/116,3):t/T,s(u[2],3)>S?s(u[2],3):(116*u[2]-16)/T].map(function(e,t){return e*w[t]}),p=k(n([[.9555766,-.0230393,.0631636],[-.0282895,1.0099416,.0210077],[.0122982,-.020483,1.3299098]],n([[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]],x(l)))).map(function(e){return 255*e}),f=_slicedToArray(p,3);return{r:f[0],g:f[1],b:f[2],a:c}}function j(e){var t=O(e);return[t.r,t.g,t.b].every(function(e){return e>=0&&e<=255})}var A=Object.freeze({TwineScript_TypeID:"colour",TwineScript_TypeName:"a colour",TwineScript_ObjectName:"a colour",TwineScript_DebugName:function(){return"a colour "+this.TwineScript_Print()},"TwineScript_+":function(e){var t=this.toRGBA(),n=e.toRGBA();return A.create({r:Math.min(Math.round(.6*(t.r+n.r)),255),g:Math.min(Math.round(.6*(t.g+n.g)),255),b:Math.min(Math.round(.6*(t.b+n.b)),255),a:(t.a+n.a)/2})},TwineScript_Print:function(){var e=this.toRGBA();return"<tw-colour style='background-color:rgba("+[e.r,e.g,e.b,e.a]+");'></tw-colour>"},TwineScript_is:function(e){if(!A.isPrototypeOf(e))return!1;if(e.lcha&&this.lcha)return e.lcha.l===this.lcha.l&&e.lcha.c===this.lcha.c&&e.lcha.h===this.lcha.h&&e.a===this.a;var t=this.toRGBA();return(e=e.toRGBA()).r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a},TwineScript_Clone:function(){return A.create(this)},toRGBAString:function(){var e=this.toRGBA();return"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"},toHSLA:function(){return b(this.toRGBA())},toRGBA:function(){return this.lch?O(function(e){if(j(e))return e;var t=(e=h({},e)).c,n=0;for(e.c/=2;t-n>1e-5;)j(e)?n=e.c:t=e.c,e.c=(t+n)/2;return e}(h({},this.lch,{a:this.a}))):this},toLCHA:function(){return this.lch?h({},this.lch):(t=(e=this).r,r=e.g,a=e.b,i=e.a,o=k(n([[1.0478112,.0228866,-.050127],[.0295424,.9904844,-.0170491],[-.0092345,.0150436,.7521316]],n([[.4124564,.3575761,.1804375],[.2126729,.7151522,.072175],[.0193339,.119192,.9503041]],x([t/255,r/255,a/255])))).map(function(e,t){return e/w[t]}).map(function(e){return e>S?p(e):(T*e+16)/116}),c=[116*o[1]-16,500*(o[0]-o[1]),200*(o[1]-o[2])],u=180*l(c[2],c[1])/d,{l:c[0]/100,c:f(s(c[1],2)+s(c[2],2)),h:u>=0?u:u+360,a:i});var e,t,r,a,i,o,c,u},LCHRotate:function(e){e<0&&(e=360+e);var t=this.toLCHA();return t.h=(t.h+e)%360,t.a=this.a,A.create(t)},TwineScript_GetProperty:function(e){if("lch"===e){var t=this.toLCHA();return new Map([["l",t.l],["c",t.c],["h",t.h]])}var n=this.toRGBA();return"h"===e||"s"===e||"l"===e?b(n)[e]:"r"===e||"g"===e||"b"===e||"a"===e?n[e]:void 0},TwineScript_Properties:["h","s","l","r","g","b","a","lch"],TwineScript_ToSource:function(){var e=!this.lch&&b(this);if(e&&!e.h&&!e.s){if(1===e.l)return"white";if(0===e.l)return"black"}return"("+(this.lch?"lch":"hsl")+":"+(this.lch?[this.lch.l,this.lch.c,this.lch.h]:[e.h,e.s,e.l])+(1!==this.a?","+this.a:"")+")"},create:function(t){return"string"==typeof t?this.create((A.isHexString(t)?function(e){return"string"!=typeof e?e:(e=(e=e.replace("#","")).replace(m,"$1$1$2$2$3$3"),{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)})}:function(t){if(t in v)return v[t];var n=e("<p>").css("background-color",t).css("background-color");return n="transparent"===n?{r:0,g:0,b:0,a:0}:n.startsWith("rgb")?n.match(/\d+/g).reduce(function(e,t,n){return e["rgb"[n]]=+t,e},{}):{r:192,g:192,b:192},v[t]=n,n})(t)):!("h"in t&&"s"in t&&"l"in t)||"r"in t||"g"in t||"b"in t?("a"in t&&"number"==typeof t.a||(t.a=1),h(y(this),"h"in t&&"c"in t&&!("s"in t)&&"l"in t?{a:t.a,lch:{l:t.l,c:t.c,h:t.h}}:t)):this.create(function(e){var t=e.h,n=e.s,r=e.l,a=e.a;if(0===n){var i=u(255*r);return{r:i,g:i,b:i}}var o=r<.5?r*(1+n):r+n-r*n,s=2*r-o;function c(e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?s+6*(o-s)*e:e<.5?o:e<2/3?s+(o-s)*(2/3-e)*6:s}return{r:u(255*c((t/=360)+1/3)),g:u(255*c(t)),b:u(255*c(t-1/3)),a:a}}(t))},isHexString:function(e){return"string"==typeof e&&"#"===e[0]&&(e.slice(1).match(m)||e.slice(1).match(g))},isCSS3Function:function(e){return"string"==typeof e&&/^(?:rgb|hsl)a?\(\s*\d+\s*,\s*\d+%?\s*,\s*\d+%?(?:,\s*\d+(?:\.\d+)?\s*)?\)$/.test(e)}});return A}),define("datatypes/gradient",["utils/operationutils"],function(e){var t=e.toSource,n=Object.freeze({TwineScript_TypeID:"gradient",TwineScript_TypeName:"a gradient",TwineScript_ObjectName:"a gradient",TwineScript_DebugName:function(){return"a gradient "+this.TwineScript_Print()},TwineScript_GetProperty:function(e){var t=this;return"angle"===e?this.angle:"stops"===e?this.stops.map(function(e){return new Map([[t.repeating?"pixels":"percent",e.stop],["colour",e.colour.TwineScript_Clone()]])}):void 0},TwineScript_Properties:["angle","stops"],TwineScript_ToSource:function(){return"(gradient:"+this.angle+","+this.stops.map(function(e){return t(e.stop)+","+t(e.colour)})+")"},TwineScript_is:function(e){var t=this;return e.angle===this.angle&&e.stops.length===this.stops.length&&e.stops.every(function(e,n){var r=e.colour,a=e.stop;return t.stops[n].stop===a&&t.stops[n].colour.TwineScript_is(r)})},TwineScript_Clone:function(){return n.create(this.angle,[].concat(_toConsumableArray(this.stops)))},TwineScript_Print:function(){return"<tw-colour style='background:"+this.toLinearGradientString()+"'></tw-colour>"},create:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object.assign(Object.create(this),{angle:e,stops:t.sort(function(e,t){return e.stop-t.stop}),repeating:n})},multiply:function(e){return n.create(this.angle,this.stops.map(function(t){return{colour:t.colour,stop:t.stop*e}}))},toLinearGradientString:function(){var e=this;return(this.repeating?"repeating-":"")+"linear-gradient("+this.angle+"deg, "+this.stops.reduce(function(t,n){var r=n.colour,a=n.stop;return t+r.toRGBAString()+" "+a*(e.repeating?1:100)+(e.repeating?"px,":"%,")},"").slice(0,-1)+")"}});return n}),define("datatypes/datatype",["utils","utils/operationutils","datatypes/changercommand","datatypes/colour","datatypes/gradient","datatypes/lambda","datatypes/custommacro","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s){var c=e.realWhitespace,u=e.anyRealLetter,l=e.anyCasedLetter,p=e.anyNewline,f=t.objectName,d=Object.assign,h=Object.seal,y=Object.keys,m=Math.floor,g=Math.abs,v=void 0,b=void 0,w={TwineScript_TypeID:"datatype",TwineScript_TypeName:"a datatype",TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},get TwineScript_ObjectName(){return"the "+(this.rest?"...":"")+this.name+" datatype"},TwineScript_is:function(e){return w.isPrototypeOf(e)&&e.name===this.name},TwineScript_Clone:function(){return this.rest?this:Object.create(this)},TwineScript_ToSource:function(){return(this.rest?"...":"")+this.name},TwineScript_IsTypeOf:function(e){var t=this.name,n=this.rest;return!!v[t]&&v[t](e,n)},toTypeSignatureObject:function(){var e=this.name,t={pattern:"range",range:v[e],name:"a "+("dm"===e?"datamap":"ds"===e?"dataset":"num"===e?e+"ber":"str"===e?e+"ing":"color"===e?"colour":"bool"===e?e+"ean":"alnum"===e?"alphanumeric character":"int"===e?e+"eger":"even"===e||"odd"===e?e+" number":e.endsWith("case")||"whitespace"===e?e+" character":"empty"===e?e+" value":e)};return this.rest?{pattern:"zero or more",innerType:t}:t},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e="datamap"===e?"dm":"dataset"===e?"ds":"number"===e?"num":"string"===e?"str":"color"===e?"colour":"boolean"===e?"bool":"alphanumeric"===e?"alnum":"integer"===e?"int":e;var n=Object.create(this);return n.name=e,n.rest=t,n},from:function(e){var t=y(b).find(function(t){return b[t](e)});return t?w.create(t):s.create("datatype",f(e)+" doesn't correspond to a datatype value.")}};return b={array:Array.isArray,dm:function(e){return e instanceof Map},ds:function(e){return e instanceof Set},datatype:function(e){return w.isPrototypeOf(e)},changer:function(e){return n.isPrototypeOf(e)},colour:function(e){return r.isPrototypeOf(e)},gradient:function(e){return a.isPrototypeOf(e)},lambda:function(e){return i.isPrototypeOf(e)},macro:function(e){return o.isPrototypeOf(e)},str:function(e){return"string"==typeof e},num:function(e){return"number"==typeof e},bool:function(e){return"boolean"==typeof e}},v=d({},b,{even:function(e){return!isNaN(e)&&m(g(e))%2==0},odd:function(e){return!isNaN(e)&&m(g(e))%2==1},empty:function(e){return e instanceof Map||e instanceof Set?!e.size:!(!Array.isArray(e)&&"string"!=typeof e)&&!e.length},int:function(e){return"number"==typeof e&&e===(0|e)},uppercase:function(e){return"string"==typeof e&&1===[].concat(_toConsumableArray(e)).length&&[].concat(_toConsumableArray(e)).every(function(e){return e!==e.toLowerCase()})},lowercase:function(e){return"string"==typeof e&&1===[].concat(_toConsumableArray(e)).length&&[].concat(_toConsumableArray(e)).every(function(e){return e!==e.toUpperCase()})},whitespace:function(e){return"string"==typeof e&&!!e.match("^"+c+"$")},digit:function(e){return"string"==typeof e&&!!e.match("^\\d$")},alnum:function(e){return"string"==typeof e&&!!e.match("^"+u+"$")},anycase:function(e){return"string"==typeof e&&!!e.match("^"+l+"$")},linebreak:function(e){return"string"==typeof e&&!!e.match("^"+p+"$")},any:function(){return!0},const:function(){return!0}}),h(w)}),define("datatypes/typedvar",["utils/operationutils","datatypes/datatype","internaltypes/varref","internaltypes/twineerror"],function(e,t,n,r){var a=e.typeName,i=e.matches,o=e.toSource,s=e.unstorableValue,c=Object.freeze,u=Object.assign,l=Object.create,p=c({TwineScript_TypeName:"a typed variable name",get TwineScript_ObjectName(){return this.TwineScript_ToSource()},TwineScript_Print:function(){return"`[A typed variable name]`"},TwineScript_Unstorable:!0,TwineScript_Clone:function(){return u(l(p),{datatype:this.datatype.TwineScript_Clone(),varRef:this.varRef})},TwineScript_ToSource:function(){return o(this.datatype)+"-type "+this.varRef.TwineScript_ToSource()},TwineScript_GetProperty:function(e){return"name"===e?this.getName():this[e]},TwineScript_Properties:["datatype","name"],TwineScript_IsTypeOf:function(e){return i(this.datatype,e)},get:function(){var e;return(e=this.varRef).get.apply(e,arguments)},getName:function(){return this.varRef.getName()},defineType:function(){if("any"!==this.datatype.name)return this.varRef.defineType(this.datatype)},create:function(e,t){var n;if(n=r.containsError(t)||r.containsError(e)||t.error)return n;var i=s(e);return i&&!p.isPrototypeOf(i)?r.create("syntax","The -type syntax can't have "+a(i)+" to its left."):u(l(this),{datatype:e,varRef:t})}});return p}),define("macros",["jquery","utils/naturalsort","utils","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/lambda","datatypes/hookset","datatypes/codehook","datatypes/typedvar","datatypes/datatype","internaltypes/changedescriptor","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c,u,l,p,f){var d=n.insensitiveName,h=n.nth,y=n.plural,m=n.andList,g=n.lockProperty,v=(r.clone,r.objectName),b=r.typeName,w=r.singleTypeCheck,T=r.toSource,S=void 0,x={};function k(e,n,r){var a=n.fn,i=n.typeSignature,s=n.isChanger,u=void 0!==s&&s,l=r[0];r=function(e){return e.reduce(function(e,n){if(n&&!0===n.spreader){var r=n.value,a=f.containsError(r);if(a)e.push(a);else if(Array.isArray(r)||"string"==typeof r)for(var i=0;i<r.length;i++)e.push(r[i]);else r instanceof Set?e.push.apply(e,_toConsumableArray(Array.from(r).sort(t("en")))):e.push(f.create("operation","I can't spread out "+v(r)+", because it is not a string, dataset, or array."))}else e.push(n);return e},[])}(r.slice(1)),i=[].concat(i||[]);var p=!e,d=p?"":"("+(Array.isArray(e)&&e.length>1?e[0]:e)+":)";e=p?"this custom macro":"the "+d+" macro";var g=void 0;g=i.length>0?e+" must only be given "+m(i.map(b))+(i.length>1?", in that order":"."):e+" must not be given any data."+(p?"":" Just write "+d);for(var T=void 0,x=function(t,n){var a=i[t],s=r[t];if(f.containsError(s))return{v:s};if(c.isPrototypeOf(s)&&u)return{v:f.create("syntax","Please put this hook outside the parentheses of the changer macro, not inside it.","Hooks should appear after a macro"+(p?".":": "+d+"[Some text]"))};if(t>=i.length&&!T)return{v:f.create("datatype",r.length-i.length+" too many values were given to "+e+".",g)};if(a||(a=T),!a.innerType||"rest"!==a.pattern&&"zero or more"!==a.pattern||(T=a.innerType,"rest"===a.pattern&&(a=a.innerType)),!w(s,a)){if(void 0===s){var l=i.filter(function(e){return!("optional"===e.pattern||"zero or more"===e.pattern)}).length;return{v:f.create("datatype",e+" needs "+y(l-t,"more value")+".",g)}}return s&&s.TwineScript_Unstorable&&(a===S.TypeSignature.Any||a.innerType&&a.innerType===S.TypeSignature.Any)?{v:f.create("datatype",e+"'s "+h(t+1)+" value, "+v(s)+", is not valid data for this macro.",g)}:s&&o.isPrototypeOf(s)&&"lambda"===a.pattern?{v:f.create("datatype",e+"'s "+h(t+1)+" value (a lambda) should have "+m(["where","when","making","via","with"].filter(function(e){return a.clauses.includes(e)}).map(function(e){return"a '"+e+"' clause"}))+", not "+m(["where","when","making","via","with"].filter(function(e){return e in s}).map(function(e){return"a '"+e+"' clause"}))+".")}:"insensitive set"===a.pattern?{v:f.create("datatype",v(s)+" is not a valid name string for "+e+".","Only the following names are recognised (capitalisation and hyphens ignored): "+m(a.innerType)+".")}:{v:f.create("datatype",e+"'s "+h(t+1)+" value is "+v(s)+", but should be "+b(a)+".",a.message||g)}}},k=0,O=Math.max(r.length,i.length);k<O;k+=1){var j=x(k);if("object"===(void 0===j?"undefined":_typeof(j)))return j.v}return a.apply(void 0,[l].concat(_toConsumableArray(r)))}function O(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={fn:t,typeSignature:n};r&&(a.isChanger=!0),Object.freeze(a),Array.isArray(e)?e.forEach(function(e){return g(x,d(e),a)}):g(x,d(e),a)}return S={has:function(e){return e=d(e),x.hasOwnProperty(e)},get:function(e){return e=d(e),x.hasOwnProperty(e)&&x[e]},add:function e(t,n,r){return O(t,n,r),e},addChanger:function e(t,n,r,i){return O(t,n,i,!0),a.register(Array.isArray(t)?t[0]:t,r),e},addCommand:function e(t,n,r,a){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return O(t,function(e,t,n,r){return function(a){for(var i=arguments.length,o=Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];var c=t.apply(void 0,o);if(c)return c;var u=p.create(),l=Object.assign({TwineScript_TypeID:"command",TwineScript_ObjectName:"a ("+e+":) command",TwineScript_TypeName:"a ("+e+":) command",TwineScript_Print:function(){return"`[A ("+e+":) command]`"},TwineScript_ToSource:function(){return"("+e+":"+o.map(T)+")"},TwineScript_is:function(e){return T(this)===T(e)}},r?{TwineScript_Attach:function(e,t){return u.section=e,t.run(u),l},TwineScript_Run:function(e){return n.apply(void 0,[u,e].concat(o))}}:{TwineScript_Run:function(e){return n.apply(void 0,[e].concat(o))}});return l}}([].concat(t)[0],n,r,i),a),e},TypeSignature:{optional:function(e){return{pattern:"optional",innerType:e}},zeroOrMore:function(e){return{pattern:"zero or more",innerType:e}},either:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"either",innerType:t}},rest:function(e){return{pattern:"rest",innerType:e}},insensitiveSet:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"insensitive set",innerType:t}},numberRange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return{pattern:"range",min:e,max:t,range:function(n){return"number"==typeof n&&!Number.isNaN(n)&&n>=e&&n<=t}}},nonNegativeInteger:{pattern:"range",integer:!0,min:0,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&e>=0&&!(e+"").includes(".")}},positiveInteger:{pattern:"range",integer:!0,min:1,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&e>=1&&!(e+"").includes(".")}},wrapped:function(e,t){return{pattern:"wrapped",innerType:e,message:t}},Any:{TwineScript_TypeName:"anything"},Everything:{TwineScript_TypeName:"everything"}},run:function(e,t){return S.has(e)?k(e,S.get(e),t):f.create("macrocall","I can't run the macro '"+e+"' because it doesn't exist.","Did you mean to run a macro? If you have a word written like (this:), it is regarded as a macro name.")},runCustom:function(e,t){return i.isPrototypeOf(e)?k("",e,t):f.create("macrocall","I can't call "+v(e)+" because it isn't a custom macro.")}},Object.assign(S.TypeSignature,{positiveNumber:S.TypeSignature.numberRange(Math.pow(2,-52),1/0),nonNegativeNumber:S.TypeSignature.numberRange(0,1/0),percent:S.TypeSignature.numberRange(0,1)}),Object.freeze(S)}),define("datatypes/varbind",["jquery","utils","utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(e,t,n,r,a){var i=n.objectName;return r.on("set",function(n,r){n.TwineScript_VariableStore&&e(t.storyElement).find("[data-2bind]").each(function(t,a){var i=(a=e(a)).data("twoWayBindEvent");"function"==typeof i&&i(a,n,r)})}),Object.freeze({TwineScript_TypeName:"a bound variable",TwineScript_ObjectName:"a bound variable",TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return("two way"===this.bind?"2":"")+"bind "+this.varRef.TwineScript_ToSource()},set:function(e){var t,n=this.varRef.set(e);if(t=a.containsError(n))return t},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"one way";return r.isPrototypeOf(e)?e.error?e.error:Object.assign(Object.create(this),{varRef:e,bind:t}):a.create("operation","I can only 'bind' a variable, not "+i(e)+".")}})}),define("datatypes/assignmentrequest",["utils/operationutils","datatypes/typedvar","datatypes/datatype","internaltypes/varref","internaltypes/twineerror"],function(e,t,n,r,a){var i=e.objectName,o=e.matches;return Object.freeze({assignmentRequest:!0,TwineScript_TypeName:"a 'to' or 'into' expression",TwineScript_ObjectName:"a 'to' or 'into' expression",TwineScript_Unstorable:!0,set:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=void 0,c=[],u=function e(s,c){var u,l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],p=[],f=void 0;if(f=c&&r.isPrototypeOf(c)?c.get():c,u=a.containsError(f))return u;if(Array.isArray(f)&&Array.isArray(s)){for(var d=0,h=0;d<s.length&&h<f.length;){var y=s[d],m=f[h];if(t.isPrototypeOf(y)&&y.datatype.rest||n.isPrototypeOf(y)&&y.rest){for(var g=h;h<f.length&&o(y,m);)m=f[h+=1];t.isPrototypeOf(y)?y.datatype=[y.datatype]:n.isPrototypeOf(y)&&(y=n.create("array")),p=p.concat(e(y,r.isPrototypeOf(c)?r.create(c,{first:g+1,last:h+1}):f.slice(g,h)))}else p=p.concat(e(y,r.isPrototypeOf(c)?r.create(c,h+1):m)),h+=1;d+=1}return d<s.length?l&&a.create("operation","I can't unpack this array because it needs "+(s.length-d)+" more value"+(s.length-d>0?"s":"")+"."):p}if(s instanceof Map&&f instanceof Map){var v=!0,b=!1,w=void 0;try{for(var T,S=s.entries()[Symbol.iterator]();!(v=(T=S.next()).done);v=!0){var x=_slicedToArray(T.value,2),k=x[0],O=x[1];if(!f.has(k))return l&&a.create("operation","I can't unpack this datamap because it needs a '"+k+"' data name.");p=p.concat(e(O,r.isPrototypeOf(c)?r.create(c,k):f.get(k)))}}catch(e){b=!0,w=e}finally{try{!v&&S.return&&S.return()}finally{if(b)throw w}}return p}if(t.isPrototypeOf(s)){if("function"==typeof s.datatype.destructure)return[{dest:s,value:f,src:c}].concat(s.datatype.destructure(f));if(!o(f,s.datatype))return[l&&a.create("operation","I can't unpack "+i(f)+" into "+s.varRef.TwineScript_ToSource()+" because it doesn't match "+i(s.datatype)+".")];p=p.concat(e(s.datatype,f))}return r.isPrototypeOf(s)||t.isPrototypeOf(s)?p.concat({dest:s,value:f,src:c}):"function"==typeof s.destructure?p.concat(s.destructure(f)):o(f,s)?p:l&&a.create("operation","I tried to unpack, but "+i(s)+" in the pattern didn't match "+i(f)+".")}(this.dest,this.src);if(s=a.containsError(u))return s;if(!u.length)return a.create("operation","I can't store a new value inside "+i(this.dest)+" that isn't in a variable.","You need a variable, or a data structure containing variables at certain positions, to store the value.");var l=!0,p=!1,f=void 0;try{for(var d,h=u.reverse()[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var y=d.value,m=y.dest,g=y.value,v=y.src;if(t.isPrototypeOf(m)){if(s=a.containsError(m.defineType()))return s;m=m.varRef}if(s=m.set(g),a.isPrototypeOf(s))return s;e&&v&&v.delete(),c.shift(i(m)+" is now "+i(g))}}catch(e){p=!0,f=e}finally{try{!l&&h.return&&h.return()}finally{if(p)throw f}}return c.join("; ")},create:function(e,t,n){return Object.assign(Object.create(this),{dest:e,src:t,operator:n})}})}),define("twinescript/operations",["jquery","state","datatypes/assignmentrequest","utils/operationutils","internaltypes/varref","datatypes/typedvar","datatypes/datatype","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s){var c=r.isObject,u=r.collectionType,l=r.is,p=r.isA,f=r.clone,d=r.unique,h=r.contains,y=r.matches,m=r.objectName,g=void 0,v=0;function b(e,t,n,r){return n=n||"do this to",function(a,i){1===t.length&&(i=a);var o;return(o=s.containsError(a,i))?o:(void 0===a?"undefined":_typeof(a))!==e||(void 0===i?"undefined":_typeof(i))!==e?s.create("operation","I can only "+n+" "+e+"s, not "+m((void 0===a?"undefined":_typeof(a))!==e?a:i)+".",r):t(a,i)}}function w(e){return function(t,n){var r;if(r=s.containsError(t,n))return r;if((void 0===t?"undefined":_typeof(t))!==(void 0===n?"undefined":_typeof(n))||c(t)&&"TwineScript_TypeName"in t&&c(n)&&"TwineScript_TypeName"in n&&t.TwineScript_TypeName!==n.TwineScript_TypeName||u(t)!==u(n)){var a=m(t)+" isn't the same type of data as "+m(n);return s.create("operation",a[0].toUpperCase()+a.slice(1))}return e(t,n)}}function T(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function r(a,i){var o=void 0;if(o=s.containsError(a,i))return o;v=a;var c=a.determiner?[a,i]:i.determiner?[i,a]:[],u=_slicedToArray(c,2),l=u[0],p=u[1];if(l){var f=l.determiner;if("start"===f||"end"===f){if(t)return s.create("operation","I can't use '"+t+"' with the 'start' or 'end' of "+m(l)+".");if(p.determiner){if("start"===p.determiner||"end"===p.determiner)return s.create("operation","I can't compare one value's 'start' or 'end' with another value's 'start' or 'end'.","Please change one of them to use an exact range, such as '1stto4th' or '2ndlasttolast'.");var d=[p,l];l=d[0],p=d[1]}for(var h=l.string||l.array,y=0;y<h.length+1;y+=1){var g=y?"end"===f?h.slice(-y):h.slice(0,y):h.constructor(),b=l===a?r(g,i):r(a,g);if(o=s.containsError(b))return o;if(b!==n)return b}return n}var w="all"===f;return l.array.reduce(function(e,t){var n,o=l===a?r(t,i):r(a,t);return(n=s.containsError(e,o))?n:w?e&&o:e||o},w)}return e(a,i)}}function S(e,t){return T(function(t,n){var r=e(t,n);return s.containsError(r)?r:!r},t,!0)}var x="If one of these values is a number, you may want to write a check that it 'is not 0'. Also, if one is a string, you may want to write a check that it 'is not \"\" '.";return g={create:function(n){var r=Object.create(this);return r.Identifiers={TwineScript_Identifiers:!0,get it(){return v},get time(){return n.stackTop&&n.stackTop.evaluateOnly?s.create("operation","'time' can't be used in "+n.stackTop.evaluateOnly+"."):Date.now()-n.timestamp},get visits(){var e=n.stackTop.speculativePassage,r=function(n){return n===(e||t.passage)};return t.pastPassageNames().filter(r).length+t.mockVisits.filter(r).length+(!e||e===t.passage)},get visit(){return r.Identifiers.visits},get exits(){return n.stackTop&&n.stackTop.evaluateOnly?s.create("operation","'exit' and 'exits' can't be used in "+n.stackTop.evaluateOnly+"."):n.dom.find("tw-enchantment, tw-link").filter(function(t,n){return e(n).data("enchantmentEvent")||e(n).parent().data("linkPassageName")||e(n).parent().data("clickEvent")}).length},get exit(){return r.Identifiers.exits},get pos(){return n.stackTop&&!n.stackTop.evaluateOnly&&n.stackTop.lambdaPos?+n.stackTop.lambdaPos||1:s.create("operation","'pos' can only be used in lambdas that aren't 'when' lambdas.")}},r},elidedComparisonOperator:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return r.reduce(function(n,r){return"boolean"==typeof r?r:g[e](n,g[t](v,r))},"and"===e)},and:b("boolean",w(function(e,t){return e&&t}),"use 'and' to join",x),or:b("boolean",w(function(e,t){return e||t}),"use 'or' to join",x),not:b("boolean",function(e){return!e},"use 'not' to invert",x),"+":w(function(e,t){if(Array.isArray(e))return[].concat(_toConsumableArray(e),_toConsumableArray(t));var n=void 0;return e instanceof Map?(n=new Map(e),t.forEach(function(e,t){return n.set(t,e)}),n):e instanceof Set?new Set([].concat(_toConsumableArray(e),_toConsumableArray(t)).filter(d).map(f)):"function"==typeof e["TwineScript_+"]?e["TwineScript_+"](t):"string|number|boolean".includes(void 0===e?"undefined":_typeof(e))?e+t:s.create("operation","I can't use + on "+m(e)+".")}),"-":w(function(e,t){if(Array.isArray(e))return e.filter(function(e){return!t.some(function(t){return l(e,t)})});if(e instanceof Set){var n=[].concat(_toConsumableArray(t));return new Set([].concat(_toConsumableArray(e)).filter(function(e){return!n.some(function(t){return l(e,t)})}))}return"string"==typeof e?e.split(t).join(""):"number"==typeof e?e-t:s.create("operation","I can't use - on "+m(e)+".")}),"*":b("number",w(function(e,t){return e*t}),"multiply"),"/":b("number",w(function(e,t){return 0===t?s.create("operation","I can't divide "+m(e)+" by zero."):e/t}),"divide"),"%":b("number",w(function(e,t){return 0===t?s.create("operation","I can't modulo "+m(e)+" by zero."):e%t}),"modulus"),"<":T(b("number",w(function(e,t){return e<t}),"do < to"),"<"),">":T(b("number",w(function(e,t){return e>t}),"do > to"),">"),"<=":T(b("number",w(function(e,t){return e<=t}),"do <= to"),"<="),">=":T(b("number",w(function(e,t){return e>=t}),"do >= to"),">="),is:T(l),isNot:S(l),contains:T(h,"contains"),doesNotContain:S(h,"does not contain"),isIn:T(function(e,t){return h(t,e)},"is in"),isNotIn:S(function(e,t){return h(t,e)},"is not in"),isA:T(p,"is a"),isNotA:S(p,"is not a"),typifies:T(function(e,t){return p(t,e)}),untypifies:S(function(e,t){return p(t,e)}),matches:T(y),doesNotMatch:S(y),where:function(e,t,n){var r;return(r=s.containsError(e))?r:"boolean"!=typeof e?s.create("operation","This lambda's 'where' clause must evaluate to true or false, not "+m(e)+"."):e?t:n},makeSpreader:function(e){if(i.isPrototypeOf(e)||o.isPrototypeOf(e)){var t=f(e);return(i.isPrototypeOf(e)?t.datatype:t).rest=!0,t}return{value:e,spreader:!0,TwineScript_TypeName:"a spreaded '...' value",TwineScript_ObjectName:"a spreaded '...' value",TwineScript_Unstorable:!0}},makeAssignmentRequest:function(e,t,r){var a=s.containsError(e,t);return a||n.create(e,t,r)},setIt:function(e){return a.isPrototypeOf(e)||i.isPrototypeOf(e)?(v=e.get(),e):e},initialiseIt:function(e){v=e}},Object.freeze(g)}),define("twinescript/environ",["macros","state","utils","datatypes/colour","datatypes/hookset","datatypes/lambda","datatypes/datatype","datatypes/varbind","datatypes/codehook","datatypes/typedvar","internaltypes/varref","internaltypes/twineerror","twinescript/operations"],function(Macros,State,Utils,Colour,HookSet,Lambda,Datatype,VarBind,CodeHook,TypedVar,VarRef,TwineError,OperationsProto){return function(section){"object"===(void 0===section?"undefined":_typeof(section))&&section||Utils.impossible("TwineScript.environ","no Section argument was given!");var Operations=OperationsProto.create(section);return section.eval=function(){try{return eval(arguments[0])}catch(e){return e}},section}}),define("section",["jquery","utils","renderer","twinescript/environ","twinescript/operations","state","utils/operationutils","utils/renderutils","datatypes/changercommand","datatypes/hookset","datatypes/colour","datatypes/lambda","internaltypes/changedescriptor","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(e,t,n,r,a,i,o,s,c,u,l,p,f,d,h,y){var m,g=o.printBuiltinValue,v=o.objectName,b=o.typeID,w=s.collapse;function T(e,n,r){if(n&&"object"===(void 0===n?"undefined":_typeof(n))&&c.isPrototypeOf(n)){if(r.data("originalSource",r.popAttr("source")),!this.renderInto(r.data("originalSource"),r,n)){var a=t.insensitiveName(e.attr("name"));if(["if","elseif","unless","else","testfalse"].includes(a)&&(e.addClass("false"),"elseif"!==a&&(this.stackTop.lastHookShown=!1)),r.data("live")){var i=r.data("live"),o=i.delay,s=i.event;(function(e,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;i&&t.assertMustHave(i,["when"]);var o=n.data("originalSource")||"",s=_slicedToArray(this.stack,1)[0].tempVariables,c=this.whenUnblocked.bind(this,function(){if(r.inDOM()){var t=i&&i.filter(r,[!0],s);h.containsError(t)?t.render(e.attr("title")).replaceAll(e):!i||t[0]?(r.renderInto(o,n,{append:"replace"}),t||n.find("tw-expression[name='stop']").length||r.inDOM()&&setTimeout(c,a)):setTimeout(c,a)}});setTimeout(c,a)}).call(this,e,r,o,s)}return}}else{if(!1===n)return r.attr("source")&&(r.data("originalSource",r.popAttr("source")),r.data("hidden",!0)),e.addClass("false"),void(this.stackTop.lastHookShown=!1);!0!==n&&e.replaceWith(h.create("datatype",v(n)+" cannot be attached to this hook.","Only Booleans and changers can be attached to hooks.").render(e.attr("title")))}this.stackTop.lastHookShown=!0}function S(t){var n=(t instanceof e?t[0]:t).nextSibling;if(n&&(n instanceof Text&&!n.textContent.trim()||["br","tw-consecutive-br"].includes((n.tagName||"").toLowerCase()))){var r=S(n),a=r.whitespace,i=r.nextElem;return{whitespace:e(n).add(a),nextElem:i}}return{whitespace:e(),nextElem:e(n)}}var x={add:[],remove:[]};return m={create:function(e){var n=Object.assign(Object.create(this),{timestamp:Date.now(),dom:e||t.storyElement,stack:[],enchantments:[],unblockCallbacks:[]});return n=r(n)},get stackTop(){return this.stack[0]},inDOM:function(){return e(t.storyElement).find(this.dom).length>0},evaluateTwineMarkup:function(t,n){var r=e("<p>");this.stack.unshift({desc:f.create({target:r,source:t,section:this,append:"append"}),tempVariables:this.stackTop.tempVariables,evaluateOnly:n,finalIter:!0}),this.execute();var a;return(a=r.find("tw-error")).length>0?a:r},speculate:function(e,t,n){this.stack.unshift({evaluateOnly:n,finalIter:!0,tempVariables:Object.assign(Object.create(d),{TwineScript_VariableStoreName:n}),speculativePassage:t});var r=void 0;return r=p.isPrototypeOf(e)?e.apply(this,{fail:!1,pass:!0}):this.eval(e),this.stack.shift(),r},renderInto:function(t,n,r){var a=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=f.create({target:n,source:t,section:this,append:"append"});if(r)if(c.isPrototypeOf(r)){var s=r.run(o);if(h.containsError(s))return s.render(n.attr("title")).replaceAll(n),!1}else Object.assign(o,r);if((n=o.target,this.stack.length>=50)&&this.stack.reduce(function(e,t){return e+!!t.finalIter},0)>=50)return h.create("infinite","Printing this expression may have trapped me in an infinite loop.").render(n.attr("title")).replaceAll(n),!1;var u=function(t,r,i){var o=n instanceof e&&n.is("tw-hook")&&n.parents("tw-collapsed,[collapsing=true]").length>0;a.stack.unshift({desc:t,finalIter:i,tempVariables:r,collapses:o,evaluateOnly:a.stackTop&&a.stackTop.evaluateOnly})};if(i||(i=Object.create(this.stack.length?this.stackTop.tempVariables:d)),!i.hasOwnProperty("TwineScript_VariableStoreName")){var l=n&&n.tag();i.TwineScript_VariableStoreName="tw-hook"===l?n.attr("name")?"?"+n.attr("name"):"an unnamed hook":"tw-expression"===l?"a "+n.attr("type")+" expression":"tw-passage"===l?"this passage":"an unknown scope"}return Object.keys(o.loopVars).length?function(){var e=Object.assign({},o.loopVars),t=Math.min.apply(Math,_toConsumableArray(Object.keys(e).map(function(t){return e[t].length})));if(y.create(t+" loop"+(1!==t?"s":"")).render().prependTo(n),t){for(var r=function(n){u(o,Object.keys(e).reduce(function(t,r){return t[r]=e[r][n],t},Object.create(i),n===t-1))},s=t-1;s>=0;s-=1)r(s);for(s=t-1;s>=0&&!a.stackTop.blocked;s-=1)a.execute()}}():(u(o,i,!0),this.execute()),0===this.stack.length&&this.updateEnchantments(),o.enabled},execute:function(){var n=this,r=this.stackTop,i=r.desc,o=r.dom,s=r.collapses,u=r.evaluateOnly;i&&!o&&(o=i.render(),this.stackTop.dom=o,this.stackTop.desc=void 0),o.findAndFilter("tw-hook,tw-expression").each(function(r,i){if(n.stackTop.blocked)return!1;switch((i=e(i)).tag()){case"tw-hook":var o=i.popAttr("source")||"";if(o&&i.data("originalSource",o),i.data("tempVariables",n.stackTop.tempVariables),i.popAttr("hidden")){i.data("hidden",!0);break}o&&n.renderInto(o,i);break;case"tw-expression":if(i.attr("blockers")){if(u)return void i.removeAttr("blockers").removeAttr("js").replaceWith(h.create("syntax","I can't use a macro like (prompt:) or (confirm:) in "+u+".","Please rewrite this without putting such macros here.").render(i.attr("title"),i));var s=[];try{s=JSON.parse(i.popAttr("blockers")),i.data("blockers",s)}catch(e){t.impossible("Section.execute","JSON.parse blockers failed.")}}if(i.data("blockers")){var p=i.data("blockers");if(p.length){n.stackTop.blocked=!0;var d=n.eval(p.shift());return h.containsError(d)&&(n.stackTop.blocked=!1,i.removeData("blockers").replaceWith(d.render(i.attr("title"),i))),!1}i.removeData("blockers")}i.attr("js")&&function(n){var r=this.eval(n.popAttr("js")||"");this.stackTop.evaluateOnly&&r&&(c.isPrototypeOf(r)||"function"==typeof r.TwineScript_Run)&&(r=h.create("syntax","I can't work out what "+this.stackTop.evaluateOnly+" should evaluate to, because it contains a "+(c.isPrototypeOf(r)?"changer.":"command."),"Please rewrite this without putting changers or commands here."));var i=void 0,o=void 0,s=e();for(o=n;c.isPrototypeOf(r);){var u=S(o);if(i=u.whitespace,(o=u.nextElem)[0]instanceof Text&&"+"===o[0].textContent.trim()){var p,d=o,m=S(d);if(p=m.whitespace,(o=m.nextElem).is("tw-expression")){var w=this.eval(o.popAttr("js"));if(h.containsError(w)){r=w;break}var x=a["+"](r,w);e(i).add(d).add(p).remove(),r=h.containsError(x)?h.create("operation","I can't combine "+v(r)+" with "+v(w)+".","function"==typeof w.TwineScript_Run?"If you want to attach this changer to "+v(w)+", remove the + between them.":"Changers can only be added to other changers."):x;continue}}if(o.is("tw-expression")){var k=this.eval(o.popAttr("js"));if(h.containsError(k)){r=k;break}if(k&&"object"===(void 0===k?"undefined":_typeof(k))&&"function"==typeof k.TwineScript_Attach){r=k.TwineScript_Attach(this,r);break}return c.isPrototypeOf(k)?void n.replaceWith(h.create("operation","Changers like ("+r.macroName+":) need to be combined using + between them.","Place the + between the changer macros, or the variables holding them. The + is absent only between a changer and its attached hook or command.").render(n.attr("title"))):void n.replaceWith(h.create("operation",v(k)+" can't have changers like ("+r.macroName+":) attached.","Changers placed just before hooks, links and commands will attempt to attach, but in this case it didn't work.").render(n.attr("title")))}if(o.is("tw-hook")){i.remove(),s=o;break}r.macroName||t.impossible("Section.runExpression","changer has no macroName");var O=n.attr("title")||"("+r.macroName+": ...)";return void n.replaceWith(h.create("syntax","The ("+r.macroName+":) changer should be stored in a variable or attached to a hook.","Macros like this should appear before a hook: "+O+"[Some text]").render(n.attr("title")))}n.attr("return",b(r)),s=s.length?s:S(n).nextElem.filter("tw-hook");var j=void 0;if(j=h.containsError(r))j instanceof Error&&(j=h.fromError(j)),n.replaceWith(j.render(n.attr("title"),n));else if(y.isPrototypeOf(r))n.append(r.render());else if(r&&"function"==typeof r.TwineScript_Run)if(r=r.TwineScript_Run(this),h.containsError(r))n.replaceWith(r.render(n.attr("title")));else if(f.isPrototypeOf(r)){if(r.data&&r.data.live)return void n.replaceWith(h.create("unimplemented","I currently can't attach (live:) or (event:) macros to commands - only hooks.").render(n.attr("title")));r.section=this,r.target=o,this.renderInto("",o,r)}else{if("blocked"===r)return this.stackTop.blocked=!0,void n.attr("js","section.blockedValue()");r&&t.impossible("Section.runExpression","TwineScript_Run() returned a non-ChangeDescriptor "+(void 0===r?"undefined":_typeof(r))+': "'+r+'"')}else!s.length&&("string"==typeof r||"number"==typeof r||r instanceof Map||r instanceof Set||Array.isArray(r)||l.isPrototypeOf(r))||r&&"function"==typeof r.TwineScript_Print&&!c.isPrototypeOf(r)?(r=g(r),h.containsError(r)?(r instanceof Error&&(r=h.fromError(r)),n.replaceWith(r.render(n.attr("title")))):"string"!=typeof r?t.impossible("printBuiltinValue() produced a non-string "+(void 0===r?"undefined":_typeof(r))):this.renderInto(r,n)):s.length?T.call(this,n,r,s):c.isPrototypeOf(r)||"boolean"==typeof r||t.impossible("Section.runExpression","The expression evaluated to an unknown value: "+r)}.call(n,i)}}),this.stackTop.blocked||(o.length&&s&&w(o),o.findAndFilter("tw-collapsed,[collapsing=true]").each(function(){w(e(this))}),this.stack.shift())},updateEnchantments:function(){this.enchantments.forEach(function(e){e.disenchant(),e.enchantScope()})},on:function(e,t){return x[e].push(t),this},addEnchantment:function(e){var t=this;this.enchantments.push(e),x.add.forEach(function(n){return n(t,e)})},removeEnchantment:function(e){var t=this,n=this.enchantments.indexOf(e);this.enchantments.splice(n,1),e.disenchant(),x.remove.forEach(function(n){return n(t,e)})},unblock:function(e){for(this.stack.length||t.impossible("Section.unblock","stack is empty"),this.stackTop.blocked=!1,void 0!==e&&(this.stackTop.blockedValues=(this.stackTop.blockedValues||[]).concat(e));this.stack.length&&!this.stackTop.blocked;)this.execute();if(!this.stack.length)for(;this.unblockCallbacks.length>0;){if(this.unblockCallbacks.shift()(),this.stackTop&&this.stackTop.blocked)return}},whenUnblocked:function(e){this.stack.length&&this.stackTop.blocked?this.unblockCallbacks=this.unblockCallbacks.concat(e):e()},blockedValue:function(){var e=this.stackTop;return e||t.impossible("Section.blockedValue","stack is empty"),e.blockedValues&&e.blockedValues.length||t.impossible("Section.blockedValue","blockedValues is missing or empty"),e.blockedValues.shift()}},Object.preventExtensions(m)}),define("engine",["jquery","utils","state","section","passages"],function(e,t,n,r,a){var i,o=t.escape,s=t.impossible,c=t.passageSelector,u=t.transitionOut,l=Object.create(null);function p(e,t){return"<tw-include type="+e+" title='"+o(t.get("name"))+"'>"+t.get("source")+"</tw-include>"}function f(i){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.assertOnlyHas(o,["stretch","transition"]);var f=a.get(i),d=t.storyElement,h=d.parent(),y=o.stretch,m=o.transition,g=(m=void 0===m?{}:m).depart,v=void 0===g?"instant":g,b=m.arrive,w=void 0===b?"dissolve":b,T=m.departOrigin,S=m.arriveOrigin,x=m.time;h.findAndFilter("tw-enchantment").each(function(t,n){var r=(n=e(n)).data("enchantedProperties");r&&d.css(r.reduce(function(e,t){return e[t]="",e},{})),n[0]===h[0]&&(h=d.unwrap().parent())}),a.hasValid(i)||s("Engine.showPassage","There's no passage with the name \""+i+'"!');var k,O,j,A,C=d.children(c).not(".transition-out, .transition-out *"),E=(f.get("tags")||[]).join(" "),_=(k=e("<tw-passage><tw-sidebar>"),O=k.children("tw-sidebar"),j=e('<tw-icon tabindex=0 alt="Undo" title="Undo">&#8630;</tw-icon>'),A=e('<tw-icon tabindex=0 alt="Redo" title="Redo">&#8631;</tw-icon>'),n.pastLength<=0&&j.css("visibility","hidden"),n.futureLength<=0&&A.css("visibility","hidden"),O.append(j,A),k);"function"==typeof T&&(T=T.call(C)),"function"==typeof S&&(S=S.call(_)),d.detach(),_.appendTo(d).attr({tags:E}),!y&&v&&(u(C,v,x,0,0,0,T),C.css("position","absolute")),d.attr({tags:E});var N=r.create(_),P=f.get("source");P=a.getTagged("header").map(p.bind(0,"header")).join("")+(l.debug?a.getTagged("debug-header").map(p.bind(0,"debug-header")).join(""):"")+P+a.getTagged("footer").map(p.bind(0,"footer")).join("")+(l.debug?a.getTagged("debug-footer").map(p.bind(0,"debug-footer")).join(""):""),n.pastLength<=0&&(l.debug&&(P=a.getTagged("debug-startup").map(p.bind(0,"debug-startup")).join("")+P),P=a.getTagged("startup").map(p.bind(0,"startup")).join("")+P),N.renderInto(P,_,{transition:w,transitionTime:x,transitionOrigin:S}),h.append(d.parents().length?d.parents().last():d),scroll(0,y?_.offset().top-.05*e(window).height():d.offset().top)}return i={goBack:function(e){n.rewind()&&f(n.passage,e)},goForward:function(e){n.fastForward()&&f(n.passage,e)},goToPassage:function(e,t){n.play(e),f(e,t)},toggleFullscreen:function(){var e=document.documentElement;document.fullscreenElement?document.exitFullscreen():document.msFullscreenElement?document.msExitFullscreen():(e.msRequestFullscreen||e.requestFullscreen).call(e)},showPassage:f,options:l},Object.freeze(i)}),define("debugmode/panel",["jquery"],function(e){return Object.freeze({create:function(t){var n=t.className,r=t.rowAdd,a=t.rowCheck,i=t.columnHead,o=t.tabName,s=t.tabUpdate,c=e("<div class='panel panel-"+n+"' hidden><table class='panel-rows'></table></div>"),u=e("<button class='tab tab-"+n+"'>0 "+o+"s</button>");return u.click(function(){u.toggleClass("enabled"),u.parent().siblings(".panel").attr("hidden",""),u.is(".enabled")&&(u.siblings(".tab:not(.tab-"+n+")").removeClass("enabled"),c.removeAttr("hidden"))}),s||(s=function(e){return u.text(e+" "+o+(1!==e?"s":""))}),Object.assign(Object.create(this),{tabName:o,tab:u,panel:c,panelRows:c.find(".panel-rows"),rowAdd:r,rowCheck:a,columnHead:i,tabUpdate:s})},update:function(t,n){var r=this.rowCheck,a=this.rowAdd,i=this.panelRows,o=this.columnHead,s=[],c=i.children();t.forEach(function(t){var n=c.filter(function(n,a){return r(t,e(a))}),o=a(t);n.length?n.replaceWith(o):i.append(o),s.push(o[0])}),c.filter(function(e,t){return!s.includes(t)}).remove(),this.tabUpdate(n),n>0&&!i.find(".panel-head").length?i.prepend(o()):0===n&&i.find(".panel-head").remove()}})}),define("debugmode/mode",["jquery","utils","state","internaltypes/varref","internaltypes/twineerror","utils/operationutils","engine","passages","section","debugmode/panel"],function(e,t,n,r,a,i,o,s,c,u){var l=t.escape,p=t.nth,f=t.storyElement,d=t.debounce,h=i.objectName,y=i.isObject,m=i.toSource;return function(t,i){var g=e(document.documentElement),v=e("<tw-debugger>\n\t\t<div class='panel panel-errors' hidden><table></table></div>\n\t\t<div class='tabs'></div>\n\t\t<label style='user-select:none'>Turns: </label><select class='turns' disabled></select><button class='show-invisibles'>Debug View</button><button class='show-dom'>DOM View</button>\n\t\t<div class='resizer'>\n\t\t</tw-debugger>"),b=v.find(".tabs"),w=v.find(".show-dom"),T=v.find(".show-invisibles"),S=v.find(".turns");v.find(".resizer").mousedown(function(e){if(1!==e.which)return!0;e.stopPropagation();var t=e.pageX,n=v.width();g.on("mousemove.debugger-resizer",function(e){var r=e.pageX;v.width((n+t-r|0)+"px")}).on("mouseup.debugger-resizer",function(){g.off(".debugger-resizer")})}),T.click(function(){g.toggleClass("debug-mode").removeClass("dom-debug-mode"),T.toggleClass("enabled"),w.removeClass("enabled")}),w.click(function(){g.toggleClass("dom-debug-mode").removeClass("debug-mode"),w.toggleClass("enabled"),T.removeClass("enabled")}),n.timelinePassageNames().forEach(function(e,t){S.append("<option value="+t+">"+(t+1)+": "+e+"</option>")}),S.val(n.pastLength),n.pastLength>0&&S.removeAttr("disabled"),S.change(function(e){var t=e.target.value-n.pastLength;0!==t&&(n[t<0?"rewind":"fastForward"](Math.abs(t)),o.showPassage(n.passage))}),n.on("forward",function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=n.pastLength;a>=1&&S.removeAttr("disabled"),r?(S.find("[selected]").removeAttr("selected"),S.val(a)):(S.children().each(function(t,n){t>=a&&e(n).remove()}),S.append("<option value="+a+">"+(a+1)+": "+t+"</option>").val(a))}).on("back",function(){n.pastLength<=1&&S.attr("disabled"),S.find("[selected]").removeAttr("selected"),S.val(n.pastLength)}).on("load",function(e){S.empty(),S[e.length<=1?"attr":"removeAttr"]("disabled"),e.forEach(function(e,t){return S.append("<option value="+t+">"+(t+1)+": "+e.passage+"</option>")})});var x=new Set,k=u.create({className:"variables",tabName:"Variable",rowAdd:function(t){var n=t.name,r=t.dataset,a=t.path,i=t.value,o=t.tempScope,s=t.type,c=y(i)&&i.TwineScript_DebugName?i.TwineScript_DebugName():l(h(i)),u="";a.length&&(u=a.reduce(function(e,t){return e+t+"'s "},"")),r&&(n="???");var p=s?m(s):"",f=c.length>48&&!i.TwineScript_DebugName,d="object"===(void 0===i?"undefined":_typeof(i))||f,g=f?c.slice(0,48)+"\u2026":c;return e('<div class="variable-row">').attr("data-name",n).attr("data-path",a+"").attr("data-scope",o||"").css("padding-left",Math.min(5,a.length)+"em").append("<td class='variable-type'>"+(p?p+"-type ":"")+"</td>","<td class='variable-name'>"+(u?"<span class='variable-path'>"+(o?"_":"$")+l(u)+"</span> ":"")+(u?"":o?"_":"$")+l(n+"")+"</td>","<td class='temporary-variable-scope'>"+(o||"")+"</td>","<td class='variable-value'>"+g+"</td><td class='panel-row-buttons'>"+(d?"<tw-folddown tabindex=0>(source:) </tw-folddown>":"")+"</td>").add(d?"<tr class='variable-row panel-row-source' style='display:none'><td colspan='5'>"+l(m(i))+"</td></tr>":"")},rowCheck:function(e,t){var n=e.name,r=e.path;e.tempScope;return t.attr("data-name")===n&&t.attr("data-path")===r+""},columnHead:function(){return'<tr class="panel-head"><th>Type</th><th>Name</th><th>Scope</th><th>Value</th></tr>'}}),O=d(function(){var e=[],t=n.variables,r=e.length;function a(t){if(!(e.length>500)){e.push(t);var n=t.path.concat(t.name),r=t.value,i=t.tempScope;Array.isArray(r)?r.forEach(function(e,t){return a({name:p(t+1),path:n,value:e,tempScope:i})}):r instanceof Map?[].concat(_toConsumableArray(r)).forEach(function(e){var t=_slicedToArray(e,2),r=t[0],o=t[1];return a({name:r,path:n,value:o,tempScope:i})}):r instanceof Set&&[].concat(_toConsumableArray(r)).forEach(function(e,t){return a({name:t,dataset:!0,path:n,value:e,tempScope:i})})}}for(var i in t)i.startsWith("TwineScript")||(r+=1,a({name:i,path:[],value:t[i],tempScope:"",type:t.TwineScript_TypeDefs&&t.TwineScript_TypeDefs[i]}));e.push.apply(e,_toConsumableArray(x)),r+=x.size,k.update(e,r),k.panel[(r?"remove":"add")+"Class"]("panel-variables-empty")}),j=void 0;r.on("set",function(e,t,r){if(e!==n.variables&&e.TwineScript_VariableStoreName&&!e.TwineScript_VariableStoreName.match(/#\d+$/)){var a=e.TwineScript_VariableStoreName,i=e.TwineScript_TypeDefs&&e.TwineScript_TypeDefs[t],o=[].concat(_toConsumableArray(x)).find(function(e){return e.name===t&&e.tempScope===a});o?o.value=r:x.add({name:t,path:[],value:r,tempScope:a,type:i})}O(),j()}).on("delete",function(){O(),j()}),k.panel.append("<div class='panel-variables-bottom'>\n\t\t\t<button class='panel-variables-copy'>Copy $ variables as (set:) call</button>\n\t\t\t<input class='clipboard' type=\"text\" style='opacity:0;pointer-events:none;position:absolute;'></input>\n\t\t</div>").removeAttr("hidden"),k.tab.addClass("enabled");var A=k.panel.find(".clipboard");g.on("click",".panel-variables-copy",function(){var e=[];for(var t in n.variables)t.startsWith("TwineScript")||e.push("$"+t+" to "+m(n.variables[t]));A.val("(set:"+e+")")[0].select(),document.execCommand("copy")});var C=u.create({className:"enchantments",tabName:"Enchantment",rowAdd:function(t){var n=t.scope,r=t.changer,a=t.name,i=t.localHook,o=void 0;return o=r?l(h(r)):"<em>enchanted via ("+a+":)</em>",e('<div class="enchantment-row">').data("enchantment",t).append("<td><span class='enchantment-name'>"+m(n)+(i?"</span><span class=enchantment-local>"+("function"==typeof i.TwineScript_ToSource?i.TwineScript_ToSource():i.attr("name")?"?"+i.attr("name"):"an unnamed hook"):"")+"</span></td><td class='enchantment-value'>"+o+"</td>"+(r?"<td class='panel-row-buttons'><tw-folddown tabindex=0>(source:)</tw-folddown></td>":"")).add(r?"<tr class='panel-row-source' style='display:none'><td colspan='3'>"+l(m(r))+"</td></tr>":"")},rowCheck:function(e,t){return t.data("enchantment")===e},columnHead:function(){return'<tr class="panel-head"><th>Scope</th><th>Value</th></div>'}}),E=d(function(e){C.update(e.enchantments,e.enchantments.length)});c.on("add",E).on("remove",E);var _=c.create(f),N=u.create({className:"storylets",tabName:"Storylet",rowAdd:function(t){var n=t.name,r=t.active,a=t.storyletSource,i=t.exclusive,o=t.urgent;return e('<tr class="storylet-row '+(r?"":"storylet-closed")+'">').attr("data-name",n).append("<td class='storylet-name'>"+n+"</td><td class='storylet-lambda'>"+a+"</td><td class='storylet-exclusive'>"+i+"</td><td class='storylet-urgent'>"+o+"</td>")},rowCheck:function(e,t){var n=e.name;return t.attr("data-name")===l(n+"")},columnHead:function(){return"<tr class=\"panel-head\"><th>Name</th><th>Condition</th><th class='storylet-exclusive'>Exclusivity</th><th class='storylet-urgent'>Urgency</th></tr>"}});N.tab.hide(),j=d(function(){var e=s.getStorylets(_),t=a.containsError(e),n=s.allStorylets();N.update(n.map(function(n){return{name:n.get("name"),storyletSource:n.get("storylet").TwineScript_ToSource(),active:!t&&e.some(function(e){return e.get("name")===n.get("name")}),exclusive:"number"==typeof n.get("exclusivity")?n.get("exclusivity"):0,urgent:"number"==typeof n.get("urgency")?n.get("urgency"):0}}),t?0:e.length),N.panel[(t?"add":"remove")+"Class"]("storylet-error");var r=n.some(function(e){return e.get("exclusivity")&&"number"==typeof e.get("exclusivity")}),i=n.some(function(e){return e.get("urgency")&&"number"==typeof e.get("urgency")});N.panel[(r?"add":"remove")+"Class"]("panel-exclusive"),N.panel[(i?"add":"remove")+"Class"]("panel-urgent"),n.length&&N.tab.show()});var P=u.create({className:"source",tabName:"Source",rowAdd:e.noop,rowCheck:e.noop,tabUpdate:e.noop,columnHead:e.noop});P.tab.text("Source");var I=u.create({className:"errors",tabName:"Error",rowAdd:e.noop,rowCheck:e.noop,columnHead:e.noop}),M=function(t,r){if("propagated"!==t.type){I.panelRows.children().length>500&&I.panelRows.children(":first-child").remove();var a=e('<tr class="error-row"><td class="error-passage">'+n.passage+'</td><td class="error-message">'+t.message+"</td></tr>");a.find(".error-message").attr("title",r),I.panelRows.append(a),I.tabUpdate(I.panelRows.children().length)}};function D(){if(x=new Set,O(),j(),C.panelRows.empty(),C.tabUpdate(0),n.passage){var e=s.get(n.passage);e&&P.panelRows.text(e.get("source"))}}a.on("error",M),v.prepend(k.panel,C.panel,I.panel,N.panel,P.panel),b.prepend(k.tab,C.tab,I.tab,N.tab,P.tab),n.on("forward",D).on("back",D).on("load",D),t&&(M(t,i),D()),e(document.body).append(v)}}),define("macrolib/values",["macros","utils","utils/operationutils","datatypes/colour","datatypes/gradient","datatypes/datatype","datatypes/hookset","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s){var c=t.realWhitespace,u=t.nth,l=t.anyRealLetter,p=n.subset,f=n.objectName,d=n.clone,h=n.toSource,y=e.TypeSignature,m=y.rest,g=y.zeroOrMore,v=y.either,b=y.optional,w=y.insensitiveSet,T=y.numberRange,S=y.percent,x=y.nonNegativeInteger,k=y.positiveInteger,O=y.Any,j=Math.max,A=Math.min,C=Math.round,E=Math.floor,_=Math.ceil;function N(e){return function(){var t=e.apply(void 0,arguments);return"number"!=typeof t||isNaN(t)?s.create("macrocall","This mathematical expression doesn't compute!"):t}}e.add(["str","string","text"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.join("")},[g(e.TypeSignature.either(String,Number,Boolean,Array))])("source",function(e,t){return t&&"command"===t.TwineScript_TypeID&&!t.TwineScript_ToSource?s.create("datatype","I can't construct the source code of a command created by a custom macro."):h(t)},[O])("substring",function(e,t,n,r){return p(t,n,r)},[String,parseInt,parseInt])("lowercase",function(e,t){return t.toLowerCase()},[String])("uppercase",function(e,t){return t.toUpperCase()},[String])("lowerfirst",function(e,t){return t.replace(RegExp(l+"+"),function(e){return(e=Array.from(e))[0].toLowerCase()+e.slice(1).join("").toLowerCase()})},[String])("upperfirst",function(e,t){return t.replace(RegExp(l+"+"),function(e){return(e=Array.from(e))[0].toUpperCase()+e.slice(1).join("").toLowerCase()})},[String])("words",function(e,t){return t.split(RegExp(c+"+")).filter(Boolean)},[String])(["str-repeated","string-repeated"],function(e,t,n){return 0===n.length?s.create("macrocall","I can't repeat an empty string."):n.repeat(t)},[x,String])(["str-reversed","string-reversed"],function(e,t){return[].concat(_toConsumableArray(t)).reverse().join("")},[String])("joined",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return r.join(t)},[m(String)])("plural",function(e,t,n,r){return n&&""!==r?t+" "+(1!==Math.abs(t)?r||n+"s":n):s.create("macrocall","The (plural:) macro can't be given empty strings.")},[parseInt,String,b(String)])(["str-nth","string-nth"],function(e,t){return u(t)},[parseInt])(["num","number"],function(e,t){return Number.isNaN(+t)?s.create("macrocall","I couldn't convert "+f(t)+" to a number."):+t},[String])("datatype",function(e,t){return i.from(t)},[O])("datapattern",function(e,t){return function e(t){var n,r=void 0;return Array.isArray(t)?r=t.map(e):t instanceof Map?(r=new Map,[].concat(_toConsumableArray(t)).forEach(function(t){var n=_slicedToArray(t,2),a=n[0],i=n[1];return r.set(a,e(i))})):r=i.from(t),(n=s.containsError(r))?n:r}(t)},[O])(["rgb","rgba"],function(e){return r.create({r:arguments.length<=1?void 0:arguments[1],g:arguments.length<=2?void 0:arguments[2],b:arguments.length<=3?void 0:arguments[3],a:arguments.length<=4?void 0:arguments[4]})},[T(0,255),T(0,255),T(0,255),b(S)])(["hsl","hsla"],function(e,t,n,a,i){return(t=C(t)%360)<0&&(t+=360),r.create({h:t,s:n,l:a,a:i})},[Number,S,S,b(S)])(["lch","lcha"],function(e,t,n,a,i){return(a=C(a)%360)<0&&(a+=360),r.create({l:t,c:n,h:a,a:i})},[S,T(0,132),Number,b(S)])("complement",function(e,t){return t.LCHRotate(180)},[r])("palette",function(e,t,n){var a=n.toLCHA(),i=a.l,o={l:i<=.75?.75+i/3:.75-3*(1-i),c:80,h:a.h,a:1},s=void 0,c=void 0,u=void 0;return s=r.create(o),o.l+=i<=.75?-.1:.1,o.l<.5&&(o.l*=.5/o.l),c=r.create(o),o.l+=i<=.85?.15:-.15,u=r.create(o),"adjacent"===t?(c=(s=s.LCHRotate(-30)).LCHRotate(30),u=s.LCHRotate(60)):"triad"===t&&(u=s.LCHRotate(180),c=s.LCHRotate(140),s=s.LCHRotate(-140)),[n,s,c,u]},[w("mono","adjacent","triad"),r])("gradient",function(e,t){for(var n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];if((t=C(t)%360)<0&&(t+=360),i.length<4)return s.create("datatype","(gradient:) must be given at least 2 colour-stop pairs of numbers and colours.");var c=void 0,u=[],l=i.reduce(function(e,t){if(s.containsError(e))return e;if(void 0===c)c=t;else{if("number"!=typeof c||!r.isPrototypeOf(t))return s.create("datatype","(gradient:) colour-stops should be pairs of numbers and colours, not colours and numbers.");u.push({stop:c,colour:d(t)}),c=void 0}return e},!0);return s.containsError(l)?l:void 0!==c?s.create("macrocall","This gradient has a colour-stop percent without a colour."):a.create(t,u)},[Number,m(v(S,r))])("stripes",function(e,t,n){for(var r=arguments.length,i=Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];(t=C(t)%360)<0&&(t+=360);var s=0,c=[];return i.forEach(function(e){c.push({stop:s,colour:d(e)}),s+=n,c.push({stop:s,colour:d(e)})}),a.create(t,c,!0)},[Number,k,r,m(r)])("hooks-named",function(e,t){return t?o.create({type:"name",data:t}):s.create("datatype","(hooks-named:) can't be given an empty string.")},[String])("cond",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=2){var n=arguments.length<=t+1?void 0:arguments[t+1];if(t===(arguments.length<=1?0:arguments.length-1)-1||s.containsError(n))return n;if("boolean"!=typeof n)return s.create("datatype","(cond:)'s "+u(t+1)+" value is "+f(n)+", but should be a boolean.");if(n)return arguments.length<=t+1+1?void 0:arguments[t+1+1]}return s.create("macrocall","An odd number of values must be given to (cond:), not "+(arguments.length<=1?0:arguments.length-1),"(cond:) must be given one or more pairs of booleans and values, as well as one final value.")},[Boolean,O,m(O)]),{weekday:[function(){return["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur"][(new Date).getDay()]+"day"},null],monthday:[function(){return(new Date).getDate()},null],currenttime:[function(){var e=new Date,t=e.getHours()<12;return(e.getHours()%12||12)+":"+((e.getMinutes()<10?"0":"")+e.getMinutes())+" "+(t?"A":"P")+"M"},null],currentdate:[function(){return(new Date).toDateString()},null],min:[A,m(Number)],max:[j,m(Number)],abs:[Math.abs,Number],sign:[Math.sign,Number],sin:[Math.sin,Number],cos:[Math.cos,Number],tan:[Math.tan,Number],floor:[E,Number],round:[C,Number],trunc:[function(e){return e>0?E(e):_(e)},Number],ceil:[_,Number],pow:[N(Math.pow),[Number,Number]],exp:[Math.exp,Number],sqrt:[N(Math.sqrt),Number],log:[N(Math.log),Number],log10:[N(Math.log10),Number],log2:[N(Math.log2),Number],random:[function(e,t){var n=void 0,r=void 0;return t?(n=A(e,t),r=j(e,t)):(n=0,r=e),r+=1,~~(Math.random()*(r-n))+n},[parseInt,e.TypeSignature.optional(parseInt)]],either:[function(){var e;return e=~~(Math.random()*arguments.length),arguments.length<=e?void 0:arguments[e]},m(O)],nth:[function(e){var t;return e<=0?s.create("datatype","(nth:)'s first value should be a positive whole number, not "+e):(t=(e-1)%(arguments.length<=1?0:arguments.length-1)+1,arguments.length<=t?void 0:arguments[t])},[parseInt,m(O)]],"":function(){var t=this;Object.keys(this).forEach(function(n){if(n){var r=t[n][0],a=t[n][1];e.add(n,function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return r.apply(void 0,n)},a)}})}}[""]()}),define("macrolib/commands",["jquery","macros","utils","state","passages","renderer","engine","internaltypes/twineerror","internaltypes/twinenotifier","datatypes/assignmentrequest","datatypes/hookset","datatypes/codehook","datatypes/lambda","datatypes/colour","datatypes/gradient","internaltypes/varref","datatypes/typedvar","datatypes/varbind","utils/operationutils","utils/renderutils"],function(e,t,n,r,a,i,o,s,c,u,l,p,f,d,h,y,m,g,v,b){var w=v.printBuiltinValue,T=v.objectName,S=v.clone,x=v.toSource,k=b.dialog,O=b.geomParse,j=b.geomStringRegExp,A=t.TypeSignature,C=A.Any,E=A.Everything,_=A.rest,N=A.either,P=A.optional,I=A.zeroOrMore,M=A.positiveInteger,D=A.positiveNumber,R=Object.assign,L=Math.floor,q=Math.ceil,F=Math.abs,V=Math.max,H=Math.min,z=e.noop;function $(e){return"("+e+" "+o.options.ifid+") "}["set","put","unpack"].forEach(function(e){return t.add(e,function(t){for(var n=0;n<(arguments.length<=1?0:arguments.length-1);n+=1){var r=arguments.length<=n+1?void 0:arguments[n+1];if("into"===r.operator&&"set"===e)return s.create("macrocall","Please say 'to' when using the (set:) macro.");if("to"===r.operator&&"set"!==e)return s.create("macrocall","Please say 'into' when using the (put:) or (unpack:) macro.");if((y.isPrototypeOf(r.dest)||m.isPrototypeOf(r.dest))===("unpack"===e))return s.create("macrocall","unpack"===e?"Please use the (unpack:) macro with arrays, datamaps or (p:) patterns containing variables to the right of 'into'.":"Please use the ("+e+":) macro with just single variables and typed variables to the "+("set"===e?"left of 'to'.":"right of 'into'."));var a=r.set();if(s.containsError(a))return a}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a ("+e+":) operation",TwineScript_ObjectName:"a ("+e+":) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return o.options.debug,""}}},[_(u)])}),t.add("move",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=arguments.length<=t+1?void 0:arguments[t+1];if("into"!==n.operator)return s.create("macrocall","Please say 'into' when using the (move:) macro.");var r=n.set(!0);if(s.containsError(r))return r}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a (move:) operation",TwineScript_ObjectName:"a (move:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return o.options.debug,""}}},[_(u)]),t.addCommand("display",function(e){if(!a.hasValid(e))return s.create("macrocall","I can't (display:) the passage '"+e+"' because it doesn't exist.")},function(e,t,r){return R(e,{source:n.unescape(a.get(r).get("source"))})},[String])("print",z,function(e,t,n){return R(e,{source:w(n)})},[C])(["verbatim-print","v6m-print"],z,function(e,t,n){return R(e,{verbatim:!0,source:w(n)})},[C])(["verbatim-source","v6m-source"],function(e){if(e&&"command"===e.TwineScript_TypeID&&!e.TwineScript_ToSource)return s.create("datatype","I can't construct the source code of a command created by a custom macro.")},function(e,t,n){return R(e,{verbatim:!0,source:w(x(n))})},[C])("go-to",function(e){if(!a.hasValid(e))return s.create("macrocall","I can't (go-to:) the passage '"+e+"' because it doesn't exist.")},function(e,t,n){return requestAnimationFrame(function(){return o.goToPassage(n,{transition:e.data.passageT8n})}),"blocked"},[String])("undo",z,function(e){return r.pastLength<1?s.create("macrocall","I can't (undo:) on the first turn."):(requestAnimationFrame(function(){return o.goBack({transition:e.data.passageT8n})}),"blocked")},[]),n.onStartup(function(){return e(n.storyElement).on("click.icon","tw-icon",function(t){var n=e(this),a=n.data("clickEvent"),i=n.attr("alt");a&&a(n),"Undo"===i&&(t.stopPropagation(),o.goBack()),"Redo"===i&&(t.stopPropagation(),o.goForward()),"Fullscreen"===i&&(t.stopPropagation(),o.toggleFullscreen()),"Restart"===i&&(r.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload())})}),[["Undo","&#8630;",function(){return r.pastLength>0}],["Redo","&#8631;",function(){return r.futureLength>0}],["Fullscreen","&#9974;",function(){return document.fullscreenEnabled||document.msFullscreenEnabled}],["Restart","&#10226;",Object]].forEach(function(e){var n=_slicedToArray(e,3),r=n[0],a=n[1],i=n[2];t.addCommand("icon-"+r.toLowerCase(),function(e,t){if("string"==typeof e&&"string"==typeof t){var n=[].concat(_toConsumableArray(e)).length,a=[].concat(_toConsumableArray(t)).length;if(n>1&&a>1)return s.create("datatype","One of the two strings given to (icon-"+r.toLowerCase()+":) should be 1 character long, for its icon.");if(1===n&&1===a)return s.create("datatype","One of the two strings given to (icon-"+r.toLowerCase()+":) should be 2 or more characters long, for its label.")}},function(e,t,n,o){if("string"==typeof o&&1===[].concat(_toConsumableArray(o)).length||"string"==typeof n&&[].concat(_toConsumableArray(n)).length>1){var s=[o,n];n=s[0],o=s[1]}return R(e,{source:'<tw-icon tabindex=0 alt="'+r+'" '+(o?'data-label="'+o.replace('"',"&quot;")+'"':"")+' title="'+r+'" '+(i()?"":'style="visibility:hidden"')+">"+(n||a)+"</tw-icon>"})},[P(String),P(String)])}),t.addCommand("icon-counter",function(e,t,n){var r=" label string given to (icon-counter:) can't be empty or only whitespace.";return t&&t.trim()?"string"!=typeof n||n.trim()?void 0:s.create("datatype","The 2nd "+r):s.create("datatype","The 1st "+r)},function(e,t,r,a,i){e.attr.push({"data-2bind":!0}),e.data.twoWayBindEvent=function(t,n,o){if(r.varRef.matches(n,o)){var s=r.varRef.get();if("number"==typeof s)e.target.children("tw-icon").text(s>0?L(s):q(s)).attr("data-label",1!==F(s)&&void 0!==i?i:a)}};var o=r.varRef.get();return"number"!=typeof o?s.create("datatype","(icon-counter:) can only be bound to a variable holding a number, not "+T(o)+"."):R(e,{source:'<tw-icon data-label="'+n.escape(1!==F(o)&&void 0!==i?i:a)+'">'+(o>0?L(o):q(o))+"</tw-icon>"})},[g,String,P(String)]),t.addCommand("meter",function(e,t,n,r){return"string"!=typeof r||r.trim()?-1===n.search(j)||!n.includes("=")&&n.length>1?s.create("datatype",'The (meter:) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not '+JSON.stringify(n)+"."):void 0:s.create("datatype","The label string given to (meter:) can't be empty or only whitespace.")},function(e,t,n,r,a,i,o){i&&"string"!=typeof i&&(o=i,i=void 0),o||(o=d.create({h:0,s:0,l:.5,a:.5})),d.isPrototypeOf(o)&&(o=h.create(90,[{colour:o,stop:0},{colour:o,stop:1}]));var c=O(a),u=c.marginLeft,l=c.size,p=u>0&&Math.ceil(u+l)<100,f=function(e){var t=V(0,H(1,e/r)),n=o.repeating?o:o.multiply(r/e);return"height:100%;background-repeat:no-repeat;background-image:"+(p?R(n,n.repeating?{}:{angle:270}).toLinearGradientString()+", ":"")+R(n,n.repeating?{}:{angle:p||0===u?90:270}).toLinearGradientString()+";background-size:"+(p?Array(2).fill(50*t+"%"):100*t+"%")+";background-position-x:"+(p?-100/(2-t)+100+"%,"+100/(2-t)+"%":0===u?"left":"right")+";text-align:"+(p?"center":0===u?"left":"right")};e.styles.push({"margin-left":u+"%",width:l+"%",height:"1.5em",display:"block"}),e.attr.push({"data-2bind":!0});var y=i&&t.stackTop.tempVariables;e.data.twoWayBindEvent=function(t,r,a){if(n.varRef.matches(r,a)){var o=n.varRef.get();if("number"==typeof o){var s=e.target.children("tw-meter");s.attr("style",f(o)),i&&e.section.renderInto("",null,{source:i,target:s,append:"replace",transitionDeferred:!1},y)}}};var m=n.varRef.get();return"number"!=typeof m?s.create("datatype","(meter:) can only be bound to a variable holding a number, not "+T(m)+"."):R(e,{source:'<tw-meter style="'+f(m)+'">'+(i||"")+"</tw-meter>"})},[g,D,String,P(N(String,d,h)),P(N(d,h))]),[["cycling-link"],["seq-link","sequence-link"]].forEach(function(e,n){return t.addCommand(e,function(){return""===(arguments.length<=0?void 0:arguments[0])?s.create("datatype","The first string in a ("+e[0]+":) can't be empty."):arguments.length<=(g.isPrototypeOf(arguments.length<=0?void 0:arguments[0])?2:1)?s.create("datatype","I need two or more strings to "+(n?"sequence":"cycle")+" through, not just '"+(t=arguments.length-1,arguments.length<=t?void 0:arguments[t])+"'."):void 0;var t},function(e,t){for(var r=arguments.length,a=Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];var o=void 0;g.isPrototypeOf(a[0])&&(o=a.shift());var c=0;if(o&&"two way"===o.bind){e.attr.push({"data-2bind":!0});var u=a.indexOf(o.varRef.get());u>-1&&(c=u)}var l=t.stackTop.tempVariables;function p(t,r){var i=c>=a.length-1&&n,u=""===a[c]?"":i?a[c]:"<tw-link>"+a[c]+"</tw-link>";if(i&&(e.data.clickEvent=void 0),o&&!r){var p=o.set(a[c]);if(s.containsError(p))return void t.replaceWith(p.render(a[c]))}var f=R({},e,{source:u,transitionDeferred:!1});e.section.renderInto("",null,f,l)}a[c]&&(e.data.clickEvent=function(e){c=(c+1)%a.length,p(e,!1)})&&(e.data.twoWayBindEvent=function(e,t,n){if(o.varRef.matches(t,n)){var r=o.varRef.get(),i=a.indexOf(r);i>-1&&i!==c&&(c=i,p(e,!0))}});var f="<tw-link>"+a[c]+"</tw-link>";if(o){var d=o.set(a[c]);if(s.containsError(d))return d}return R(e,{source:f,append:"replace",transitionDeferred:!0})},[N(g,String),_(String)])}),n.onStartup(function(){return e(n.storyElement).on("change.dropdown-macro","select",function(){var t=e(this),n=t.closest("tw-expression, tw-hook").data("dropdownEvent");n&&n(t)})}),t.addCommand("dropdown",function(e){var t;return""===(arguments.length<=1?void 0:arguments[1])||""===(t=(arguments.length<=1?0:arguments.length-1)-1+1,arguments.length<=t?void 0:arguments[t])?s.create("datatype","The first or last strings in a (dropdown:) can't be empty.","Because empty strings create separators within (dropdown:)s, having them at the start or end doesn't make sense."):(arguments.length<=1?0:arguments.length-1)<=1?s.create("datatype","I need two or more strings to create a (dropdown:) menu, not just "+(arguments.length<=1?0:arguments.length-1)+"."):void 0},function(t,r,a){for(var i=arguments.length,o=Array(i>3?i-3:0),c=3;c<i;c++)o[c-3]=arguments[c];var u=0;if("two way"===a.bind){t.attr.push({"data-2bind":!0});var l=o.indexOf(a.varRef.get());l>-1&&(u=l)}var p=Math.max.apply(Math,_toConsumableArray(o.map(function(e){return[].concat(_toConsumableArray(e)).length}))),f="<select>"+o.map(function(e,t){return"<option"+(t===u?" selected":"")+(""===e?" disabled":"")+">"+n.escape(e||"\u2500".repeat(p))+"</option>"}).join("\n")+"</select>";t.data.dropdownEvent=function(e){var t=e.val(),n=a.set(t);s.containsError(n)&&e.replaceWith(n.render(t))},t.data.twoWayBindEvent=function(e,t,n){if(a.varRef.matches(t,n)){var r=a.varRef.get(),i=o.indexOf(r);i>-1&&i!==u&&(e.find("select").val(r),u=i)}},t.styles.push({"background-color":function(){return n.parentColours(e(this)).backgroundColour}});var d=a.set(o[u]);return s.containsError(d)?d:R(t,{source:f,append:"replace"})},[g,String,_(String)]),n.onStartup(function(){return e(n.storyElement).on("input.checkbox-macro","input[type=checkbox]",function(){var t=e(this),n=t.closest("tw-expression").data("checkboxEvent");n&&n(t)})});var B=1;t.addCommand("checkbox",function(){},function(e,t,n,r){var a=!1,i="checkbox-"+ ++B;if("two way"===n.bind){e.attr.push({"data-2bind":!0});var o=n.varRef.get();"boolean"==typeof o&&(a=o),e.data.twoWayBindEvent=function(e,t,r){if(n.varRef.matches(t,r)){var a=n.varRef.get();"boolean"==typeof a&&e.children("input[type=checkbox]").prop("checked",a)}}}return e.data.checkboxEvent=function(e){var t=e.is(":checked"),r=n.set(t);s.containsError(r)&&e.replaceWith(r.render(""))},R(e,{source:'<input id="'+i+'" type="checkbox" '+(a?"checked":"")+'><label for="'+i+'">'+r+"</label>",append:"replace"})},[g,String]),n.onStartup(function(){return e(document).on("fullscreenchange",function(){e("input[type=checkbox][id^=fullscreen]",n.storyElement).each(function(t,n){(e(n).closest("tw-expression").data("fullscreenEvent")||Object)(n)})})}),t.addCommand("checkbox-fullscreen",function(){},function(t,n,r){var a="fullscreenCheckbox-"+ ++B;return t.data.fullscreenEvent=function(t){return e(t).prop("checked",!(!document.fullscreenElement&&!document.msFullscreenElement))},t.data.checkboxEvent=function(){return o.toggleFullscreen()},R(t,{source:'<input id="'+a+'" type="checkbox" '+(document.fullscreenEnabled||document.msFullscreenEnabled?" ":"disabled ")+(document.fullscreenElement||document.msFullscreenElement?"checked":"")+'><label for="'+a+'">'+r+"</label>",append:"replace"})},[String]),n.onStartup(function(){return e(n.storyElement).on("input.input-box-macro","textarea",function(){var t=e(this),n=t.closest("tw-expression").data("inputBoxEvent");n&&n(t)})}),["input-box","force-input-box"].forEach(function(e){return t.addCommand(e,function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=g.isPrototypeOf(n[0]),i="number"==typeof n[1+a],o="string"==typeof n[1+a+i],c=n[+a];if("string"!=typeof c||-1===c.search(j)||!c.includes("=")&&c.length>1)return s.create("datatype","The ("+e+':) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not '+JSON.stringify(c)+".");if("force-input-box"===e&&!o)return s.create("datatype","The ("+e+":) macro requires a string of text to forcibly input.");var u=1+a+i+o;return n.length>u?s.create("datatype","An incorrect combination of values was given to this ("+e+":) macro."):void 0},function(t,r){for(var a=arguments.length,i=Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];var c="force-input-box"===e,u=g.isPrototypeOf(i[0]),l="number"==typeof i[1+u],p=u&&i[0],f=l?i[1+u]:3,d=O(i[+u]),h=d.marginLeft,y=d.size,m="string"==typeof i[1+u+l]?i[1+u+l]:"",v=c?"":m;if("two way"===p.bind){t.attr.push({"data-2bind":!0});var b=p.varRef.get();if("string"==typeof b){v=c?m.slice(0,b.length):b;var w=p.set(v);if(s.containsError(w))return w}t.data.twoWayBindEvent=function(e,t,n){if(p.varRef.matches(t,n)){var r=p.varRef.get();"string"==typeof r&&e.find("textarea").val(c?m.slice(0,r.length):r)}}}else if(p){var T=p.set(c?"":m);if(s.containsError(T))return T}!c&&p&&(t.data.inputBoxEvent=function(e){var t=e.val(),n=p.set(t);s.containsError(n)&&e.replaceWith(n.render(""))});var S='<textarea style="width:100%" rows='+f+">"+n.escape(v)+"</textarea>";if(c){var x=Array.from(m);t.data.inputBoxEvent=function(e){var t=e.val().length,n=x.slice(0,t).join("");if(e.val(n),p){var r=p.set(n);s.containsError(r)&&e.replaceWith(r.render(""))}return!0}}return t.styles.push({display:"block","margin-left":h+"%",width:y+"%","border-style":function(){return this.style.borderStyle||"solid"}}),R(t,{source:S,append:"replace"})},[N(g,String),P(N(M,String)),P(N(M,String)),P(String)])}),["show","rerun"].forEach(function(n){return t.addCommand(n,z,function(t,r){for(var a=arguments.length,i=Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return i.forEach(function(a){return a.forEach(r,function(a){var i=a.data("hidden");if(void 0!==i!=("rerun"===n))if(a.removeData("hidden"),i instanceof e)a.empty().append(i);else{var o=a.data("tempVariables");r.renderInto("",null,R({},t,{append:"replace",source:a.data("originalSource")||"",target:a}),o&&Object.create(o))}})}),t},[_(l)])});var W=function(e){return["I can't use a dialog macro in "+e+".","Please rewrite this without putting such macros here."]};t.addCommand("hide",z,function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach(function(t){return t.forEach(e,function(e){Boolean(e.data("hidden"))||e.data("hidden",e.contents().detach())})})},[_(l)],!1)("stop",z,z,[],!1)("load-game",z,function(e,t){var n=localStorage.getItem($("Saved Game")+t);if(!n)return s.create("saving","I can't find a save slot named '"+t+"'!");var a=r.deserialise(e,n);if(a instanceof Error){var i=k({message:"Sorry to interrupt... The story tried to load saved data, but there was a problem.\n"+a.message+"\n\nThat data might have been saved from a different version of this story. Should I delete it?\n(Type 'delete' and choose Yes to delete it.)\n\nEither way, the story will now continue without loading the data.",defaultValue:"",buttons:[{name:"Yes",confirm:!0,callback:function(){"delete"===i.find("input").last().val()&&localStorage.removeItem($("Saved Game")+t),e.unblock("")}},{name:"No",cancel:!0,callback:function(){return e.unblock()}}]});return"blocked"}requestAnimationFrame(o.showPassage.bind(o,r.passage,!1))},[String],!1)("mock-visits",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!o.options.debug)return s.create("operation","(mock-visits:) cannot be used outside of debug mode.","This macro is not meant to be used outside of debugging your story.");var r=t.find(function(e){return!a.hasValid(e)});return r?s.create("datatype","I can't mock-visit '"+r+"' because no passage with that name exists."):void 0},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];r.mockVisits=S(n)},[_(String)],!1)(["dialog","alert"],function(e,t){for(var r=arguments.length,a=Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];if(g.isPrototypeOf(e)){if("two way"===e.bind)return s.create("datatype","(dialog:) shouldn't be given two-way bound variables.");if(void 0===t)return s.create("datatype","(dialog:) needs a message string to display.")}else void 0!==t&&a.unshift(t);var o=a.findIndex(function(e){return""===e});if(o>-1)return s.create("datatype","(dialog:)'s "+n.nth(o+1)+" link text shouldn't be an empty string.")},function(e,t,n,r){for(var a=arguments.length,i=Array(a>4?a-4:0),o=4;o<a;o++)i[o-4]=arguments[o];return g.isPrototypeOf(n)||(void 0!==r&&i.unshift(r),r=n,n=void 0),i.length||(i=["OK"]),k({section:t,message:r,cd:e,buttons:i.map(function(e){return{name:e,callback:function(){t.unblock(n&&n.set(e)||"")}}})}),"blocked"},[N(g,String),I(String)])("open-url",z,function(e,t){window.open(t,"")},[String],!1)(["restart","reload"],z,function(){if(r.pastLength<1)return s.create("infinite","I mustn't (restart:) the story in the starting passage.");r.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload()},[],!1)("goto-url",z,function(e,t){window.location.assign(t)},[String],!1)("ignore",z,z,[I(E)])("assert-exists",function(e){if(""===e)return s.create("datatype","(assert-exists:) mustn't be given an empty string.")},function(e,t,n){var r=0;return("string"==typeof n?l.create({type:"string",data:n}):n).forEach(t,function(){++r}),r?e:s.create("assertion","I didn't see any "+("string"==typeof n?"text occurrences of":"hooks matching")+" "+x(n)+" in this passage.")},[N(l,String)]),t.add("assert",function(e,t){return t?{TwineScript_TypeID:"instant",TwineScript_TypeName:"an (assert:) operation",TwineScript_ObjectName:"an (assert:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}:R(s.create("assertion","An assertion failed: "),{appendTitleText:!0})},[Boolean])("save-game",function(e,t,n){if(n=n||"",!r.hasStorage)return!1;var a=r.serialise();if(s.containsError(a))return a;if(!1===a)return!1;try{return localStorage.setItem($("Saved Game")+t,a),localStorage.setItem($("Saved Game Filename")+t,n),!0}catch(e){return!1}},[String,P(String)])("prompt",function(e,t,n,r,a){if(e.stackTop&&e.stackTop.evaluateOnly)return s.create.apply(s,["macrocall"].concat(_toConsumableArray(W(e.stackTop.evaluateOnly))));if(""===a)return s.create("datatype","The text for (prompt:)'s confirm link can't be blank.");var i=k({section:e,message:t,defaultValue:n,buttons:[{name:a||"OK",confirm:!0,callback:function(){return e.unblock(i.find("input").last().val())}}].concat(""===r?[]:{name:r||"Cancel",cancel:!0,callback:function(){return e.unblock(n)}})});setTimeout(function(){return i.find("input").last().focus()},100)},[String,String,P(String),P(String)])("confirm",function(e,t,n,r){return e.stackTop&&e.stackTop.evaluateOnly?s.create.apply(s,["macrocall"].concat(_toConsumableArray(W(e.stackTop.evaluateOnly)))):""===r?s.create("datatype","The text for (confirm:)'s confirm link can't be blank."):void k({section:e,message:t,defaultValue:!1,buttons:[{name:r||"OK",confirm:!0,callback:function(){return e.unblock(!0)}}].concat(""===n?[]:{name:n||"Cancel",cancel:!0,callback:function(){return e.unblock(!1)}})})},[String,P(String),P(String)])("page-url",function(){return window.location.href},[]),i.options.blockerMacros.push("prompt","confirm")}),define("macrolib/datastructures",["jquery","utils","utils/naturalsort","macros","utils/operationutils","state","engine","passages","datatypes/lambda","datatypes/datatype","datatypes/typedvar","internaltypes/varref","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c,u,l,p,f){var d=t.shuffled,h=t.permutations,y=a.objectName,m=a.subset,g=a.collectionType,v=a.isValidDatamapName,b=a.is,w=a.unique,T=a.clone,S=a.range,x=r.TypeSignature,k=x.optional,O=x.rest,j=x.either,A=x.zeroOrMore,C=x.Any,E=x.nonNegativeInteger;r.add(["a","array"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n},A(j(l,C)))("range",function(e,t,n){return S(t,n)},[parseInt,parseInt])("subarray",function(e,t,n,r){return m(t,n,r)},[Array,parseInt,parseInt])("reversed",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reverse().map(T)},A(C))("shuffled",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return d.apply(void 0,n).map(T)},[C,O(C)])("sorted",function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return r.sort(n("en"))},[j(Number,String),O(j(Number,String))])("rotated",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return 0===(t*=-1)?f.create("macrocall","I can't rotate these values by 0 positions."):Math.abs(t)>=r.length?f.create("macrocall","I can't rotate these "+r.length+" values by "+t+" positions."):r.slice(t).concat(r.slice(0,t)).map(T)},[parseInt,C,O(C)])("rotated-to",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i=t.filter(e,r);if(f.containsError(i))return i;if(!i.length)return f.create("macrocall","None of these "+r.length+" values matched the lambda, so I can't rotate them.");var o=r.indexOf(i[0]);return r.slice(o).concat(r.slice(0,o)).map(T)},[c.TypeSignature("where"),C,O(C)])("repeated",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];for(var i=[];t-- >0;)i.push.apply(i,r);return i.map(T)},[E,O(C)])("interlaced",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=Math.min.apply(Math,_toConsumableArray(n.map(function(e){return e.length}))),i=[],o=0;o<a;o+=1)for(var s=0;s<n.length;s+=1)i.push(T(n[s][o]));return i},[Array,O(Array)])("permutations",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.length?h.apply(void 0,n):[]},[A(C)]),r.add("altered",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return r.map(function(n,r){return t.apply(e,{loop:n,pos:r+1})})},[c.TypeSignature("via"),A(C)])("find",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return t.filter(e,r)},[c.TypeSignature("where"),A(C)])(["all-pass","pass"],function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i=t.filter(e,r);return f.containsError(i)||i.length===r.length},[c.TypeSignature("where"),A(C)])("some-pass",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i=t.filter(e,r);return f.containsError(i)||i.length>0},[c.TypeSignature("where"),A(C)])("none-pass",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i=t.filter(e,r);return f.containsError(i)||0===i.length},[c.TypeSignature("where"),A(C)])("folded",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return"where"in t&&(r=t.filter(e,r)),f.containsError(r)||r.reduce(function(n,r,a){return t.apply(e,{making:n,loop:r,pos:a+1})})},[j(c.TypeSignature("where","via","making"),c.TypeSignature("via","making")),O(C)]),r.add("datanames",function(e,t){return Array.from(t.keys()).sort(n("en"))},[Map])("datavalues",function(e,t){return Array.from(t.entries()).sort(n("en",function(e){return String(e[0])})).map(function(e){return T(e[1])})},[Map])("dataentries",function(e,t){return Array.from(t.entries()).sort(function(e,t){return[e[0],t[0]].sort(n("en"))[0]===e[0]?-1:1}).map(function(e){return new Map([["name",e[0]],["value",T(e[1])]])})},[Map])("history",function(e,t){var n=i.mockVisits.concat(i.pastPassageNames());if(!t)return n;var r=t.filter(e,n.map(function(e){return s.get(e)}));return f.containsError(r)?r:r.map(function(e){return e.get("name")})},[k(c.TypeSignature("where"))])("passage",function(e,t){return T(s.get(t||i.passage))||f.create("macrocall","There's no passage named '"+t+"' in this story.")},[k(String)])("passages",function(e,t){var r=n("en"),a=[].concat(_toConsumableArray(s.values())).map(function(e){return T(e)}),i=t?t.filter(e,a):a,o=f.containsError(i);return o||i.sort(function(e,t){return r(e.get("name"),t.get("name"))})},[k(c.TypeSignature("where"))])("open-storylets",function(e,t){if(e.stackTop.evaluateOnly)return f.create("macrocall","(open-storylets:) can't be used in "+e.stackTop.evaluateOnly+".");var n=s.getStorylets(e,t),r=f.containsError(n);return r||n.map(T)},[k(c.TypeSignature("where"))])("savedgames",function(){function e(e){return"("+e+" "+o.options.ifid+") "}var t=0,n=void 0,r=new Map;do{if(!i.hasStorage)break;n=localStorage.key(t),t+=1;var a=e("Saved Game");n&&n.startsWith(a)&&(n=n.slice(a.length),r.set(n,localStorage.getItem(e("Saved Game Filename")+n)))}while(n);return r},[])(["datamap","dm"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=void 0,i=new Map,o=n.reduce(function(e,t){var n=void 0;if(f.containsError(e))return e;if(void 0===a)a=t;else{if(n=f.containsError(v(i,a)))return n;if(i.has(a))return f.create("macrocall","You used the same data name ("+y(a)+") twice in the same (datamap:) call.");i.set(a,T(t)),a=void 0}return e},!0);return f.containsError(o)?o:void 0!==a?f.create("macrocall","This datamap has a data name without a value."):i},A(j(l,C)))(["dataset","ds"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Set(n.filter(w).map(T))},A(C))("count",function e(t,n){for(var r=arguments.length,a=Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];if(a.length>1){var o,s=a.map(function(r){return e(t,n,r)});return(o=f.containsError(s))?o:s.reduce(function(e,t){return e+t},0)}var c=a[0];switch(g(n)){case"dataset":case"datamap":return f.create("macrocall","(count:) shouldn't be given a datamap or dataset.","You should use the 'contains' operator instead. For instance, write: $variable contains 'value'.");case"string":return"string"!=typeof c?f.create("macrocall",y(n)+" can't contain  "+y(c)+" because it isn't also a string."):c?n.split(c).length-1:0;case"array":return n.reduce(function(e,t){return e+b(t,c)},0);default:return f.create("macrocall",y(n)+" can't contain values, let alone "+y(c)+".")}},[C,O(C)])}),define("macrolib/stylechangers",["jquery","macros","utils","utils/renderutils","datatypes/colour","datatypes/hookset","datatypes/gradient","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c,u,l){var p=r.geomParse,f=r.geomStringRegExp,d=Object.assign,h=t.TypeSignature,y=h.either,m=h.wrapped,g=h.optional,v=h.Any,b=h.Everything,w=h.zeroOrMore,T=h.rest,S=h.insensitiveSet,x=h.positiveNumber,k=h.positiveInteger,O=h.nonNegativeNumber,j=h.percent,A=[m(Boolean,'If you gave a number, you may instead want to check that the number is not 0. If you gave a string, you may instead want to check that the string is not "".')];n.onStartup(function(){return e(n.storyElement).on("mouseenter.hover-macro","[hover=false]",function(){var t=e(this),n=t.data("hoverChanger");t.data({mouseoutStyle:t.attr("style")||""}),u.create({target:t},n).update(),t.attr("hover",!0)}).on("mouseleave.hover-macro","[hover=true]",function(){var t=e(this),n=t.data("mouseoutStyle");t.attr("style",n).removeData("mouseoutStyle").attr("hover",!1)})});var C,E,_=S("instant","dissolve","fade","rumble","shudder","pulse","zoom","flicker","slideleft","slideright","slideup","slidedown","fadeleft","faderight","fadeup","fadedown","blur"),N=S("dotted","dashed","solid","double","groove","ridge","inset","outset","none");t.addChanger("if",function(e,t){return s.create("if",[t])},function(e,t){return e.enabled=e.enabled&&t},A)("unless",function(e,t){return s.create("unless",[t])},function(e,t){return e.enabled=e.enabled&&!t},A)("elseif",function(e,t){return"lastHookShown"in e.stack[0]?s.create("elseif",[!1===e.stack[0].lastHookShown&&!!t]):l.create("macrocall","There's no (if:) or something else before this to do (else-if:) with.")},function(e,t){return e.enabled=e.enabled&&t},A)("else",function(e){return"lastHookShown"in e.stack[0]?s.create("else",[!1===e.stack[0].lastHookShown]):l.create("macrocall","There's nothing before this to do (else:) with.")},function(e,t){return e.enabled=e.enabled&&t},null)("hidden",function(){return s.create("hidden")},function(e){return e.enabled=!1},null)(["verbatim","v6m"],function(){return s.create("verbatim")},function(e){return e.verbatim=!0},null)("live",function(e,t){return s.create("live",[t])},function(e,t){e.enabled=!1,e.data.live={delay:t}},g(Number))("event",function(e,t){return s.create("event",[t])},function(e,t){e.enabled=!1,e.data.live={event:t}},c.TypeSignature("when"))("more",function(){return s.create("more")},function(e){e.enabled=!1,e.data.live={event:{when:!0,filter:function(e){return 0!==e.eval("Operations").Identifiers.exits?[]:[!0]}}}},null)("after",function(e,t,n){return s.create("after",[t].concat(void 0!==n?[n]:[]))},function(e,t,r){e.enabled=!1,e.data.live={event:{when:!0,filter:function(e){return n.anyInputDown()&&(t-=r),e.eval("Operations").Identifiers.time>t?[!0]:[]}}}},[x,g(O)])("hook",function(e,t){return t?s.create("hook",[t]):l.create("datatype","(hook:) names can't be empty strings.")},function(e,t){return e.attr.push({name:t})},[String])(["for","loop"],function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return t.loop?s.create("for",[t].concat(r)):l.create("datatype","The lambda provided to (for:) must refer to a temp variable, not just 'it'.")},function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i,o=t.filter(e.section,r);if(i=l.containsError(o))return i;e.loopVars[t.loop.getName()]=o||[]},[c.TypeSignature("where"),w(v)])(["transition","t8n"],function(e,t){return s.create("transition",[n.insensitiveName(t)])},function(t,r){return t.transition=r,"zoom"===r&&(t.transitionOrigin=function(){var t=e(this).offset(),r=t.left,a=t.top;return n.mouseCoords.x-r+"px "+(n.mouseCoords.y-a)+"px"}),t},[_])(["transition-time","t8n-time"],function(e,t){return s.create("transition-time",[t])},function(e,t){return e.transitionTime=t,e.data.passageT8n=d(e.data.passageT8n||{},{time:t}),e},[x])(["transition-delay","t8n-delay"],function(e,t){return s.create("transition-delay",[t])},function(e,t){return e.transitionDelay=t,e},[O])(["transition-skip","t8n-skip"],function(e,t){return s.create("transition-skip",[t])},function(e,t){return e.transitionSkip=t,e},[x])(["transition-depart","t8n-depart"],function(e,t){return s.create("transition-depart",[n.insensitiveName(t)])},function(t,r){return t.data.passageT8n=d(t.data.passageT8n||{},{depart:r}),"zoom"===r&&(t.data.passageT8n.departOrigin=function(){var t=e(this).offset(),r=t.left,a=t.top;return n.mouseCoords.x-r+"px "+(n.mouseCoords.y-a)+"px"}),t},[_])(["transition-arrive","t8n-arrive"],function(e,t){return s.create("transition-arrive",[n.insensitiveName(t)])},function(t,r){return t.data.passageT8n=d(t.data.passageT8n||{},{arrive:r}),"zoom"===r&&(t.data.passageT8n.arriveOrigin=function(){var t=e(this),r=t.offset(),a=r.left,i=r.top,o=t.height();return{"transform-origin":100*(n.mouseCoords.x-a)/t.width()+"% "+100*(n.mouseCoords.y-i)/o+"%",height:o+"px"}}),t},[_])("button",function(){return s.create("button",[])},function(e){return e.attr.push({class:function(){return this.className+(this.classList.contains("enchantment-button")?"":" ".repeat(this.className.length>0)+"enchantment-button")}}),e},[])(["border","b4r"],function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return s.create("border",r.map(n.insensitiveName))},function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return t.styles.push({display:function(){var t=e(this).css("display");return r.every(function(e){return"none"===e})||!t.includes("inline")?t:"inline-block"},"border-style":r.join(" "),"border-width":function(){return this.style.borderWidth||"2px"}}),t},[N].concat(_toConsumableArray(Array(3).fill(g(N)))))(["border-size","b4r-size"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s.create("border-size",n)},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-width":n.map(function(e){return e+"px"}).join(" ")}),e},[O].concat(_toConsumableArray(Array(3).fill(g(O)))))("corner-radius",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s.create("corner-radius",n)},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-radius":n.map(function(e){return e+"px"}).join(" "),padding:function(){return this.style.padding||n.map(function(e){return e+"px"}).join(" ")}}),e},[O].concat(_toConsumableArray(Array(3).fill(g(O)))))(["border-colour","b4r-colour","border-color","b4r-color"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s.create("border-colour",n.map(function(e){return a.isPrototypeOf(e)?e.toRGBAString(e):e}))},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-color":n.join(" ")}),e},[y(String,a)].concat(_toConsumableArray(Array(3).fill(g(y(String,a))))))("opacity",function(e,t){return s.create("opacity",[t])},function(e,t){return e.styles.push({opacity:t})},[j])("font",function(e,t){return s.create("font",[t])},function(e,t){return e.styles.push({"font-family":t}),e},[String])("align",function(e,t){var n=void 0,r=t.indexOf("><");if(!/^(==+>|<=+|=+><=+|<==+>)$/.test(t))return l.create("datatype",'The (align:) macro requires an alignment arrow ("==>", "<==", "==><=" etc.) be provided, not "'+t+'"');if(~r){var a=Math.round(r/(t.length-2)*50);n=d({"text-align":"center","max-width":"50%"},25===a?{"margin-left":"auto","margin-right":"auto"}:{"margin-left":a+"%"})}else n="<"===t[0]&&">"===t.slice(-1)?{"text-align":"justify","max-width":"50%"}:t.includes(">")?{"text-align":"right"}:{"text-align":"left"};return n.display="inline-block",s.create("align",[n])},function(e,t){e.styles.push(t)},[String])(["text-colour","text-color","color","colour"],function(e,t){return s.create("text-colour",[t])},function(e,t){return a.isPrototypeOf(t)&&(t=t.toRGBAString(t)),e.styles.push({color:t}),e},[y(String,a)])(["text-size","size"],function(e,t){return s.create("text-size",[t])},function(e,t){return e.styles.push({"font-size":24*t+"px","line-height":36*t+"px"}),e},[O])("text-indent",function(e,t){return s.create("text-indent",[t])},function(e,t){return e.styles.push({"text-indent":t+"px",display:"inline-block"}),e},[O])(["text-rotate-z","text-rotate"],function(e,t){return s.create("text-rotate-z",[t])},function(t,n){return t.styles.push({display:"inline-block",transform:function(){var t=e(this).css("transform")||"";return"none"===t&&(t=""),t+" rotate("+n+"deg)"}}),t},[Number])("text-rotate-y",function(e,t){return s.create("text-rotate-y",[t])},function(t,n){return t.styles.push({display:"inline-block",transform:function(){var t=e(this).css("transform")||"";return"none"===t&&(t=""),t+" perspective(50vw) rotateY("+n+"deg)"}}),t},[Number])("text-rotate-x",function(e,t){return s.create("text-rotate-x",[t])},function(t,n){return t.styles.push({display:"inline-block",transform:function(){var t=e(this).css("transform")||"";return"none"===t&&(t=""),t+" perspective(50vw) rotateX("+n+"deg)"}}),t},[Number])(["background","bg"],function(e,t){return s.create("background",[t])},function(t,r){var i=void 0;return a.isPrototypeOf(r)?r=r.toRGBAString(r):o.isPrototypeOf(r)&&(r=r.toLinearGradientString(r)),i=a.isHexString(r)||a.isCSS3Function(r)?{"background-color":r}:r.startsWith("linear-gradient(")||r.startsWith("repeating-linear-gradient(")?{"background-image":r}:{"background-size":"cover","background-image":"url("+r+")"},t.styles.push(i,{display:function(){var t=e(this);return!t.children().length||n.childrenProbablyInline(t)?e(this).css("display"):"block"}}),t},[y(String,a,o)]).apply(void 0,_toConsumableArray((C={color:function(){return"transparent"}},E=d(Object.create(null),{none:{},bold:{"font-weight":"bold"},italic:{"font-style":"italic"},underline:{"text-decoration":"underline"},doubleunderline:{"text-decoration":"underline","text-decoration-style":"double"},wavyunderline:{"text-decoration":"underline","text-decoration-style":"wavy"},strike:{"text-decoration":"line-through"},doublestrike:{"text-decoration":"line-through","text-decoration-style":"double"},wavystrike:{"text-decoration":"line-through","text-decoration-style":"wavy"},superscript:{"vertical-align":"super","font-size":".83em"},subscript:{"vertical-align":"sub","font-size":".83em"},blink:{animation:"fade-in-out 1s steps(1,end) infinite alternate"},shudder:{animation:"shudder linear 0.1s 0s infinite"},mark:{"background-color":"hsla(60, 100%, 50%, 0.6)"},condense:{"letter-spacing":"-0.08em"},expand:{"letter-spacing":"0.1em"},outline:[{"text-shadow":function(){var t=e(this).css("color");return"-1px -1px 0 "+t+", 1px -1px 0 "+t+",-1px  1px 0 "+t+", 1px  1px 0 "+t}},{color:function(){return n.parentColours(e(this)).backgroundColour}}],shadow:{"text-shadow":function(){return"0.08em 0.08em 0.08em "+e(this).css("color")}},emboss:{"text-shadow":function(){return"0.04em 0.04em 0em "+e(this).css("color")}},smear:[{"text-shadow":function(){var t=e(this).css("color");return"0em   0em 0.02em "+t+",-0.2em 0em  0.5em "+t+", 0.2em 0em  0.5em "+t}},C],blur:[{"text-shadow":function(){return"0em 0em 0.08em "+e(this).css("color")}},C],blurrier:[{"text-shadow":function(){return"0em 0em 0.2em "+e(this).css("color")},"user-select":"none"},C],mirror:{display:"inline-block",transform:"scaleX(-1)"},upsidedown:{display:"inline-block",transform:"scaleY(-1)"},fadeinout:{animation:"fade-in-out 2s ease-in-out infinite alternate"},rumble:{animation:"rumble linear 0.1s 0s infinite"},sway:{animation:"sway linear 2.5s 0s infinite"},buoy:{animation:"buoy linear 2.5s 0s infinite"},fidget:{animation:function(){return"fidget step-end 60s "+60*-Math.random()+"s infinite"+(Math.random()<.5?" reverse":"")}}}),["text-style",function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return s.create("text-style",r.map(n.insensitiveName))},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a+=1)"none"===n[a]?e.styles=[]:e.styles=e.styles.concat(E[n[a]]);return e},[T(S.apply(void 0,_toConsumableArray(Object.keys(E))))]])))("collapse",function(){return s.create("collapse")},function(e){return e.attr.push({collapsing:!0}),e},[])("hover-style",function(e,t){var n=u.create(),r=(t.run(n),n.summary());return r+""=="styles"||r.every(function(e){return"styles"===e||"attr"===e})&&n.attr.every(function(e){return Object.keys(e)+""=="style"})?s.create("hover-style",[t]):l.create("datatype","The changer given to (hover-style:) must only change the hook's style.")},function(e,t){return e.data.hoverChanger=t,e.attr.push({hover:function(e,t){return void 0!==t&&t}}),e},[s])("css",function(e,t){return t.trim().endsWith(";")||(t+=";"),s.create("css",[t])},function(t,n){return t.attr.push({style:function(){return(e(this).attr("style")||"")+n}}),t},[String])("test-true",function(){return s.create("test-true",[])},function(e){return e.enabled=!0},w(b))("test-false",function(){return s.create("test-false",[])},function(e){return e.enabled=!1},w(b)),t.addCommand("animate",e.noop,function(e,t,r,a,i){r.forEach(t,function(t){var r=void 0;if("zoom"===name){var o=t.offset(),s=o.left,c=o.top;r=n.mouseCoords.x-s+"px "+(n.mouseCoords.y-c)+"px"}n.transitionIn(t,a,e.transitionTime||i,e.transitionDelay,e.transitionSkip,0,r)})},[T(i),S.apply(void 0,_toConsumableArray(_.innerType.filter(function(e){return"instant"!==e}))),g(x)]),["box","float-box"].forEach(function(r){return t.addChanger(r,function(e,t,n){var a=-1===t.search(f)||t.length>1&&!t.includes("="),i="float-box"===r&&(-1===n.search(f)||n.length>1&&!n.includes("="));return a||i?l.create("datatype","The ("+r+':) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not "'+(a?t:n)+'".'):s.create(r,[t,n].filter(function(e){return void 0!==e}))},function(t,a,i){var o,s=p(a),c=s.marginLeft,u=s.size,l=void 0;if("float-box"===r){var f=p(i);l=f.marginLeft,i=f.size}var h="box"===r?"%":"vw",y=(_defineProperty(o={display:"block",width:u+h,"max-width":u+h},"box"===r?"margin-left":"left",c+h),_defineProperty(o,"box-sizing","content-box"),_defineProperty(o,"overflow-y","auto"),_defineProperty(o,"padding",function(){return e(this).css("padding")||"1em"}),o);return void 0!==i&&(y.height=i+("box"===r?"em":"vh")),"float-box"===r&&d(y,{position:"fixed",top:l+"vh","background-color":function(){return n.parentColours(e(this)).backgroundColour}}),t.styles.push(y),t},[String,"box"===r?g(k):String])})}),define("internaltypes/enchantment",["jquery","utils","internaltypes/changedescriptor","datatypes/changercommand","utils/operationutils","internaltypes/twineerror","utils/renderutils"],function(e,t,n,r,a,i,o){var s=a.objectName,c=o.collapse,u={create:function(n){return t.assertOnlyHas(n,["scope","localHook","section","attr","data","changer","functions","lambda","name"]),Object.assign(Object.create(this),{enchantments:e()},n)},enchantScope:function(){var a=this,o=this.attr,u=this.data,l=this.functions,p=this.section,f=this.scope,d=this.localHook,h=this.lambda,y=[];f.forEach(p,function(m,g){if(!d||(d.jquery?d:d.hooks(p)).has(m[0]).length){var v=void 0;if(h)if(v=h.apply(p,{loop:f.TwineScript_GetProperty(g),pos:g+1}),i.containsError(v))m.replaceWith(v.render("")),h=v=null;else if(r.isPrototypeOf(v)){var b=v.summary();(b.includes("newTargets")||b.includes("target"))&&(m.replaceWith(i.create("macrocall","The changer produced by the 'via' lambda given to enchantment macros can't include a revision or enchantment changer like (replace:) or (click:).").render("")),h=v=null)}else m.replaceWith(i.create("macrocall","The 'via' lambda given to enchantment macros must return a changer, not "+s(v)+".").render("")),h=v=null;else v=a.changer;var w=!o&&!u&&(!v||v.summary().every(function(e){return e.startsWith("transition")})),T=w?m:m.wrap("<tw-enchantment>").parent();if(o&&T.attr(o),u&&T.data(u),l&&l.forEach(function(e){return e(T)}),v){var S=n.create({section:p,target:T});if(v.run(S),S.update(),m.is(t.storyElement)){var x=Object.keys(Object.assign.apply(Object,[{}].concat(_toConsumableArray(S.styles))));m.css(x.reduce(function(e,t){return e[t]="inherit",e},{})),T.data({enchantedProperties:x})}else if(m.is("tw-passage")&&S.styles.some(function(e){return"margin-left"in e||"margin"in e||"margin-right"in e})){var k="padding-left",O="padding-right";t.storyElement.css(k,"0px").css(O,"0px"),T.data({enchantedProperties:[k,O]})}}m.is(t.storyElement)&&T.css({width:"100%",height:"100%"}),"true"===T.attr("collapsing")&&(T.find("[collapsing=false]").each(function(){e(this).removeAttr("collapsing")}),c(T)),w||y.push(T)}}),this.enchantments=e(y)},disenchant:function(){this.enchantments.each(function(){e(this).contents().unwrap();var n=e(this).data("enchantedProperties");n&&t.storyElement.css(n.reduce(function(e,t){return e[t]="",e},{}))})}};return Object.freeze(u)}),define("macrolib/enchantments",["jquery","utils","utils/operationutils","engine","state","passages","macros","datatypes/hookset","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/enchantment","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c,u,l,p,f){var d=n.is,h=o.TypeSignature,y=h.either,m=h.rest,g=h.optional;function v(e,t){if(c.isPrototypeOf(t)){var n=t.summary();if(["newTargets","target","appendSource","functions"].some(function(e){return n.includes(e)}))return f.create("datatype","The changer given to ("+e+":) can't include a revision or enchantment changer like (replace:) or (click:).")}}["enchant","change"].forEach(function(e){o.addCommand(e,function(t,n){var r=v(e,n);if(r)return r},function(t,n,r){var a;n=s.from(n);var i=[];if(c.isPrototypeOf(r)){var o=l.create({section:t});if(r.run(o),(o.innerEnchantments||[]).length>0){var u=o.innerEnchantments.map(function(e){return e(n)});i.push.apply(i,_toConsumableArray(u))}}return i.push(p.create((_defineProperty(a={scope:n},c.isPrototypeOf(r)?"changer":"lambda",r),_defineProperty(a,"section",t),a))),i.forEach(function(n){"enchant"===e?(t.addEnchantment(n),t.updateEnchantments()):n.enchantScope()}),""},[y(s,String),y(c,u.TypeSignature("via"))],!1)}),o.addChanger("enchant-in",function(e,t,n){var r=v("enchant-in",n);return r||c.create("enchant-in",[t,n])},function(e,t,n){return e.innerEnchantments=(e.innerEnchantments||[]).concat(function(r){var a;return p.create((_defineProperty(a={scope:s.from(t),localHook:r},c.isPrototypeOf(n)?"changer":"lambda",n),_defineProperty(a,"section",e.section),a))}),e},[y(s,String),y(c,u.TypeSignature("via"))]),[["link-style",s.create({type:"name",data:"link"})],["line-style",s.create({type:"base",data:s.create({type:"name",data:"page"})},"lines",void 0)],["char-style",s.create({type:"base",data:s.create({type:"name",data:"page"})},"chars",void 0)]].forEach(function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];o.addChanger(n,function(e,t){var r=v(n,t);return r||c.create(n,[t])},function(e,t){return e.innerEnchantments=(e.innerEnchantments||[]).concat(function(n){var a;return p.create((_defineProperty(a={scope:r,localHook:n},c.isPrototypeOf(t)?"changer":"lambda",t),_defineProperty(a,"section",e.section),a))}),e},[y(c,u.TypeSignature("via"))])});var b=["replace","append","prepend"];function w(n,a){return t.onStartup(function(){var r=n.classList.replace(/ /g,"."),a=n.blockClassList?n.blockClassList.replace(/ /g,"."):"",i="."+r+(a?",."+a:"");t.storyElement.on(n.event.map(function(e){return e+".enchantment"}).join(" "),i,function(){var t=e(Array.from(e(this).parents(i).add(this)).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0]),n=t.data("enchantmentEvent");n&&n(t)})}),[function(e,t,n){if(!t)return f.create("datatype","A string given to this ("+a+":) macro was empty.");if(n){var r=v(a,n);if(r)return r}return c.create(a,[s.from(t)].concat(n?[n]:[]))},function(e,t,i){e.enabled=!1,e.transitionDeferred=!0,n.rerender&&(e.newTargets=(e.newTargets||[]).concat({target:t,append:n.rerender}));var o=e.section&&e.section.stackTop?e.section.stackTop.tempVariables:Object.create(null),s=p.create(_defineProperty({functions:[function(e){e.attr("class",e.children().is("tw-story, tw-sidebar, tw-passage")||"block"===e.children().css("display")?n.blockClassList:n.classList)}],attr:(n.classList+"").match(/\b(?:link|enchantment-clickblock)\b/)?{tabIndex:"0"}:{},data:{enchantmentEvent:function(){e.section.stackTop&&e.section.stackTop.blocked||(n.once&&e.section.removeEnchantment(s),n.goto?r.goToPassage(n.goto,{transition:n.transition}):n.undo?r.goBack({transition:n.transition}):e.section.renderInto(e.source,null,Object.assign({},e,{enabled:!0,transitionDeferred:!1}),o))}},scope:t,section:e.section,name:a},c.isPrototypeOf(i)?"changer":"lambda",i));return e.section&&(e.section.addEnchantment(s),s.enchantScope()),e},[y(s,String),g(y(c,u.TypeSignature("via")))]]}b.forEach(function(t){o.addChanger(t,function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.every(Boolean)?c.create(t,r.map(s.from)):f.create("datatype","A string given to this ("+t+":) macro was empty.")},function(n){for(var r,a=arguments.length,i=Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return e(n.target).parents().filter("tw-collapsed,[collapsing=true]").length>0||n.attr.some(function(e){return e.collapsing})||(n.attr=[].concat(_toConsumableArray(n.attr),[{collapsing:!1}])),n.newTargets=n.newTargets||[],(r=n.newTargets).push.apply(r,_toConsumableArray(i.filter(function(e){return!n.newTargets.some(function(n){var r=n.target,a=n.append;return d(e,r)&&t===a})}).map(function(e){return{target:e,append:t,before:!0}}))),n},m(y(s,String)))(t+"-with",function(e,n){return c.create(t+"-with",[n])},function(e,n){return e.appendSource=(e.appendSource||[]).concat({source:n,append:t}),e},String)});var T="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,S=[{name:"click",enchantDesc:{event:["click"],once:!0,rerender:"",classList:"link enchantment-link",blockClassList:"enchantment-clickblock"}},{name:"mouseover",enchantDesc:{event:["mouseenter",T?"click":""].filter(Boolean),once:!0,rerender:"",classList:"enchantment-mouseover",blockClassList:"enchantment-mouseoverblock"}},{name:"mouseout",enchantDesc:{event:["mouseleave",T?"click":""].filter(Boolean),once:!0,rerender:"",classList:"enchantment-mouseout",blockClassList:"enchantment-mouseoutblock"}}];S.forEach(function(e){return o.addChanger.apply(o,[e.name].concat(_toConsumableArray(w(e.enchantDesc,e.name))))}),t.onStartup(function(){S.forEach(function(n){var r=n.enchantDesc;r.blockClassList&&t.storyElement.on(r.event.map(function(e){return e+".enchantment"}).join(" "),function(){var t=e(Array.from(e(this).parents("."+r.blockClassList.replace(/ /g,"."))).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0]),n=t.data("enchantmentEvent");n&&n(t)})})}),b.forEach(function(e){S.forEach(function(t){var n=Object.assign({},t.enchantDesc,{rerender:e}),r=t.name+"-"+e;o.addChanger.apply(o,[r].concat(_toConsumableArray(w(n,r))))})}),S.forEach(function(e){["goto","undo"].forEach(function(t){var n=e.name+"-"+t;o.addCommand(n,function(e,r){return!e||!r&&"goto"===t?f.create("datatype","A string given to this ("+n+":) macro was empty."):"goto"!==t||i.hasValid(r)?void 0:f.create("macrocall","I can't ("+n+":) the passage '"+r+"' because it doesn't exist.")},function(r,i,o,c){if("undo"===t&&a.pastLength<1)return f.create("macrocall","I can't (undo:) on the first turn.");var u=w(Object.assign({},e.enchantDesc,{transition:r.data.passageT8n},"undo"===t?{undo:!0}:{goto:c}),n);return(0,_slicedToArray(u,2)[1])({section:i},s.from(o)),Object.assign(r,{source:""})},[y(s,String)].concat("undo"===t?[]:String))})})}),define("macrolib/metadata",["macros","renderer","utils/operationutils","datatypes/lambda","internaltypes/twineerror"],function(e,t,n,r,a){var i=n.clone,o=n.objectName,s=n.isValidDatamapName,c=e.TypeSignature,u=c.zeroOrMore,l=c.Any,p=t.options.metadataMacros,f=function(e){return{TwineScript_TypeName:"a ("+e+":) macro",TwineScript_ObjectName:"a ("+e+":) macro",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}};[["storylet",r.TypeSignature("when")],["urgency",Number],["exclusivity",Number]].forEach(function(t){var n=_slicedToArray(t,2),r=n[0],a=n[1];e.add(r,function(e,t){return e.stackTop.speculativePassage?t:f(r)},a),p.push(r)}),e.add("metadata",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var c=void 0,u=new Map,l=n.reduce(function(e,t){var n=void 0;if(a.containsError(e))return e;if(void 0===c)c=t;else{if(n=a.containsError(s(u,c)))return n;if(u.has(c))return a.create("macrocall","You used the same data name ("+o(c)+") twice in the same (metadata:) call.");u.set(c,i(t)),c=void 0}return e},!0);return a.containsError(l)?l:void 0!==c?a.create("macrocall","This (metadata:) macro has a data name without a value."):e.stackTop.speculativePassage?u:f("storylet")},u(l)),p.push("metadata")}),define("macrolib/patterns",["jquery","macros","utils","utils/operationutils","datatypes/datatype","datatypes/typedvar","internaltypes/twineerror"],function(e,t,n,r,a,i,o){var s=n.anyRealLetter,c=n.anyUppercase,u=n.anyLowercase,l=n.anyCasedLetter,p=n.realWhitespace,f=n.impossible,d=r.objectName,h=r.toSource,y=t.TypeSignature,m=y.rest,g=y.either,v=y.optional,b=y.nonNegativeInteger,w=Object.assign,T=Object.create,S=m(g(String,a,i)),x=function e(t){var n,r=t.name,y=t.fullArgs,m=t.args,g=t.makeRegExpString,v=void 0===g?function(e){return e.join("")}:g,b=t.insensitive,S=void 0!==b&&b,x=t.canContainTypedVars,k=void 0===x||x,O=t.canBeUsedAlone,j=void 0===O||O,A=m||y,C=A.map(function e(t){if(i.isPrototypeOf(t)){if(!k)return o.create("operation","Optional string patterns, like ("+r+":)"+("p-many"===r?" with min 0":"")+", can't have typed variables inside them.");var n=e(t.datatype);return o.containsError(n)?n:"("+n+")"}if(a.isPrototypeOf(t)){if(!k&&"typedVars"in t&&t.typedVars().length)return o.create("operation","("+r+":) can't have typed variables inside its pattern.");if(t.regExp)return(t.rest?"(?:":"")+(S?t.insensitive().regExp:t.regExp)+(t.rest?")*":"");var h=t.name,y=t.rest?"*":"";return"alnum"===h?s+y:"whitespace"===h?p+y:"uppercase"===h?(S?l:c)+y:"lowercase"===h?(S?l:u)+y:"anycase"===h?l+y:"digit"===h?"\\d"+y:"linebreak"===h?"(?:\\r|\\n|\\r\\n)"+y:"str"===h?".*?":["even","odd","int","num"].includes(h)?o.create("datatype","Please use string datatypes like 'digit' in ("+r+":) instead of number datatypes."):o.create("datatype","The ("+r+":) macro must only be given string-related datatypes, not "+d(t)+".")}return"string"==typeof t?(t=t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),S&&(t=t.replace(RegExp("("+c+"|"+u+")","g"),function(e){return"["+e.toUpperCase()+e.toLowerCase()+"]"})),t):(f("createPattern","mapper() was given a non-string non-datatype "+t),"")});if(n=o.containsError(C))return n;var E=v(C),_=w(T(a),{name:r,regExp:E,insensitive:function(){return S?_:e({name:r,fullArgs:y,args:A.map(function(e){return a.isPrototypeOf(e)&&"function"==typeof e.insensitive?e.insensitive():e}),makeRegExpString:v,insensitive:!0,canContainTypedVars:k,canBeUsedAlone:j})},typedVars:function(){return A.reduce(function(t,n){return i.isPrototypeOf(n)&&(t=t.concat(S?i.create(e({name:"p-ins",fullArgs:[n.datatype],insensitive:!0}),n.varRef):n),n=n.datatype),a.isPrototypeOf(n)&&"function"==typeof n.typedVars&&(t=t.concat(n.typedVars())),t},[])},destructure:function(t){if("string"!=typeof t)return[o.create("operation","I can't unpack "+d(t)+" into "+this.TwineScript_ToSource()+" because it isn't a string.")];var n=this.typedVars();if(!n.length)return[];var r=(RegExp("^"+(this.rest?"(?:":"")+E+(this.rest?")*":"")+"$").exec(t)||[]).slice(1);return r.length?r.map(function(t,r){var a=n[r];if(a)return a.datatype.rest&&!a.datatype.regExp&&((a=a.TwineScript_Clone()).datatype=e({name:"p",fullArgs:[a.datatype]})),{dest:a,value:t||"",src:void 0}}).filter(Boolean):[o.create("operation","I can't unpack "+d(t)+" because it doesn't match the pattern "+this.TwineScript_ToSource()+".")]},TwineScript_IsTypeOf:function(e){return j?"string"==typeof e&&!!e.match("^"+(this.rest?"(?:":"")+E+(this.rest?")*":"")+"$"):o.create("operation","A ("+r+":) datatype must only be used with a (p:) macro.")},TwineScript_toTypeSignatureObject:function(){var e=this;return{pattern:"range",name:r,range:function(t){return e.TwineScript_IsTypeOf(t)}}},TwineScript_ToSource:function(){return(this.rest?"...":"")+"("+r+":"+y.map(h)+")"}});return Object.defineProperty(_,"TwineScript_ObjectName",{get:function(){return"a ("+r+":) datatype"}}),_};t.add(["p","pattern"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return x({name:"p",fullArgs:n})},S)(["p-either","pattern-either"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return x({name:"p-either",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("|")+")"}})},S)(["p-opt","pattern-opt","p-optional","pattern-optional"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return x({name:"p-opt",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("")+")?"}})},S)(["p-not","pattern-not"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.find(function(e){return"string"==typeof e?1!==[].concat(_toConsumableArray(e)).length:e.rest||e.regExp||["str","empty"].includes(e.name)})?o.create("datatype","(p-not:) should only be given single character"):x({name:"p-not",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"[^"+e.map(function(e){return e.startsWith("[")&&e.endsWith("]")?e.slice(1,-1):e}).join("")+"]"}})},S)(["p-many","pattern-many"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s=n.slice(),c=void 0,u=void 0;if("number"==typeof n[0]&&(c=n.shift(),u="number"==typeof n[0]?n.shift():1/0),void 0!==u&&u<c)return o.create("datatype","The (p-many:) macro needs to be given string patterns, not just min and max numbers.");if(!n.length)return o.create("datatype","The (p-many:) macro needs to be given string patterns, not just min and max numbers.");var l=n.find(function(e){return"string"!=typeof e&&!a.isPrototypeOf(e)&&!i.isPrototypeOf(e)});return l?o.create("datatype","This (p-many:) macro can only be given a min and max number followed by datatypes or strings, but was also given "+d(l)+"."):x({name:"p-many",args:n,fullArgs:s,canContainTypedVars:c>0,makeRegExpString:function(e){return"(?:"+e.join("")+")"+(void 0!==c?"{"+c+(u===1/0?",":u!==c?","+u:"")+"}":"+")}})},[m(g(b,String,a,i))])(["p-ins","pattern-ins","p-insensitive","pattern-insensitive"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return x({name:"p-ins",fullArgs:n,insensitive:!0})},S)(["split","splitted"],function(e,t,n){if(t=x({name:"split",fullArgs:[t],canContainTypedVars:!1}),o.containsError(t))return t;if(!n)return[""];if(!t.regExp)return[].concat(_toConsumableArray(n));for(var r=RegExp(t.regExp),a=[],i=void 0;n&&(i=r.exec(n));){if(i.index+i[0].length===0)return a;a.push(n.slice(0,i.index)),n=n.slice(i.index+i[0].length)}return a.concat(n||[])},[g(String,a),String])("trimmed",function(e,t,n){return void 0===n||a.isPrototypeOf(t)&&"whitespace"===t.name?t.trim():(t=x({name:"trimmed",fullArgs:[t],canContainTypedVars:!1}),o.containsError(t)?t:t.regExp?n.replace(RegExp("^("+t.regExp+")*|("+t.regExp+")*$","g"),""):n)},[g(String,a),v(String)])}),define("macrolib/links",["jquery","macros","utils","state","passages","engine","datatypes/changercommand","internaltypes/changedescriptor","datatypes/hookset","datatypes/lambda","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c,u,l){var p=t.TypeSignature,f=p.optional,d=p.rest,h=p.either,y=["Links can't have empty strings for their displayed text.","In the link syntax, a link's displayed text is inside the [[ and ]], and on the non-pointy side of the -> or <- arrow if it's there."],m=Object.assign;function g(e,t,r){r=r||t;var i=a.hasValid(t)&&t===r,o=e.evaluateTwineMarkup(n.unescape(r),"a link's passage name"),s=void 0;if(i){var c=o.children().length>0?"`".repeat((r.match(/`+/)||[]).reduce(function(e,t){return Math.max(e,t.length+1)},1)):"";t=c+"\0".repeat(!!c)+t+"\0".repeat(!!c)+c}else o.findAndFilter("tw-error").length&&(s=o.findAndFilter("tw-error").data("TwineError")),r=o.text();return{text:t,passage:r,error:s}}n.onStartup(function(){e(n.storyElement).on("click.passage-link","tw-link",function(t){var n=e(this),r=n.closest("tw-expression"),a=n.closest("tw-expression, tw-hook"),o=a.data("clickEvent"),s=a.data("section");if(!(s&&s.stackTop&&s.stackTop.blocked)){if(o){if(n.find("tw-error").length>0)return;return t.stopPropagation(),void o(n)}var c=r.data("linkPassageName"),u=Object.assign({},r.data("passageT8n")||{});return r.find("tw-enchantment").each(function(t,n){Object.assign(u,e(n).data("passageT8n")||{})}),c?(t.stopPropagation(),void i.goToPassage(c,{transition:u})):n.is("[undo]")?(t.stopPropagation(),void i.goBack({transition:u})):n.is("[fullscreen]")?(t.stopPropagation(),void i.toggleFullscreen()):void 0}}),e(document).on("fullscreenchange",function(){e("tw-link[fullscreen]",n.storyElement).each(function(t,n){(e(n).closest("tw-expression, tw-hook").data("fullscreenEvent")||Object)(n)})})}),[["link","link-replace"],["link-reveal"],["link-repeat"],["link-rerun"]].forEach(function(e){return t.addChanger(e,function(t,n,r){if(!n)return l.create("datatype",y[0]);if(r){var a=r.summary();if(["newTargets","target","appendSource","functions"].some(function(e){return a.includes(e)}))return l.create("datatype","The changer given to ("+e[0]+":) can't include a revision or enchantment changer like (replace:) or (click:).")}return o.create(e[0],[n].concat(r||[]))},function(t,n,r){var a=e[0],i=t.section&&t.section.stackTop?t.section.stackTop.tempVariables:Object.create(null),o=s.create({source:"<tw-link tabindex=0>"+n+"</tw-link>",target:function(){return t.target},append:"replace",data:{section:t.section,clickEvent:function(e){t.enablers=t.enablers.filter(function(e){return e.descriptor!==o}),"link-reveal"===a&&e.contents().unwrap();var n=e.parentsUntil(":not(tw-enchantment)").parent();if(n.length||(n=e.parent()),"link-rerun"===a){var r=e.parentsUntil(":not(tw-enchantment)");e.detach(),r.remove()}"link"!==a&&"link-rerun"!==a||n.empty(),t.section.renderInto("",null,t,i),"link-rerun"===a&&n.prepend(e)}}});return t.enablers=(t.enablers||[]).concat({descriptor:o,changer:r}),t},[String,f(o)])}),t.addCommand("link-goto",function(e){if(!e)return l.create.apply(l,["datatype"].concat(y))},function(e,t,i,o){var s,c=g(t,i,o);if(i=c.text,o=c.passage,s=c.error)return s;if(e.transition){var u="transition";return l.create("datatype","Please attach ("+u+"-depart:) or ("+u+"-arrive:) to a passage link, not ("+u+":).")}var p=void 0;return a.hasValid(o)||(p='<tw-broken-link passage-name="'+n.escape(o)+'">'+i+"</tw-broken-link>"),p=p||"<tw-link tabindex=0 "+(r.passageNameVisited(o)>0?'class="visited" ':"")+">"+i+"</tw-link>",e.data.linkPassageName=o,e.data.section=t,m(e,{source:p,transitionDeferred:!0})},[String,f(String)])("link-storylet",function(){var e,t=(e=1===arguments.length||"string"!=typeof(arguments.length<=0?void 0:arguments[0])?0:1,arguments.length<=e?void 0:arguments[e]);if(!t||"string"==typeof t)return l.create("datatype","(link-storylet:) should be given one index number or one 'where' lambda, after the optional link text string.")},function(e,t){var n,i,o,s=(n=2+(1==(arguments.length<=2?0:arguments.length-2)?0:3==(arguments.length<=2?0:arguments.length-2)||"string"==typeof(arguments.length<=2?void 0:arguments[2])?1:2),arguments.length<=n?void 0:arguments[n]),c="string"==typeof(arguments.length<=2?void 0:arguments[2])&&(arguments.length<=2?void 0:arguments[2]),p=(i=(arguments.length<=2?0:arguments.length-2)-1+2,(arguments.length<=i?void 0:arguments[i])!==s&&(o=(arguments.length<=2?0:arguments.length-2)-1+2,arguments.length<=o?void 0:arguments[o]));if(e.transition){var f="transition";return l.create("datatype","Please attach ("+f+"-depart:) or ("+f+"-arrive:) to (link-storylet:), not ("+f+":).")}var d=u.isPrototypeOf(s),h=a.getStorylets(t,d&&s),y=l.containsError(h);if(y)return y;var g=h[d?0:s<0?h.length+s:s-1],v=void 0;if(g)g=g.get("name"),c=c||g,v=v||"<tw-link tabindex=0 "+(r.passageNameVisited(g)>0?'class="visited" ':"")+">"+c+"</tw-link>",e.data.linkPassageName=g,e.data.section=t;else{if(!p)return e;v=p}return m(e,{source:v,transitionDeferred:!0})},[h(parseInt,String,u.TypeSignature("where")),f(h(parseInt,String,u.TypeSignature("where"))),f(String)])("link-undo",function(e){if(!e)return l.create("datatype",y[0])},function(e,t,n){return r.pastLength<1?l.create("macrocall","I can't use (link-undo:) on the first turn."):(e.data.section=t,m(e,{source:"<tw-link tabindex=0 undo>"+n+"</tw-link>",transitionDeferred:!0}))},[String])("link-show",function(e){if(!e)return l.create("datatype",y[0])},function(t,n,r){for(var a=arguments.length,i=Array(a>3?a-3:0),o=3;o<a;o++)i[o-3]=arguments[o];return t.data.section=n,t.data.clickEvent=function(r){r.contents().unwrap(),i.forEach(function(r){return r.forEach(n,function(r){var a=r.data("originalSource")||"",i=r.data("hidden");if(i)if(r.removeData("hidden"),i instanceof e)r.empty().append(i);else{var o=r.data("tempVariables");n.renderInto("",null,m({},t,{source:a,target:r,transitionDeferred:!1}),o&&Object.create(o))}})})},m(t,{source:"<tw-link tabindex=0>"+r+"</tw-link>",transitionDeferred:!0})},[String,d(c)])("link-fullscreen",function(e,t){if(!e||!t)return l.create("datatype",y[0])},function(e,t,n,r){var a=function(){return document.fullscreenEnabled||document.msFullscreenEnabled?"<tw-link tabindex=0 fullscreen>"+(document.fullscreenElement||document.msFullscreenElement?r:n)+"</tw-link>":r?"<tw-broken-link>"+r+"</tw-broken-link>":""},i=t.stackTop.tempVariables;return e.data.section=t,e.data.fullscreenEvent=function(){(document.fullscreenEnabled||document.msFullscreenEnabled)&&e.data.section.whenUnblocked(function(){var t=m({},e,{append:"replace",source:a(),transitionDeferred:!1});e.section.renderInto("",null,t,i)})},m(e,{source:a(),transitionDeferred:!0})},[String,String,f(String)]),t.addChanger(["link-reveal-goto"],function(e,t,n,r){if(!t)return l.create.apply(l,["datatype"].concat(y));if(o.isPrototypeOf(n)){if(o.isPrototypeOf(r))return l.create("datatype","You mustn't give two changers to (link-reveal-goto:)");r=n,n=void 0}if(r){var a=r.summary();if(["newTargets","target","appendSource","functions"].some(function(e){return a.includes(e)}))return l.create("datatype","The changer given to (link-reveal-goto:) can't include a revision or enchantment changer like (replace:) or (click:).")}var i=g(e,t,n);return t=i.text,n=i.passage,i.error||o.create("link-reveal-goto",[t,n,r].filter(function(e){return void 0!==e}))},function(e,t,o,c){if(a.hasValid(o)){var u=r.passageNameVisited(o),l=e.section&&e.section.stackTop?e.section.stackTop.tempVariables:Object.create(null),p=s.create({source:"<tw-link tabindex=0 "+(u>0?'class="visited" ':"")+">"+t+"</tw-link>",target:e.target,append:"replace",data:{section:e.section,append:"replace",clickEvent:function(t){e.enablers=e.enablers.filter(function(e){return e.descriptor!==p}),t.contents().unwrap(),e.section.renderInto("",null,e,l),e.section.whenUnblocked(function(){return i.goToPassage(o,{transition:e.data.passageT8n})})}}});return e.enablers=(e.enablers||[]).concat({descriptor:p,changer:c}),e}e.source='<tw-broken-link passage-name="'+n.escape(o)+'">'+t+"</tw-broken-link>"},[String,f(h(o,String)),f(o)])}),define("macrolib/custommacros",["utils","macros","state","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/codehook","datatypes/typedvar","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c){var u=t.add,l=t.addChanger,p=t.addCommand,f=t.TypeSignature,d=f.rest,h=f.either,y=f.Any,m=r.objectName;u("macro",function(t){for(var r=arguments.length,a=Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];var u=void 0,l=[];for(u=0;u<a.length;u+=1){var p=u===a.length-1;if(s.isPrototypeOf(a[u])===p)return c.create("datatype","The "+(p?"":e.nth(a.length-u+1)+"-")+"last value given to (macro:) should be a "+(p?"code hook":"datatyped variable")+", not "+m(a[u]));if(!p){var f="A custom macro";if(a[u].varRef.object===n.variables)return c.create("datatype",f+"'s typed variables must be temp variables (with a '_'), not global variables (with a '$').","Write them with a _ symbol at the start instead of a $ symbol.");if(a[u].varRef.propertyChain.length>1)return c.create("datatype",f+"'s typed variables can't be properties inside a data structure.");if(a[u].datatype.rest&&u!==a.length-2)return c.create("datatype",f+" can only have one spread variable, and it must be its last variable.");var d=a[u].varRef.propertyChain[0];if(l.includes(d))return c.create("datatype",f+"'s typed variables can't both be named '"+d+"'.");l.push(d)}}return i.create(a.slice(0,-1),a[a.length-1])},[d(h(s,o))]);var g=function(e,t,n){if(!t.some(function(e){if("function"==typeof e.output)return e.output(n),!0}))return c.create("macrocall","("+e+":) should only be used inside a code hook passed to (macro:).")};p(["output-data","out-data"],function(){},function(e,t){var n=e.stack;return g("output-data",n,t)||"blocked"},[y],!1),l(["output","out"],function(e){return Object.assign(a.create("output",[e]))},function(e,t){var n=t.stack,r=t.stackTop;return e.loopVars=Object.keys(r.tempVariables).reduce(function(e,t){return e[t]=[r.tempVariables[t]],e},{}),g("output",n,e),r.blocked=!0,e},[]),p("error",function(e){if(!e)return c.create("datatype","This (error:) macro was given an empty string.")},function(e,t){var n=e.stack;return g("error",n,c.create("user",t))||"blocked"},[String],!1)}),define("repl",["utils","engine","markup","twinescript/compiler","twinescript/environ"],function(e,t,n,r,a){e.onStartup(function(){return setTimeout(function(){t.options.debug&&(window.REPL=function(e){var t=r(n.lex("(print:"+e+")"));console.log(t);var i=a({}).eval(t);return i.TwineScript_Run?i.TwineScript_Run().source:i},window.LEX=function(e){var t=n.lex(e);return 1===t.length?t[0]:t})})})}),require.config({paths:{jquery:"../node_modules/jquery/dist/jquery",almond:"../node_modules/almond/almond","es6-shim":"../node_modules/es6-shim/es6-shim",jqueryplugins:"utils/jqueryplugins",markup:"./markup/markup",lexer:"./markup/lexer",patterns:"./markup/patterns"},deps:["es6-shim","jqueryplugins"]}),require(["jquery","debugmode/mode","renderer","state","section","engine","passages","utils","utils/renderutils","internaltypes/varscope","internaltypes/twineerror","macros","macrolib/values","macrolib/commands","macrolib/datastructures","macrolib/stylechangers","macrolib/enchantments","macrolib/metadata","macrolib/patterns","macrolib/links","macrolib/custommacros","repl"],function($,DebugMode,Renderer,State,Section,Engine,Passages,Utils,_ref118,VarScope,TwineError){var dialog=_ref118.dialog;function __HarloweEval(text){return eval(text+"")}var _installHandlers=function(){$(document.documentElement).on("keydown",function(e){13===e.which&&"0"===e.target.getAttribute("tabindex")&&$(e.target).trigger("click")}),Engine.options.debug?DebugMode():TwineError.on("error",function(e,t){return!$("tw-debugger").length&&DebugMode(e,t)}),_installHandlers=null},oldOnError;function printJSError(e){var t=e.name+": "+e.message;if(e.stack){var n=e.stack.split("\n"),r=n.findIndex(function(e){return e.includes("__HarloweEval")});t+="\n"+n.slice(0,r).join("\n").replace(/\([^\)]+\)/g,"")}return"<div style='font-family:monospace;overflow-y:scroll;max-height:30vh'>```"+t+"```</div>"}oldOnError=window.onerror,window.onerror=function(e,t,n,r,a){window.onerror=oldOnError,Utils.storyElement.parent().append(dialog({message:"Sorry to interrupt, but this page's code has got itself in a mess.\n\n"+printJSError(a)+"\n(This is probably due to a bug in the Harlowe game engine.)"})),"function"==typeof oldOnError&&oldOnError.apply(void 0,arguments)},Utils.onStartup(function(){var e=$("tw-storydata");if(0!==e.length){var t=e.attr("options");t&&t.split(/\s/).forEach(function(e){Renderer.options[e]=Engine.options[e]=!0});var n=e.attr("startnode");Renderer.options.ifid=Engine.options.ifid=e.attr("ifid"),n||(n=[].reduce.call($("tw-passagedata"),function(e,t){var n=t.getAttribute("pid");return n<e?n:e},1/0)),n=$("tw-passagedata[pid="+n+"]").attr("name"),_installHandlers();var r=!1;$("[role=script]").each(function(e){try{__HarloweEval($(this).html())}catch(t){r||(r=!0,dialog({parent:Utils.storyElement.parent(),message:"There is a problem with this story's "+Utils.nth(e+1)+" script:\n\n"+printJSError(t)}))}}),$("[role=stylesheet]").each(function(e){$(document.head).append('<style data-title="Story stylesheet '+(e+1)+'">'+$(this).html())});var a=Section.create();a.stack=[{tempVariables:Object.create(VarScope)}];var i=Passages.loadMetadata(a);if(i.length){var o=dialog({parent:Utils.storyElement.parent(),message:"These errors occurred when running the `(metadata:)` macro calls in this story's passages:<p></p>"});i.forEach(function(e){return o.find("p").append(e.render(""))})}var s=!Engine.options.debug&&State.hasSessionStorage&&sessionStorage.getItem("Saved Session");s&&!0===State.deserialise(a,s)?Engine.showPassage(State.passage,!1):Engine.goToPassage(n)}})}),define("harlowe",function(){}),require(["harlowe"])}();
</script>

</body>
</html>
